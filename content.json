{"meta":{"title":"wangba's blogs","subtitle":"","description":"è¾å»å·²æ— å¹´å°‘æ—¥,ç¾ç»Šæ°¸ç»“å°‘å¹´å¿ƒ","author":"wangba","url":"http://wangba.me","root":"/"},"pages":[{"title":"about","date":"2020-08-12T01:50:42.000Z","updated":"2020-09-11T12:03:23.090Z","comments":true,"path":"about/index.html","permalink":"http://wangba.me/about/index.html","excerpt":"","text":"ğŸ‘‹ &nbsp;Hey there! Iâ€™m WangbağŸ˜¯ About meIâ€™m a student of USTC, Iâ€™m a Javaer (Java NO.1 !!!)Welcome to my website: wangbaâ€™s blogs or wangbaâ€™s blog"},{"title":"categories","date":"2020-08-12T00:57:07.000Z","updated":"2020-09-29T06:10:59.525Z","comments":true,"path":"categories/index.html","permalink":"http://wangba.me/categories/index.html","excerpt":"","text":""},{"title":"link","date":"2020-08-12T00:57:15.000Z","updated":"2020-09-29T06:14:20.312Z","comments":true,"path":"friends/index.html","permalink":"http://wangba.me/friends/index.html","excerpt":"","text":""},{"title":"tags","date":"2020-08-12T00:56:53.000Z","updated":"2020-09-29T06:11:31.657Z","comments":true,"path":"tags/index.html","permalink":"http://wangba.me/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"Queue","slug":"Queue","date":"2020-11-24T12:38:44.000Z","updated":"2020-11-24T13:20:13.680Z","comments":true,"path":"2020/11/24/Queue/","link":"","permalink":"http://wangba.me/2020/11/24/Queue/","excerpt":"","text":"ä¸€ã€OverViewåœ¨å‰é¢å·²ç»çœ‹è¿‡å—é™çš„çº¿æ€§åºåˆ—ï¼šæ ˆ åœ¨æœ¬ç« ä¸­å¯ä»¥çœ‹ä¸€ä¸‹å¦å¤–ä¸€ä¸ªå—é™çš„çº¿æ€§åºåˆ—ï¼šé˜Ÿåˆ— åœ¨æœ¬ç« ä¸­å¯ä»¥çœ‹åˆ°ï¼š ğŸ¢ : é¦–å…ˆå¯¹æ¯”ä¸€ä¸‹æ ˆï¼Œå¹¶ä»‹ç»ä¸€ä¸‹é˜Ÿåˆ—çš„ç‰¹æ€§ ğŸ· : åœ¨è¿™ä¸€å°èŠ‚ä¸­åˆ†åˆ«ç”¨æ•°ç»„å’Œé“¾è¡¨å®ç°ä¸€ä¸‹é˜Ÿåˆ—ï¼Œä¸»è¦æ˜¯ç”¨æ•°ç»„å®ç° ğŸ­ : åœ¨è¿™ä¸€å°èŠ‚ä¸»è¦ä»‹ç»ä¸€ä¸‹å‡ ä¸ªç‰¹æ®Šçš„é˜Ÿåˆ—ï¼Œå…¶ä¸­ä¸»è¦æ˜¯ä¼˜å…ˆé˜Ÿåˆ—å’ŒåŒç«¯é˜Ÿåˆ— ğŸ‚ : ç”±äºåœ¨ Java ä¸­ï¼Œé˜Ÿåˆ—æ˜¯ä¸€ä¸ªæ¥å£ï¼Œç®€å•çœ‹ä¸€ä¸‹å®ç°ç±» äºŒã€ç‰¹æ€§é¦–å…ˆæ¥å›å¿†ä¸€ä¸‹æ ˆçš„ç‰¹æ€§ï¼šå…ˆè¿›åå‡ºï¼Œåè¿›å…ˆå‡º è€Œé˜Ÿåˆ—çš„ç‰¹æ€§å°±æ˜¯ï¼šå…ˆè¿›å…ˆå‡ºï¼Œåè¿›åå‡º å¯ä»¥çœ‹ä¸€ä¸‹ä¸‹é¢çš„ä¾‹å­ï¼š å­—ç¬¦ä¸² â€œwangâ€ ä¾æ¬¡å…¥é˜Ÿï¼Œéšåå†å‡ºé˜Ÿï¼ˆçœç•¥éƒ¨åˆ†æ­¥éª¤ï¼‰ ä¸‰ã€å®ç°é˜Ÿåˆ—3.1 æ•°ç»„å®ç°é¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“æœ‰å“ªäº›æ“ä½œï¼š åªåœ¨é˜Ÿå°¾è¿›è¡Œå…¥é˜Ÿçš„æ“ä½œï¼šenqueue åªåœ¨é˜Ÿå¤´è¿›è¡Œå‡ºé˜Ÿçš„æ“ä½œï¼šdequeue 1234567891011121314151617181920212223242526272829303132public class LC0000ArrayQueue &#123; private String[] elements; private int capacity = 0; private int front = 0; private int tail = 0; public LC0000ArrayQueue(int n) &#123; elements = new String[n]; capacity = n; &#125; // enqueue public boolean enqueue(String element) &#123; if (tail == capacity) return false; elements[tail] = element; tail++; return true; &#125; // dequeue public String dequeue() &#123; if (front == tail) return null; String res = elements[front]; front++; return res; &#125;&#125; ä½†æ˜¯ä»”ç»†æƒ³æƒ³è¿™ä¸ªæ˜¯æœ‰é—®é¢˜çš„ï¼Œå°±æ‹¿ä¸Šé¢é‚£ä¸ªä¾‹å­æ¥è¯´ï¼Œå®ƒå…¨éƒ¨å…¥é˜Ÿå’Œå…¨éƒ¨å‡ºé˜Ÿåçš„ç»“æœåº”è¯¥æ˜¯è¿™æ ·ï¼š é‚£ä¹ˆå·¦è¾¹çš„ç©ºé—´å°±æ²¡æœ‰å†ä½¿ç”¨äº†ï¼Œå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿæ¥è€ƒè™‘ä¸€ä¸‹åœ¨æ•°ç»„ä¸­æ˜¯å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ•°ç»„ä¸­åˆ é™¤ä¸€ä¸ªå…ƒç´ ï¼Œç„¶åç§»åŠ¨æŠŠè¿™ä¸ªå…ƒç´ åçš„æ‰€æœ‰æ•°æ®éƒ½å‘å‰ç§»åŠ¨ä¸€ä½ã€‚ é‚£ä¹ˆåœ¨è¿™é‡Œåªéœ€è¦å‡ºé˜Ÿä¸€ä¸ªå…ƒç´ ï¼ŒéšåæŠŠæ‰€æœ‰å…ƒç´ å‘å‰ç§»åŠ¨ä¸€ä½å³å¯ã€‚ä½†æ˜¯è¿™ä¸ªæ¯å‡ºé˜Ÿä¸€ä¸ªå…ƒç´ å°±ç§»åŠ¨ä¸€ä½ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(n)ï¼Œç¨å¾®ä¼˜åŒ–ä¸€ä¸‹ï¼Œåªåœ¨æˆ‘ä»¬éœ€è¦å®ƒçš„æ—¶å€™æ‰è¿›è¡Œç§»åŠ¨æ“ä½œã€‚é‚£ä¹ˆæˆ‘ä»¬ä»€ä¹ˆæ—¶å€™æ˜¯éœ€è¦åˆ°è¿™äº›ç©ºä½™çš„ç©ºé—´å‘¢ï¼Œæ˜¯ä¸æ˜¯åªæœ‰åœ¨å…ƒç´ å…¥é˜Ÿçš„æ—¶å€™æ‰éœ€è¦ï¼Œæ‰€ä»¥åªéœ€è¦åœ¨å…¥é˜Ÿçš„æ—¶å€™è¿›è¡Œæ•°æ®æ¬ç§»çš„æ“ä½œå³å¯ï¼Œä»£ç å¦‚ä¸‹ï¼š 123456789101112131415// enqueuepublic boolean enqueue(String element) &#123; if (tail == capacity) &#123; // queue is full if (front == 0) return false; for (int i = front; i &lt; elements.length; i++) &#123; elements[i - front] = elements[i]; &#125; tail -= front; front = 0; &#125; elements[tail] = element; tail++; return true;&#125; é¦–å…ˆè¦åˆ¤æ–­ä¸€ä¸‹é˜Ÿåˆ—æ˜¯ä¸æ˜¯çœŸçš„æ»¡äº† å¦‚æœä¸æ˜¯æ»¡çš„ï¼Œå°±å¯ä»¥å°† front åˆ° tail çš„å…ƒç´ å…¨éƒ¨æ¬åˆ° 0 åˆ° tail - front çš„ä½ç½® 3.2 é“¾è¡¨å®ç°ç”¨é“¾è¡¨å®ç°çš„è¯ï¼Œå°±ä¸ç”¨è€ƒè™‘ capacity çš„é—®é¢˜äº†ï¼Œç†è®ºä¸Šåœ¨å†…å­˜è¶³å¤Ÿçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥æ— é™å…¥é˜Ÿï¼Œ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748public class LC0000LinkedListQueue &#123; private Node front; private Node tail; // enqueue public void enqueue(String element) &#123; if (tail == null) &#123; Node next = new Node(element, null); front = next; tail = next; &#125; else &#123; tail.next = new Node(element, null); tail = tail.next; &#125; &#125; // dequeue public String dequeue() &#123; if (front == tail) return null; String res = front.val; front = front.next; if (front == null) &#123; tail = null; &#125; return res; &#125;&#125;class Node &#123; public String val; public Node next; public Node(String val) &#123; this.val = val; &#125; Node(String val, Node next) &#123; this.val = val; this.next = next; &#125;&#125; å››ã€ä¸€äº›ç‰¹æ®Šçš„é˜Ÿåˆ—4.1 å¾ªç¯é˜Ÿåˆ—åœ¨ä¸Šé¢ç”¨æ•°ç»„å®ç°é˜Ÿåˆ—æ—¶ï¼Œç”±äºé˜Ÿåˆ—çš„ç‰¹æ€§ä½¿å¾—æˆ‘ä»¬å·²ç»å°†å…¶è¿›è¡Œäº†ä¸€æ¬¡ä¼˜åŒ–ï¼Œåœ¨æ¯æ¬¡è¿›è¡Œå…¥é˜Ÿæ“ä½œæ—¶éƒ½è¦æœ‰æ¡ä»¶çš„è¿›è¡Œä¸€æ¬¡æ•°æ®ç§»åŠ¨æ“ä½œï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(n)ï¼Œé‚£æœ‰æ²¡æœ‰èƒ½å°†è¿™ä¸ªæ—¶é—´å¤æ‚åº¦ä¹Ÿçœå»çš„é˜Ÿåˆ—æ“ä½œå‘¢ï¼Ÿè¿™å°±æ˜¯æœ¬å°èŠ‚ä»‹ç»çš„ä¸€ç§ç‰¹æ®Šçš„é˜Ÿåˆ—ï¼šå¾ªç¯é˜Ÿåˆ— é¡¾åæ€ä¹‰ï¼Œè¿™ç§é˜Ÿåˆ—æœ€å¤§çš„ç‰¹ç‚¹å°±åœ¨äº å¾ªç¯ äºŒå­—ï¼Œé‚£åˆ°åº•è¦å¦‚ä½•å®ç°è¿™ä¸ªå¾ªç¯å‘¢ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸ªä¾‹å­ï¼š æˆ‘ä»¬æ­£å¸¸æƒ…å†µä¸‹ï¼Œç©ºä½™çš„ç©ºé—´å°±æ˜¯å·¦è¾¹é‚£éƒ¨åˆ†ç©ºç™½ï¼Œå¦‚æœæˆ‘ä»¬èƒ½å®ç°ç›´æ¥å°†æ–°åŠ å…¥çš„å…ƒç´ ç›´æ¥æ”¾å…¥å·¦è¾¹ç©ºç™½çš„ç©ºé—´ä¸å°±è¡Œäº†å—ï¼Ÿé‚£ä¹ˆç”¨ä»€ä¹ˆæ“ä½œæ‰èƒ½è¾¾åˆ°è¿™æ ·çš„æ•ˆæœå‘¢ï¼Œä½¿ç”¨ å–ä½™ è¿™ä¸ªæ•°å­¦æ“ä½œå³å¯ã€‚ çœ‹èµ·æ¥çš„ç¡®æ˜¯å¾ˆ easy ï¼Œåªè¦å°† tail = (tail + 1) % capacity å³å¯ï¼Œä½†æ˜¯äº‹å®çœŸçš„å¦‚æ­¤å—ï¼Ÿ åœ¨å‰é¢ä½¿ç”¨æ•°ç»„å®ç°é˜Ÿåˆ—æ—¶ï¼Œæˆ‘ä»¬å¯¹æ ˆç©ºå’Œæ ˆæ»¡çš„åˆ¤æ–­æ˜¯è¿™æ ·çš„ æ ˆç©ºï¼šfront == tail æ ˆæ»¡ï¼štail == capacity é‚£åœ¨å¾ªç¯é˜Ÿåˆ—ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•å®ç°è¿™ä¸¤ä¸ªåˆ¤æ–­å‘¢ï¼Ÿè¿˜æ˜¯ä¸¾ä¸ªä¾‹å­ï¼Œä¸ºäº†æ›´åŠ æ–¹ä¾¿ç†è§£ï¼Œæˆ‘å°†æ•°ç»„çš„é¦–å°¾ç›¸è¿ï¼Œæœ¬è´¨æ˜¯è¿˜æ˜¯ä¸€ä¸ªæ•°ç»„ï¼š æ ˆç©ºï¼šfront == tail æ ˆæ»¡ï¼šåœ¨å¾ªç¯é˜Ÿåˆ—ä¸­ç”¨ tail == capacity åˆ¤æ–­æ ˆæ»¡è‚¯å®šä¸åœ¨åˆé€‚ã€‚åœ¨ä¸Šé¢å³å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¯¥å¾ªç¯æ ˆè¿˜æ²¡æœ‰æ»¡ï¼Œæˆ‘ä»¬å°è¯•åœ¨å…¶ä¸­å†å¢åŠ ä¸€ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆæ ˆæ»¡çš„åˆ¤æ–­å°±å˜æˆäº† front == tail ï¼Œè¿™å°±å’Œåˆ¤æ–­æ ˆç©ºä¸€æ ·äº†ï¼Œæ‰€ä»¥åœ¨å¾ªç¯é˜Ÿåˆ—ä¸­ï¼Œæˆ‘ä»¬æ€»æ˜¯ä¼šæµªè´¹ä¸€ä¸ªç©ºé—´ï¼Œå³ tail æŒ‡å‘çš„çš„æ•°æ®ä¸ºç©ºï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢å³å›¾è¿™æ ·çš„æƒ…å†µï¼Œé‚£ä¹ˆæ­¤æ—¶åˆ¤æ–­æ ˆæ»¡çš„æ¡ä»¶å°±å˜æˆäº†ï¼š (tail + 1) % capacity == front ä¸Šä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233public class LC0000CycleQueue &#123; private String[] elements; private int capacity = 0; private int front = 0; private int tail = 0; public LC0000CycleQueue(int n) &#123; elements = new String[n]; capacity = n; &#125; // enqueue public boolean enqueue(String element) &#123; // judging queue is full if ((tail + 1) % capacity == front) return false; elements[tail] = element; tail = (tail + 1) % capacity; return true; &#125; // dequeue public String dequeue() &#123; // judging queue is empty if (front == tail) return null; String res = elements[front]; front = (front + 1) % capacity; return res; &#125;&#125; 4.2 ä¼˜å…ˆé˜Ÿåˆ—è¿™ä¸€å°èŠ‚ä»‹ç»ä¸€ä¸‹å¦ä¸€ç§ç‰¹æ®Šçš„é˜Ÿåˆ—ï¼šä¼˜å…ˆé˜Ÿåˆ—ã€‚è€è§„çŸ©ï¼Œå…ˆè¯´ä¸€ä¸‹ç‰¹æ€§ï¼š æœ¬è´¨ä¸Šè¿˜æ˜¯é˜Ÿåˆ—ï¼Œæ‰€ä»¥é˜Ÿåˆ—è¯¥æœ‰çš„æ“ä½œå®ƒéƒ½æœ‰ ä½†æ˜¯å®ƒçš„ enqueue å’Œ dequeue çš„æ“ä½œç»“æœå¯èƒ½ä¸æ­£å¸¸çš„é˜Ÿåˆ—ç»“æœä¸ä¸€æ ·ï¼š enqueue : æ’å…¥ä¸€ä¸ªå…ƒç´  dequeue : åˆ é™¤æœ€å°å€¼æ“ä½œï¼ˆè¿”å›å¹¶åˆ é™¤æœ€å°å…ƒç´ ï¼‰æˆ–åˆ é™¤æœ€å¤§å€¼æ“ä½œï¼ˆè¿”å›å¹¶åˆ é™¤æœ€å¤§å…ƒç´ ï¼‰ ä¼˜å…ˆé˜Ÿåˆ—çš„ä¸»è¦æ“ä½œï¼š ä¼˜å…ˆé˜Ÿåˆ—æ˜¯å…ƒç´ çš„å®¹å™¨ï¼Œæ¯ä¸ªå…ƒç´ æœ‰ä¸€ä¸ªç›¸å…³çš„é”®å€¼ï¼› insert(key, data)ï¼šæ’å…¥é”®å€¼ä¸ºkeyçš„æ•°æ®åˆ°ä¼˜å…ˆé˜Ÿåˆ—ä¸­ï¼Œå…ƒç´ ä»¥å…¶keyè¿›è¡Œæ’åºï¼› deleteMin/deleteMaxï¼šåˆ é™¤å¹¶è¿”å›æœ€å°/æœ€å¤§é”®å€¼çš„å…ƒç´ ï¼› getMinimum/getMaximumï¼šè¿”å›æœ€å°/æœ€å¤§å‰‘æŒ‡çš„å…ƒç´ ï¼Œä½†ä¸åˆ é™¤å®ƒï¼› ä¼˜å…ˆé˜Ÿåˆ—çš„è¾…åŠ©æ“ä½œï¼š ç¬¬kæœ€å°/ç¬¬kæœ€å¤§ï¼šè¿”å›ä¼˜å…ˆé˜Ÿåˆ—ä¸­é”®å€¼ä¸ºç¬¬kä¸ªæœ€å°/æœ€å¤§çš„å…ƒç´ ï¼› å¤§å°ï¼ˆsizeï¼‰ï¼šè¿”å›ä¼˜å…ˆé˜Ÿåˆ—ä¸­çš„å…ƒç´ ä¸ªæ•°ï¼› å †æ’åºï¼ˆHeap Sortï¼‰ï¼šåŸºäºé”®å€¼çš„ä¼˜å…ˆçº§å°†ä¼˜å…ˆé˜Ÿåˆ—ä¸­çš„å…ƒç´ è¿›è¡Œæ’åºï¼› ä¼˜å…ˆé˜Ÿåˆ—åŸºäºä»€ä¹ˆå®ç°æœ€å¥½ï¼Ÿ å®ç° æ’å…¥ åˆ é™¤ å¯»æ‰¾æœ€å°å€¼ æ— åºæ•°ç»„ 1 n n æ— åºé“¾è¡¨ 1 n n æœ‰åºæ•°ç»„ n 1 1 æœ‰åºé“¾è¡¨ n 1 1 äºŒå‰æœç´¢æ ‘ logn(å¹³å‡) logn(å¹³å‡) logn(å¹³å‡) å¹³è¡¡äºŒå‰æœç´¢æ ‘ logn logn logn äºŒå‰å † logn logn 1 å¯ä»¥çœ‹åˆ°ä¸€èˆ¬çš„ä¼˜å…ˆé˜Ÿåˆ—éƒ½æ˜¯åŸºäº äºŒå‰å † å®ç°ï¼Œå…·ä½“å¦‚ä½•å®ç°æš‚æ—¶ä¸ç»†è®²ï¼Œç­‰åˆ°å†™åˆ°äºŒå‰å †çš„æ—¶å€™æåŠä¸€ä¸‹ åœ¨ LeetCode ä¸­å…³äºä¼˜å…ˆé˜Ÿåˆ—çš„é¢˜ç›®ä¹Ÿä¸å°‘ï¼Œæœ€ç»å…¸çš„å°±æ˜¯ 0023. Merge k Sorted Lists ï¼Œå…·ä½“è§£æ³•å¯ä»¥çœ‹ä¸‹ 0023. Merge k Sorted Lists ä¸­çš„è§£æ³•ä¸‰ï¼Œè¿˜æœ‰æ¯”è¾ƒç»å…¸çš„ 0215ã€0239ã€0264ã€0295ã€0347ã€0692 ç­‰ç­‰ äº”ã€Java ä¸­çš„é˜Ÿåˆ—åœ¨ Java ä¸­ï¼Œé˜Ÿåˆ—åªæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå¦‚ä¸‹ï¼š è®©æˆ‘ä»¬æ¥çœ‹çœ‹é‡Œé¢çš„å…·ä½“å®ç°ç±»å§ï¼Œè¿™é‡Œä¼˜å…ˆé€‰æ‹©ä¸Šé¢ä¼˜å…ˆé˜Ÿåˆ—ï¼Œç»§æ‰¿å’Œå®ç°ç±»å›¾å¦‚ä¸‹ï¼š åœ¨ä¼˜å…ˆé˜Ÿåˆ—çš„ Structure ä¸­å¯ä»¥çœ‹åˆ°ï¼š å¯ä»¥çœ‹åˆ°æœ€å…³é”®çš„ä¸¤ä¸ªæ–¹æ³•ï¼š offer å’Œ removeï¼Œå…¶ä¸­ add æ˜¯è°ƒç”¨ offer æ–¹æ³•çš„ï¼Œè¿™ä¸¤ä¸ªå°±æ˜¯å¯¹åº”ç€é˜Ÿåˆ—ä¸­çš„ enqueue å’Œ dequeue æ–¹æ³•ã€‚ ç”±äºä¼˜å…ˆé˜Ÿåˆ—æ˜¯åŸºäºäºŒå‰å †çš„ï¼Œæ‰€ä»¥ä¼šæœ‰ ä¸Šæµ® å’Œ ä¸‹æ²‰ æ“ä½œï¼Œåœ¨æ­¤å°±ä¸ç»†è¯´äº† 1234567891011121314public boolean offer(E e) &#123; if (e == null) throw new NullPointerException(); modCount++; int i = size; if (i &gt;= queue.length) grow(i + 1); size = i + 1; if (i == 0) queue[0] = e; else siftUp(i, e); return true;&#125; 123456789public boolean remove(Object o) &#123; int i = indexOf(o); if (i == -1) return false; else &#123; removeAt(i); return true; &#125;&#125; 123456789101112131415161718private E removeAt(int i) &#123; // assert i &gt;= 0 &amp;&amp; i &lt; size; modCount++; int s = --size; if (s == i) // removed last element queue[i] = null; else &#123; E moved = (E) queue[s]; queue[s] = null; siftDown(i, moved); if (queue[i] == moved) &#123; siftUp(i, moved); if (queue[i] != moved) return moved; &#125; &#125; return null;&#125;","categories":[{"name":"é‡å­¦ç®—æ³•ç³»åˆ—","slug":"é‡å­¦ç®—æ³•ç³»åˆ—","permalink":"http://wangba.me/categories/%E9%87%8D%E5%AD%A6%E7%AE%97%E6%B3%95%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"Algorithm","slug":"Algorithm","permalink":"http://wangba.me/tags/Algorithm/"},{"name":"Queue","slug":"Queue","permalink":"http://wangba.me/tags/Queue/"}]},{"title":"Stack--Monotonic Stack","slug":"Stack-Monotonic-Stack","date":"2020-11-23T13:03:24.000Z","updated":"2020-11-23T13:05:11.287Z","comments":true,"path":"2020/11/23/Stack-Monotonic-Stack/","link":"","permalink":"http://wangba.me/2020/11/23/Stack-Monotonic-Stack/","excerpt":"","text":"ä¸€ã€OverViewåœ¨å‰é¢å·²ç»æåŠè¿‡ æ ˆ è¿™ä¸ªæ•°æ®ç»“æ„ï¼Œåœ¨ LeetCode ä¸­æœ‰è€ƒå¯Ÿè¿‡è¿™æ ·ä¸€ç§æ ˆæ“ä½œï¼šå•è°ƒæ ˆã€‚ é¡¾åæ€ä¹‰ï¼Œè¿™æ˜¯åœ¨æ ˆçš„åŸºç¡€ä¸Šè¾¾åˆ°å•è°ƒé€’å¢æˆ–å•è°ƒé€’å‡çš„æ•ˆæœã€‚ å¤§æ¦‚çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š å¦‚æœæƒ³è¾¾åˆ°é€’å¢çš„æ•ˆæœï¼š è¿›æ ˆï¼šé¦–å…ˆè¦æ¯”è¾ƒä¸æ ˆé¡¶çš„å¤§å°ï¼Œå¦‚æœæ¯”æ ˆé¡¶å…ƒç´ å¤§ï¼Œé‚£ä¹ˆç›´æ¥æ”¾åœ¨æ ˆé¡¶å³å¯ï¼›å¦åˆ™è¦å°†æ ˆé¡¶å…ƒç´ å‡ºæ ˆï¼Œç„¶åå°†è¿™ä¸ªå…ƒç´ ä¸æ ˆé¡¶å…ƒç´ è¿›è¡Œæ¯”è¾ƒ å‡ºæ ˆï¼šç›´æ¥å‡ºæ ˆå³å¯ å¦‚æœæƒ³è¾¾åˆ°é€’å‡çš„æ•ˆæœï¼š è¿›æ ˆï¼šé¦–å…ˆè¦æ¯”è¾ƒä¸æ ˆé¡¶çš„å¤§å°ï¼Œå¦‚æœæ¯”æ ˆé¡¶å…ƒç´ å°ï¼Œé‚£ä¹ˆç›´æ¥æ”¾åœ¨æ ˆé¡¶å³å¯ï¼›å¦åˆ™è¦å°†æ ˆé¡¶å…ƒç´ å‡ºæ ˆï¼Œç„¶åå°†è¿™ä¸ªå…ƒç´ ä¸æ ˆé¡¶å…ƒç´ è¿›è¡Œæ¯”è¾ƒ å‡ºæ ˆï¼šç›´æ¥å‡ºæ ˆå³å¯ äºŒã€Exampleå‡å¦‚æœ‰ä¸‹é¢çš„ä¾‹å­ï¼š æœ‰ä¸€ç»„æ•°ä¸ºï¼š 1ï¼Œ4ï¼Œ2ï¼Œ5ï¼Œ7ï¼Œ6ï¼Œ8 ç°åœ¨è¦å¾—åˆ°ä¸€ä¸ªå•è°ƒé€’å¢æ ˆï¼Œè¿‡ç¨‹å¦‚ä¸‹ï¼š Step Op Stack 1 1 push 1 2 4 push 1 4 3 4 pop | 2 push 1 2 4 5 push 1 2 5 5 7 push 1 2 5 7 6 7 pop | 6 push 1 2 5 6 7 8 push 1 2 5 6 8 ä¸‰ã€LeetCode 496çœ‹ä¸€ä¸ªå…¸å‹ä¾‹å­ LeetCode 0496 : é¢˜æ„ï¼šç»™å®šä¸¤ä¸ª æ²¡æœ‰é‡å¤å…ƒç´  çš„æ•°ç»„ nums1 å’Œ nums2 ï¼Œå…¶ä¸­nums1 æ˜¯ nums2 çš„å­é›†ã€‚æ‰¾åˆ° nums1 ä¸­æ¯ä¸ªå…ƒç´ åœ¨ nums2 ä¸­çš„ä¸‹ä¸€ä¸ªæ¯”å…¶å¤§çš„å€¼ã€‚ 12Input: nums1 &#x3D; [4,1,2], nums2 &#x3D; [1,3,4,2].Output: [-1,3,-1] åˆ†æï¼š 123456789101112131415161718192021public int[] nextGreaterElement(int[] nums1, int[] nums2) &#123; int[] res = new int[nums1.length]; Map&lt;Integer, Integer&gt; map = new HashMap&lt;&gt;(); Stack&lt;Integer&gt; stack = new Stack&lt;&gt;(); for (int i : nums2) &#123; while (!stack.isEmpty() &amp;&amp; stack.peek() &lt; i) &#123; map.put(stack.peek(), i); stack.pop(); &#125; stack.push(i); &#125; for (int i = 0; i &lt; nums1.length; i++) &#123; res[i] = map.get(nums1[i]) != null ? map.get(nums1[i]) : -1; &#125; return res;&#125;","categories":[{"name":"é‡å­¦ç®—æ³•ç³»åˆ—","slug":"é‡å­¦ç®—æ³•ç³»åˆ—","permalink":"http://wangba.me/categories/%E9%87%8D%E5%AD%A6%E7%AE%97%E6%B3%95%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"Algorithm","slug":"Algorithm","permalink":"http://wangba.me/tags/Algorithm/"},{"name":"Stack","slug":"Stack","permalink":"http://wangba.me/tags/Stack/"}]},{"title":"0084. Largest Rectangle in Histogram","slug":"0084-Largest-Rectangle-in-Histogram","date":"2020-11-02T11:46:08.000Z","updated":"2020-11-05T13:41:39.555Z","comments":true,"path":"2020/11/02/0084-Largest-Rectangle-in-Histogram/","link":"","permalink":"http://wangba.me/2020/11/02/0084-Largest-Rectangle-in-Histogram/","excerpt":"","text":"84. Largest Rectangle in Histogram HardGiven n non-negative integers representing the histogramâ€™s bar height where the width of each bar is 1, find the area of largest rectangle in the histogram. Above is a histogram where width of each bar is 1, given height = [2,1,5,6,2,3]. The largest rectangle is shown in the shaded area, which has area = 10 unit. Example: 12Input: [2,1,5,6,2,3]Output: 10 æ€è·¯ï¼šæ€è·¯ä¸€ï¼šæš´åŠ›ç ´è§£ å…ˆç”¨ HashSet å­˜å‚¨æ•°ç»„ä¸­ä¸é‡å¤çš„å€¼ï¼Œä¸»è¦æ˜¯ç”¨æ¥åŠ é€Ÿçš„ï¼Œä¸ç”¨ä¹Ÿå¯ä»¥ï¼Œåƒåœ¨æœ¬é¢˜é‡Œé¢å°±å¯ä»¥å°‘ç®—ä¸€æ¬¡ 2 ç„¶åéå†è¿™ä¸ª setï¼Œå†åœ¨ set ä¸­è¿›è¡Œæ•°ç»„éå†ï¼Œæ‰¾åˆ°è¿ç»­æ¯”å½“å‰å€¼å¤§äºæˆ–ç­‰äºçš„æ•°ç»„å€¼ï¼Œå¹¶æ‰¾åˆ°æœ€å¤§çš„å®½åº¦ï¼Œåƒåœ¨ä¸Šé¢çš„ğŸŒ°ä¸­ï¼Œå½“å€¼ä¸º 1 æ—¶ï¼Œéå†ä¸€éåï¼Œæœ€å¤§çš„çš„å®½åº¦ä¸º 6 ä»£ç ï¼š 12345678910111213141516171819202122public int largestRectangleArea(int[] heights) &#123; Set&lt;Integer&gt; set = new HashSet&lt;&gt;(); for (int height : heights) &#123; set.add(height); &#125; int res = 0; for (int height : set) &#123; int width = 0; int max = 1; for (int value : heights) &#123; if (value &gt;= height) &#123; width++; &#125; else &#123; max = Math.max(max, width); width = 0; &#125; &#125; max = Math.max(max, width); res = Math.max(res, max * (height)); &#125; return res;&#125; æ—¶é—´å¤æ‚åº¦ï¼šO(n^2) ç©ºé—´å¤æ‚åº¦ï¼šO(n) æ€è·¯äºŒï¼šè¿™ä¸ªæ€è·¯æœ‰ç‚¹å’Œ 42é¢˜ æœ‰ç‚¹åƒï¼Œå¯ä»¥çœ‹ä¸‹é¢çš„ğŸŒ°ï¼š åœ¨æ€è·¯ä¸€ä¸­ï¼Œæ˜¯å°†æ¯ä¸€ä¸ªä¸é‡å¤çš„æ•°ç»„å…ƒç´ å’Œæ•´ä¸ªæ•°ç»„è¿›è¡Œå¯¹æ¯”ï¼Œæ±‚å‡ºæœ€å¤§é¢ç§¯ åœ¨ è¯¥è§£æ³•ä¸­ï¼Œä»ç„¶æ˜¯æ±‚æ¯ä¸ªæŸ±å­æ‰€å çš„æœ€å¤§é¢ç§¯ï¼Œæœ€åå–æœ€å¤§çš„å³å¯ çº¢è‰²æ˜¯å½“å‰æŸ±å­ï¼Œåˆ†åˆ«æ‰¾åˆ°ç¦»è¯¥æŸ±å­å·¦è¾¹æœ€è¿‘æ¯”è¯¥æŸ±å­ä½çš„æŸ±å­ leftMin å’Œå³è¾¹æœ€è¿‘ä½äºè¯¥æŸ±å­çš„æŸ±å­ rightMin æ­¤æ—¶çš„é¢ç§¯å¯ä»¥è®¡ç®—ä¸ºï¼šheights[cur] * ( rightMin - leftMin -1) é‚£ä¹ˆå¦‚ä½•æ±‚å‡ºæ¯ä¸€ä¸ªæŸ±å­çš„ leftMin ï¼Œä¸‹é¢çš„ä»£ç æ˜¯æ—¶é—´å¤æ‚åº¦ä¸º O(n) 123456789int[] leftMin = new int[heights.length];leftMin[0] = -1;for (int i = 1; i &lt; heights.length; i++) &#123; int temp = i - 1; while (temp &gt;= 0 &amp;&amp; heights[i] &lt;= heights[temp]) &#123; temp--; &#125; leftMin[i] = temp;&#125; å½“ç„¶ä¸Šé¢çš„ä»£ç æ˜¯å¯ä»¥é™ä½æ—¶é—´å¤æ‚åº¦çš„ï¼Œå¯ä»¥çœ‹ä¸‹é¢è¿™ä¸ªğŸŒ°ï¼š å¦‚æœæˆ‘ä»¬è¦æ±‚ cur çš„ leftMin ï¼Œå¯ä»¥æ”¾å¼ƒä¸€éƒ¨åˆ†æ¯”è¾ƒï¼Œå…·ä½“æ˜¯å“ªä¸€éƒ¨åˆ†å‘¢ï¼Ÿ å¦‚æœå½“å‰ cur é«˜åº¦å°äº cur - 1 ï¼Œé‚£ä¹ˆ leftMin[i - 1] + 1 åˆ° cur - 1 ä¹‹é—´æ‰€æœ‰æŸ±å­çš„é«˜åº¦éƒ½æ˜¯å¤§äº cur çš„ï¼Œå› ä¸º leftMin[i - 1] æ˜¯ç¬¬ä¸€ä¸ªæ¯” cur - 1 ä½çš„ 123456789int[] leftMin = new int[heights.length];leftMin[0] = -1;for (int i = 1; i &lt; heights.length; i++) &#123; int temp = i - 1; while (temp &gt;= 0 &amp;&amp; heights[temp] &gt;= heights[i]) &#123; temp = leftMin[temp]; &#125; leftMin[i] = temp;&#125; ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031public int largestRectangleArea(int[] heights) &#123; if (heights.length == 0) return 0; int[] leftMin = new int[heights.length]; leftMin[0] = -1; for (int i = 1; i &lt; heights.length; i++) &#123; int temp = i - 1; while (temp &gt;= 0 &amp;&amp; heights[temp] &gt;= heights[i]) &#123; temp = leftMin[temp]; &#125; leftMin[i] = temp; &#125; int[] rightMin = new int[heights.length]; rightMin[heights.length - 1] = heights.length; for (int i = heights.length - 2; i &gt;= 0; i--) &#123; int temp = i + 1; while (temp &lt;= heights.length -1 &amp;&amp; heights[temp] &gt;= heights[i]) &#123; temp = rightMin[temp]; &#125; rightMin[i] = temp; &#125; int max = 0; for (int i = 0; i &lt; heights.length; i++) &#123; int temp = (rightMin[i] - leftMin[i] - 1) * heights[i]; max = Math.max(max, temp); &#125; return max;&#125; æ€è·¯ä¸‰ï¼šæ ˆ å½“éå†åˆ° cur æ—¶ï¼Œå‡ºç° height[cur] &lt; height[peek] æ—¶ï¼Œé‚£ä¹ˆ leftMin ä¸€å®šæ˜¯ newPeek ï¼ŒrightMin å°±æ˜¯ cur ï¼Œæ­¤æ—¶é¢ç§¯æœ€å¤§å€¼å°±æ˜¯ (cur - leftMin - 1) * height[peek] ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132public int largestRectangleArea(int[] heights) &#123; int max = 0; Stack&lt;Integer&gt; stack = new Stack&lt;&gt;(); int i = 0; while (i &lt; heights.length) &#123; if (stack.isEmpty()) &#123; stack.push(i); i++; &#125; else &#123; int peek = stack.peek(); if (heights[i] &gt;= heights[peek]) &#123; stack.push(i); i++; &#125; else &#123; int height = heights[stack.pop()]; int leftMin = stack.isEmpty() ? -1 : stack.peek(); int area = (i - leftMin - 1) * height; max = Math.max(area, max); &#125; &#125; &#125; while (!stack.isEmpty()) &#123; int height = heights[stack.pop()]; int leftMin = stack.isEmpty() ? -1 : stack.peek(); int area = (heights.length - leftMin - 1) * height; max = Math.max(area, max); &#125; return max;&#125;","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"Stack","slug":"Stack","permalink":"http://wangba.me/tags/Stack/"}]},{"title":"0071. Simplify Path","slug":"0071-Simplify-Path","date":"2020-10-30T12:51:58.000Z","updated":"2020-10-30T12:54:07.707Z","comments":true,"path":"2020/10/30/0071-Simplify-Path/","link":"","permalink":"http://wangba.me/2020/10/30/0071-Simplify-Path/","excerpt":"","text":"71. Simplify Path MediumGiven an absolute path for a file (Unix-style), simplify it. Or in other words, convert it to the canonical path. In a UNIX-style file system, a period . refers to the current directory. Furthermore, a double period .. moves the directory up a level. Note that the returned canonical path must always begin with a slash /, and there must be only a single slash / between two directory names. The last directory name (if it exists) must not end with a trailing /. Also, the canonical path must be the shortest string representing the absolute path. Example 1: 123Input: &quot;&#x2F;home&#x2F;&quot;Output: &quot;&#x2F;home&quot;Explanation: Note that there is no trailing slash after the last directory name. Example 2: 123Input: &quot;&#x2F;..&#x2F;&quot;Output: &quot;&#x2F;&quot;Explanation: Going one level up from the root directory is a no-op, as the root level is the highest level you can go. Example 3: 123Input: &quot;&#x2F;home&#x2F;&#x2F;foo&#x2F;&quot;Output: &quot;&#x2F;home&#x2F;foo&quot;Explanation: In the canonical path, multiple consecutive slashes are replaced by a single one. Example 4: 12Input: &quot;&#x2F;a&#x2F;.&#x2F;b&#x2F;..&#x2F;..&#x2F;c&#x2F;&quot;Output: &quot;&#x2F;c&quot; Example 5: 12Input: &quot;&#x2F;a&#x2F;..&#x2F;..&#x2F;b&#x2F;..&#x2F;c&#x2F;&#x2F;.&#x2F;&#x2F;&quot;Output: &quot;&#x2F;c&quot; Example 6: 12Input: &quot;&#x2F;a&#x2F;&#x2F;b&#x2F;&#x2F;&#x2F;&#x2F;c&#x2F;d&#x2F;&#x2F;.&#x2F;.&#x2F;&#x2F;..&quot;Output: &quot;&#x2F;a&#x2F;b&#x2F;c&quot; æ€è·¯ï¼šæ€è·¯ä¸€ï¼šæ ˆè¿™ä¸¤ä¸ªæ€è·¯æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯åˆ†åˆ«ä½¿ç”¨æ•°ç»„å’Œæ ˆè€Œå·² é¦–å…ˆä» / åˆ†å¼€ï¼Œç„¶åç”¨æ ˆä¿å­˜ï¼Œå¦‚æœæ ˆä¸ä¸ºç©ºï¼Œä¸”å½“å‰å­—ç¬¦ä¸º .. è¯´æ˜è¦è¿›è¡Œè¿›å…¥ä¸Šå±‚ç›®å½•ï¼Œæ­¤æ—¶å°†æ ˆä¸­çš„å…ƒç´ å¼¹å‡º åªè¦ä¸ä¸ºç©ºã€ä¸ä¸º . ã€ä¸ä¸º .. ï¼Œå°±æŠŠå…¶ä¸­çš„å…ƒç´ æ”¾å…¥æ ˆä¸­å³å¯ æœ€ååœ¨æœ€å‰é¢å’Œæ¯ä¸ªå­—ç¬¦ä¸²ä¸­é—´åŠ ä¸Š / ä»£ç ï¼š 123456789101112131415public String simplifyPath(String path) &#123; // 1. Stack String[] split = path.split(&quot;/&quot;); Stack&lt;String&gt; stack = new Stack&lt;&gt;(); for (String s : split) &#123; if (!stack.isEmpty() &amp;&amp; &quot;..&quot;.equals(s)) &#123; stack.pop(); &#125; else if (!&quot;.&quot;.equals(s) &amp;&amp; !&quot;&quot;.equals(s) &amp;&amp; !&quot;..&quot;.equals(s)) &#123; stack.push(s); &#125; &#125; List&lt;String&gt; res = new ArrayList&lt;&gt;(stack); return &quot;/&quot; + String.join(&quot;/&quot;, res);&#125; æ—¶é—´å¤æ‚åº¦ï¼šO(n) ç©ºé—´å¤æ‚åº¦ï¼šO(n) æ€è·¯äºŒï¼šçº¯æ•°ç»„ä»£ç ï¼š 123456789101112131415161718192021public String simplifyPath(String path) &#123; String[] split = path.split(&quot;/&quot;); List&lt;String&gt; wordList = new ArrayList&lt;&gt;(); for (String s : split) &#123; if (s.isEmpty() || s.equals(&quot;.&quot;)) &#123; continue; &#125; wordList.add(s); &#125; List&lt;String&gt; wordListSim = new ArrayList&lt;&gt;(); for (String s : wordList) &#123; if (s.equals(&quot;..&quot;)) &#123; if (!wordListSim.isEmpty()) &#123; wordListSim.remove(wordListSim.size() - 1); &#125; &#125; else &#123; wordListSim.add(s); &#125; &#125; return &quot;/&quot; + String.join(&quot;/&quot;, wordListSim);&#125;","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"Stack","slug":"Stack","permalink":"http://wangba.me/tags/Stack/"}]},{"title":"something need to learn or write","slug":"something-need-to-learn-or-write","date":"2020-10-29T12:52:01.000Z","updated":"2020-10-29T12:57:05.570Z","comments":true,"path":"2020/10/29/something-need-to-learn-or-write/","link":"","permalink":"http://wangba.me/2020/10/29/something-need-to-learn-or-write/","excerpt":"","text":"Java å®ä½“ç±»ä½¿ç”¨ java.x çš„ valiation å’Œ hibernate çš„ validator è¿›è¡Œæ ¡éªŒ Spring Data JPA çš„æ›´æ·±å…¥ä½¿ç”¨ Shiro æˆ–è€… Spring Security æ•´åˆ JWT mapstruct å’Œ beansUtils çš„ç±»è‡ªåŠ¨èµ‹å€¼ Java 8-13 ä¸­çš„ä¸€äº›æ–°ç‰¹æ€§ å‰åç«¯åˆ†ç¦»ä¸­çš„å¼‚å¸¸å¤„ç† å‰ç«¯ å“ˆä½›çš„ CS 50 è¯¾ç¨‹ ä»é›¶æ­å»ºä¸€ä¸ª Hexo ä¸»é¢˜ Leetcode æ•°ç»„ é“¾è¡¨ æ ˆ","categories":[],"tags":[{"name":"Life","slug":"Life","permalink":"http://wangba.me/tags/Life/"}]},{"title":"0042. Trapping Rain Water","slug":"0042-Trapping-Rain-Water","date":"2020-10-28T13:42:11.000Z","updated":"2020-10-30T12:52:56.056Z","comments":true,"path":"2020/10/28/0042-Trapping-Rain-Water/","link":"","permalink":"http://wangba.me/2020/10/28/0042-Trapping-Rain-Water/","excerpt":"","text":"42. Trapping Rain Water HardGiven n non-negative integers representing an elevation map where the width of each bar is 1, compute how much water it can trap after raining. Example 1: 123Input: height &#x3D; [0,1,0,2,1,0,1,3,2,1,2,1]Output: 6Explanation: The above elevation map (black section) is represented by array [0,1,0,2,1,0,1,3,2,1,2,1]. In this case, 6 units of rain water (blue section) are being trapped. Example 2: 12Input: height &#x3D; [4,2,0,3,2,5]Output: 9 Constraints: n == height.length 0 &lt;= n &lt;= 3 * 104 0 &lt;= height[i] &lt;= 105 æ€è·¯ï¼šæ€è·¯ä¸€ï¼šè¡Œæ±‚è§£æ¯æ¬¡æ±‚ä¸€è¡Œçš„æ‰€æœ‰æ°´ï¼š é¦–å…ˆè¦æ ‡è®°æ˜¯å¦å¼€å§‹ï¼Œåªè¦ç¬¬ä¸€æ¬¡å‡ºç° height[i] &gt;= å½“å‰å±‚æ¬¡çš„å€¼æ—¶ï¼Œæ‰å¼€å§‹è®¡æ•°ï¼Œå› ä¸ºå®ƒå·¦è¾¹æ²¡æœ‰å¢™ ä»£ç ï¼š 123456789101112131415161718192021222324public int trap(int[] height) &#123; // find the maximum num in the height int max = Integer.MIN_VALUE; for (int i : height) &#123; if (i &gt; max) max = i; &#125; int res = 0; for (int i = 1; i &lt;= max; i++) &#123; int count = 0; boolean start = false; for (int value : height) &#123; if (start &amp;&amp; value &lt; i) &#123; count++; &#125; if (value &gt;= i) &#123; res += count; count = 0; start = true; &#125; &#125; &#125; return res;&#125; æ—¶é—´å¤æ‚åº¦ï¼šO(n * m) å…¶ä¸­ n ä¸ºæ•°ç»„é•¿åº¦ï¼Œm ä¸ºæ•°ç»„ä¸­æœ€å¤§çš„å€¼ ç©ºé—´å¤æ‚åº¦ï¼šO(1) æ€è·¯äºŒï¼šåˆ—æ±‚è§£ åªè¦å…³æ³¨äºæ¯ä¸€åˆ—å°±è¡Œï¼Œä¸”å…³æ³¨è¯¥åˆ—çš„å·¦è¾¹æœ€é«˜åˆ—å’Œå³è¾¹æœ€é«˜åˆ— å¦‚ä½•æ±‚è§£è¯¥åˆ—çš„æ°´ï¼Œåªéœ€è¦å°†è¿™å·¦å³é«˜åˆ—ä¸­è¾ƒä½çš„é‚£ä¸ªå‡å»å½“å‰çš„åˆ—çš„é«˜åº¦å³å¯ ä»£ç ï¼š 12345678910111213141516171819202122public int trap(int[] height) &#123; // 2. column int count = 0; for (int i = 0; i &lt; height.length; i++) &#123; int minColumn = getMinColumn(i, height); if (minColumn &gt; height[i]) &#123; count += (minColumn - height[i]); &#125; &#125; return count;&#125;private int getMinColumn(int index, int[] height) &#123; int left = 0, right = 0; for (int i = 0; i &lt; index; i++) &#123; if (height[i] &gt; left) left = height[i]; &#125; for (int i = index + 1; i &lt; height.length; i++) &#123; if (height[i] &gt; right) right = height[i]; &#125; return Math.min(left, right);&#125; æ—¶é—´å¤æ‚åº¦ï¼šO(n^2) ç©ºé—´å¤æ‚åº¦ï¼šO(1) æ€è·¯ä¸‰ï¼šæ ˆå¯ä»¥æƒ³è±¡ä¸ºæ‹¬å·åŒ¹é…ï¼šå…¶ä¸­å¢™å¯ä»¥çœ‹ä½œæ‹¬å·ï¼Œæ°´å¯ä»¥çœ‹ä½œæ‹¬å·åŒ¹é…çš„ä¸­é—´è®¡ç®— ä»£ç ï¼š 12345678910111213141516171819public int trap(int[] height) &#123; // 3. Stack Stack&lt;Integer&gt; stack = new Stack&lt;&gt;(); int res = 0; int cur = 0; while (cur &lt; height.length) &#123; while (!stack.isEmpty() &amp;&amp; height[cur] &gt; height[stack.peek()]) &#123; int temp = height[stack.peek()]; stack.pop(); if (stack.isEmpty()) break; int len = cur - stack.peek() - 1; int min = Math.min(height[cur], height[stack.peek()]); res += (min - temp) * len; &#125; stack.push(cur); cur++; &#125; return res;&#125; æ€è·¯å››ï¼šåŠ¨æ€è§„åˆ’åœ¨æ€è·¯äºŒä¸­ï¼Œæ˜¯ä½¿ç”¨æ²¡æ¬¡æ‰¾ä¸€ä¸ªæ•°ï¼Œéƒ½è¦éå†æ•´ä¸ªæ•°ç»„æ‰¾åˆ°å·¦è¾¹å’Œå³è¾¹çš„æœ€é«˜åˆ—ï¼Œç„¶åè¿›è¡Œè®¡ç®—ï¼Œåœ¨è¿™ä¸ªåŸºç¡€ä¸Šï¼Œä½¿ç”¨ä¸€ä¸ª dp æ•°ç»„å°†è¿™äº›å€¼ç»´æŠ¤èµ·æ¥ï¼š ç¬¬ i åˆ—çš„å·¦è¾¹æœ€é«˜åˆ—å’Œå³è¾¹æœ€é«˜åˆ—åº”è¯¥ä¸ºï¼š left[i] = max(left[i - 1], height[i - 1]) right[i] = max(right[i + 1], height[i + 1]) è¿™æ ·ç”¨ä¸¤ä¸ªæ•°ç»„å»ç»´æŠ¤å°±è¡Œäº†ï¼Œæ¯æ¬¡éå†çš„æ—¶å€™ç›´æ¥åœ¨è¿™ä¸ª dp æ•°ç»„ä¸­å–å°±è¡Œäº† ä»£ç ï¼š 1234567891011121314151617181920212223public int trap(int[] height) &#123; int res = 0; int[] left = new int[height.length]; int[] right = new int[height.length]; // use array to save the maximum left num of every item for (int i = 1; i &lt; height.length - 1; i++) &#123; left[i] = Math.max(left[i - 1], height[i - 1]); &#125; // use array to save the maximum right num of every item for (int i = height.length - 2; i &gt;= 0; i--) &#123; right[i] = Math.max(right[i + 1], height[i + 1]); &#125; for (int i = 0; i &lt; height.length; i++) &#123; int minColumn = Math.min(left[i], right[i]); if (minColumn &gt; height[i]) &#123; res += minColumn - height[i]; &#125; &#125; return res;&#125; æ—¶é—´å¤æ‚åº¦ï¼šO(nï¼‰ ç©ºé—´å¤æ‚åº¦ï¼šO(n) æ€è·¯äº”ï¼šåŠ¨æ€è§„åˆ’ + åŒæŒ‡é’ˆåœ¨æ€è·¯å››ä¸­ï¼Œå·²ç»ä½¿ç”¨ dp æ•°ç»„å»å­˜å‚¨å·¦è¾¹å’Œå³è¾¹çš„æœ€é«˜åˆ—ï¼Œä½†æ˜¯ä»”ç»†æ€è€ƒä¸€ä¸‹ï¼Œè¿™ä¸ª dp æ•°ç»„ä¸­çš„å€¼ï¼Œå…¶å®å°±ä½¿ç”¨ä¸€æ¬¡ï¼Œé‚£ä¹ˆå¯ä»¥å°†è¿™ä¸ªç©ºé—´å¤æ‚åº¦å†é™ä½ä¸€ç‚¹ï¼Œæœ‰ç‚¹ç±»ä¼¼äºç”¨åŠ¨æ€è§„åˆ’æ±‚è§£æ–æ³¢é‚£å¥‘æ•°åˆ— ä»£ç ï¼š 123456789101112131415161718public int trap(int[] height) &#123; int res = 0, l = 0, r = height.length - 1; while (l &lt; r) &#123; int mn = Math.min(height[l], height[r]); if (height[l] == mn) &#123; ++l; while (l &lt; r &amp;&amp; height[l] &lt; mn) &#123; res += mn - height[l++]; &#125; &#125; else &#123; --r; while (l &lt; r &amp;&amp; height[r] &lt; mn) &#123; res += mn - height[r--]; &#125; &#125; &#125; return res;&#125; æ—¶é—´å¤æ‚åº¦ï¼šO(nï¼‰ ç©ºé—´å¤æ‚åº¦ï¼šO(1)","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"Stack","slug":"Stack","permalink":"http://wangba.me/tags/Stack/"}]},{"title":"0020. Valid Parentheses","slug":"0020-Valid-Parentheses","date":"2020-10-28T13:41:57.000Z","updated":"2020-10-30T12:53:03.967Z","comments":true,"path":"2020/10/28/0020-Valid-Parentheses/","link":"","permalink":"http://wangba.me/2020/10/28/0020-Valid-Parentheses/","excerpt":"","text":"20. Valid Parentheses EasyGiven a string s containing just the characters &#39;(&#39;, &#39;)&#39;, &#39;&#123;&#39;, &#39;&#125;&#39;, &#39;[&#39; and &#39;]&#39;, determine if the input string is valid. An input string is valid if: Open brackets must be closed by the same type of brackets. Open brackets must be closed in the correct order. Example 1: 12Input: s &#x3D; &quot;()&quot;Output: true Example 2: 12Input: s &#x3D; &quot;()[]&#123;&#125;&quot;Output: true Example 3: 12Input: s &#x3D; &quot;(]&quot;Output: false Example 4: 12Input: s &#x3D; &quot;([)]&quot;Output: false Example 5: 12Input: s &#x3D; &quot;&#123;[]&#125;&quot;Output: true Constraints: 1 &lt;= s.length &lt;= 104 s consists of parentheses only &#39;()[]&#123;&#125;&#39;. æ€è·¯ï¼šæ€è·¯ä¸€ï¼šæ ˆåœ¨æ ˆçš„é‚£ä¸€èŠ‚ä¸­ï¼Œå°±æåŠåˆ°äº†æ ˆçš„å…¶ä¸­ä¸€ä¸ªåº”ç”¨å°±æ˜¯æ‹¬å·åŒ¹é…ï¼Œå¤§è‡´æ€è·¯å¦‚ä¸‹ï¼š é‡åˆ° (ã€ &#123;ã€ [ è¿™ä¸‰ç§å·¦æ‹¬å·ï¼Œç›´æ¥è®©å®ƒå…¥æ ˆï¼Œç›´åˆ°å‡ºç° ï¼‰ã€ &#125;ã€ ] ï¼Œé¦–å…ˆåˆ¤æ–­æ ˆæ˜¯å¦ä¸ºç©ºæˆ–è€…æ ˆé¡¶çš„å…ƒç´ æ˜¯å¦å¯¹åº”ï¼Œå¦‚æœå¯¹åº”ï¼Œé‚£ä¹ˆè®©å®ƒå‡ºæ ˆï¼Œç»§ç»­ä¸Šè¿°æ“ä½œå³å¯ ä»£ç ï¼š 1234567891011121314151617public boolean isValid(String s) &#123; if (s == null || s.length() == 0) return true; Stack&lt;Character&gt; stack = new Stack&lt;&gt;(); for (int i = 0; i &lt; s.length(); i++) &#123; char temp = s.charAt(i); if (temp != &#x27;)&#x27; &amp;&amp; temp != &#x27;]&#x27; &amp;&amp; temp != &#x27;&#125;&#x27;) &#123; stack.push(s.charAt(i)); &#125; else if (temp == &#x27;)&#x27; &amp;&amp; !stack.isEmpty() &amp;&amp; stack.peek() == &#x27;(&#x27; || temp == &#x27;]&#x27; &amp;&amp; !stack.isEmpty() &amp;&amp; stack.peek() == &#x27;[&#x27; || temp == &#x27;&#125;&#x27; &amp;&amp; !stack.isEmpty() &amp;&amp; stack.peek() == &#x27;&#123;&#x27;) &#123; stack.pop(); &#125; else &#123; return false; &#125; &#125; return stack.isEmpty();&#125; æ—¶é—´å¤æ‚åº¦ï¼šO(n) ç©ºé—´å¤æ‚åº¦ï¼šO(n) è¿˜çœ‹åˆ°äº†ä¸€ç§åå‘å†™æ³• ä»£ç ï¼š 12345678910111213public boolean isValid(String s) &#123; if(s.isEmpty()) &#123; return true; &#125; Stack&lt;Character&gt; stack = new Stack&lt;&gt;(); for(char c:s.toCharArray())&#123; if(c == &#x27;(&#x27;) &#123; stack.push(&#x27;)&#x27;); &#125; else if(c == &#x27;[&#x27;) &#123; stack.push(&#x27;]&#x27;); &#125; else if(c == &#x27;&#123;&#x27;) &#123; stack.push(&#x27;&#125;&#x27;); &#125; else if(stack.isEmpty() || stack.pop() != c)&#123; return false; &#125; &#125; return stack.isEmpty();&#125;","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"Stack","slug":"Stack","permalink":"http://wangba.me/tags/Stack/"}]},{"title":"Stack","slug":"Stack","date":"2020-10-27T14:01:27.000Z","updated":"2020-11-23T10:57:46.252Z","comments":true,"path":"2020/10/27/Stack/","link":"","permalink":"http://wangba.me/2020/10/27/Stack/","excerpt":"","text":"ä¸€ã€OverView å¿«é€Ÿé¢„è§ˆï¼š ğŸ·ï¼šç¬¬ä¸€å°èŠ‚çœ‹ä¸€ä¸‹æ ˆçš„ç‰¹æ€§ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§å—é™çš„æ•°æ®ç»“æ„çš„å‡ºç°ï¼Ÿ ğŸ¢ï¼šç¬¬äºŒå°èŠ‚çœ‹ä¸€ä¸‹è¦å®ç°ä¸€ä¸ªæ ˆï¼Œæœ€åŸºæœ¬éœ€è¦ä»€ä¹ˆæ“ä½œï¼Ÿ ğŸ­ï¼šç¬¬ä¸‰å°èŠ‚çœ‹ä¸€ä¸‹æ ˆçš„çš„åº”ç”¨ï¼Œæ˜¯ä¸æ˜¯è¿™äº›åº”ç”¨é©±åŠ¨ç€æ ˆçš„è¯ç”Ÿ ğŸ¦ï¼šæœ€åä¸€ä¸ªå°èŠ‚è¿˜æ˜¯è€å¥—è·¯ï¼Œç®€å•çš„çœ‹ä¸€ä¸‹ Java ä¸­å…³äºæ ˆçš„ API äºŒã€ç‰¹æ€§â€‹ åœ¨å‰é¢å·²ç»ä»‹ç»äº†æ•°ç»„å’Œé“¾è¡¨ä¸¤ç§æœ€åŸºæœ¬çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥è¯´ä»–ä¿©å°±æ˜¯æ•´ä¸ªæ•°æ®ç»“æ„ä¸ç®—æ³•çš„åŸºçŸ³ã€‚çœ‹ä¸€ä¸‹æ ˆçš„ç»„æˆï¼š é‚£ä¹ˆå®ƒå’Œå…¶ä»–çº¿æ€§è¡¨æœ€å¤§çš„åŒºåˆ«åœ¨å“ªå‘¢ï¼Ÿæ¯«æ— ç–‘é—®ï¼šå®ƒåªå…è®¸åœ¨ä¸€ç«¯è¿›è¡Œæ’å…¥å’Œåˆ é™¤ æˆ–è€…è¯´æˆ å…ˆè¿›åå‡ºã€åè¿›å…ˆå‡º æ­¤æ—¶ï¼Œå°æœ‹å‹ï¼Œä½ æ˜¯å¦æœ‰å¾ˆå¤šé—®å·ï¼Ÿä¸ºä»€ä¹ˆè¦æœ‰è¿™ç§å—é™çš„æ•°æ®ç»“æ„ï¼Œæˆ‘ç”¨æ•°ç»„å’Œé“¾è¡¨ä¸é¦™å—ï¼Ÿå½“ç„¶æ ˆå°±æ˜¯åŸºäºæ•°ç»„æˆ–é“¾è¡¨å®ç°çš„ï¼Œä½†æ˜¯åœ¨ç‰¹å®šçš„éœ€æ±‚ä¸‹ï¼Œæ ˆå°±åº”ç”¨è€Œç”Ÿäº†ã€‚å…·ä½“å¯ä»¥å‚è€ƒä¸‹é¢çš„æ ˆçš„åº”ç”¨å’Œ Java ä¸­æ ˆï¼Œå°±å¯ä»¥çœ‹åˆ°åœ¨æŸäº›æƒ…å†µä¸‹æ ˆçš„ä¼˜åŠ¿ã€ä»¥åŠç”±äºæ•°ç»„å’Œé“¾è¡¨æš´éœ²å‡ºå¤ªå¤šçš„æ¥å£ï¼Œè€Œæ ˆåªéœ€è¦å…¶ä¸­çš„ä¸€å°éƒ¨åˆ†å°±å¯ä»¥äº† ä¸‰ã€å®ç°æ ˆæˆ‘ä»¬åœ¨ä¸Šé¢å°±æåˆ°äº†ï¼Œæ ˆæ—¢å¯ä»¥åŸºäºæ•°ç»„å®ç°ï¼Œä¹Ÿå¯ä»¥åŸºäºé“¾è¡¨å®ç°ã€‚æ ˆæœ€é‡è¦çš„ä¸¤ä¸ªæ“ä½œï¼šå…¥æ ˆ å’Œ å‡ºæ ˆ 3.1 å®šå®¹æ ˆè¿™æ˜¯ã€Šç®—æ³•ã€‹ä¸­æ–‡ç‰ˆä¸­çš„è¯‘åï¼Œé¡¾åæ€ä¹‰å°±æ˜¯å®¹é‡å›ºå®šçš„æ ˆï¼ŒåŸºäºæ•°ç»„å¹¶ç”¨ Java ä»£ç æ¥å®ç°ä¸€ä¸‹ï¼š 12345678910111213141516171819202122232425262728public class FixedCapacityStackOfString &#123; private String[] items; private int count; private int n; public FixedCapacityStackOfString(int n) &#123; this.items = new String[n]; this.count = 0; this.n = n; &#125; // å…¥æ ˆ private boolean push(String item) &#123; if (count == n) return false; items[count] = item; count++; return true; &#125; // å‡ºæ ˆ private String pop() &#123; if (count == 0) return null; String item = items[count - 1]; count--; return item; &#125;&#125; æ—¶é—´å¤æ‚åº¦ï¼šO(1) ç©ºé—´å¤æ‚åº¦ï¼šO(1) ä¸åŒ…å«è¯¥æ ˆæœ¬èº«ï¼Œæ“ä½œæ—¶çš„ç©ºé—´å¤æ‚åº¦ 3.2 æ‰©å®¹æ ˆåœ¨ä¸Šé¢çš„å®šå®¹æ ˆä¸­ï¼Œæ˜¯ç”¨ä¸€ä¸ªå›ºå®šå¤§å°çš„æ•°ç»„å½“æˆå®ç°æ ˆçš„ç»“æ„ï¼Œé‚£ä¹ˆåº”è¯¥å¦‚ä½•å®ç°ä¸€ä¸ªæ‰©å®¹æ ˆå‘¢ï¼Ÿ å…¶å®ä¹Ÿå¾ˆå¥½å®ç°ï¼Œå›å¿†ä¸€ä¸‹åŠ¨æ€æ•°ç»„çš„äº‹é¡¹ï¼Œæ˜¯å°†æ•°ç»„è¿›è¡Œæ‰©å®¹ï¼Œç„¶åå°†åŸæ¥çš„æ•°æ® copy è¿›å»å°±è¡Œäº†ï¼›é‚£ä¹ˆç”¨åŒæ ·çš„æ–¹å¼å¯¹åŸºäºæ•°ç»„çš„æ ˆè¿›è¡Œæ‰©å®¹ (å½“ç„¶åŸºäºé“¾è¡¨å®ç°çš„æ ˆå°±æ²¡æœ‰è¿™ä¸€æ¦‚å¿µï¼Œç†è®ºä¸Šåªè¦å†…å­˜ç©ºé—´è¶³å¤Ÿå¤§ï¼Œæ ˆå¯ä»¥æ— é™å¤§) å½“æ ˆæ»¡çš„æ—¶å€™ï¼Œè¿›è¡Œæ‰©å®¹ï¼šæ–°å»ºä¸€ä¸ªæ¯”ç°åœ¨å¤§çš„æ•°ç»„ å°†åŸæ¥æ ˆä¸­çš„æ•°æ®å…¨éƒ¨å¤åˆ¶åˆ°æ–°çš„æ•°ç»„ä¸­ å…·ä½“å®ç°å¯ä»¥å‚è€ƒä¸‹é¢çš„ç¬¬äº”å°èŠ‚ å››ã€æ ˆçš„åº”ç”¨4.1 æ’¤é”€æ“ä½œâ€‹ å¦‚æœä½ ç»å¸¸ä½¿ç”¨ command + Z æˆ–è€… ctrl + Zï¼Œä½ å¯èƒ½ä¼šéå¸¸ç†è§£è¿™ä¸ªæ“ä½œï¼šå½“æˆ‘ä»¬å¤åˆ¶æˆ–è€…ä¿®æ”¹äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬æƒ³æŠŠå®ƒæ¢å¤æˆå¤åˆ¶æˆ–ä¿®æ”¹ä¹‹å‰çš„ä¸€æ ·çš„çŠ¶æ€ï¼Œåªéœ€è¦æŒ‰ä¸Šé¢çš„å¿«æ·é”®å°±è¡Œäº†ï¼Œä»”ç»†æƒ³ä¸€ä¸‹æ˜¯å¦æœ‰æ ˆçš„å½±å­åœ¨é‡Œé¢ å°±å¦‚åŒä¸Šé¢è¿™ä¸ªä¾‹å­ï¼šæˆ‘ä»¬å†™åˆ°äº† wangbaï¼Œéšååˆä¸æƒ³è¦ wangba äº†ï¼Œæ­¤æ—¶è¿›è¡Œæ’¤é”€æ“ä½œï¼Œåªéœ€è¦å°†æ ˆä¸­çš„ wangba pop å°±å¯ä»¥äº†ï¼Œæœ‰çš„è¿˜æœ‰å‰è¿›åŠŸèƒ½ï¼Œæ­¤æ—¶åªéœ€è¦å°†å…¶ push è¿›æ¥å³å¯ 4.2 å‡½æ•°è°ƒç”¨â€‹ å¦‚æœäº†è§£è¿‡æ“ä½œç³»ç»Ÿæˆ–è€…å¬è¯´è¿‡å‡½æ•°è°ƒç”¨ï¼Œé‚£ä¹ˆå¯ä»¥æ›´å®¹æ˜“ç†è§£ä¸‹é¢çš„å†…å®¹ï¼Œåœ¨è®¡ç®—æœºä¸­ï¼Œæ“ä½œç³»ç»Ÿä¼šç»™æ¯ä¸ªçº¿ç¨‹åˆ†é…ä¸€ä¸ªå†…å­˜ç©ºé—´ï¼Œè€Œè¿™ä¸ªå†…å­˜ç©ºé—´å°±æ˜¯æ ˆå¼ç»“æ„ï¼Œä¸“é—¨ä¸ºå‡½æ•°è°ƒç”¨å­˜å‚¨ä¸´æ—¶å˜é‡ï¼Œå°±ä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š 123456789public static void main(String[] args)&#123; int a = 1, b = 2; int res = add(a, b); System.out.println(res);&#125;private static Integer add(int x, int y) &#123; return x + y;&#125; åœ¨ä¸Šé¢è¿™æ®µ Java ä»£ç ä¸­ï¼Œå¯ä»¥çœ‹è§åœ¨ main ä¸­è°ƒç”¨äº† add å‡½æ•°ï¼Œåœ¨æ ˆå¸§ä¸­åº”è¯¥å°±æ˜¯è¿™æ ·ï¼š å½“ç„¶ï¼ŒçœŸå®æƒ…å†µä¸æ˜¯è¿™æ ·çš„ï¼Œè¦æ˜¯è¿™ä¹ˆç®€å•ï¼Œè®¡ç®—æœºåº•å±‚å°±ä¸ä¼šè¿™ä¹ˆåŠé€€äº† ï½ï½ï½ å¦‚æœæœ‰å…´è¶£äº†è§£æ›´æ·±å¯ä»¥å‚è€ƒï¼šã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹æˆ–è€…æƒ³å¤§æ¦‚äº†è§£ä¸€ä¸‹å¯ä»¥å‚è€ƒ è¿™ä¸ª 4.3 è¡¨è¾¾å¼æ±‚å€¼ğŸ¢ï¼šåœ¨ç¼–è¯‘å™¨ä¸­æ˜¯å¦‚ä½•å¯¹è¡¨è¾¾å¼è¿›è¡Œæ±‚å€¼çš„å‘¢ï¼Ÿå¦‚æœæ˜¯åç¼€è¡¨è¾¾å¼å°±åªéœ€è¦ä¸€ä¸ªæ“ä½œæ ˆå³å¯ï¼›å¦‚æœæ˜¯å‰ç¼€æˆ–ä¸­ç¼€è¡¨è¾¾å¼åˆ™éœ€è¦ä¸€ä¸ªæ“ä½œæ•°æ ˆå’Œä¸€ä¸ªæ“ä½œç¬¦æ ˆï¼Œæ¥çœ‹ä¸€ä¸‹ä¸­ç¼€è¡¨è¾¾å¼çš„æ±‚å€¼è¿‡ç¨‹ï¼š a * (b + c) è¿‡ç¨‹å¤§æ¦‚å¦‚ä¸‹ï¼š é‡åˆ°æ“ä½œæ•°å°±å‹åˆ°æ“ä½œæ•°çš„æ ˆï¼›é‡åˆ°æ“ä½œç¬¦å°±å‹åˆ°æ“ä½œç¬¦çš„æ ˆ åœ¨å‹åˆ°æ“ä½œç¬¦çš„æ ˆæ˜¯æœ‰æ¡ä»¶çš„ï¼šå¦‚æœæ“ä½œç¬¦æ ˆé¡¶çš„ç¬¦å·çš„ä¼˜å…ˆçº§å¤§äºç­‰äºè¦å‹å…¥çš„ç¬¦å·ï¼Œé‚£å°±å–æ“ä½œæ•°æ ˆé¡¶çš„ä¸¤ä¸ªæ•°è¿›è¡Œè®¡ç®—ï¼›å¦‚æœå°äºåˆ™ç›´æ¥æŠŠæ“ä½œç¬¦å‹å…¥æ“ä½œç¬¦çš„æ ˆ 4.4 æ‹¬å·åŒ¹é…å…³äºæ‹¬å·åŒ¹é…å¯ä»¥å‚è€ƒ LeetCode 0020ï¼Œå…³äºè¿™é¢˜çš„è§£ç­”å¯ä»¥çœ‹ 0020. Valid Parentheses äº”ã€Javaä¸­çš„æ ˆé¦–å…ˆçœ‹ä¸€ä¸‹ç»§æ‰¿ä¸å®ç°çš„å…³ç³»ï¼š å†çœ‹ä¸€ä¸‹è¯¥ç±»ä¸­çš„ Structure : å¯ä»¥çœ‹å‡ºæ¥å¾ˆç®€å•ï¼Œå°±å¦‚åŒä¸Šé¢åœ¨å®šå®¹æ ˆä¸­çš„æ“ä½œå·®ä¸å¤šï¼Œå®é™…ä¸Šå·®çš„å¾ˆå¤šï¼Œè¦è€ƒè™‘åˆ°æ‰©å®¹ã€å¹¶å‘ç­‰ç­‰æƒ…å†µï¼Œæ“ä½œå¤§éƒ½æ˜¯åœ¨ä»–çš„çˆ¶ç±» Vertor ä¸­å®Œæˆï¼Œå¦‚æœä½ çœ‹è¿‡é¢ç»å•¥çš„ï¼Œä½ åº”è¯¥å°±å¬è¿‡å¹¶å‘ä¸è¦ä½¿ç”¨ Vertorï¼Œè¦å¤šä½¿ç”¨ JUC åŒ…ä¸‹é¢çš„ç±»ï¼Œç„¶åç©¶å…¶åŸå› å°±æ˜¯ï¼šVertor ä½¿ç”¨ synchronized å…³é”®å­—ï¼ŒJUC åŒ…ä¸‹çš„æ˜¯ä½¿ç”¨ ReentrantLockï¼Œè€Œå¯é‡å…¥é”çš„åº•å±‚åˆ™æ˜¯ AQS LeetCode é‡ç‚¹å…³äºæ ˆçš„é‡ç‚¹ï¼šMonotonic Stack","categories":[{"name":"é‡å­¦ç®—æ³•ç³»åˆ—","slug":"é‡å­¦ç®—æ³•ç³»åˆ—","permalink":"http://wangba.me/categories/%E9%87%8D%E5%AD%A6%E7%AE%97%E6%B3%95%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"Algorithm","slug":"Algorithm","permalink":"http://wangba.me/tags/Algorithm/"}]},{"title":"148. SortList","slug":"148-SortList","date":"2020-10-26T11:16:05.000Z","updated":"2020-10-26T11:17:39.094Z","comments":true,"path":"2020/10/26/148-SortList/","link":"","permalink":"http://wangba.me/2020/10/26/148-SortList/","excerpt":"","text":"148. Sort List MediumGiven the head of a linked list, return the list after sorting it in ascending order. Follow up: Can you sort the linked list in O(n logn) time and O(1) memory (i.e. constant space)? Example 1: 12Input: head &#x3D; [4,2,1,3]Output: [1,2,3,4] Example 2: 12Input: head &#x3D; [-1,5,3,4,0]Output: [-1,0,3,4,5] Example 3: 12Input: head &#x3D; []Output: [] Constraints: The number of nodes in the list is in the range [0, 5 * 104]. -105 &lt;= Node.val &lt;= 105 æ€è·¯ï¼šæ€è·¯ä¸€ï¼šé€’å½’æ³• å½’å¹¶æ’åº æ‰¾é“¾è¡¨ä¸­ç‚¹ å“¨å…µ æœ¬é¢˜æ˜¯ä¸€ä¸ªæ— åºé“¾è¡¨çš„æ’åºé—®é¢˜ï¼Œè¦æ±‚æ˜¯ç©ºé—´å¤æ‚åº¦ä¸º O(nlogn) ï¼Œé‚£åªèƒ½æƒ³åˆ°å¿«é€Ÿæ’åºã€å½’å¹¶æ’åºã€å †æ’åºï¼Œå¿«æ’ä¸Šé€šè¿‡ç´¢å¼•çš„ï¼Œä¸é€‚åˆç”¨åœ¨é“¾è¡¨ä¸­ï¼›å †æ’åºæ–°å»ºç»“ç‚¹ä¸­ï¼›è¿™é¢˜å¯é‡‡ç”¨å½’å¹¶æ’åºï¼Œåœ¨ 21é¢˜ ä¸­ä»‹ç»äº†åˆå¹¶ä¸¤ä¸ªæœ‰åºåˆ—è¡¨ï¼Œç°åœ¨åªæ˜¯ä¸€ä¸ªæ— åºé“¾è¡¨ï¼Œæ²¡æœ‰æ¡ä»¶åˆ›é€ æ¡ä»¶ï¼š ä¸¤ä¸ªé“¾è¡¨ï¼šæ‰¾åˆ°é“¾è¡¨ä¸­ç‚¹ï¼Œåˆ‡æ–­ æœ‰åºï¼šä¸€ä¸ªæ— åºé“¾è¡¨åˆ‡å¼€åï¼Œå˜æˆäº†ä¸¤ä¸ªæ— åºé“¾è¡¨ï¼Œå†å¯¹æ¯ä¸€ä¸ªé“¾è¡¨è¿›è¡Œé€’å½’ï¼Œå½“åªæœ‰ä¸€ä¸ªç»“ç‚¹ï¼Œè‡ªç„¶å°±æ˜¯æœ‰åºçš„äº† ä»£ç ï¼š 1234567891011121314151617181920212223242526272829public ListNode sortList(ListNode head) &#123; if (head == null || head.next == null) return head; ListNode slow = head, fast = head, pre = head; while (fast != null &amp;&amp; fast.next != null) &#123; pre = slow; slow = slow.next; fast = fast.next.next; &#125; pre.next = null; return mergeTwoLists(sortList(head), sortList(slow));&#125;private ListNode mergeTwoLists(ListNode l1, ListNode l2) &#123; ListNode dummy = new ListNode(-1); ListNode cur = dummy; while (l1 != null &amp;&amp; l2 != null) &#123; if (l1.val &lt; l2.val) &#123; cur.next = l1; l1 = l1.next; &#125; else &#123; cur.next = l2; l2 = l2.next; &#125; cur = cur.next; &#125; if (l1 != null) cur.next = l1; if (l2 != null) cur.next = l2; return dummy.next;&#125; æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn) ç©ºé—´å¤æ‚åº¦ï¼šO(1) å…¶å®å¹¶ä¸æ˜¯ 1 ï¼Œç”±äºé€’å½’è¦è°ƒç”¨æ ˆ","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"LinkedList","slug":"LinkedList","permalink":"http://wangba.me/tags/LinkedList/"}]},{"title":"147. Insertion Sort List","slug":"147-Insertion-Sort-List","date":"2020-10-23T13:28:07.000Z","updated":"2020-10-23T13:29:30.064Z","comments":true,"path":"2020/10/23/147-Insertion-Sort-List/","link":"","permalink":"http://wangba.me/2020/10/23/147-Insertion-Sort-List/","excerpt":"","text":"147. Insertion Sort List MediumSort a linked list using insertion sort. A graphical example of insertion sort. The partial sorted list (black) initially contains only the first element in the list.With each iteration one element (red) is removed from the input data and inserted in-place into the sorted list Algorithm of Insertion Sort: Insertion sort iterates, consuming one input element each repetition, and growing a sorted output list. At each iteration, insertion sort removes one element from the input data, finds the location it belongs within the sorted list, and inserts it there. It repeats until no input elements remain. Example 1: 12Input: 4-&gt;2-&gt;1-&gt;3Output: 1-&gt;2-&gt;3-&gt;4 Example 2: 12Input: -1-&gt;5-&gt;3-&gt;4-&gt;0Output: -1-&gt;0-&gt;3-&gt;4-&gt;5 æ€è·¯ï¼šæ€è·¯ä¸€ï¼šæ’å…¥æ’åºæŒ‰ç…§æ’å…¥æ’åºçš„æ€æƒ³ï¼Œè¦æ³¨æ„çš„ç‚¹ï¼š ä¸è¦æ–­é“¾ æ¯ä¸€æ¬¡éƒ½æ˜¯ä»å¤´å¼€å§‹è¿›è¡Œæ¯”è¾ƒ ä»£ç ï¼š 12345678910111213141516171819202122public ListNode insertionSortList(ListNode head) &#123; if (head == null || head.next == null) return head; ListNode res = new ListNode(0); ListNode pre = res; ListNode cur = head; ListNode next = null; while (cur != null) &#123; next = cur.next; while (pre.next != null &amp;&amp; pre.next.val &lt; cur.val) &#123; pre = pre.next; &#125; cur.next = pre.next; pre.next = cur; // ä»å¤´å¼€å§‹ pre = res; cur = next; &#125; return res.next;&#125; æ—¶é—´å¤æ‚åº¦ï¼šO(n^2) ç©ºé—´å¤æ‚åº¦ï¼šO(1)","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"LinkedList","slug":"LinkedList","permalink":"http://wangba.me/tags/LinkedList/"}]},{"title":"143. Reorder List","slug":"143-Reorder-List","date":"2020-10-22T13:26:16.000Z","updated":"2020-10-22T13:30:43.420Z","comments":true,"path":"2020/10/22/143-Reorder-List/","link":"","permalink":"http://wangba.me/2020/10/22/143-Reorder-List/","excerpt":"","text":"143. Reorder List MediumGiven a singly linked list L: L0â†’L1â†’â€¦â†’L**n-1â†’Ln,reorder it to: L0â†’L**nâ†’L1â†’L**n-1â†’L2â†’L**n-2â†’â€¦ You may not modify the values in the listâ€™s nodes, only nodes itself may be changed. Example 1: 1Given 1-&gt;2-&gt;3-&gt;4, reorder it to 1-&gt;4-&gt;2-&gt;3. Example 2: 1Given 1-&gt;2-&gt;3-&gt;4-&gt;5, reorder it to 1-&gt;5-&gt;2-&gt;4-&gt;3. æ€è·¯ï¼šæ€è·¯ä¸€ï¼šæš´åŠ›è§£æ³•ç›´æ¥å°†é“¾è¡¨å­˜åœ¨æ•°ç»„ä¸­ï¼Œç„¶åè¿›è¡Œæ“ä½œï¼Œä¸ç”¨è€ƒè™‘æ–­é“¾ç­‰é—®é¢˜ï¼Œç›´æ¥ç”¨æ•°ç»„ä¸‹æ ‡è§£å†³ä¸€åˆ‡ ä»£ç ï¼š 1234567891011121314151617181920212223public void reorderList(ListNode head) &#123; // Given 1-&gt;2-&gt;3-&gt;4-&gt;5, reorder it to 1-&gt;5-&gt;2-&gt;4-&gt;3. // 1. æš´åŠ›è§£æ³• if (head == null) return; List&lt;ListNode&gt; list = new ArrayList&lt;&gt;(); while (head != null) &#123; list.add(head); head = head.next; &#125; int i = 0, j = list.size() - 1; while (i &lt; j) &#123; list.get(i).next = list.get(j); i++; if (i == j) &#123; break; &#125; list.get(j).next = list.get(i); j--; &#125; list.get(j).next = null;&#125; æ—¶é—´å¤æ‚åº¦ï¼šO(n) ç©ºé—´å¤æ‚åº¦ï¼šO(n) æ€è·¯äºŒï¼šé€’å½’çœ‹åˆ°é€’å½’è¿˜æ˜¯è¦æƒ³åˆ°ä¸¤ä¸ªæ–¹é¢çš„é—®é¢˜ï¼š å‡ºå£ è°ƒç”¨é€’å½’å‡½æ•°çš„ç»Ÿä¸€æ“ä½œ é¦–å…ˆè¦æ˜ç¡®é€’å½’ä¼ å‡ºæ¥çš„æ˜¯å•¥ï¼Œä¸ºä»€ä¹ˆä½¿ç”¨æ€è·¯ä¸€çš„æƒ³æ³•å°±æ˜¯ï¼Œæˆ‘æƒ³æ‰¾æœ€åä¸€ä¸ªå…ƒç´ ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½è¦éå†ä¸€éæ‰èƒ½æ‰¾åˆ°é‚£ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥ä½¿ç”¨äº†æ•°ç»„ï¼Œé€šè¿‡ä¸‹æ ‡è·å–å…¶ä¸­çš„å…ƒç´ ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åº”è¯¥é€’å½’å‡ºæ¥çš„å±€éƒ¨é“¾è¡¨çš„å°¾å…ƒç´ ï¼Œçœ‹ä¸‹é¢çš„ğŸŒ°ï¼š ç°åœ¨é€’å½’åˆ°å‡ºå£ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥å°† tail ä¼ å‡ºæ¥ ç¬¬äºŒï¼Œæœ¬é¢˜çš„å‡ºå£è¦åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼šå¥‡æ•°ä¸ªå’Œå¶æ•° å¥‡æ•°ï¼šç›´æ¥ä¼ å‡ºæ¥ å¶æ•°ï¼šå°†å®ƒçš„ next ä¼ å‡ºæ¥ ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031public void reorderList(ListNode head) &#123; // Given 1-&gt;2-&gt;3-&gt;4-&gt;5, reorder it to 1-&gt;5-&gt;2-&gt;4-&gt;3. // 2. é€’å½’æ³• if (head == null || head.next == null) return; int len = 0; ListNode count = head; while (count != null) &#123; count = count.next; len++; &#125; helper(head, len);&#125;private ListNode helper(ListNode listNode, int length) &#123; if (length == 1) &#123; ListNode tail = listNode.next; listNode.next = null; return tail; &#125; if (length == 2) &#123; ListNode tail = listNode.next.next; listNode.next.next = null; return tail; &#125; ListNode helper = helper(listNode.next, length - 2); ListNode cur = listNode.next; ListNode next = helper.next; listNode.next = helper; helper.next = cur; return next;&#125; æ€è·¯ä¸‰ï¼šåˆ†ç»„è§£æ³•è¿˜å¯ä»¥å°†è¿™ä¸ªé¢˜åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š æ‰¾åˆ°ä¸­ç‚¹ï¼Œåˆ†å‰²æˆä¸¤ä¸ªé“¾è¡¨ å¯¹åä¸€ä¸ªé“¾è¡¨è¿›è¡Œé€†åº åŒæŒ‡é’ˆåŒæ­¥è¿›è¡Œï¼Œå°†åé¢é“¾è¡¨ä¸å‰é¢çš„é“¾è¡¨è¿›è¡Œè¿æ¥ 123456781 -&gt; 2 -&gt; 3 -&gt; 4 -&gt; 5 -&gt; 6åˆ†å‰²ï¼š1 -&gt; 2 -&gt; 3 4 -&gt; 5 -&gt; 6 é€†åºï¼š6 -&gt; 5 -&gt; 4 è¿æ¥ï¼š1 -&gt; 6 -&gt; 2 -&gt; 5 -&gt; 3 -&gt; 4 ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031public void reorderList(ListNode head) &#123; // Given 1-&gt;2-&gt;3-&gt;4-&gt;5, reorder it to 1-&gt;5-&gt;2-&gt;4-&gt;3. if (head == null || head.next == null) return; ListNode slow = head, fast = head; while (fast.next != null &amp;&amp; fast.next.next != null) &#123; slow = slow.next; fast = fast.next.next; &#125; ListNode cur = slow.next; slow.next = null; ListNode next = reverseList(cur); while (head != null &amp;&amp; next != null) &#123; ListNode l1 = head.next; ListNode l2 = next.next; head.next = next; next.next = l1; head = l1; next = l2; &#125;&#125;private ListNode reverseList(ListNode head) &#123; // é€’å½’æ³• if (head == null || head.next == null) &#123; return head; &#125; ListNode listNode = reverseList(head.next); head.next.next = head; head.next = null; return listNode;&#125; æ—¶é—´å¤æ‚åº¦ï¼šO(n) ç©ºé—´å¤æ‚åº¦ï¼šO(1) æ³¨ï¼šåœ¨ LeetCode ä¸­ï¼Œé€’å½’æ³•æ—¶é—´å¤æ‚åº¦å¯ä»¥ beats 100%ï¼Œç¬¬ä¸‰ç§æ–¹æ³•ä¸å¯ä»¥ï¼ŒæŒ‰ç…§åˆ†ææ¥è¯´ï¼Œåº”è¯¥æ˜¯ä¸€æ ·çš„","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"LinkedList","slug":"LinkedList","permalink":"http://wangba.me/tags/LinkedList/"}]},{"title":"142. Linked List Cycle II","slug":"142-Linked-List-Cycle-II","date":"2020-10-22T13:25:28.000Z","updated":"2020-10-22T13:29:22.519Z","comments":true,"path":"2020/10/22/142-Linked-List-Cycle-II/","link":"","permalink":"http://wangba.me/2020/10/22/142-Linked-List-Cycle-II/","excerpt":"","text":"142. Linked List Cycle II MediumGiven a linked list, return the node where the cycle begins. If there is no cycle, return null. There is a cycle in a linked list if there is some node in the list that can be reached again by continuously following the next pointer. Internally, pos is used to denote the index of the node that tailâ€™s next pointer is connected to. Note that pos is not passed as a parameter. Notice that you should not modify the linked list. Follow up: Can you solve it using O(1) (i.e. constant) memory? Example 1: 123Input: head &#x3D; [3,2,0,-4], pos &#x3D; 1Output: tail connects to node index 1Explanation: There is a cycle in the linked list, where tail connects to the second node. Example 2: 123Input: head &#x3D; [1,2], pos &#x3D; 0Output: tail connects to node index 0Explanation: There is a cycle in the linked list, where tail connects to the first node. Example 3: 123Input: head &#x3D; [1], pos &#x3D; -1Output: no cycleExplanation: There is no cycle in the linked list. Constraints: The number of the nodes in the list is in the range [0, 104]. -105 &lt;= Node.val &lt;= 105 pos is -1 or a valid index in the linked-list. æ€è·¯ï¼šæ€è·¯ä¸€ï¼šå¤§ä½“æ€è·¯è¿˜æ˜¯å’Œ 141 ä¸€æ ·çš„ï¼Œå”¯ä¸€çš„åç»­æ“ä½œå°±æ˜¯ï¼šè®©ç›¸é‡ç‚¹å’Œå¼€å§‹ç‚¹ä¸€èµ·å†å‘åèµ°ï¼Œè¿™ä¸¤ä¸ªç‚¹å†æ¬¡ç›¸é‡çš„ç‚¹å°±æ˜¯å…¥å£ç‚¹ï¼Œå…·ä½“å¯ä»¥å‚è€ƒä¸‹é¢çš„å›¾å’Œæ•°å­¦è¯æ˜ï¼š æ•°å­¦è¯æ˜ æ¡ä»¶ï¼šç¯çš„ç»“ç‚¹æ•° Nã€å¼€å§‹ç‚¹åˆ°å…¥å£ç‚¹è·ç¦» Xã€å…¥å£ç‚¹åˆ°ç›¸é‡ç‚¹è·ç¦» Y (é€†æ—¶é’ˆçš„è·ç¦»ï¼Œä¸Šå›¾ä¸­é•¿çš„é‚£éƒ¨åˆ†) å‡è®¾ï¼šslow ç»“ç‚¹æ€»å…±èµ°äº† T æ­¥åˆ°ç›¸é‡ç‚¹ï¼›åˆ™ fast ç»“ç‚¹å…±èµ°äº† 2T æ­¥ â€‹ slow ç»“ç‚¹æ€»å…±èµ°äº† K1 åœˆï¼› fast ç»“ç‚¹å…±èµ°äº† K2 åœˆ åˆ™ï¼š T = X + K1 * N + Y :one: 2T = X + K2 * N + Y :two: åŒ–ç®€ï¼š T = (K2 - K1) * N å¸¦åˆ° :one: ä¸­ï¼š X = (K2 - 2K1 -1) * N + (N - Y) å…¶ä¸­ï¼š (N - Y) è¡¨ç¤ºç›¸é‡ç‚¹åˆ°å…¥å£ç‚¹çš„è·ç¦» è¿™æ—¶å€™å°±å¯ä»¥è¯´ï¼šæˆ‘ç›¸é‡ç‚¹çš„ç»“ç‚¹å‘å‰èµ°äº† (K2 - 2K1 -1) åœˆå›åˆ°äº†ç›¸é‡ç‚¹ï¼Œå†èµ°äº† (N - Y) åˆ°äº†å…¥å£ç‚¹ ç®€ç›´å°±æ˜¯ Amazing å•Šï¼ ä»£ç ï¼š 1234567891011121314151617public ListNode detectCycle(ListNode head) &#123; ListNode slow = head, fast = head; ListNode temp = null; while (fast != null &amp;&amp; fast.next != null) &#123; slow = slow.next; fast = fast.next.next; if (slow == fast) &#123; temp = slow; while (head != temp) &#123; head = head.next; temp = temp.next; &#125; return head; &#125; &#125; return null;&#125; æ—¶é—´å¤æ‚åº¦ï¼šO() ç©ºé—´å¤æ‚åº¦ï¼šO()","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"LinkedList","slug":"LinkedList","permalink":"http://wangba.me/tags/LinkedList/"}]},{"title":"0092. Reverse Linked List II","slug":"0092-Reverse-Linked-List-II","date":"2020-10-21T12:14:42.000Z","updated":"2020-10-21T12:17:23.402Z","comments":true,"path":"2020/10/21/0092-Reverse-Linked-List-II/","link":"","permalink":"http://wangba.me/2020/10/21/0092-Reverse-Linked-List-II/","excerpt":"","text":"92. Reverse Linked List II Mediuméš¾åº¦ä¸­ç­‰551 Reverse a linked list from position m to n. Do it in one-pass. Note: 1 â‰¤ m â‰¤ n â‰¤ length of list. Example: 12Input: 1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;NULL, m &#x3D; 2, n &#x3D; 4Output: 1-&gt;4-&gt;3-&gt;2-&gt;5-&gt;NULL æ€è·¯ï¼šæ€è·¯ä¸€ï¼šåˆ©ç”¨åè½¬é“¾è¡¨åœ¨ 206 ä¸­å·²ç»è§£å†³äº†åè½¬æ•´ä¸ªé“¾è¡¨ï¼Œç°åœ¨è¿™ç§éƒ¨åˆ†çš„åè½¬é“¾è¡¨ï¼Œåªéœ€è¦å°†ä¸Šé¢çš„æ–­é“¾ï¼Œä¸¢åˆ°åè½¬æ•´ä¸ªé“¾è¡¨çš„å‡½æ•°ä¸­ï¼Œå†æ¢å¤è¿æ¥å°±è¡Œäº† 123456åŸé“¾è¡¨ï¼š1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;NULLæ–­é“¾ï¼š1 2-&gt;3-&gt;4 5-&gt;NULLè°ƒç”¨å‡½æ•°ï¼š4-&gt;3-&gt;2æ¢å¤ï¼š1-&gt;4-&gt;3-&gt;2-&gt;5-&gt;NULL ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041public ListNode reverseBetween(ListNode head, int m, int n) &#123; ListNode listNode = new ListNode(-1); listNode.next = head; ListNode res = listNode; ListNode pre = null; ListNode cur = null; ListNode next = null; int count = 0; while (listNode != null) &#123; if (count == m) &#123; next = listNode; &#125; if (count == m - 1) &#123; pre = listNode; &#125; if (count == n) &#123; cur = listNode; break; &#125; listNode = listNode.next; count++; &#125; ListNode temp = cur.next; cur.next = null; ListNode node = reverseList(pre.next); pre.next = node; next.next = temp; return res.next;&#125;private ListNode reverseList(ListNode head) &#123; // è¿­ä»£æ³• ListNode pre = null; while (head != null) &#123; ListNode next = head.next; head.next = pre; pre = head; head = next; &#125; return pre;&#125; å†™çš„æœ‰ç‚¹å¤æ‚äº†â€¦â€¦ æ—¶é—´å¤æ‚åº¦ï¼šO(n) ç©ºé—´å¤æ‚åº¦ï¼šO(1) æ€è·¯äºŒï¼šå¤´æ’æ³•è¿˜æ˜¯è¦ä½¿ç”¨å“¨å…µï¼Œé¿å…é‡å¤æ“ä½œï¼Œå“¨å…µåé¢ç»“ç‚¹çš„æ“ä½œï¼šæ‰¾åˆ°ç¬¬ä¸€ä¸ªè¦è¿›è¡Œé€†ç½®ç»“ç‚¹çš„å‰ä¸€ä¸ªç»“ç‚¹ï¼Œç„¶åå¯¹åæ¯ä¸ªç»“ç‚¹éƒ½è¿›è¡Œå¤´æ’æ³•å°±è¡Œäº† ä»£ç ï¼š 1234567891011121314151617public ListNode reverseBetween(ListNode head, int m, int n) &#123; ListNode dummy = new ListNode(-1); dummy.next = head; ListNode pre = dummy; for (int i = 0; i &lt; m - 1; i++) &#123; pre = pre.next; &#125; ListNode cur = pre.next; for (int i = m; i &lt; n; i++) &#123; ListNode next = cur.next; cur.next = next.next; next.next = pre.next; pre.next = next; &#125; return dummy.next;&#125; æ—¶é—´å¤æ‚åº¦ï¼šO(n) ç©ºé—´å¤æ‚åº¦ï¼šO(1)","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"LinkedList","slug":"LinkedList","permalink":"http://wangba.me/tags/LinkedList/"}]},{"title":"0086. Partition List","slug":"0086-Partition-List","date":"2020-10-20T13:35:39.000Z","updated":"2020-10-20T13:37:46.940Z","comments":true,"path":"2020/10/20/0086-Partition-List/","link":"","permalink":"http://wangba.me/2020/10/20/0086-Partition-List/","excerpt":"","text":"86. Partition List MediumGiven a linked list and a value x, partition it such that all nodes less than x come before nodes greater than or equal to x. You should preserve the original relative order of the nodes in each of the two partitions. Example: 12Input: head &#x3D; 1-&gt;4-&gt;3-&gt;2-&gt;5-&gt;2, x &#x3D; 3Output: 1-&gt;2-&gt;2-&gt;4-&gt;3-&gt;5 æ€è·¯ï¼šæ€è·¯ä¸€ï¼šå¤§å°é“¾è¡¨123456åŸé“¾è¡¨ï¼š1 -&gt; 4 -&gt; 3 -&gt; 2 -&gt; 5 -&gt; 2å¤§é“¾è¡¨ï¼š4 -&gt; 3 -&gt; 5å°é“¾è¡¨ï¼š1 -&gt; 2 -&gt; 2åˆå¹¶é“¾è¡¨ï¼š1 -&gt; 2 -&gt; 2 -&gt; 4 -&gt; 3 -&gt; 5 ä»£ç ï¼š 1234567891011121314151617181920212223242526 public ListNode partition(ListNode head, int x) &#123;// Input: head = 1-&gt;4-&gt;3-&gt;2-&gt;5-&gt;2, x = 3// Output: 1-&gt;2-&gt;2-&gt;4-&gt;3-&gt;5 // å°é“¾è¡¨ ListNode min = new ListNode(-1); ListNode l = min; // å¤§é“¾è¡¨ ListNode max = new ListNode(-1); ListNode h = max; while (head != null) &#123; if (head.val &lt; x) &#123; l.next = head; l = l.next; &#125; else &#123; h.next = head; h = h.next; &#125; head = head.next; &#125; h.next = null; l.next = max.next; return min.next; &#125; æ—¶é—´å¤æ‚åº¦ï¼šO(n) ç©ºé—´å¤æ‚åº¦ï¼šO()","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"LinkedList","slug":"LinkedList","permalink":"http://wangba.me/tags/LinkedList/"}]},{"title":"0083. Remove Duplicates from Sorted List","slug":"0083-Remove-Duplicates-from-Sorted-List","date":"2020-10-19T13:28:17.000Z","updated":"2020-10-20T13:34:21.281Z","comments":true,"path":"2020/10/19/0083-Remove-Duplicates-from-Sorted-List/","link":"","permalink":"http://wangba.me/2020/10/19/0083-Remove-Duplicates-from-Sorted-List/","excerpt":"","text":"83. Remove Duplicates from Sorted List EasyGiven a sorted linked list, delete all duplicates such that each element appear only once. Example 1: 12Input: 1-&gt;1-&gt;2Output: 1-&gt;2 Example 2: 12Input: 1-&gt;1-&gt;2-&gt;3-&gt;3Output: 1-&gt;2-&gt;3 æ€è·¯ï¼šæ€è·¯ä¸€ï¼šåŒæŒ‡é’ˆç”±äºéƒ½æ˜¯å·²ç»æ’å¥½åºçš„é“¾è¡¨ï¼Œç›¸åŒçš„æ•°éƒ½åœ¨ä¸€èµ·ï¼Œåªè¦ä½¿ç”¨åŒæŒ‡é’ˆï¼šä¸€ä¸ªæŒ‡å‘å‡ºç°çš„ç¬¬ä¸€ä¸ªæ•°ï¼Œä¸€ä¸ªä¸€ç›´éå†åˆ°è¿™ä¸ªæ•°ç»“æŸå³å¯ ä»£ç ï¼š 12345678910111213141516public ListNode deleteDuplicates(ListNode head) &#123; if (head == null || head.next == null) return head; ListNode slow = head; ListNode fast = head.next; while (fast != null) &#123; if (slow.val == fast.val) &#123; fast = fast.next; slow.next = fast; &#125; else &#123; slow = slow.next; fast = fast.next; &#125; &#125; return head;&#125;","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"LinkedList","slug":"LinkedList","permalink":"http://wangba.me/tags/LinkedList/"}]},{"title":"0025. Reverse Nodes in k-Group","slug":"0025-Reverse-Nodes-in-k-Group","date":"2020-10-15T11:56:31.000Z","updated":"2020-10-15T12:01:22.813Z","comments":true,"path":"2020/10/15/0025-Reverse-Nodes-in-k-Group/","link":"","permalink":"http://wangba.me/2020/10/15/0025-Reverse-Nodes-in-k-Group/","excerpt":"","text":"25. Reverse Nodes in k-Group HardGiven a linked list, reverse the nodes of a linked list k at a time and return its modified list. k is a positive integer and is less than or equal to the length of the linked list. If the number of nodes is not a multiple of k then left-out nodes, in the end, should remain as it is. Follow up: Could you solve the problem in O(1) extra memory space? You may not alter the values in the listâ€™s nodes, only nodes itself may be changed. Example 1: 12Input: head &#x3D; [1,2,3,4,5], k &#x3D; 2Output: [2,1,4,3,5] Example 2: 12Input: head &#x3D; [1,2,3,4,5], k &#x3D; 3Output: [3,2,1,4,5] Example 3: 12Input: head &#x3D; [1,2,3,4,5], k &#x3D; 1Output: [1,2,3,4,5] Example 4: 12Input: head &#x3D; [1], k &#x3D; 1Output: [1] Constraints: The number of nodes in the list is in the range sz. 1 &lt;= sz &lt;= 5000 0 &lt;= Node.val &lt;= 1000 1 &lt;= k &lt;= sz æ€è·¯ï¼šæ€è·¯ä¸€ï¼šè¿­ä»£å¯ä»¥ç»“åˆä¸‹é¢çš„å›¾å’Œä»£ç è¿›è¡ŒæŸ¥çœ‹ï¼š ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132public ListNode reverseKGroup(ListNode head, int k) &#123; ListNode ans = new ListNode(0); ans.next = head; ListNode res = ans; ListNode end = ans; while (end.next != null) &#123; for (int i = 0; i &lt; k &amp;&amp; end != null; i++) end = end.next; if (end == null) break; ListNode start = res.next; ListNode next = end.next; end.next = null; res.next = reverseList(start); start.next = next; res = start; end = res; &#125; return ans.next;&#125;private ListNode reverseList(ListNode head) &#123; // é€’å½’æ³• if (head == null || head.next == null) &#123; return head; &#125; ListNode listNode = reverseList(head.next); head.next.next = head; head.next = null; return listNode;&#125; æ—¶é—´å¤æ‚åº¦ï¼šO(n) ç©ºé—´å¤æ‚åº¦ï¼šO(1) æ€è·¯äºŒï¼šé€’å½’ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536public ListNode reverseKGroup(ListNode head, int k) &#123; if (head == null) return null; ListNode point = head; //æ‰¾åˆ°å­é“¾è¡¨çš„å°¾éƒ¨ int i = k; while(i - 1 &gt;0)&#123; point = point.next; if (point == null) &#123; return head; &#125; i--; &#125; ListNode temp = point.next; //å°†å­é“¾è¡¨æ–­å¼€ point.next = null; //å€’ç½®å­é“¾è¡¨ï¼Œå¹¶æ¥å—æ–°çš„å¤´ç»“ç‚¹ ListNode new_head = reverseList(head); //head å…¶å®æ˜¯å€’ç½®é“¾è¡¨çš„å°¾éƒ¨ï¼Œç„¶åæˆ‘ä»¬å°†åè¾¹çš„å€’ç½®ç»“æœæ¥è¿‡æ¥å°±å¯ä»¥äº† //temp æ˜¯é“¾è¡¨æ–­å¼€åçš„å¤´æŒ‡é’ˆï¼Œå¯ä»¥å‚è€ƒè§£æ³•ä¸€çš„å›¾ç¤º head.next = reverseKGroup(temp,k); return new_head;&#125;private ListNode reverseList(ListNode head) &#123; // é€’å½’æ³• if (head == null || head.next == null) &#123; return head; &#125; ListNode listNode = reverseList(head.next); head.next.next = head; head.next = null; return listNode;&#125;","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"LinkedList","slug":"LinkedList","permalink":"http://wangba.me/tags/LinkedList/"}]},{"title":"1002. Find Common Characters","slug":"1002-Find-Common-Characters","date":"2020-10-14T11:46:04.000Z","updated":"2020-10-14T11:51:39.832Z","comments":true,"path":"2020/10/14/1002-Find-Common-Characters/","link":"","permalink":"http://wangba.me/2020/10/14/1002-Find-Common-Characters/","excerpt":"","text":"1002. Find Common Characters EasyGiven an array A of strings made only from lowercase letters, return a list of all characters that show up in all strings within the list (including duplicates). For example, if a character occurs 3 times in all strings but not 4 times, you need to include that character three times in the final answer. You may return the answer in any order. Example 1: 12Input: [&quot;bella&quot;,&quot;label&quot;,&quot;roller&quot;]Output: [&quot;e&quot;,&quot;l&quot;,&quot;l&quot;] Example 2: 12Input: [&quot;cool&quot;,&quot;lock&quot;,&quot;cook&quot;]Output: [&quot;c&quot;,&quot;o&quot;] Note: 1 &lt;= A.length &lt;= 100 1 &lt;= A[i].length &lt;= 100 A[i][j] is a lowercase letter æ€è·¯ï¼šæ€è·¯ä¸€ï¼šæš´åŠ›ç ´è§£ä»…ä¾›å‚è€ƒï¼š æ‰¾åˆ°é•¿åº¦æœ€å°çš„å­—ç¬¦ä¸²ï¼Œç”±äºæ˜¯è€ƒè™‘æ¯ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­é‡å¤çš„å…ƒç´  å°†è¿™ä¸ªå­—ç¬¦ä¸²æ”¾åˆ° map ä¸­ï¼Œmap ä¸­çš„å€¼å¯ä»¥è®¾ä¸ºå­—ç¬¦ä¸²æ•°ç»„é•¿åº¦ ä¾æ¬¡éå†ï¼Œå¦‚æœé‡å¤å°± -1 ï¼Œæœ€åçœ‹ map ä¸­çš„å€¼æ˜¯å¦å˜ä¸º 0 æ€è·¯äºŒï¼šå“ˆå¸Œå¯ä»¥ç»“åˆä¸‹é¢çš„å›¾å’Œä»£ç è¿›è¡Œç†è§£ ç”±äºéƒ½æ˜¯å°å†™å­—æ¯ï¼Œåªéœ€è¦ä½¿ç”¨å®¹é‡ä¸º 26 çš„æ•°ç»„è¡¨ç¤º 26 ä½å­—æ¯ï¼› ç¬¬ä¸€ä¸ª 26 ä½æ•°ç»„ï¼Œå°†å­—ç¬¦ä¸²æ•°ç»„çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²è£…ä¸‹ï¼Œé‡å¤çš„ + 1 åé¢å’Œç¬¬ä¸€ä¸ªä¸€æ ·æ“ä½œå¾—åˆ°æ–°çš„æ•°ç»„ï¼Œæ¯”è¾ƒå…¶ä¸­çš„å€¼ï¼Œå–æœ€å° çš„å³å¯ï¼Œå› ä¸ºæœ€å°çš„é‚£ä¸ªæ‰ä»£è¡¨ç€å®ƒåœ¨è‡ªå·±çš„æ•°ç»„ä¸­é‡å¤äº†å¤šå°‘æ¬¡ï¼Œåœ¨æ‰€æœ‰çš„å­—ç¬¦ä¸²ä¸­ï¼Œå®ƒæœ€å¤šçš„å­—ç¬¦é‡å¤ å°†ç»“æœæ”¾åœ¨ç¬¬ä¸€ä¸ªæ•°ç»„ï¼Œç»§ç»­æ¯”è¾ƒ ä»£ç ï¼š 12345678910111213141516171819202122232425public List&lt;String&gt; commonChars(String[] A) &#123; // å“ˆå¸Œè¡¨ int[] res = new int[26]; for (int i = 0; i &lt; A[0].length(); i++) &#123; res[A[0].charAt(i) - &#x27;a&#x27;]++; &#125; for (int i = 1; i &lt; A.length; i++) &#123; int[] temp = new int[26]; for (int j = 0; j &lt; A[i].length(); j++) &#123; temp[A[i].charAt(j) - &#x27;a&#x27;]++; &#125; for (int j = 0; j &lt; 26; j++) &#123; res[j] = Math.min(res[j], temp[j]); &#125; &#125; List&lt;String&gt; ans = new ArrayList&lt;&gt;(); for (int i = 0; i &lt; 26; i++) &#123; while (res[i] != 0) &#123; ans.add(String.valueOf((char)((i) + &#x27;a&#x27;))); res[i]--; &#125; &#125; return ans;&#125;","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"LinkedList","slug":"LinkedList","permalink":"http://wangba.me/tags/LinkedList/"}]},{"title":"0023. Merge k Sorted Lists","slug":"0023-Merge-k-Sorted-Lists","date":"2020-10-14T06:39:51.000Z","updated":"2020-10-14T07:00:54.331Z","comments":true,"path":"2020/10/14/0023-Merge-k-Sorted-Lists/","link":"","permalink":"http://wangba.me/2020/10/14/0023-Merge-k-Sorted-Lists/","excerpt":"","text":"23. Merge k Sorted Lists HardYou are given an array of k linked-lists lists, each linked-list is sorted in ascending order. Merge all the linked-lists into one sorted linked-list and return it. Example 1: 12345678910Input: lists &#x3D; [[1,4,5],[1,3,4],[2,6]]Output: [1,1,2,3,4,4,5,6]Explanation: The linked-lists are:[ 1-&gt;4-&gt;5, 1-&gt;3-&gt;4, 2-&gt;6]merging them into one sorted list:1-&gt;1-&gt;2-&gt;3-&gt;4-&gt;4-&gt;5-&gt;6 Example 2: 12Input: lists &#x3D; []Output: [] Example 3: 12Input: lists &#x3D; [[]]Output: [] Constraints: k == lists.length 0 &lt;= k &lt;= 10^4 0 &lt;= lists[i].length &lt;= 500 -10^4 &lt;= lists[i][j] &lt;= 10^4 lists[i] is sorted in ascending order. The sum of lists[i].length wonâ€™t exceed 10^4. æ€è·¯ï¼šæ€è·¯ä¸€ï¼šæš´åŠ›è§£æ³•éå†é“¾è¡¨æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªé“¾è¡¨ï¼Œåœ¨æ¯ä¸€ä¸ªé“¾è¡¨ä¸­ç»§ç»­éå†ï¼Œå°†æ‰€æœ‰çš„ç»“æœéƒ½å­˜åœ¨æ•°ç»„ä¸­ï¼Œå†è¿›è¡Œä¸€æ¬¡å¿«é€Ÿæ’åºï¼Œæœ€åå†æŠŠæ•°ç»„ä¸­çš„æ¯ä¸ªç»“ç‚¹ç»„è£…æˆé“¾è¡¨å³å¯ ä»£ç ï¼š 12345678910111213141516171819public ListNode mergeKLists(ListNode[] lists) &#123; List&lt;Integer&gt; res = new ArrayList&lt;&gt;(); for (ListNode listNode : lists) &#123; while (listNode != null) &#123; res.add(listNode.val); listNode = listNode.next; &#125; &#125; Collections.sort(res); ListNode head = new ListNode(-1); ListNode ans = head; for (int i : res) &#123; ListNode listNode = new ListNode(i); head.next = listNode; head = head.next; &#125; head.next = null; return ans.next;&#125; æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn)ï¼Œn ä¸ºæ‰€æœ‰ç»“ç‚¹æ•° ç©ºé—´å¤æ‚åº¦ï¼šO(n) æ€è·¯äºŒï¼šåˆ—æ¯”è¾ƒåˆ©ç”¨æ¯ä¸ªé“¾è¡¨æ•°ç»„ä¸­çš„é“¾è¡¨æ˜¯æœ‰åºçš„ï¼Œåˆ™æ¯æ¬¡æ‹¿åˆ°æœ€å°çš„ç»“ç‚¹åŠ å…¥æ–°çš„é“¾è¡¨ä¸­ï¼Œæ¯ä¸ªé“¾è¡¨æ•°ç»„ä¸­çš„é“¾è¡¨å¤´çš„å€¼ä¸€å®šæ˜¯æœ€å°çš„ ä»£ç ï¼š 123456789101112131415161718192021222324252627282930public ListNode mergeKLists(ListNode[] lists) &#123; // 2. åˆ—æ¯”è¾ƒ // æœ€å°ç´¢å¼• int minIndex = 0; ListNode head = new ListNode(-1); ListNode res = head; while (true) &#123; boolean isCompleted = true; int min = Integer.MAX_VALUE; // éå†ä¸€éé“¾è¡¨æ•°ç»„æ‰¾åˆ°æ•°å€¼æœ€å°çš„ç»“ç‚¹ for (int i = 0; i &lt; lists.length; i++) &#123; if (lists[i] != null) &#123; if (lists[i].val &lt; min) &#123; minIndex = i; min = lists[i].val; &#125; isCompleted = false; &#125; &#125; // å½“æ‰€æœ‰çš„é“¾è¡¨å…¨éƒ¨éå†å®Œäº†ï¼Œwhile å¾ªç¯ç»“æŸ if (isCompleted) break; head.next = lists[minIndex]; head = head.next; lists[minIndex] = lists[minIndex].next; &#125; head.next = null; return res.next;&#125; æ—¶é—´å¤æ‚åº¦ï¼šO(m * n)ï¼Œm ä¸ºæœ€é•¿é“¾è¡¨çš„é•¿åº¦ï¼›n ä¸ºé“¾è¡¨æ•°ç»„é•¿åº¦ ç©ºé—´å¤æ‚åº¦ï¼šO(1) æ€è·¯ä¸‰ï¼šä¼˜å…ˆé˜Ÿåˆ—åœ¨ä¸Šé¢çš„æ€è·¯ä¸­ï¼Œæ¯æ¬¡éƒ½æ˜¯æ‰¾åˆ°é“¾è¡¨æ•°ç»„ä¸­æœ€å°çš„ç»“ç‚¹ï¼Œå†åŠ å…¥æ–°é“¾è¡¨ä¸­ï¼Œåœ¨ä¸Šé¢ä½¿ç”¨çš„ç›´æ¥éå†çš„æ–¹å¼ï¼Œåœ¨è¿™é‡Œå¯ä»¥é‡‡ç”¨ä¼˜å…ˆé˜Ÿåˆ—çš„æ–¹å¼ï¼Œä¼˜å…ˆé˜Ÿåˆ—æ˜¯åŸºäºå †å®ç°çš„ï¼Œå…·ä½“æ¥è¯´å°±æ˜¯å°/å¤§æ ¹(é¡¶)å †ï¼Œåªéœ€è¦å°†æ¯ä¸ªé“¾è¡¨çš„å¤´ç»“ç‚¹æ”¾å…¥ï¼Œä¼šè‡ªåŠ¨è¿›è¡Œå¤§å°æ¯”è¾ƒï¼Œå‡ºé˜Ÿåˆ—æ˜¯å°±æ˜¯æœ€å°/æœ€å¤§ ä»£ç ï¼š 12345678910111213141516171819202122232425public ListNode mergeKLists(ListNode[] lists) &#123; // ä¼˜å…ˆé˜Ÿåˆ—ä¸­é»˜è®¤å°±æ˜¯å°æ ¹å † PriorityQueue&lt;ListNode&gt; priorityQueue = new PriorityQueue&lt;ListNode&gt;(Comparator.comparing(n -&gt; n.val)); // å°†æ¯ä¸ªç»“ç‚¹çš„çš„å¤´ç»“ç‚¹åŠ å…¥ä¼˜å…ˆé˜Ÿåˆ— for (int i = 0; i &lt; lists.length; i++) &#123; if (lists[i] != null) &#123; priorityQueue.add(lists[i]); &#125; &#125; ListNode head = new ListNode(-1); ListNode res = head; while (!priorityQueue.isEmpty()) &#123; // å‡ºé˜Ÿåˆ—æ—¶å°±æ˜¯æœ€å°å€¼å…ˆå‡ºæ¥çš„ head.next = priorityQueue.poll(); head = head.next; // å°†å‡ºé˜Ÿåˆ—çš„åé¢é‚£ä¸ªå€¼åŠ å…¥ä¼˜å…ˆé˜Ÿåˆ— if (head.next != null) &#123; priorityQueue.add(head.next); &#125; &#125; return res.next;&#125; æ—¶é—´å¤æ‚åº¦ï¼šO(nlogk)ï¼Œn è¡¨ç¤ºæ‰€æœ‰çš„ç»“ç‚¹ä¹¦æ•°ï¼Œlogk è¡¨ç¤ºæ¯ä¸ªç»“ç‚¹çš„å…¥é˜Ÿã€å‡ºé˜Ÿ ç©ºé—´å¤æ‚åº¦ï¼šO(k)ï¼Œk è¡¨ç¤ºé“¾è¡¨æ•°ç»„çš„é•¿åº¦ï¼›åœ¨ Java ä¸­ä¼˜å…ˆé˜Ÿåˆ—æ˜¯æœ‰é»˜è®¤å€¼çš„ æ€è·¯å››ï¼šä¸¤ä¸¤åˆå¹¶åœ¨0021. Merge Two Sorted Listsä¸­ï¼Œå·²ç»å®ç°è¿‡ä¸¤ä¸ªæœ‰åºé“¾è¡¨çš„åˆå¹¶ï¼Œæœ¬é¢˜ä¹Ÿå¯ä»¥å‚è€ƒè¿™ä¸ªæ€è·¯ï¼šé¦–å…ˆå°†é“¾è¡¨ 0 å’Œé“¾è¡¨ 1 åˆå¹¶ï¼Œåˆå¹¶æˆæ–°çš„é“¾è¡¨ aï¼Œåœ¨å’Œé“¾è¡¨ 2 è¿›è¡Œåˆå¹¶ â€¦â€¦ ä»£ç ï¼š 123456789101112131415161718192021public ListNode mergeKLists(ListNode[] lists) &#123; // 4. ä¸¤ä¸¤åˆå¹¶ ListNode temp = null; for (int i = 0; i &lt; lists.length; i++) &#123; temp = mergeTwoLists(temp, lists[i]); &#125; return temp;&#125;private ListNode mergeTwoLists(ListNode l1, ListNode l2) &#123; if (l1 == null) return l2; if (l2 == null) return l1; if (l1.val &gt; l2.val) &#123; l2.next = mergeTwoLists(l1, l2.next); return l2; &#125; else &#123; l1.next = mergeTwoLists(l1.next, l2); return l1; &#125;&#125; æ€è·¯äº”ï¼šäºŒåˆ†æ³•ä¸¤ä¸¤åˆå¹¶åœ¨ä¸Šé¢æ€è·¯äº”ä¸­ï¼Œåˆå¹¶çš„æ€è·¯æ˜¯ï¼šå…ˆæ˜¯åˆå¹¶ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªï¼Œåˆå¹¶ä¸ºæ–°çš„åï¼Œå†å’Œç¬¬ä¸‰ä¸ªè¿›è¡Œåˆå¹¶ï¼Œè¿™æ ·çš„æ•ˆç‡æœ‰ç‚¹ä½ è¿™ä¸ªæ€è·¯ä¹Ÿæ˜¯å¯ä»¥ä¼˜åŒ–çš„ï¼Œä½¿ç”¨äºŒåˆ†æ³•ï¼š ä»£ç ï¼š 123456789101112131415161718192021222324public ListNode mergeKLists(ListNode[] lists) &#123; if (lists.length == 0) return null; return merge(lists, 0 , lists.length - 1);&#125;private ListNode merge(ListNode[] lists, int left, int right) &#123; if (left == right) return lists[left]; int mid = left + (right - left) / 2; ListNode l = merge(lists, left, mid); ListNode r = merge(lists, mid + 1, right); return mergeTwoLists(l , r);&#125;private ListNode mergeTwoLists(ListNode l1, ListNode l2) &#123; if (l1 == null) return l2; if (l2 == null) return l1; if (l1.val &gt; l2.val) &#123; l2.next = mergeTwoLists(l1, l2.next); return l2; &#125; else &#123; l1.next = mergeTwoLists(l1.next, l2); return l1; &#125;&#125;","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"LinkedList","slug":"LinkedList","permalink":"http://wangba.me/tags/LinkedList/"}]},{"title":"0021. Merge Two Sorted Lists","slug":"0021-Merge-Two-Sorted-Lists","date":"2020-10-13T12:28:27.000Z","updated":"2020-10-14T07:00:19.534Z","comments":true,"path":"2020/10/13/0021-Merge-Two-Sorted-Lists/","link":"","permalink":"http://wangba.me/2020/10/13/0021-Merge-Two-Sorted-Lists/","excerpt":"","text":"21. Merge Two Sorted Lists EasyMerge two sorted linked lists and return it as a new sorted list. The new list should be made by splicing together the nodes of the first two lists. Example 1: 12Input: l1 &#x3D; [1,2,4], l2 &#x3D; [1,3,4]Output: [1,1,2,3,4,4] Example 2: 12Input: l1 &#x3D; [], l2 &#x3D; []Output: [] Example 3: 12Input: l1 &#x3D; [], l2 &#x3D; [0]Output: [0] Constraints: The number of nodes in both lists is in the range [0, 50]. -100 &lt;= Node.val &lt;= 100 Both l1 and l2 are sorted in non-decreasing order. æ€è·¯ï¼šæ€è·¯ä¸€ï¼šè¿­ä»£æ³•è®¾ç½®ä¸€ä¸ªå¤´ç»“ç‚¹ï¼Œéšåå¼€å§‹æ¯”è¾ƒä¸¤ä¸ªé“¾è¡¨çš„ç»“ç‚¹å€¼å¤§å°ï¼Œå…·ä½“é€»è¾‘å¯ä»¥å°†ä¸‹é¢çš„å›¾å’Œä»£ç é€»è¾‘è”ç³»èµ·æ¥ï¼š ä»£ç ï¼š 1234567891011121314151617181920212223242526public ListNode mergeTwoLists(ListNode l1, ListNode l2) &#123; // è¿­ä»£æ³• // 1 2 4 1 3 4 // 1 1 2 3 4 4 ListNode temp = new ListNode(-1); ListNode res = temp; while (l1 != null &amp;&amp; l2 != null) &#123; if (l1.val &gt; l2.val) &#123; temp.next = l2; temp = temp.next; l2 = l2.next; &#125; else &#123; temp.next = l1; temp = temp.next; l1 = l1.next; &#125; &#125; if (l1 == null) temp.next = l2; if (l2 == null) temp.next = l1; return res.next;&#125; æ—¶é—´å¤æ‚åº¦ï¼šO(m + n) ç©ºé—´å¤æ‚åº¦ï¼šO(1) æ€è·¯äºŒï¼šé€’å½’æ³•é€’å½’æœ€é‡è¦çš„ä¸¤ä¸ªç‚¹ï¼š é€’å½’çš„å‡ºå£ï¼Œåœ¨æœ¬é¢˜é‡Œé¢å°±æ˜¯å½“å…¶ä¸­çš„ä¸€ä¸ªé“¾è¡¨ä¸ºç©ºï¼Œç›´æ¥è¿”å›å¦å¤–ä¸€ä¸ªé“¾è¡¨å³å¯ è¦è¿›è¡Œé€’å½’ï¼Œä¼ å…¥å‚æ•°åçš„ç»“æœåº”è¯¥æ˜¯å·²ç»ç¡®å®šçš„äº†ï¼Œåœ¨è¿™é‡Œå°±æ˜¯é“¾è¡¨å·²ç»æ’å¥½åºäº† ä¸¾ä¸ªä¾‹å­ï¼šå¦‚æœç°åœ¨æ˜¯ 123é“¾è¡¨laï¼š1 -&gt; 3 -&gt; 5é“¾è¡¨lbï¼š2 -&gt; 4 -&gt; 6 è¿›è¡Œç¬¬ä¸€æ¬¡é€’å½’æ—¶ï¼šè¦æ¯”è¾ƒ 1 å’Œ 2 çš„å¤§å°ï¼Œå‘ç° 1 &lt; 2ï¼Œæ­¤æ—¶åªéœ€è¦å°† 1.next = mergeTwoLists(3, 2) å°±è¡Œäº†ï¼Œä¸è¦å»æƒ³ mergeTwoLists(3, 2) æ€ä¹ˆæ¥çš„ï¼Œè¦æŠŠå®ƒå½“ä½œå·²ç»ç¡®å®šçš„å€¼å°±è¡Œï¼Œè€Œ mergeTwoLists(3, 2) çš„å€¼å¯ä»¥çœ‹ä½œæ˜¯ä¸‹é¢è¿™ä¸¤ä¸ªé“¾è¡¨çš„è¿›è¡Œ mergeTwoLists çš„ç»“æœ 123é“¾è¡¨laï¼š3 -&gt; 5é“¾è¡¨lbï¼š2 -&gt; 4 -&gt; 6 ä»£ç ï¼š 12345678910111213141516public ListNode mergeTwoLists(ListNode l1, ListNode l2) &#123; // é€’å½’æ³• // é€’å½’çš„å‡ºå£ if (l1 == null) return l2; if (l2 == null) return l1; if (l1.val &gt; l2.val) &#123; l2.next = mergeTwoLists(l1, l2.next); return l2; &#125; else &#123; l1.next = mergeTwoLists(l1.next, l2); return l1; &#125;&#125; æ—¶é—´å¤æ‚åº¦ï¼šO(m + n) ç©ºé—´å¤æ‚åº¦ï¼šO(m + n) ç”±äºé€’å½’æ˜¯è°ƒç”¨æ ˆçš„ï¼Œæ¯é€’å½’ä¸€æ¬¡éœ€è¦ä¸€ä¸ªæ ˆå¸§","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"Array","slug":"Array","permalink":"http://wangba.me/tags/Array/"},{"name":"LinkedList","slug":"LinkedList","permalink":"http://wangba.me/tags/LinkedList/"}]},{"title":"SpringBootæ•´åˆSpring Security(ä¸ƒ)","slug":"SpringBootæ•´åˆSpring-Security-ä¸ƒ","date":"2020-10-13T05:38:58.000Z","updated":"2020-10-13T05:40:08.522Z","comments":true,"path":"2020/10/13/SpringBootæ•´åˆSpring-Security-ä¸ƒ/","link":"","permalink":"http://wangba.me/2020/10/13/SpringBoot%E6%95%B4%E5%90%88Spring-Security-%E4%B8%83/","excerpt":"","text":"ä¸€ã€OverViewâ€‹ è¿™ä¸€å°èŠ‚æ•´ç†ä¸€ä¸‹å‰é¢å‡ èŠ‚çš„å†…å®¹ï¼Œä¸»è¦å®Œæ•´çš„æ‹ä¸€é Spring Security çš„ç™»å½•è¿‡ç¨‹ã€‚ä¸ºäº†æœ‰ä¸€ä¸ª Architecture First çš„å°è±¡ï¼Œå…ˆå°†å…¶ä¸­å…³é”®çš„ç±»å’Œæ¥å£åˆ—å‡ºï¼Œå¦‚æœçœ‹åˆ°åé¢å‘ç°æœ‰å°è±¡ï¼Œå°±å¯ä»¥è·³åˆ°å‰é¢æ¥çœ‹ä¸€ä¸‹ï¼š SecurityContextHolder Authentication Token ç±» UsernamePasswordAuthenticationToken AbstractAuthenticationToken Provider å’Œ Manger ç±» AuthenticationManager ProviderManager AuthenticationProvider DaoAuthenticationProvider UserDetails ä¸ UserDetailsService ä¸»è¦å¯ä»¥å‚è€ƒä¸€ä¸‹è¿™å¼ å›¾ï¼š å›¾æºï¼šSpring Security(ä¸€)â€“Architecture Overview äºŒã€DeepLearning2.1 Authenticationå…ˆçœ‹ä¸€ä¸‹ Authentication çš„ç›¸å…³å®ç°ç±» æºç ï¼š 12345678910111213public interface Authentication extends Principal, Serializable &#123; Collection&lt;? extends GrantedAuthority&gt; getAuthorities(); Object getCredentials(); Object getDetails(); Object getPrincipal(); boolean isAuthenticated(); void setAuthenticated(boolean var1) throws IllegalArgumentException;&#125; getAuthorities()ï¼šæƒé™ä¿¡æ¯åˆ—è¡¨ï¼Œé»˜è®¤æ˜¯ GrantedAuthority æ¥å£çš„ä¸€äº›å®ç°ç±»ï¼Œé€šå¸¸æ˜¯ä»£è¡¨æƒé™ä¿¡æ¯çš„ä¸€ç³»åˆ—å­—ç¬¦ä¸²ã€‚ getCredentials()ï¼šå¯†ç ä¿¡æ¯ï¼Œç”¨æˆ·è¾“å…¥çš„å¯†ç å­—ç¬¦ä¸²ï¼Œåœ¨è®¤è¯è¿‡åé€šå¸¸ä¼šè¢«ç§»é™¤ï¼Œç”¨äºä¿éšœå®‰å…¨ã€‚ getDetails()ï¼šç»†èŠ‚ä¿¡æ¯ï¼Œweb åº”ç”¨ä¸­çš„å®ç°æ¥å£é€šå¸¸ä¸º WebAuthenticationDetailsï¼Œå®ƒè®°å½•äº†è®¿é—®è€…çš„ ip åœ°å€å’Œ sessionId çš„å€¼ã€‚ getPrincipal()ï¼šæœ€é‡è¦çš„èº«ä»½ä¿¡æ¯ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹è¿”å›çš„æ˜¯ UserDetails æ¥å£çš„å®ç°ç±»ï¼Œä¹Ÿæ˜¯æ¡†æ¶ä¸­çš„å¸¸ç”¨æ¥å£ä¹‹ä¸€ã€‚UserDetails æ¥å£å°†ä¼šåœ¨ä¸‹é¢çš„å°èŠ‚é‡ç‚¹ä»‹ç»ã€‚ åœ¨å®ç°ç±»ä¸­éå¸¸é‡è¦çš„å°±æ˜¯ UsernamePasswordAuthenticationToken ï¼Œå†çœ‹ä¸€ä¸‹å…¶ä¸­çš„å±æ€§å’Œæ–¹æ³• ä»¥åŠå®ƒçš„çˆ¶ç±»ï¼šAbstractAuthenticationToken 2.2 UsernamePasswordAuthenticationFilteråœ¨ Spring Security ä¸­ï¼Œè®¤è¯ä¸æˆæƒçš„ç›¸å…³æ ¡éªŒéƒ½æ˜¯åœ¨ä¸€ç³»åˆ—çš„è¿‡æ»¤å™¨é“¾ä¸­å®Œæˆçš„ï¼Œåœ¨è¿™ä¸€ç³»åˆ—çš„è¿‡æ»¤å™¨é“¾ä¸­ï¼Œå’Œè®¤è¯ç›¸å…³çš„è¿‡æ»¤å™¨å°±æ˜¯ UsernamePasswordAuthenticationFilterï¼š 123456789101112131415161718192021222324252627282930313233343536public class UsernamePasswordAuthenticationFilter extends AbstractAuthenticationProcessingFilter &#123; public UsernamePasswordAuthenticationFilter() &#123; super(new AntPathRequestMatcher(&quot;/login&quot;, &quot;POST&quot;)); &#125; public Authentication attemptAuthentication(HttpServletRequest request, HttpServletResponse response) throws AuthenticationException &#123; if (this.postOnly &amp;&amp; !request.getMethod().equals(&quot;POST&quot;)) &#123; throw new AuthenticationServiceException(&quot;Authentication method not supported: &quot; + request.getMethod()); &#125; else &#123; String username = this.obtainUsername(request); String password = this.obtainPassword(request); if (username == null) &#123; username = &quot;&quot;; &#125; if (password == null) &#123; password = &quot;&quot;; &#125; username = username.trim(); UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(username, password); this.setDetails(request, authRequest); return this.getAuthenticationManager().authenticate(authRequest); &#125; &#125; @Nullable protected String obtainPassword(HttpServletRequest request) &#123; return request.getParameter(this.passwordParameter); &#125; @Nullable protected String obtainUsername(HttpServletRequest request) &#123; return request.getParameter(this.usernameParameter); &#125;&#125; å…¶ä¸­ï¼šUsernamePasswordAuthenticationFilter æ˜¯ç»§æ‰¿ AbstractAuthenticationProcessingFilter é€šè¿‡ obtainUsername å’Œ obtainPassword æ–¹æ³•æå–å‡ºè¯·æ±‚é‡Œè¾¹çš„ç”¨æˆ·å/å¯†ç å‡ºæ¥ï¼Œæå–æ–¹å¼å°±æ˜¯ request.getParameter è·å–åˆ°è¯·æ±‚é‡Œä¼ é€’æ¥çš„ç”¨æˆ·å/å¯†ç ä¹‹åï¼Œæ¥ä¸‹æ¥å°±æ„é€ ä¸€ä¸ª UsernamePasswordAuthenticationToken å¯¹è±¡ï¼Œä¼ å…¥ username å’Œ passwordï¼Œusername å¯¹åº”äº† UsernamePasswordAuthenticationToken ä¸­çš„ principal å±æ€§ï¼Œè€Œ password åˆ™å¯¹åº”äº†å®ƒçš„ credentials å±æ€§ æ¥ä¸‹æ¥ setDetails æ–¹æ³•ç»™ details å±æ€§èµ‹å€¼ï¼ŒUsernamePasswordAuthenticationToken æœ¬èº«æ˜¯æ²¡æœ‰ details å±æ€§çš„ï¼Œè¿™ä¸ªå±æ€§åœ¨å®ƒçš„çˆ¶ç±» AbstractAuthenticationToken ä¸­ã€‚details æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡é‡Œè¾¹æ”¾çš„æ˜¯ WebAuthenticationDetails å®ä¾‹ï¼Œè¯¥å®ä¾‹ä¸»è¦æè¿°äº†ä¸¤ä¸ªä¿¡æ¯ï¼Œè¯·æ±‚çš„ remoteAddress ä»¥åŠè¯·æ±‚çš„ sessionId æœ€åè°ƒç”¨ authenticate æ–¹æ³•å»åšæ ¡éªŒäº† ä»”ç»†æ¥ç»†è¯´ä¸€ä¸‹ä¸Šé¢ä»£ç ä¸­çš„æœ€åä¸€ä¸ªæ–¹æ³•ä¸­çš„æ ¡éªŒï¼šauthenticate æ ¡éªŒæ“ä½œé¦–å…ˆè¦è·å–åˆ°ä¸€ä¸ª AuthenticationManagerï¼š è¿™é‡Œæ‹¿åˆ°çš„æ˜¯ ProviderManager ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬å°±è¿›å…¥åˆ° ProviderManager çš„ authenticate æ–¹æ³•ä¸­ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162public Authentication authenticate(Authentication authentication) throws AuthenticationException &#123; Class&lt;? extends Authentication&gt; toTest = authentication.getClass(); AuthenticationException lastException = null; AuthenticationException parentException = null; Authentication result = null; Authentication parentResult = null; boolean debug = logger.isDebugEnabled(); for (AuthenticationProvider provider : getProviders()) &#123; if (!provider.supports(toTest)) &#123; continue; &#125; if (debug) &#123; logger.debug(&quot;Authentication attempt using &quot; + provider.getClass().getName()); &#125; try &#123; result = provider.authenticate(authentication); if (result != null) &#123; copyDetails(authentication, result); break; &#125; &#125; catch (AccountStatusException | InternalAuthenticationServiceException e) &#123; prepareException(e, authentication); throw e; &#125; catch (AuthenticationException e) &#123; lastException = e; &#125; &#125; if (result == null &amp;&amp; parent != null) &#123; try &#123; result = parentResult = parent.authenticate(authentication); &#125; catch (ProviderNotFoundException e) &#123; &#125; catch (AuthenticationException e) &#123; lastException = parentException = e; &#125; &#125; if (result != null) &#123; if (eraseCredentialsAfterAuthentication &amp;&amp; (result instanceof CredentialsContainer)) &#123; ((CredentialsContainer) result).eraseCredentials(); &#125; if (parentResult == null) &#123; eventPublisher.publishAuthenticationSuccess(result); &#125; return result; &#125; ...... throw lastException;&#125; é¦–å…ˆè·å– authentication çš„ Classï¼Œåˆ¤æ–­å½“å‰ provider æ˜¯å¦æ”¯æŒè¯¥ authentication å¦‚æœæ”¯æŒï¼Œåˆ™è°ƒç”¨ provider çš„ authenticate æ–¹æ³•å¼€å§‹åšæ ¡éªŒï¼Œæ ¡éªŒå®Œæˆåï¼Œä¼šè¿”å›ä¸€ä¸ªæ–°çš„ Authentication è¿™é‡Œçš„ provider å¯èƒ½æœ‰å¤šä¸ªï¼Œå¦‚æœ provider çš„ authenticate æ–¹æ³•æ²¡èƒ½æ­£å¸¸è¿”å›ä¸€ä¸ª Authenticationï¼Œåˆ™è°ƒç”¨ provider çš„ parent çš„ authenticate æ–¹æ³•ç»§ç»­æ ¡éªŒ copyDetails æ–¹æ³•åˆ™ç”¨æ¥æŠŠæ—§çš„ Token çš„ details å±æ€§æ‹·è´åˆ°æ–°çš„ Token ä¸­æ¥ æ¥ä¸‹æ¥ä¼šè°ƒç”¨ eraseCredentials æ–¹æ³•æ“¦é™¤å‡­è¯ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯ä½ çš„å¯†ç ï¼Œè¿™ä¸ªæ“¦é™¤æ–¹æ³•æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯å°† Token ä¸­çš„ credentials å±æ€§ç½®ç©º æœ€åé€šè¿‡ publishAuthenticationSuccess æ–¹æ³•å°†ç™»å½•æˆåŠŸçš„äº‹ä»¶å¹¿æ’­å‡ºå» åœ¨å…·ä½“è¯´ä¸€ä¸‹è°ƒç”¨ provider çš„ authenticate æ–¹æ³•çš„è¿‡ç¨‹ï¼š åœ¨ for å¾ªç¯ä¸­ï¼Œç¬¬ä¸€æ¬¡æ‹¿åˆ°çš„ provider æ˜¯ä¸€ä¸ª AnonymousAuthenticationProviderï¼Œè¿™ä¸ª provider å‹æ ¹å°±ä¸æ”¯æŒ UsernamePasswordAuthenticationTokenï¼Œä¹Ÿå°±æ˜¯ä¼šç›´æ¥åœ¨ provider.supports æ–¹æ³•ä¸­è¿”å› falseï¼Œç»“æŸ for å¾ªç¯ ç„¶åä¼šè¿›å…¥åˆ°ä¸‹ä¸€ä¸ª if ä¸­ï¼Œç›´æ¥è°ƒç”¨ parent çš„ authenticate æ–¹æ³•è¿›è¡Œæ ¡éªŒã€‚è€Œ parent å°±æ˜¯ ProviderManagerï¼Œæ‰€ä»¥ä¼šå†æ¬¡å›åˆ°è¿™ä¸ª authenticate æ–¹æ³•ä¸­ã€‚å†æ¬¡å›åˆ° authenticate æ–¹æ³•ä¸­ï¼Œprovider ä¹Ÿå˜æˆäº† DaoAuthenticationProviderï¼Œè¿™ä¸ª provider æ˜¯æ”¯æŒ UsernamePasswordAuthenticationToken çš„ æ‰€ä»¥ä¼šé¡ºåˆ©è¿›å…¥åˆ°è¯¥ç±»çš„ authenticate æ–¹æ³•å»æ‰§è¡Œï¼Œè€Œ DaoAuthenticationProvider ç»§æ‰¿è‡ª AbstractUserDetailsAuthenticationProvider å¹¶ä¸”æ²¡æœ‰é‡å†™ authenticate æ–¹æ³•ï¼Œæ‰€ä»¥ æˆ‘ä»¬æœ€ç»ˆæ¥åˆ° AbstractUserDetailsAuthenticationProvider#authenticate æ–¹æ³•ä¸­ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071public Authentication authenticate(Authentication authentication) throws AuthenticationException &#123; Assert.isInstanceOf(UsernamePasswordAuthenticationToken.class, authentication, () -&gt; messages.getMessage( &quot;AbstractUserDetailsAuthenticationProvider.onlySupports&quot;, &quot;Only UsernamePasswordAuthenticationToken is supported&quot;)); // Determine username String username = (authentication.getPrincipal() == null) ? &quot;NONE_PROVIDED&quot; : authentication.getName(); boolean cacheWasUsed = true; UserDetails user = this.userCache.getUserFromCache(username); if (user == null) &#123; cacheWasUsed = false; try &#123; user = retrieveUser(username, (UsernamePasswordAuthenticationToken) authentication); &#125; catch (UsernameNotFoundException notFound) &#123; logger.debug(&quot;User &#x27;&quot; + username + &quot;&#x27; not found&quot;); if (hideUserNotFoundExceptions) &#123; throw new BadCredentialsException(messages.getMessage( &quot;AbstractUserDetailsAuthenticationProvider.badCredentials&quot;, &quot;Bad credentials&quot;)); &#125; else &#123; throw notFound; &#125; &#125; Assert.notNull(user, &quot;retrieveUser returned null - a violation of the interface contract&quot;); &#125; try &#123; preAuthenticationChecks.check(user); additionalAuthenticationChecks(user, (UsernamePasswordAuthenticationToken) authentication); &#125; catch (AuthenticationException exception) &#123; if (cacheWasUsed) &#123; cacheWasUsed = false; user = retrieveUser(username, (UsernamePasswordAuthenticationToken) authentication); preAuthenticationChecks.check(user); additionalAuthenticationChecks(user, (UsernamePasswordAuthenticationToken) authentication); &#125; else &#123; throw exception; &#125; &#125; postAuthenticationChecks.check(user); if (!cacheWasUsed) &#123; this.userCache.putUserInCache(user); &#125; Object principalToReturn = user; if (forcePrincipalAsString) &#123; principalToReturn = user.getUsername(); &#125; return createSuccessAuthentication(principalToReturn, authentication, user);&#125; é¦–å…ˆä» Authentication æå–å‡ºç™»å½•ç”¨æˆ·å ç„¶åé€šè¿‡æ‹¿ç€ username å»è°ƒç”¨ retrieveUser æ–¹æ³•å»è·å–å½“å‰ç”¨æˆ·å¯¹è±¡ï¼Œè¿™ä¸€æ­¥ä¼šè°ƒç”¨æˆ‘ä»¬è‡ªå·±åœ¨ç™»å½•æ—¶å€™çš„å†™çš„ loadUserByUsername æ–¹æ³•ï¼Œæ‰€ä»¥è¿™é‡Œè¿”å›çš„ user å…¶å®å°±æ˜¯ä½ çš„ç™»å½•å¯¹è±¡ æ¥ä¸‹æ¥è°ƒç”¨ preAuthenticationChecks.check æ–¹æ³•å»æ£€éªŒ user ä¸­çš„å„ä¸ªè´¦æˆ·çŠ¶æ€å±æ€§æ˜¯å¦æ­£å¸¸ï¼Œä¾‹å¦‚è´¦æˆ·æ˜¯å¦è¢«ç¦ç”¨ã€è´¦æˆ·æ˜¯å¦è¢«é”å®šã€è´¦æˆ·æ˜¯å¦è¿‡æœŸç­‰ç­‰ additionalAuthenticationChecks æ–¹æ³•åˆ™æ˜¯åšå¯†ç æ¯”å¯¹çš„ æœ€ååœ¨ postAuthenticationChecks.check æ–¹æ³•ä¸­æ£€æŸ¥å¯†ç æ˜¯å¦è¿‡æœŸ æ¥ä¸‹æ¥æœ‰ä¸€ä¸ª forcePrincipalAsString å±æ€§ï¼Œè¿™ä¸ªæ˜¯æ˜¯å¦å¼ºåˆ¶å°† Authentication ä¸­çš„ principal å±æ€§è®¾ç½®ä¸ºå­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå±æ€§æˆ‘ä»¬ä¸€å¼€å§‹åœ¨ UsernamePasswordAuthenticationFilter ç±»ä¸­å…¶å®å°±æ˜¯è®¾ç½®ä¸ºå­—ç¬¦ä¸²çš„ï¼ˆå³ usernameï¼‰ï¼Œä½†æ˜¯é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ç”¨æˆ·ç™»å½•æˆåŠŸä¹‹åï¼Œ è¿™ä¸ªå±æ€§çš„å€¼å°±å˜æˆå½“å‰ç”¨æˆ·è¿™ä¸ªå¯¹è±¡äº†ã€‚ä¹‹æ‰€ä»¥ä¼šè¿™æ ·ï¼Œå°±æ˜¯å› ä¸º forcePrincipalAsString é»˜è®¤ä¸º falseï¼Œä¸è¿‡è¿™å—å…¶å®ä¸ç”¨æ”¹ï¼Œå°±ç”¨ falseï¼Œè¿™æ ·åœ¨åæœŸè·å–å½“å‰ç”¨æˆ·ä¿¡æ¯çš„æ—¶å€™åè€Œæ–¹ä¾¿å¾ˆå¤š æœ€åï¼Œé€šè¿‡ createSuccessAuthentication æ–¹æ³•æ„å»ºä¸€ä¸ªæ–°çš„ UsernamePasswordAuthenticationToken æ•´ä½“æµç¨‹å¤§æ¦‚å¦‚ä¸‹ï¼š å›¾æºï¼šSpring Securityè®¤è¯è¿‡ç¨‹","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Spring Security","slug":"Spring-Security","permalink":"http://wangba.me/tags/Spring-Security/"}]},{"title":"0019.Remove Nth Node From End of List","slug":"0019-Remove-Nth-Node-From-End-of-List","date":"2020-10-12T12:06:55.000Z","updated":"2020-10-12T12:10:23.037Z","comments":true,"path":"2020/10/12/0019-Remove-Nth-Node-From-End-of-List/","link":"","permalink":"http://wangba.me/2020/10/12/0019-Remove-Nth-Node-From-End-of-List/","excerpt":"","text":"19. åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬Nä¸ªèŠ‚ç‚¹ Mediumç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œåˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬ n ä¸ªèŠ‚ç‚¹ï¼Œå¹¶ä¸”è¿”å›é“¾è¡¨çš„å¤´ç»“ç‚¹ã€‚ ç¤ºä¾‹ï¼š 123ç»™å®šä¸€ä¸ªé“¾è¡¨: 1-&gt;2-&gt;3-&gt;4-&gt;5, å’Œ n &#x3D; 2.å½“åˆ é™¤äº†å€’æ•°ç¬¬äºŒä¸ªèŠ‚ç‚¹åï¼Œé“¾è¡¨å˜ä¸º 1-&gt;2-&gt;3-&gt;5. è¯´æ˜ï¼š ç»™å®šçš„ n ä¿è¯æ˜¯æœ‰æ•ˆçš„ã€‚ è¿›é˜¶ï¼š ä½ èƒ½å°è¯•ä½¿ç”¨ä¸€è¶Ÿæ‰«æå®ç°å—ï¼Ÿ æ€è·¯ï¼šé¦–å…ˆå›å¿†ä¸€ä¸‹å¦‚ä½•åˆ é™¤ä¸€ä¸ªç»“ç‚¹ï¼Œå¯ä»¥å‚è€ƒè¿™ä¸ªï¼Œä¸»è¦å°±æ˜¯æ‰¾åˆ°è¦åˆ é™¤å‰é¢çš„é‚£ä¸ªç»“ç‚¹ æ€è·¯ä¸€ï¼šæš´åŠ›æ³•ç›´æ¥ä¸¤æ¬¡éå†å³å¯ï¼Œç¬¬ä¸€éæ‰¾åˆ°è¿™ä¸ªé“¾è¡¨çš„é•¿åº¦ï¼Œç¬¬äºŒéåªéœ€è¦èµ°é“¾è¡¨é•¿åº¦å‡å»è¿™ä¸ª**n**å°±è¡Œäº† ä»£ç ï¼š123456789101112131415161718192021222324public ListNode removeNthFromEnd(ListNode head, int n) &#123; int length = 0; ListNode l = head; while (l != null) &#123; length++; l = l.next; &#125; if (length == 1) &#123; return null; &#125; l = head; int sub = length - n; if (sub == 0) &#123; return head.next; &#125; while (sub &gt; 1) &#123; l = l.next; sub--; &#125; l.next = l.next.next; return head;&#125; è™½ç„¶éå†äº†ä¸¤æ¬¡ï¼Œä½†æ˜¯æ—¶é—´å¤æ‚åº¦è¿˜æ˜¯ O(n)ï¼Œçº¿æ€§é•¿åº¦ ç©ºé—´å¤æ‚åº¦ä¸º O(1) æ€è·¯äºŒï¼šç›¸å¯¹ä½ç§»æ³•è¿™ä¸ªæ€è·¯ä¹Ÿå¾ˆç®€å•ï¼Œå¯¹æ¯”ä¸Šé¢çš„æ€è·¯å¥½å¤„æ˜¯ï¼šåªéœ€è¦éå†ä¸€éå°±è¡Œäº† åŒæŒ‡é’ˆï¼Œè®© A æŒ‡é’ˆå…ˆèµ° næ­¥ï¼Œéšåå†è®© B æŒ‡é’ˆå’Œ A æŒ‡é’ˆä¸€èµ·èµ°ï¼Œè¿™æ ·å°±ä¼šæœ‰é•¿åº¦ä¸º n çš„ç›¸å¯¹ä½ç§»ï¼Œç›´åˆ°è®© A æŒ‡é’ˆèµ°åˆ°ç»ˆç‚¹ï¼Œæ­¤æ—¶ B æŒ‡é’ˆä¹Ÿå°±è·ç»ˆç‚¹ n çš„é•¿åº¦äº† ä»£ç ï¼š12345678910111213public ListNode removeNthFromEnd(ListNode head, int n) &#123; ListNode fast = head, slow = head; for (int i=0; i&lt;n; i++)&#123; fast = fast.next; &#125; if (fast == null) return head.next; while (fast.next != null)&#123; fast = fast.next; slow = slow.next; &#125; slow.next = slow.next.next; return head;&#125;","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"Array","slug":"Array","permalink":"http://wangba.me/tags/Array/"},{"name":"LinkedList","slug":"LinkedList","permalink":"http://wangba.me/tags/LinkedList/"}]},{"title":"0160. Intersection of Two Linked Lists","slug":"0160-Intersection-of-Two-Linked-Lists","date":"2020-10-12T02:09:45.000Z","updated":"2020-10-12T02:32:26.613Z","comments":true,"path":"2020/10/12/0160-Intersection-of-Two-Linked-Lists/","link":"","permalink":"http://wangba.me/2020/10/12/0160-Intersection-of-Two-Linked-Lists/","excerpt":"","text":"160. ç›¸äº¤é“¾è¡¨ Easyç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œæ‰¾åˆ°ä¸¤ä¸ªå•é“¾è¡¨ç›¸äº¤çš„èµ·å§‹èŠ‚ç‚¹ã€‚ å¦‚ä¸‹é¢çš„ä¸¤ä¸ªé“¾è¡¨ï¼š åœ¨èŠ‚ç‚¹ c1 å¼€å§‹ç›¸äº¤ã€‚ ç¤ºä¾‹ 1ï¼š 123è¾“å…¥ï¼šintersectVal &#x3D; 8, listA &#x3D; [4,1,8,4,5], listB &#x3D; [5,0,1,8,4,5], skipA &#x3D; 2, skipB &#x3D; 3è¾“å‡ºï¼šReference of the node with value &#x3D; 8è¾“å…¥è§£é‡Šï¼šç›¸äº¤èŠ‚ç‚¹çš„å€¼ä¸º 8 ï¼ˆæ³¨æ„ï¼Œå¦‚æœä¸¤ä¸ªé“¾è¡¨ç›¸äº¤åˆ™ä¸èƒ½ä¸º 0ï¼‰ã€‚ä»å„è‡ªçš„è¡¨å¤´å¼€å§‹ç®—èµ·ï¼Œé“¾è¡¨ A ä¸º [4,1,8,4,5]ï¼Œé“¾è¡¨ B ä¸º [5,0,1,8,4,5]ã€‚åœ¨ A ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ 2 ä¸ªèŠ‚ç‚¹ï¼›åœ¨ B ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ 3 ä¸ªèŠ‚ç‚¹ã€‚ ç¤ºä¾‹ 2ï¼š 123è¾“å…¥ï¼šintersectVal &#x3D; 2, listA &#x3D; [0,9,1,2,4], listB &#x3D; [3,2,4], skipA &#x3D; 3, skipB &#x3D; 1è¾“å‡ºï¼šReference of the node with value &#x3D; 2è¾“å…¥è§£é‡Šï¼šç›¸äº¤èŠ‚ç‚¹çš„å€¼ä¸º 2 ï¼ˆæ³¨æ„ï¼Œå¦‚æœä¸¤ä¸ªé“¾è¡¨ç›¸äº¤åˆ™ä¸èƒ½ä¸º 0ï¼‰ã€‚ä»å„è‡ªçš„è¡¨å¤´å¼€å§‹ç®—èµ·ï¼Œé“¾è¡¨ A ä¸º [0,9,1,2,4]ï¼Œé“¾è¡¨ B ä¸º [3,2,4]ã€‚åœ¨ A ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ 3 ä¸ªèŠ‚ç‚¹ï¼›åœ¨ B ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ 1 ä¸ªèŠ‚ç‚¹ã€‚ ç¤ºä¾‹ 3ï¼š 1234è¾“å…¥ï¼šintersectVal &#x3D; 0, listA &#x3D; [2,6,4], listB &#x3D; [1,5], skipA &#x3D; 3, skipB &#x3D; 2è¾“å‡ºï¼šnullè¾“å…¥è§£é‡Šï¼šä»å„è‡ªçš„è¡¨å¤´å¼€å§‹ç®—èµ·ï¼Œé“¾è¡¨ A ä¸º [2,6,4]ï¼Œé“¾è¡¨ B ä¸º [1,5]ã€‚ç”±äºè¿™ä¸¤ä¸ªé“¾è¡¨ä¸ç›¸äº¤ï¼Œæ‰€ä»¥ intersectVal å¿…é¡»ä¸º 0ï¼Œè€Œ skipA å’Œ skipB å¯ä»¥æ˜¯ä»»æ„å€¼ã€‚è§£é‡Šï¼šè¿™ä¸¤ä¸ªé“¾è¡¨ä¸ç›¸äº¤ï¼Œå› æ­¤è¿”å› nullã€‚ æ³¨æ„ï¼š å¦‚æœä¸¤ä¸ªé“¾è¡¨æ²¡æœ‰äº¤ç‚¹ï¼Œè¿”å› null. åœ¨è¿”å›ç»“æœåï¼Œä¸¤ä¸ªé“¾è¡¨ä»é¡»ä¿æŒåŸæœ‰çš„ç»“æ„ã€‚ å¯å‡å®šæ•´ä¸ªé“¾è¡¨ç»“æ„ä¸­æ²¡æœ‰å¾ªç¯ã€‚ ç¨‹åºå°½é‡æ»¡è¶³ O(n) æ—¶é—´å¤æ‚åº¦ï¼Œä¸”ä»…ç”¨ O(1) å†…å­˜ã€‚ æ€è·¯åˆ†ææ€è·¯ä¸€ï¼šæš´åŠ›æ³•éå†é“¾è¡¨ A çš„æ—¶å€™ï¼Œæ¯éå†ä¸€ä¸ªç»“ç‚¹éƒ½å®Œæ•´éå†ä¸€ä¸‹é“¾è¡¨ Bï¼Œåˆ¤æ–­æŒ‡å‘çš„ç»“ç‚¹æ˜¯å¦ä¸ºåŒä¸€ä¸ªï¼Œè¿™æ ·æ—¶é—´å¤æ‚åº¦ä¸º O(mn) æ€è·¯äºŒï¼š+ HashMapåœ¨æ€è·¯ä¸€çš„åŸºç¡€ä¸Šï¼Œå…ˆå°†é“¾è¡¨ A çš„æ‰€æœ‰ç»“ç‚¹å…ˆæ”¾å…¥ HashMap ä¸­ï¼Œéå†é“¾è¡¨ B çš„æ—¶å€™æ¯”è¾ƒæ¯ä¸ªèŠ‚ç‚¹æ˜¯å¦å­˜åœ¨ HashMap ä¸­ï¼Œæ­¤æ—¶æ—¶é—´å¤æ‚åº¦ä¸º O(n)ï¼Œä½†æ˜¯ç©ºé—´å¤æ‚åº¦ä¸º O(n) æ€è·¯ä¸‰ï¼šåœ¨ä¸Šé¢çš„å›¾ä¸­å¯ä»¥çœ‹è§ï¼Œåœ¨æœ‰äº¤ç‚¹çš„æƒ…å†µä¸‹ï¼Œæ— éå°±ä¸‰ç§æƒ…å†µï¼šç”±äºåœ¨äº¤ç‚¹å(åŒ…æ‹¬äº¤ç‚¹)çš„æ‰€æœ‰ç»“ç‚¹éƒ½ç›¸åŒ é“¾è¡¨ A çš„é•¿åº¦ &gt; é“¾è¡¨ B çš„é•¿åº¦ é“¾è¡¨ A çš„é•¿åº¦ = é“¾è¡¨ B çš„é•¿åº¦ é“¾è¡¨ A çš„é•¿åº¦ &lt; é“¾è¡¨ B çš„é•¿åº¦ å¦‚æœæˆ‘ä»¬èƒ½ç®—å‡ºè¿™ä¸ªé•¿åº¦å·®ï¼Œç„¶åè®©é•¿çš„é‚£ä¸ªé“¾è¡¨å…ˆèµ°è¿™ä¸ªé•¿åº¦å·®ï¼Œå†è®©ä¸¤ä¸ªé“¾è¡¨ä¸€èµ·èµ°ï¼Œç›´åˆ°èµ°åˆ°ç›¸äº¤ç‚¹ ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚ä¸‹ï¼š é“¾è¡¨ A é•¿åº¦ = 6ï¼›é“¾è¡¨ B é•¿åº¦ = 4ï¼›é“¾è¡¨å·® = 2 è®©é•¿åº¦é•¿çš„é“¾è¡¨(A)å…ˆèµ°é“¾è¡¨å·®ï¼Œå³ pointerA å…ˆèµ° 2 ä¸ªç»“ç‚¹ pointerA ä¸ pointerB ä¸€èµ·éå†ï¼Œç›´åˆ°éå†åˆ°ç›¸åŒç»“ç‚¹ ä»£ç 12345678910111213141516171819202122232425262728293031323334353637383940414243444546public ListNode getIntersectionNode(ListNode headA, ListNode headB) &#123; if (headA == null || headB == null) &#123; return null; &#125; ListNode a = headA; ListNode b = headB; // é“¾è¡¨A å’Œ é“¾è¡¨B çš„é•¿åº¦ int la = 0, lb = 0; while (a.next != null) &#123; la++; a = a.next; &#125; while (b.next != null) &#123; lb++; b = b.next; &#125; // æ­¤æ—¶è¯´æ˜ç›´åˆ° é“¾è¡¨A å’Œ é“¾è¡¨B çš„æœ€åä¸€ä¸ªç»“ç‚¹éƒ½è¿˜æ²¡ç›¸äº¤ if (a != b) &#123; return null; &#125; // é“¾è¡¨A çš„é•¿åº¦å¤§äº é“¾è¡¨B if (la &gt; lb) &#123; int sub = la - lb; while (sub &gt; 0)&#123; headA = headA.next; sub--; &#125; &#125; // é“¾è¡¨A çš„é•¿åº¦å°äº é“¾è¡¨B else &#123; int sub = lb - la; while (sub &gt; 0)&#123; headB = headB.next; sub--; &#125; &#125; while (headA != headB) &#123; headA = headA.next; headB = headB.next; &#125; return headA;&#125; å¦å¤–ä¸€ç§ç®€æ´çš„å†™æ³•ï¼Œæ€è·¯ä¸€æ · 12345678910111213public ListNode getIntersectionNode(ListNode headA, ListNode headB) &#123; if(headA == null || headB == null) return null; ListNode a = headA; ListNode b = headB; while( a != b)&#123; a = a == null? headB : a.next; b = b == null? headA : b.next; &#125; return a;&#125; å¦‚æœæ²¡æœ‰é‡åˆéƒ¨åˆ†ï¼Œé‚£ä¹ˆ a å’Œ b åœ¨æŸä¸€æ—¶é—´ç‚¹ ä¸€å®šä¼šåŒæ—¶èµ°åˆ° nullï¼Œä»è€Œç»“æŸå¾ªç¯ï¼› å¦‚æœæœ‰é‡åˆéƒ¨åˆ†ï¼Œåˆ†ä¸¤ç§æƒ…å†µï¼š é•¿åº¦ç›¸åŒçš„è¯ï¼Œ a å’Œ b ä¸€å®šæ˜¯åŒæ—¶åˆ°è¾¾ç›¸é‡ç‚¹ï¼Œç„¶åè¿”å›ï¼› é•¿åº¦ä¸åŒçš„è¯ï¼Œè¾ƒçŸ­çš„é“¾è¡¨å…ˆåˆ°è¾¾ç»“å°¾ï¼Œç„¶åæŒ‡é’ˆè½¬å‘è¾ƒé•¿çš„é“¾è¡¨ã€‚æ­¤åˆ»ï¼Œè¾ƒé•¿çš„é“¾è¡¨ç»§ç»­å‘æœ«å°¾èµ°ï¼Œå¤šèµ°çš„è·ç¦»åˆšå¥½å°±æ˜¯æœ€å¼€å§‹ä»‹ç»çš„è§£æ³•ï¼Œé“¾è¡¨çš„é•¿åº¦å·®ï¼Œèµ°å®Œä¹‹åæŒ‡é’ˆè½¬å‘è¾ƒçŸ­çš„é“¾è¡¨ã€‚ç„¶åç»§ç»­èµ°çš„è¯ï¼Œç›¸é‡çš„ä½ç½®å°±åˆšå¥½æ˜¯ç›¸é‡ç‚¹äº†ã€‚","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"Array","slug":"Array","permalink":"http://wangba.me/tags/Array/"},{"name":"LinkedList","slug":"LinkedList","permalink":"http://wangba.me/tags/LinkedList/"}]},{"title":"SpringBootæ•´åˆSpring Security(å…­)","slug":"SpringBootæ•´åˆSpring-Security-å…­","date":"2020-10-10T09:32:56.000Z","updated":"2020-10-10T09:34:50.900Z","comments":true,"path":"2020/10/10/SpringBootæ•´åˆSpring-Security-å…­/","link":"","permalink":"http://wangba.me/2020/10/10/SpringBoot%E6%95%B4%E5%90%88Spring-Security-%E5%85%AD/","excerpt":"","text":"ä¸€ã€OverViewâ€‹ åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œä½¿ç”¨äº†ç¬¬ä¸€ç§æ–¹å¼ï¼šJDBC è¿æ¥æ•°æ®åº“ã€‚è¿™ä¸€èŠ‚ä¸­å°†ä½¿ç”¨ Spring Data JPA è¿›è¡Œæ•°æ®åº“æ“ä½œã€‚å¦‚æœå¯¹ JPA çš„ç¯å¢ƒå’Œæ“ä½œæ²¡äº†è§£è¿‡çš„ï¼Œå¯ä»¥é€‚å½“å‚è€ƒè¿™ä¸ªã€‚ åœ¨ä¸Šä¸€èŠ‚ä¹Ÿæåˆ° Spring Security æ”¯æŒå¤šç§æ•°æ®æºï¼Œè¿™äº›ä¸åŒæ¥æºçš„æ•°æ®è¢«å…±åŒå°è£…æˆäº†ä¸€ä¸ª UserDetailService æ¥å£ â€‹ åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œè¿˜æ˜¯è¿™ä¸ªæ€è·¯ï¼Œè¿™ä¸€æ¬¡ä¸ç”¨ Spring Security æä¾›çš„ç±», å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªç±»å»å®ç° UserDetailService äºŒã€ç¯å¢ƒæ­å»ºæ€è·¯æ¸…æ™°ï¼Œå…ˆçœ‹ä¾èµ– application.properties 123456789spring.datasource.username=rootspring.datasource.password=spring.datasource.url=jdbc:mysql://127.0.0.1:3306/security?useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=Asia/Shanghaispring.jpa.database=mysqlspring.jpa.database-platform=mysqlspring.jpa.hibernate.ddl-auto=updatespring.jpa.show-sql=truespring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect å®ä½“ç±» User 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162@Entity(name = &quot;t_user&quot;)public class User implements UserDetails &#123; @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private Long id; private String username; private String password; private boolean accountNonExpired; private boolean accountNonLocked; private boolean credentialsNonExpired; private boolean enabled; // User å’Œ Role æ˜¯å¤šå¯¹å¤šå…³ç³» @ManyToMany(fetch = FetchType.EAGER,cascade = CascadeType.PERSIST) private List&lt;Role&gt; roles; // è¿”å›ç”¨æˆ·æƒé™ @Override public Collection&lt;? extends GrantedAuthority&gt; getAuthorities() &#123; List&lt;SimpleGrantedAuthority&gt; authorities = new ArrayList&lt;&gt;(); for (Role role : getRoles()) &#123; authorities.add(new SimpleGrantedAuthority(role.getName())); &#125; return authorities; &#125; @Override public String getPassword() &#123; return password; &#125; @Override public String getUsername() &#123; return username; &#125; // ç”¨æˆ·æ˜¯å¦è¿‡æœŸ @Override public boolean isAccountNonExpired() &#123; return accountNonExpired; &#125; // ç”¨æˆ·æ˜¯å¦è¢«é” @Override public boolean isAccountNonLocked() &#123; return accountNonLocked; &#125; // å¯†ç æ˜¯å¦è¿‡æœŸ @Override public boolean isCredentialsNonExpired() &#123; return credentialsNonExpired; &#125; // è´¦æˆ·æ˜¯å¦å¯ç”¨ @Override public boolean isEnabled() &#123; return enabled; &#125; // set get çœç•¥&#125; æ³¨ï¼šè¿™é‡Œä¸ºä»€ä¹ˆ User è¦å®ç° UserDetails ? ä¸»è¦æ˜¯ç”±äºåœ¨è‡ªå®šä¹‰ç±»å®ç° UserDetailServiceï¼Œå…¶ä¸­åªæœ‰å”¯ä¸€çš„æŠ½è±¡æ–¹æ³•loadUserByUsernameï¼Œè€Œè¯¥æ–¹æ³•å°±æ˜¯è¿”å›çš„ UserDetails Role 12345678@Entity(name = &quot;t_role&quot;)public class Role &#123; @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private Long id; private String name; private String nameZh;&#125; UserDao 12345678910public interface UserDao extends JpaRepository&lt;User, Long&gt; &#123; /** * é€šè¿‡ç”¨æˆ·åæ‰¾åˆ°ç”¨æˆ· * * @param username ç”¨æˆ·å * @return &#123;@link User&#125; */ User findAllByUsername(String username);&#125; ä¸æ‡‚ä¸ºå•¥è¿™ä¹ˆå†™çš„å¯ä»¥å‚è€ƒä¸€ä¸‹ JPA çš„ CRUD æ“ä½œ UserService 1234567891011121314151617181920212223242526272829@Servicepublic class UserService implements UserDetailsService&#123; private UserDao userDao; @Autowired public void setUserDao(UserDao userDao) &#123; this.userDao = userDao; &#125; @Override public UserDetails loadUserByUsername(String s) throws UsernameNotFoundException &#123; User user = userDao.findAllByUsername(s); if (StringUtils.isEmpty(user)) &#123; throw new UsernameNotFoundException(&quot;ç”¨æˆ·ä¸å­˜åœ¨&quot;); &#125; return user; &#125; /** * ä¿å­˜ç”¨æˆ· * * @param user ç”¨æˆ· * @return &#123;@link User&#125; */ User save(User user) &#123; return userDao.save(user); &#125;&#125; æ³¨ï¼š å®ç°äº† UserDetailsServiceï¼Œé‡å†™å…¶ä¸­çš„ loadUserByUsername æ–¹æ³•ï¼šé€šè¿‡ä¼ å…¥çš„ç”¨æˆ·åæŸ¥æ‰¾ç”¨æˆ·ä¿¡æ¯ save æ–¹æ³•æ˜¯ä¸ºäº†åé¢å†™å…¥ä¸åŒè§’è‰²ç”¨æˆ· UserController 123456789101112131415@RestControllerpublic class UserController &#123; private UserService userService; @Autowired public void setUserService(UserService userService) &#123; this.userService = userService; &#125; @PutMapping(&quot;/save&quot;) public User save(@RequestBody User user) &#123; return userService.save(user); &#125;&#125; å°† SecurityConfig ä¸­ configure æ–¹æ³•æ”¹ä¸ºï¼š 1234567891011private UserService userService;@Autowiredpublic void setUserService(UserService userService) &#123; this.userService = userService;&#125;@Overrideprotected void configure(AuthenticationManagerBuilder auth) throws Exception &#123; auth.userDetailsService(userService);&#125; ä¸‰ã€TestPostman ç”±äºåœ¨æœªç™»å½•çš„æƒ…å†µä¸‹ï¼Œç›´æ¥è°ƒç”¨ localhost:8080/save æ¥å£ä¼šå¤±è´¥ï¼Œæ‰€ä»¥å…ˆåœ¨æ•°æ®åº“ä¸­æ‰‹åŠ¨æ·»åŠ ä¸€ä¸ªæ•°æ®ï¼š user è¡¨ï¼š role è¡¨ï¼š user_role å…³ç³»è¡¨ï¼š ä½¿ç”¨ä¸Šè¿°å¢åŠ çš„ç”¨æˆ·ç™»å½•ï¼š å¢åŠ ä¸åŒè§’è‰²ç”¨æˆ·ï¼š user ç”¨æˆ· adminç”¨æˆ· çœ‹ä¸‹æ•°æ®åº“ï¼š userè¡¨ roleè¡¨ ![image-20201010160613255](/Users/wangdechao/Library/Application Support/typora-user-images/image-20201010160613255.png) user_role å…³ç³»è¡¨ æ­¤æ—¶åœ¨åˆ†åˆ«ä½¿ç”¨ user ç”¨æˆ·å’Œ admin ç”¨æˆ·ç™»å½•ï¼Œçœ‹ä¸€ä¸‹ä¸åŒç”¨æˆ·çš„æƒé™ï¼š userç”¨æˆ· useræƒé™æ¥å£ adminæƒé™æ¥å£","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Spring Security","slug":"Spring-Security","permalink":"http://wangba.me/tags/Spring-Security/"}]},{"title":"SpringBootæ•´åˆSpring Security(äº”)","slug":"SpringBootæ•´åˆSpring-Security-äº”","date":"2020-10-10T08:35:48.000Z","updated":"2020-10-10T09:37:21.525Z","comments":true,"path":"2020/10/10/SpringBootæ•´åˆSpring-Security-äº”/","link":"","permalink":"http://wangba.me/2020/10/10/SpringBoot%E6%95%B4%E5%90%88Spring-Security-%E4%BA%94/","excerpt":"","text":"ä¸€ã€OverViewâ€‹ åœ¨å‰é¢å‡ èŠ‚ä¸­éƒ½ä½¿ç”¨çš„æ˜¯å†…å­˜æ•°æ®ï¼Œå¹¶æ²¡æœ‰è¿æ¥æ•°æ®åº“ï¼Œè¿™ä¸€ç« å°†ä»‹ç» Spring Security æ•´åˆ JDBC â€‹ åœ¨ä¸Šä¸€èŠ‚ä¸­å…ˆæ˜¯ä½¿ç”¨ä¸‹é¢è¿™ç§æ–¹å¼å°†ä¿¡æ¯æ”¾åœ¨å†…å­˜ä¸­ï¼š 1234567891011@Overrideprotected void configure(AuthenticationManagerBuilder auth) throws Exception &#123; auth.inMemoryAuthentication() .withUser(&quot;wangba&quot;) .password(&quot;guigui&quot;) .roles(&quot;admin&quot;) .and() .withUser(&quot;wangyi&quot;) .password(&quot;1111&quot;) .roles(&quot;user&quot;);&#125; å¦å¤–æ–¹å¼ï¼š 12345678@Override@Beanprotected UserDetailsService userDetailsService() &#123; InMemoryUserDetailsManager manager = new InMemoryUserDetailsManager(); manager.createUser(User.withUsername(&quot;wangba&quot;).password(&quot;guigui&quot;).roles(&quot;admin&quot;).build()); manager.createUser(User.withUsername(&quot;wangyi&quot;).password(&quot;1111&quot;).roles(&quot;user&quot;).build()); return manager;&#125; ç”±äº Spring Security æ”¯æŒå¤šç§æ•°æ®æºï¼Œä¾‹å¦‚å†…å­˜ã€æ•°æ®åº“ã€LDAP ç­‰ï¼Œè¿™äº›ä¸åŒæ¥æºçš„æ•°æ®è¢«å…±åŒå°è£…æˆäº†ä¸€ä¸ª UserDetailService æ¥å£ï¼Œä»»ä½•å®ç°äº†è¯¥æ¥å£çš„å¯¹è±¡éƒ½å¯ä»¥ä½œä¸ºè®¤è¯æ•°æ®æºã€‚ é¦–å…ˆçœ‹ä¸€ä¸‹ç±»ç»§æ‰¿å’Œå®ç°æƒ…å†µï¼š è¿™æ—¶å€™å°±èƒ½çœ‹å‡ºæ¥ä¸ºä»€ä¹ˆä¸Šé¢ç¬¬äºŒç§æ–¹å¼ä¸­ï¼Œä½¿ç”¨çš„æ˜¯ InMemoryUserDetailsManager å®ä¾‹äº†ï¼Œè¿™ä¸ªå°±æ˜¯åŸºäºå†…å­˜çš„ã€‚è¿˜å¯ä»¥å‘ç° JdbcUserDetailsManager åº”è¯¥å°±æ˜¯åŸºäºæ•°æ®åº“çš„å®ä¾‹äº†ã€‚ äºŒã€ç¯å¢ƒæ­å»º2.1 å‡†å¤‡æ•°æ®åº“åœ¨ org/springframework/security/core/userdetails/jdbc ä¸­åº”è¯¥å­˜å‚¨ç€ JdbcUserDetailsManager è‡ªå·±æä¾›çš„æ•°æ®åº“è„šæœ¬ï¼Œå†…å®¹å¦‚ä¸‹ï¼š users.ddl 123create table users(username varchar_ignorecase(50) not null primary key,password varchar_ignorecase(500) not null,enabled boolean not null);create table authorities (username varchar_ignorecase(50) not null,authority varchar_ignorecase(50) not null,constraint fk_authorities_users foreign key(username) references users(username));create unique index ix_auth_username on authorities (username,authority); è¿™ä¸ªæ•°æ®åº“è„šæœ¬é€‚ç”¨äº HSQLDB ä¸ºäº†è®©ä»–é€‚ç”¨äº Mysql ï¼Œå°†å…¶æ”¹ä¸ºï¼š 123create table users(username varchar(50) not null primary key,password varchar(500) not null,enabled boolean not null);create table authorities (username varchar(50) not null,authority varchar(50) not null,constraint fk_authorities_users foreign key(username) references users(username));create unique index ix_auth_username on authorities (username,authority); æ‰§è¡Œå®Œè„šæœ¬å¯ä»¥çœ‹è§ï¼šusers è¡¨å’Œ authorities è¡¨ userè¡¨ authoritiesè¡¨ ä¸¤å¼ è¡¨æ˜¯é€šè¿‡ username å…³è”èµ·æ¥ 2.2 å¢åŠ ä¸åŒè§’è‰²ç”¨æˆ·å°†ä¸Šè¿°çš„ç¬¬äºŒç§åŸºäºå†…å­˜çš„æ–¹å¼ä¿®æ”¹ä¸ºåŸºäºæ•°æ®åº“æ–¹å¼ 1234567891011121314151617181920private DataSource dataSource;@Autowiredpublic void setDataSource(DataSource dataSource) &#123; this.dataSource = dataSource;&#125;@Override@Beanprotected UserDetailsService userDetailsService() &#123; JdbcUserDetailsManager manager = new JdbcUserDetailsManager(); manager.setDataSource(dataSource); if (!manager.userExists(&quot;wangba&quot;)) &#123; manager.createUser(User.withUsername(&quot;wangba&quot;).password(&quot;guigui&quot;).roles(&quot;admin&quot;).build()); &#125; if (!manager.userExists(&quot;wangyi&quot;)) &#123; manager.createUser(User.withUsername(&quot;wangyi&quot;).password(&quot;1111&quot;).roles(&quot;user&quot;).build()); &#125; return manager;&#125; è¿è¡Œé¡¹ç›®å¯ä»¥çœ‹è§å·²ç»å°†ç”¨æˆ·å†™å…¥æ•°æ®åº“äº† è¿›å…¥ JdbcUserDetailsManager çš„ createUser æ–¹æ³•ä¸­çœ‹çœ‹ å¯ä»¥çœ‹åˆ° createUserSql å±æ€§ï¼Œå…·ä½“çœ‹ä¸€ä¸‹ï¼š å¯ä»¥çœ‹åˆ°å®é™…ä¸Šå°±æ˜¯ä¸€æ¡ Sql è¯­å¥ï¼Œç„¶åæŠŠæˆ‘ä»¬çš„ç”¨æˆ·æ•°æ®å†™åˆ°æ•°æ®åº“ä¸­ ä¸‰ã€Testç™»å½• user è®¿é—® user è®¿é—® admin","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Spring Security","slug":"Spring-Security","permalink":"http://wangba.me/tags/Spring-Security/"}]},{"title":"SpringBootæ•´åˆSpring Security (å››)","slug":"SpringBootæ•´åˆSpring-Security-å››","date":"2020-10-09T10:33:41.000Z","updated":"2020-10-09T10:36:07.175Z","comments":true,"path":"2020/10/09/SpringBootæ•´åˆSpring-Security-å››/","link":"","permalink":"http://wangba.me/2020/10/09/SpringBoot%E6%95%B4%E5%90%88Spring-Security-%E5%9B%9B/","excerpt":"","text":"ä¸€ã€OverViewåœ¨æœ¬èŠ‚ä¸­ä¸»è¦å®ç°ä¸€ä¸‹æˆæƒåŠŸèƒ½ï¼Œå³éœ€æ±‚æ—¶ï¼š admin: èƒ½è®¿é—®æ‰€æœ‰çš„é¡µé¢ï¼Œä¸ä»…ä»…æ˜¯ /admin/ ä¸‹çš„é¡µé¢ï¼Œä¹Ÿå¯ä»¥è®¿é—® /user/ ä¸‹çš„é¡µé¢ user: åªèƒ½è®¿é—® /user/ ä¸‹æ‰€æœ‰é¡µé¢ hello: /hello æ‰€æœ‰ç”¨æˆ·éƒ½å¯ä»¥è®¿é—® å¯ä»¥ç†è§£ä¸ºï¼šadmin æƒé™æ¯” user é«˜ äºŒã€ç¯å¢ƒæ­å»ºç¯å¢ƒå‚è€ƒå‰é¢å‡ èŠ‚ï¼Œç”±äºç›®å‰å¹¶æ²¡æœ‰è¿æ¥æ•°æ®åº“ï¼Œæ‰€ä»¥å°±åŸºäºå†…å­˜è¿›è¡Œæµ‹è¯• SecurityConfig åœ¨é‡å†™çš„ configure æ–¹æ³•ä¸­å¢åŠ ä¸€ä¸ª user ç”¨æˆ·ï¼š 1234567891011@Overrideprotected void configure(AuthenticationManagerBuilder auth) throws Exception &#123; auth.inMemoryAuthentication() .withUser(&quot;wangba&quot;) .password(&quot;guigui&quot;) .roles(&quot;admin&quot;) .and() .withUser(&quot;wangyi&quot;) .password(&quot;1111&quot;) .roles(&quot;user&quot;);&#125; åœ¨é‡å†™çš„ configure æ–¹æ³•ä¸­å¢åŠ æ‹¦æˆªè§„åˆ™ï¼š 123456789protected void configure(HttpSecurity http) throws Exception &#123; http.authorizeRequests() .antMatchers(&quot;/admin/**&quot;).hasRole(&quot;admin&quot;) .antMatchers(&quot;/user/**&quot;).hasRole(&quot;user&quot;) .anyRequest().authenticated() .and() // çœç•¥ ;&#125; æ³¨ï¼šè§„åˆ™æ˜¯æœ‰é¡ºåºçš„ï¼Œå³é“¾å¼æ“ä½œ å¦‚æœæŠŠ anyRequest() æ”¾åœ¨å‰é¢ï¼Œé¦–å…ˆå°±ä¼šè®©æ‰€æœ‰è¯·æ±‚é€šè¿‡ï¼Œç„¶åå†è¿›è¡Œæ‹¦æˆªï¼Œè¿™æ ·æ‹¦æˆªè§„åˆ™å°±æ²¡æœ‰ä»€ä¹ˆç”¨äº† SecurityController åœ¨è§†å›¾å±‚å¢åŠ ä¸€äº›è¯·æ±‚æ–¹æ³• 1234567891011121314@GetMapping(&quot;/hello&quot;)public String hello0() &#123; return &quot;hello&quot;;&#125;@GetMapping(&quot;/user/hello&quot;)public String hello1() &#123; return &quot;user&quot;;&#125;@GetMapping(&quot;/admin/hello&quot;)public String hello2() &#123; return &quot;admin&quot;;&#125; å…¶ä¸­ï¼š /hello è¯·æ±‚ï¼šå…è®¸ç™»å½•åçš„ä»»ä½•äººè®¿é—® /user/hello è¯·æ±‚ï¼šå…è®¸æ‹¥æœ‰ user è§’è‰²çš„ç”¨æˆ·ç™»å½•ï¼›å…è®¸æ‹¥æœ‰ admin è§’è‰²çš„ç”¨æˆ·ç™»å½• /admin/hello è¯·æ±‚ï¼šåªå…è®¸æ‹¥æœ‰ admin è§’è‰²çš„ç”¨æˆ·ç™»å½• 123456789protected void configure(HttpSecurity http) throws Exception &#123; http.authorizeRequests() .antMatchers(&quot;/admin/**&quot;).hasRole(&quot;admin&quot;) .antMatchers(&quot;/user/**&quot;).hasRole(&quot;user&quot;) .anyRequest().authenticated() .and() // çœç•¥ ;&#125; ä¸‰ã€æµ‹è¯•Postman é¦–å…ˆç™»å½• user ç”¨æˆ·ï¼šwangyi æŒ‰ç…§ä¸Šé¢çš„ç†è®ºæ¥è¯´ï¼šuser å¯ä»¥è®¿é—® /hello å’Œ /user/hello ï¼Œä¸èƒ½è®¿é—® /admin/hello /hello /user/hello /admin/hello å¯ä»¥çœ‹è§ï¼Œè®¿é—®è¯¥æ¥å£è¢«é™æ­¢äº† åŒæ ·ï¼Œç™»å½• admin ç”¨æˆ·ï¼šwangba /hello /admin/hello /user/hello ä½†æ˜¯ï¼Œæˆ‘ä»¬å‰é¢è¦æ±‚å®ç°çš„æ˜¯ admin å¯ä»¥è®¿é—®æ‰€æœ‰é¡µé¢ï¼Œæ‰€ä»¥è¿›è¡Œæ”¹è¿›ï¼Œå³è¿›è¡Œè§’è‰²ç»§æ‰¿ SecurityConfig 123456@BeanRoleHierarchy roleHierarchy() &#123; RoleHierarchyImpl roleHierarchy = new RoleHierarchyImpl(); roleHierarchy.setHierarchy(&quot;ROLE_admin &gt; ROLE_user&quot;); return roleHierarchy;&#125; æ³¨ï¼šä¸Šè¿°é…ç½®è¡¨è¾¾ROLE_admin è‡ªåŠ¨å…·å¤‡ ROLE_user çš„æƒé™ã€‚ æ­¤æ—¶é‡å¯é¡¹ç›®ï¼Œå†æ¬¡ç™»å½• wangbaï¼Œå¹¶è®¿é—® /user/hello å¯ä»¥çœ‹è§æ­¤æ—¶ admin è§’è‰²å¯ä»¥è®¿é—®ä»»ä½•é¡µé¢äº†","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Spring Security","slug":"Spring-Security","permalink":"http://wangba.me/tags/Spring-Security/"}]},{"title":"0206. Reverse Linked List","slug":"0206-Reverse-Linked-List","date":"2020-10-09T01:58:41.000Z","updated":"2020-10-09T02:00:28.470Z","comments":true,"path":"2020/10/09/0206-Reverse-Linked-List/","link":"","permalink":"http://wangba.me/2020/10/09/0206-Reverse-Linked-List/","excerpt":"","text":"206. åè½¬é“¾è¡¨ Easyåè½¬ä¸€ä¸ªå•é“¾è¡¨ã€‚ ç¤ºä¾‹: 12è¾“å…¥: 1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;NULLè¾“å‡º: 5-&gt;4-&gt;3-&gt;2-&gt;1-&gt;NULL è¿›é˜¶:ä½ å¯ä»¥è¿­ä»£æˆ–é€’å½’åœ°åè½¬é“¾è¡¨ã€‚ä½ èƒ½å¦ç”¨ä¸¤ç§æ–¹æ³•è§£å†³è¿™é“é¢˜ï¼Ÿ è§£æå†™é“¾è¡¨çš„ä»£ç é¢˜ï¼Œä¸€å®šè¦è€ƒè™‘å‘¨å…¨ï¼Œå¯ä»¥ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢è€ƒè™‘ï¼š æ˜¯å¦ä¸ºç©ºé“¾è¡¨ æ˜¯å¦åªå‰©ä¸€ä¸ªç»“ç‚¹ å‰©ä½™ä¸¤ä¸ªç»“ç‚¹æ€ä¹ˆæ · åœ¨å¤„ç†å¤´ç»“ç‚¹å’Œå°¾ç»“ç‚¹æ—¶ï¼Œé€»è¾‘ä¸Šæ˜¯å¦å¯ä»¥é€šè¿‡ è¿­ä»£è§£æ³•ï¼š1234567891011public ListNode reverseList(ListNode head) &#123; // è¿­ä»£æ³• ListNode pre = null; while (head != null) &#123; ListNode next = head.next; head.next = pre; pre = head; head = next; &#125; return pre;&#125; è¿™å°±æ˜¯åœ¨é“¾è¡¨ä¸­è¯´åˆ°çš„å“¨å…µï¼Œè¿™æ ·æœ€å¤§çš„ç›®çš„å°±æ˜¯ä¸ºäº†è®©å¯¹æ•´ä¸ªé“¾è¡¨çš„æ“ä½œè¿›è¡Œç»Ÿä¸€åŒ– é€’å½’è§£æ³•ï¼š12345678910public ListNode reverseList(ListNode head) &#123; // é€’å½’æ³• if (head == null || head.next == null) &#123; return head; &#125; ListNode listNode = reverseList(head.next); head.next.next = head; head.next = null; return listNode;&#125; åœ¨è¿›è¡Œé€’å½’æ“ä½œä¸­ï¼Œä¸€å®šè¦æ³¨æ„çš„ç‚¹ï¼šå‡ºå£ ä¹Ÿå°±æ˜¯è¯´ä¸€å®šè¦æœ‰æœ€å°æ¡ä»¶ï¼Œè€Œè¿™ä¸ªæ¡ä»¶æ˜¯å¯ä»¥è·³å‡ºæœ€åä¸€ä¸ªé€’å½’è°ƒç”¨çš„ï¼Œç„¶åå°†ç»“æœæ”¾åˆ°å€’æ•°ç¬¬äºŒä¸ªé€’å½’è°ƒç”¨ä¸­ åœ¨è¿™é‡Œé¢å‡ºå£å°±æ˜¯ï¼š 123if (head == null || head.next == null) &#123; return head;&#125; ä¸€æ—¦æ»¡è¶³è¿™ä¸ªæ¡ä»¶ï¼Œå°±å¯ä»¥è§¦å‘æ‰€æœ‰é€’å½’è°ƒç”¨çš„ç»“æŸ","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"Array","slug":"Array","permalink":"http://wangba.me/tags/Array/"},{"name":"LinkedList","slug":"LinkedList","permalink":"http://wangba.me/tags/LinkedList/"}]},{"title":"LinkedList","slug":"LinkedList","date":"2020-10-03T14:04:52.000Z","updated":"2020-10-12T02:10:28.109Z","comments":true,"path":"2020/10/03/LinkedList/","link":"","permalink":"http://wangba.me/2020/10/03/LinkedList/","excerpt":"","text":"ä¸€ã€OverView å¿«é€Ÿé¢„è§ˆï¼š é¦–å…ˆè¦å’Œä¸Šä¸€èŠ‚çš„æ•°ç»„è¿›è¡Œæ¨ªå‘å¯¹æ¯”ï¼Œæ¥çœ‹ä¸€ä¸‹é“¾è¡¨ç‹¬æœ‰çš„ç‰¹æ€§ ç¬¬äºŒå°èŠ‚ä¼šä»‹ç»ä¸€ä¸‹å¸¸è§çš„å‡ ç§é“¾è¡¨ï¼Œä»¥åŠä¸ºä»€ä¹ˆè¦è¡ç”Ÿå‡ºè¿™äº›é“¾è¡¨ ç¬¬ä¸‰å°èŠ‚ä¸»è¦å…³æ³¨äºé“¾è¡¨çš„åŸºæ“ï¼Œ(å‹¿6) ä»¥åŠåœ¨é“¾è¡¨ä¸­çš„ä¸€äº›æ³¨æ„äº‹é¡¹ï¼Œå¦‚ä½•ä¿æŒé“¾è¡¨ä¸æ–­é“¾ï¼Œä¸ºä»€ä¹ˆè¦å¼•å…¥å“¨å…µ æœ€åä¸€ä¸ªå°èŠ‚ä¸»è¦ç»“åˆ Java ä¸­çš„é“¾è¡¨ LinkedList æ¥åŠ æ·±å¯¹é“¾è¡¨çš„ç†è§£ äºŒã€ç‰¹æ€§åœ¨ä¸Šä¸€èŠ‚ä¸­å·²ç»ä»‹ç»è¿‡æ•°ç»„äº†ï¼Œå¯ä»¥å°†æ•°ç»„å’Œé“¾è¡¨åœ¨ç»“æ„ä¸Šè¿›è¡Œå¯¹æ¯”ï¼š åœ¨æ•°ç»„ä¸­ï¼Œæ˜¯éœ€è¦ä¸€å—è¿ç»­ä¸”è¶³å¤Ÿå­˜å‚¨æ‰€æœ‰æ•°æ®çš„å†…å­˜ç©ºé—´ã€‚å¦‚æœä½ çš„æ•°æ®å¤§å°æ˜¯ 1MBï¼Œä½†æ˜¯ä½ çš„å†…å­˜ç©ºé—´ä¸­å¯èƒ½åªæœ‰ä¸¤ä¸ªå¤§å†…å­˜å—ï¼Œä¸”å¤§å°åˆ†åˆ«ä¸º 512 KBï¼Œè¿˜æœ‰è‹¥å¹²å°å†…å­˜å—ï¼Œé‚£ä¹ˆè¿™å—æ•°æ®æ˜¯ä¸èƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ åœ¨é“¾è¡¨ä¸­ï¼Œæ˜¯é€šè¿‡ next æŒ‡é’ˆå°†ç¦»æ•£çš„å†…å­˜ç©ºé—´å…¨éƒ¨åˆ©ç”¨èµ·æ¥ï¼Œä¾‹å¦‚ä¸Šé¢çš„æƒ…å†µä¸­ï¼Œå°±å¯ä»¥å°†è¿™ 1MB å¤§å°çš„æ•°æ®å…¨éƒ¨è£…å…¥å†…å­˜ä¸­ æ³¨ï¼šåœ¨å®é™…çš„åº”ç”¨å±‚å¼€å‘ä¸­ï¼Œæ˜¯ä¸ç”¨åœ¨ä¹é‚£ä¸€ç‚¹çš„ç©ºé—´æ¢æ—¶é—´ï¼›ä½†æ˜¯åœ¨åº•å±‚å¼€å‘ä¸­ï¼Œè¿™ç§å¯¹ç©ºé—´è¦æ±‚éå¸¸é«˜çš„å¼€å‘ä¸­ï¼Œå°±è¦è€ƒè™‘åˆ°å¤šæ–¹é¢äº† å¯¹æ¯”ï¼š æ—¶é—´å¤æ‚åº¦ æ•°ç»„ é“¾è¡¨ æŸ¥è¯¢ O(1) O(n) æ’å…¥ã€åˆ é™¤ O(n) O(1) ä¸‰ã€å‡ ç§å¸¸è§„é“¾è¡¨3.1 å•é“¾è¡¨ æŒ‡å‘ w çš„ç»“ç‚¹çš„ç»“ç‚¹ç§°ä¸ºå¤´ç»“ç‚¹ æŒ‡å‘ NULL çš„ç»“ç‚¹ g ç§°ä¸ºå°¾ç»“ç‚¹ æ¯ä¸€ä¸ªç»“ç‚¹éœ€è¦é¢å¤–çš„ç©ºé—´å­˜å‚¨ä¸‹ä¸€ä¸ªç»“ç‚¹çš„åœ°å€ 3.2 å¾ªç¯é“¾è¡¨ ä¸ä»…å…·æœ‰å•é“¾è¡¨çš„ç‰¹ç‚¹ï¼Œä¸”åŠ ä¸Šå®ƒçš„å°¾ç»“ç‚¹æŒ‡å‘çš„ä¸æ˜¯ NULLï¼Œè€Œæ˜¯æŒ‡å‘äº†å¤´ç»“ç‚¹ ç›¸æ¯”å•é“¾è¡¨çš„ä¼˜ç‚¹ï¼šå¯ä»¥é€šè¿‡å°¾ç»“ç‚¹æ‰¾åˆ°å¤´ç»“ç‚¹ 3.3 åŒå‘é“¾è¡¨ æ¯ä¸€ä¸ªç»“ç‚¹é™¤äº†éœ€è¦é¢å¤–çš„ç©ºé—´å­˜å‚¨ä¸‹ä¸€ä¸ªç»“ç‚¹çš„åœ°å€ï¼Œè¿˜éœ€è¦é¢å¤–çš„ç©ºé—´æŒ‡å‘å‰ä¸€ä¸ªç»“ç‚¹çš„åœ°å€ ç›¸æ¯”å•é“¾è¡¨çš„ä¼˜ç‚¹ï¼šå¯ä»¥é€šè¿‡ä»»ä¸€ç»“ç‚¹å¯ä»¥æ‰¾åˆ°ä¸Šä¸€ä¸ªç»“ç‚¹å’Œä¸‹ä¸€ä¸ªç»“ç‚¹ 3.4 åŒå‘å¾ªç¯é“¾è¡¨ ä¸ä»…å…·æœ‰åŒå‘é“¾è¡¨çš„ç‰¹ç‚¹ï¼Œä¸”åŠ ä¸Šå¤´ç»“ç‚¹çš„ pre æŒ‡é’ˆæŒ‡å‘å°¾ç»“ç‚¹ï¼Œå°¾ç»“ç‚¹çš„ next æŒ‡é’ˆæŒ‡å‘å¤´ç»“ç‚¹ ç›¸æ¯”åŒå‘é“¾è¡¨çš„ä¼˜ç‚¹ï¼šå¯ä»¥é€šè¿‡å¤´ç»“ç‚¹æ‰¾åˆ°å°¾ç»“ç‚¹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å°¾ç»“ç‚¹æ‰¾åˆ°å¤´ç»“ç‚¹ å››ã€é“¾è¡¨çš„åŸºæ“å’Œæ³¨æ„äº‹é¡¹è¿™é‡Œå¯¹äºé“¾è¡¨çš„æ“ä½œåªåœ¨å•é“¾è¡¨ä¸­è¿›è¡Œï¼Œå…¶ä½™çš„é“¾è¡¨åŒç†ï¼š å¢ å‰æï¼šåœ¨ a ç»“ç‚¹åé¢å¢åŠ ä¸€ä¸ª x ç»“ç‚¹ï¼Œp æŒ‡å‘ a ç»“ç‚¹ ç¬¬ä¸€æ­¥ï¼šx â€“&gt; next = p â€“&gt; next ç¬¬äºŒæ­¥ï¼šp â€“&gt; next = x æ³¨ï¼š æ­¤æ—¶å°±è¦æ³¨æ„ â€œé“¾ä¸æ–­â€ ç†è®ºï¼šåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­å°±æ˜¯ï¼Œç¬¬ä¸€æ­¥å’Œç¬¬äºŒæ­¥çš„é¡ºåºä¸èƒ½é¢ å€’ï¼Œä¸ç„¶å°±ä¼šå‡ºç°ä¸‹é¢è¿™ç§æƒ…å†µï¼š ç¬¬ä¸€æ­¥ï¼šp â€“&gt; next = x ç¬¬äºŒæ­¥ï¼šx â€“&gt; next = p â€“&gt; next å¦‚æœ p â€“&gt; next æŒ‡å‘äº† xï¼Œé‚£ä¹ˆåœ¨ç¬¬äºŒæ­¥ä¸­ï¼Œx â€“&gt; next æŒ‡å‘äº†è‡ªå·± åˆ  åˆ é™¤æ“ä½œçš„è¯ï¼Œå°±åªéœ€è¦ï¼šp â€“&gt; next = p â€“&gt; next â€“&gt; next å³å¯ æ³¨ï¼šåˆ é™¤ç»“ç‚¹è¦è®°å¾—é‡Šæ”¾å†…å­˜ï¼Œé™¤äº†ä¸€äº›è‡ªå¸¦åƒåœ¾å›æ”¶çš„è¯­è¨€å¤–ï¼Œä¾‹å¦‚ Javaã€pythonã€Goç­‰ å“¨å…µæ¨¡å¼ æ—¢ç„¶åœ¨é“¾è¡¨ä¸­å‡ºç°äº†è¿™ä¸ªæ¨¡å¼ï¼Œé‚£å¿…ç„¶æ˜¯æœ‰è¿ç”¨çš„åœºæ™¯çš„ï¼Œçœ‹ä¸ªä¾‹å­ï¼š åœ¨ä¸Šé¢å•é“¾è¡¨ä¸­å¢åŠ ä¸€ä¸ªç»“ç‚¹æ—¶ 12x --&gt; next = p --&gt; nextp --&gt; next = x å¦‚æœå‡ºç°ä¸‹é¢å‡ ç§æƒ…å†µï¼š ç©ºé“¾è¡¨ï¼Œæ’å…¥ç¬¬ä¸€ä¸ªç»“ç‚¹ åˆ é™¤æœ€åä¸€ä¸ªç»“ç‚¹ åˆæˆ–æ˜¯ p æŒ‡é’ˆæŒ‡å‘çš„æ˜¯ä¸¤ä¸ªç»“ç‚¹çš„å‰ä¸€ä¸ªç»“ç‚¹ (åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­æ˜¯ a)ï¼Œä½†æ˜¯å¦‚æœå‡ºç°è¦æ’å…¥çš„æ˜¯å¤´ç»“ç‚¹å‰é¢ (ä¹Ÿå°±æ˜¯è¯´æ²¡æœ‰å‰é¢é‚£ä¸ªç»“ç‚¹äº†) å‘¢ï¼Ÿ æ­¤æ—¶å°±å¯ä»¥å‘ç°ï¼Œp æŒ‡é’ˆæ— å¤„å¯æŒ‡ï¼Œè¿™æ—¶å€™å°±å¯ä»¥å¼•å…¥â€å“¨å…µâ€äº†ã€‚(è™½ç„¶åœ¨åŒå‘é“¾è¡¨ä¸­å¯ä»¥è½»æ˜“è§£å†³è¿™ä¸ªé—®é¢˜) ä¹Ÿå°±æ˜¯è¯´ä¸ç®¡åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ï¼Œéƒ½æœ‰ä¸€ä¸ªå“¨å…µçš„å­˜åœ¨ï¼Œå…¶ä¸»è¦ç›®çš„å°±æ˜¯ç®€åŒ–ä»£ç ï¼Œä¸éœ€è¦è€ƒè™‘å¸¦å¾ˆå¤šæƒ…å†µï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ä¸‹é¢çš„ä¾‹å­ï¼š é¦–å…ˆéœ€è¦çš„å‰æå°±æ˜¯ï¼šhead æŒ‡é’ˆæ˜¯æ°¸è¿œæŒ‡å‘å“¨å…µçš„ ç©ºé“¾è¡¨ä¸­æ’å…¥ç¬¬ä¸€ä¸ªç»“ç‚¹ï¼Œå°±å¯ä»¥ï¼š 123if (head -&gt; next == null) &#123; p = head;&#125; åªéœ€è¦åˆ¤æ–­å“¨å…µæŒ‡é’ˆçš„ next æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºçš„çš„è¯ï¼Œåªéœ€è¦å°† p = headï¼Œå°±å¯ä»¥è¿›è¡Œå’Œä¸Šé¢ä¸€æ ·çš„æ’å…¥ä»£ç äº† å››ã€Javaä¸­çš„é“¾è¡¨â€‹ é¦–å…ˆæ¥å›å¿†ä¸€ä¸‹åœ¨ Java ä¸­å¯¹æ•°ç»„çš„æ“ä½œï¼Œç›´æ¥åˆ†é…ä¸€å—è¿ç»­çš„å†…å­˜ç»™æ•°ç»„ï¼Œè¿™ç§æƒ…å†µçš„ä¸å¥½ä¹‹å¤„å°±æ˜¯éœ€è¦è¿ç»­ä¸”å†…å­˜è¶³å¤Ÿçš„ç©ºé—´ï¼›éšååˆæå‡ºäº† Java ä¸­åŠ¨æ€æ•°ç»„ ArrayList ï¼Œè¿™ä¸ªç±»çš„ç¡®å¯ä»¥è¿›è¡ŒåŠ¨æ€çš„è‡ªåŠ¨æ‰©å®¹ï¼Œä½†æ˜¯å®ƒä¸èƒ½è¿›è¡Œè‡ªåŠ¨ç¼©å®¹ (æ³¨ï¼šArrayList æ˜¯æ”¯æŒæ‰‹åŠ¨æ‰©å®¹ã€ç¼©å®¹)ï¼Œè€Œä¸”å®ƒçš„æ‰©å®¹æ˜¯å°†åŸæ¥æ‰€æœ‰çš„æ•°æ®å¤åˆ¶ä¸€ä»½åˆ°å·²ç»è¿›è¡Œæ‰©å®¹åˆ°åŸæ¥ 1.5 å€çš„æ–°æ•°ç»„ä¸­ï¼Œå½“æ•°æ®é‡è¿‡å¤§æ—¶ï¼Œè¿™ç§æ“ä½œå¯èƒ½å°±éœ€è¦å¤§é‡æ—¶é—´æ¥è¿›è¡Œäº† â€‹ è€Œåœ¨è¿™ä¸€å°èŠ‚ä¸­ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ï¼Œåœ¨ Java ä¸­é“¾è¡¨ç±»ï¼šLinkedListï¼Œå®ƒçš„åº•å±‚æ˜¯åŸºäºåŒå‘é“¾è¡¨çš„ï¼Œæ—¥å¸¸å¼€å‘å¾ˆå°‘ä½¿ç”¨ é¦–å…ˆçœ‹ä¸€ä¸‹ï¼Œç»§æ‰¿å…³ç³»ï¼š å¯ä»¥å’Œä¸Šä¸€èŠ‚ ArrayList ç±»çš„ç»§æ‰¿å›¾è¿›è¡Œå¯¹æ¯”ï¼Œå¯ä»¥å‘ç°ï¼š å°‘äº†ï¼šLinkedList å°‘å®ç°äº† RandomAccess æ¥å£ï¼Œå…·ä½“çœ‹å‚è€ƒRandomAccess è¿™ä¸ªç©ºæ¶å­æœ‰ä½•ç”¨ï¼Ÿ æ”¹äº†ï¼šArrayList æ˜¯ç»§æ‰¿äº† AbstractListï¼Œè€Œ LinkedList ç»§æ‰¿äº† AbstractSequentialList (å®ƒæ˜¯ AbstractList çš„å­ç±») å¤šäº†ï¼šLinkedList è¿˜å®ç°äº† Deque æ¥å£ ====&gt; å› ä¸ºå®ç° Deque å³å¯ä»¥ä½œä¸ºé˜Ÿåˆ—ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºæ ˆä½¿ç”¨ã€‚å½“ç„¶ï¼Œä½œä¸ºåŒç«¯é˜Ÿåˆ—ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ ç”±äºæºç è¿‡å¤šï¼Œæ­¤å†…å®¹å°†æ”¾åœ¨ JDK æºç åˆ†æç³»åˆ—ä¸­ã€‚","categories":[{"name":"é‡å­¦ç®—æ³•ç³»åˆ—","slug":"é‡å­¦ç®—æ³•ç³»åˆ—","permalink":"http://wangba.me/categories/%E9%87%8D%E5%AD%A6%E7%AE%97%E6%B3%95%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"Algorithm","slug":"Algorithm","permalink":"http://wangba.me/tags/Algorithm/"}]},{"title":"Array","slug":"Array","date":"2020-10-02T14:35:15.000Z","updated":"2020-10-02T14:29:22.797Z","comments":true,"path":"2020/10/02/Array/","link":"","permalink":"http://wangba.me/2020/10/02/Array/","excerpt":"","text":"ä¸€ã€OverViewæ€ç»´å¯¼å›¾ï¼š äºŒã€ç‰¹æ€§æ•°ç»„åº”è¯¥æ˜¯æ‰€æœ‰ç¨‹åºå‘˜ä¸­æœ€ç†Ÿæ‚‰çš„æ•°æ®ç»“æ„äº†ï¼Œå¦‚æœä½ ç®€å•çš„å›å¿†ä¸€ä¸‹æ•°ç»„çš„å…·ä½“å«ä¹‰ï¼Œä½ å¯ä»¥å¾—åˆ°å·²ç»å‡ ä¸ªé‡è¦çš„ç»“è®ºï¼š ğŸ· çº¿æ€§ç»“æ„ ğŸ¢ è¿ç»­å†…å­˜ ğŸ­ å­˜å‚¨ç›¸åŒç±»å‹ 2.1 çº¿æ€§ç»“æ„é¡¾åæ€ä¹‰ï¼Œçº¿æ€§ç»“æ„å°±æ˜¯è¿™ä¸ªç»“æ„åƒçº¿æ€§ä¸€æ ·ï¼Œè€Œéæ˜¯å…¶å®ƒç»“æ„ï¼Œè¿™æ ·è¯´çš„ç¡®æœ‰ç‚¹æŠ½è±¡ï¼Œå¯ä»¥ä»ä¸‹é¢å‡ ä¸ªä¾‹å­æ¥çœ‹ä¸€ä¸‹ï¼š æ³¨ï¼š è¿™é‡Œçš„ Array æ˜¯ä½¿ç”¨ Java ä¸­çš„å†…å­˜æ¨¡å‹ï¼Œå³ char ä¸º 2 ä¸ªå­—èŠ‚ é“¾è¡¨æ²¡æœ‰ä½¿ç”¨å“¨å…µæ¨¡å¼ (åé¢ä¼šæåˆ°) 2.2 è¿ç»­å†…å­˜å’Œç›¸åŒæ•°æ®ç±»å‹æ­£å¦‚ä¸Šé¢ä¾‹å­ä¸­çš„æ•°ç»„ä¸€æ ·ï¼Œåœ¨è¿™ä¸ªæ•°ç»„ä¸­ï¼Œå®ƒä»¬çš„åœ°å€æ˜¯è¿ç»­çš„ï¼Œä¸”æ•°ç»„ä¸­æ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯ char ç±»å‹ï¼Œæ­£æ˜¯ç”±äºè¿™ä¸¤ä¸ªç‰¹æ€§ï¼Œè®©æ•°ç»„å®ç°äº†è¿™ä¸€ç”Ÿä¸­æœ€é‡è¦çš„æ“ä½œï¼šå¿«é€ŸæŸ¥è¯¢ï¼Œå®ƒå¯ä»¥è¾¾åˆ° O(1) çš„é€Ÿåº¦ï¼Œå½“ç„¶è¦å¯¹è¿™é‡Œè¿›è¡Œé™åˆ¶æ¡ä»¶ï¼Œå³å‡†ç¡®çš„è¡¨è¾¾åº”è¯¥æ˜¯æŒ‰ç…§ä¸‹æ ‡è¿›è¡ŒæŸ¥è¯¢ï¼Œå®ƒçš„æ—¶é—´å¤æ‚åº¦å¯ä»¥è¾¾åˆ° O(1) ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬ç»å¸¸è¯´çš„æ ¹æ®æŸä¸ªå€¼æ¥ç¡®å®šå®ƒçš„ä½ç½®ç­‰ï¼Œè¿™æ ·çš„æŸ¥è¯¢æ–¹å¼ (å·²ç»æ’å¥½åº) æœ€å¿«ä¹Ÿæ˜¯ O(logn) å…ˆæ¥çœ‹ä¸€ä¸‹æ˜¯å¦‚ä½•å®ç°æ ¹æ®ä¸‹æ ‡æ¥è¿›è¡Œæ—¶é—´å¤æ‚åº¦ä¸º O(1) çš„æ“ä½œï¼š æˆ‘ä»¬å¾ˆå®¹æ˜“å°±å‘ç°è¿™æ ·çš„è§„å¾‹ï¼š å‰æï¼šchar[] charList = new char[6] ç»“è®ºï¼šaddress = baseAddress + i * charSize ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“ä»¥ä¸‹æ¡ä»¶å°±è¡Œï¼š è¯¥æ•°ç»„çš„èµ·å§‹åœ°å€ baseAddressï¼Œä¹Ÿå°±æ˜¯å›¾ä¸­çš„ 1000 è¯¥æ•°ç»„æ˜¯ä»€ä¹ˆç±»å‹ï¼Œè¿™é‡Œæ˜¯ Java çš„ char ç±»å‹ï¼Œå­—èŠ‚æ•°ä¸º 2 å°±è¿™æ ·ï¼Œå¯ä»¥é€šè¿‡ä¸Šé¢æ¡ä»¶æ±‚å‡ºè¿™é‡Œä»»æ„ä¸€ä¸ªå…ƒç´ çš„åœ°å€ã€‚ å‡çŸ¥è¯†ï¼šå¦‚æœï¼Œèµ·å§‹åœ°å€ä» 1 å¼€å§‹çš„è¯ï¼Œæ¥è®¡ç®—ä¸€ä¸‹ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ è®¡ç®—å…¬å¼æ˜¯ä¸æ˜¯è¦å˜ä¸ºï¼šaddress = baseAddress + (i - 1) * charSize ä½ æƒ³ï¼Œä½ ç»†æƒ³ï¼Œæ˜¯ä¸æ˜¯æ¯æ¬¡éƒ½è¦å¤šè¿›è¡Œä¸€æ¬¡å‡æ³•æ“ä½œï¼Œè¿™æ · åŠ æ³•å™¨ (åœ¨è®¡ç»„ä¸­æ˜¯æ²¡æœ‰å‡æ³•å™¨å­˜åœ¨çš„ï¼Œé€šè¿‡è½¬æ¢ä¸ºåŠ æ³•æ¥è®¡ç®—)æ˜¯ä¸æ˜¯å°±è¦å¤šè¿›è¡Œä¸€æ¬¡è®¡ç®— è¿™ä¼šä¸ä¼šå°±æ˜¯å½“å¹´å®šä¹‰æ•°ç»„ä» 0 å¼€å§‹çš„é‚£ä½ç¨‹åºå‘˜çš„ idea å‘¢ï¼Ÿ(å¼ºè€…å¦‚æ–¯) å½“ç„¶ä¸æ˜¯ï¼Œè¿™ä»…ä»…æ˜¯ä¸€ç§è§„å®šè€Œå·²ï¼Œä¸Šé¢çš„ä¸€ç³»åˆ—çŒœæµ‹ï¼Œä»…ä»…æ˜¯ä¸ºäº†çŒœè€ŒçŒœ 2.3 æ’å…¥å’Œåˆ é™¤One coin has two sidesï¼Œæœ‰åˆ©è‡ªç„¶æœ‰å¼Šã€‚åœ¨ä¸Šé¢å·²ç»è¯´è¿‡äº†æ•°ç»„çš„æŸ¥è¯¢ï¼Œä¹Ÿæ˜¯æ•°ç»„çš„æœ€å¤§ä¼˜ç‚¹ï¼›å½“ç„¶æ•°ç»„åœ¨æ’å…¥å’Œåˆ é™¤çš„æ—¶é—´å¤æ‚åº¦æ¯”è¾ƒé«˜ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›ä¼˜åŒ–çš„å° tipsã€‚ æ’å…¥ ä¸ºä»€ä¹ˆè¯´æ•°ç»„ä¸­æ’å…¥ï¼Œä¼šæ˜¯æ—¶é—´å¤æ‚åº¦å˜é«˜å‘¢ï¼Ÿä¸»è¦æ˜¯æ•°ç»„æ˜¯è¿ç»­å­˜å‚¨çš„ï¼Œå¦‚æœåªæ˜¯åœ¨æœ€åä¸€ä¸ªå…ƒç´ æ’å…¥ä¸€ä¸ªæ–°çš„å…ƒç´ ï¼Œé‚£ä¹ˆæ²¡ä»€ä¹ˆå¤§ä¸äº†ï¼›ä½†æ˜¯ä½ è¦æ˜¯åœ¨ç¬¬ä¸€ä¸ªå…ƒç´ åé¢æ’å…¥ä¸€ä¸ªæ–°çš„å…ƒç´ ï¼Œé‚£å°±è¦æŠŠåŸæœ¬çš„ç¬¬äºŒä¸ªå…ƒç´ åˆ°æœ€åä¸€ä¸ªå…ƒç´ å…¨éƒ¨å‘åç§»åŠ¨ä¸€ä¸ª typeSizeï¼Œå¦‚ä¸‹ï¼š ç”±ä¸Šé¢çš„å›¾ï¼Œå¯ä»¥è½»æ˜“çœ‹å‡ºæ’å…¥æ–°çš„å…ƒç´ åœ¨æœ€åï¼šå‰é¢å…ƒç´ çš„ä½ç½®éƒ½æœªå˜ï¼›æ’å…¥åœ¨ç¬¬äºŒä¸ªä½ç½®ï¼šç¬¬äºŒä¸ªå…ƒç´ åˆ°æœ€åä¸€ä¸ªå…ƒç´ çš„ä½ç½®éƒ½ + 1 äº† å¹³å‡çš„æ—¶é—´å¤æ‚åº¦å°±ä¸ºï¼šO(n) å½“ç„¶è¿™æ ·åšæ˜¯æœ‰å‰æçš„ï¼šå°±æ˜¯æ˜¯è¦æœ‰åºçš„ã€‚å¦‚æœå¯¹æ’åºæ²¡æœ‰è¦æ±‚çš„ï¼Œå¯ä»¥å¦‚ä¸‹æ“ä½œï¼š æ­¤æ—¶åªéœ€è¦æŠŠåŸæœ¬åœ¨ 1 ä½ç½®çš„å…ƒç´ å¤åˆ¶åˆ°æ–°æ‰©å±•çš„ä½ç½®ï¼ŒæŠŠ 1 ä¸­çš„å…ƒç´ æ¢æˆæ–°çš„å…ƒç´ ï¼Œåœ¨ä¸Šè¿°çš„ä¾‹å­ä¸­å¯¹åº”çš„å°±æ˜¯ï¼šå°† n å¤åˆ¶åˆ°ä½ç½® 5 ä¸Šï¼Œç„¶åå°†ä½ç½® 1 çš„å…ƒç´ è¦†ç›–ä¸ºæ–°å…ƒç´  a åˆ é™¤ åˆ é™¤æ•°ç»„ä¸­çš„å…ƒç´ ä¸æ’å…¥æ“ä½œç±»ä¼¼ï¼šä¸»è¦æ˜¯ä¸ºäº†ä¿è¯å†…å­˜çš„è¿ç»­æ€§ï¼Œå¦‚æœåˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ ï¼Œé‚£æ²¡ä»€ä¹ˆé—®é¢˜ï¼›å¦‚æœæ˜¯åˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªå…ƒç´ åé¢çš„æ‰€æœ‰å…ƒç´ éƒ½è¦å‘å‰ç§»åŠ¨ä¸€ä¸ªä½ç½®ã€‚ åˆ™å¹³å‡çš„æ—¶é—´å¤æ‚åº¦å°±ä¸ºï¼šO(n) ä¸€äº›ç‰¹æ®Šæƒ…å†µä¸‹çš„åˆ é™¤ï¼šå¦‚æœå¯¹æ²¡æœ‰ç«‹é©¬å¯¹åˆ é™¤å…ƒç´ è¿›è¡Œåƒåœ¾å›æ”¶çš„æ“ä½œï¼Œæœ‰ä»€ä¹ˆæ¯”è¾ƒå¥½çš„æ–¹å¼ï¼Ÿ åœ¨ JVM è¿›è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œæœ‰ä»¥ä¸‹å‡ ç§ç®—æ³•ï¼š æ ‡è®° - æ¸…é™¤ç®—æ³• å¤åˆ¶ç®—æ³• æ ‡è®° - æ•´ç†ç®—æ³• åˆ†ä»£æ”¶é›†ç®—æ³• åœ¨è¿™é‡Œä¸»è¦ä»‹ç»ä¸€ä¸‹ æ ‡è®° - æ¸…é™¤ç®—æ³•ï¼Œç®€å•æ¥è¯´ï¼š åœ¨ JVM è¿›è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œä¸ç«‹é©¬è¿›è¡Œå›æ”¶ï¼Œåªæ˜¯å¯¹è¦è¿›è¡Œå›æ”¶çš„å…ƒç´ è¿›è¡Œæ ‡è®°ï¼Œç­‰åˆ°ç§¯ç´¯åˆ°ä¸€å®šé‡å†è¿›è¡Œä¸€æ¬¡æ‰¹å¤„ç†ï¼Œä¾‹å­å¦‚ä¸‹ï¼š å¯ä»¥çœ‹è§ï¼Œåªéœ€è¦å¯¹è¦åˆ é™¤çš„å…ƒç´ è¿›è¡Œæ ‡è®°ï¼Œéšååˆ°æœ€åä¸€æ¬¡æ€§è¿›è¡Œå›æ”¶ ä½†æ˜¯è¿™æ ·ä¹Ÿä¼šå¸¦æ¥å¾ˆå¤šé—®é¢˜ï¼Œå¦‚æ•ˆç‡é—®é¢˜å’Œç©ºé—´é—®é¢˜ï¼Œå¦‚ä¸‹ï¼š å¦‚æœæ˜¯åˆ é™¤çš„å…ƒç´ æ˜¯ä¸€æ®µä¸€æ®µçš„ï¼Œé‚£ä¹ˆå°±ä¼šäº§ç”Ÿå¤§é‡çš„ç©ºé—´ç¢ç‰‡ï¼Œæ‰€ä»¥ JVM åé¢è¿˜æœ‰å¾ˆå¤šå…¶ä½™çš„å›æ”¶ç®—æ³• 2.4 å…³äºæ•°ç»„è¶Šç•Œçš„é—®é¢˜æˆ‘ä»¬å°è¯•åœ¨ Ubuntu 18.04 64bit ä¸­è¿è¡Œä¸‹é¢è¿™æ®µ C ä»£ç ï¼š OverFlow.c 1234567891011#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;int main(int argc, char* argv[])&#123; int i = 0; int arr[3] = &#123;0&#125;; for(; i&lt;=3; i++)&#123; arr[i] = 0; printf(&quot;hello world\\n&quot;); &#125; return 0;&#125; æŒ‰ç…§æ­£å¸¸æƒ³æ³•èµ°ä¸‹å»ï¼šä¼šæ‰“å°ä¸‰è¡Œ hello worldï¼Œå°±ä¼šè¿è¡Œå®Œæ¯• è®©æˆ‘ä»¬è¿›è¡Œæµ‹è¯•å§ï¼š ä½ å°±ä¼šçœ‹åˆ°æ§åˆ¶å°å¼€å§‹æ— é™æ‰“å° hello world äº†ï¼š ![image-20201002172557103](/Users/wangdechao/Library/Application Support/typora-user-images/image-20201002172557103.png) åªè¦åœ¨å†…å­˜è¶³å¤Ÿçš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªç¨‹åºå°±ä¼šä¸€ç›´è¿è¡Œä¸‹å»ï¼Œè¿™å°±æ˜¯å…¸å‹çš„ StackOverFlow é—®é¢˜ ç®€å•çš„å°±å¯ä»¥ç†è§£æˆå¦‚ä¸‹ç»“æ„ï¼š è¿™ä¸ªæ ˆçš„ç»“æ„å…·ä½“å¯ä»¥å‚è€ƒã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹ï¼Œè¿™é‡Œå‡ºç°ä¸Šè¿°æƒ…å†µçš„ä¸»è¦åŸå› ï¼š C è¯­è¨€ä¸­æ˜¯æ‰€æœ‰çš„å†…å­˜éƒ½æ˜¯å¯ä»¥è®¿é—® (é™¤äº†å—é™å†…å­˜ä»¥å¤–) åœ¨ä¸Šè¿°ä»£ç ä¸­ i &lt;=3ï¼Œè¯´æ˜ a[3] = 0 åœ¨å†…å­˜çš„æŸä¸ªåœ°å€ä¸Š è€Œè¿™ä¸ªåœ°å€æœ¬èº«æ˜¯ åŸæ¥çš„ i çš„åœ°å€ ï¼Œæ‰€ä»¥å°±ç›¸å½“äº i = 3 åˆè¢«èµ‹å€¼ä¸º i = 0ï¼Œç„¶åç»§ç»­ä¸æ–­å¾ªç¯ å¦‚æœæƒ³çŸ¥é“è¿™ä¸ªæ ˆæº¢å‡ºæ˜¯å¦‚ä½•å…·ä½“å®ç°çš„è¯ï¼Œå¯ä»¥æ˜¯ç”¨ objdump å‘½ä»¤è¿›è¡Œåç¼–è¯‘ï¼Œå†è¿›è¡Œåˆ†æï¼Œå…¶ä¸­ä¸»è¦çš„æ±‡ç¼–ä»£ç å¦‚ä¸‹ï¼šå…¶ä¸­å…³é”®è¡Œåº”è¯¥ä¸º 65fã€67eã€682ã€661 123456789101112131415161718192021222324000000000000063a &lt;main&gt;: 63a: 55 push %rbp 63b: 48 89 e5 mov %rsp,%rbp 63e: 48 83 ec 20 sub $0x20,%rsp 642: 89 7d ec mov %edi,-0x14(%rbp) 645: 48 89 75 e0 mov %rsi,-0x20(%rbp) 649: c7 45 fc 00 00 00 00 movl $0x0,-0x4(%rbp) 650: 48 c7 45 f0 00 00 00 movq $0x0,-0x10(%rbp) 657: 00 658: c7 45 f8 00 00 00 00 movl $0x0,-0x8(%rbp) 65f: eb 1d jmp 67e &lt;main+0x44&gt; 661: 8b 45 fc mov -0x4(%rbp),%eax 664: 48 98 cltq 666: c7 44 85 f0 00 00 00 movl $0x0,-0x10(%rbp,%rax,4) 66d: 00 66e: 48 8d 3d 9f 00 00 00 lea 0x9f(%rip),%rdi # 714 &lt;_IO_stdin_used+0x4&gt; 675: e8 96 fe ff ff callq 510 &lt;puts@plt&gt; 67a: 83 45 fc 01 addl $0x1,-0x4(%rbp) 67e: 83 7d fc 03 cmpl $0x3,-0x4(%rbp) 682: 7e dd jle 661 &lt;main+0x27&gt; 684: b8 00 00 00 00 mov $0x0,%eax 689: c9 leaveq 68a: c3 retq 68b: 0f 1f 44 00 00 nopl 0x0(%rax,%rax,1) å…¶å®ï¼Œåœ¨è¿™ä¸ªå·¨å¤§æ¼æ´å‡ºæ¥åï¼Œç°åœ¨çš„å†…å­˜å·²ç»åŠ äº†é‡‘ä¸é›€ä¿æŠ¤ (canary) äº†ï¼Œä¸ºäº†è®©è¿™ä¸ªæ¼æ´å¤ç°ï¼Œåœ¨ä¸Šé¢ç¼–è¯‘çš„è¿‡ç¨‹ä¸­ï¼Œå·²ç»ä½¿ç”¨ -fno-stack-protector å°†ä¿æŠ¤å…³é—­äº† è€Œå¦‚æœè¯¥ç¨‹åºåœ¨ Java ä¸­å¤ç°ï¼Œåœ¨ç¼–è¯‘æ—¶å°±ä¼šæŠ›å‡º ArrayIndexOutOfBoundsException çš„å¼‚å¸¸äº† ä¸‰ã€Java ä¸­çš„æ•°ç»„åœ¨ Java ä¸­ï¼Œå¯¹äºæ•°ç»„æ²¡æœ‰ä»€ä¹ˆå¥½äº†è§£çš„ï¼Œé¡¶å¤šå°±ä¸€ä¸ªåŸºæœ¬è¯­æ³•ï¼›ä½†æ˜¯åœ¨ Java ä¸­æœ‰ä¸€ä¸ªé›†åˆç±»ï¼Œæ˜¯æ¯ä¸ª Java ç¨‹åºå‘˜åº”è¯¥æ¯å¤©éƒ½ä¼šç”¨åˆ°çš„ï¼Œå®ƒå°±æ˜¯ ArrayList å…ˆçœ‹ä¸€ä¸‹å®ƒçš„ç»§æ‰¿å’Œå®ç°å…³ç³» å®ƒç»§æ‰¿äº† AbstractList ï¼Œå®ç°äº† List ====&gt; å®ƒæ˜¯ä¸€ä¸ªæ•°ç»„é˜Ÿåˆ—ï¼Œæä¾›äº†ç›¸å…³çš„æ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹ã€éå†ç­‰åŠŸèƒ½ å®ƒå®ç°äº†RandomAccess æ¥å£ ====&gt; å®ç°è¿™ä¸ªè¿™ä¸ªæ¥å£çš„ List é›†åˆæ˜¯æ”¯æŒå¿«é€Ÿéšæœºè®¿é—® å®ƒå®ç° java.io.Serializable æ¥å£ ====&gt; ArrayList æ”¯æŒåºåˆ—åŒ–ï¼Œèƒ½é€šè¿‡åºåˆ—åŒ–å»ä¼ è¾“ å¹¶ä¸”è¦æ³¨æ„ï¼Œåœ¨å•çº¿ç¨‹ä¸­ä½¿ç”¨å®ƒï¼Œåœ¨å¤šçº¿ç¨‹ä½¿ç”¨ Vector(å°‘) æˆ–è€… CopyOnWriteArrayList(å¤š)**ï¼Œå°½é‡è¿˜æ˜¯ä½¿ç”¨åè€…è¾ƒå¤šï¼Œå‰è€…ä¸»è¦æ˜¯åŸºäº **synchronized å…³é”®å­—ï¼Œåè€…æ˜¯åŸºäº ReentrantLock æ“ä½œçš„ å®ƒä¸ Java è‡ªå¸¦çš„æ™®é€šæ•°ç»„æœ€å¤§çš„åŒºåˆ«å°±æ˜¯ï¼šå®ƒæ˜¯åŠ¨æ€çš„ è¿™é‡Œä¸»è¦åŸºäºæºç åˆ†æä¸€ä¸‹åŠ¨æ€æ‰©å®¹ï¼š 12345678910111213141516171819202122232425262728293031public void ensureCapacity(int minCapacity) &#123; if (minCapacity &gt; this.elementData.length &amp;&amp; (this.elementData != DEFAULTCAPACITY_EMPTY_ELEMENTDATA || minCapacity &gt; 10)) &#123; ++this.modCount; this.grow(minCapacity); &#125;&#125;private Object[] grow(int minCapacity) &#123; return this.elementData = Arrays.copyOf(this.elementData, this.newCapacity(minCapacity));&#125;private Object[] grow() &#123; return this.grow(this.size + 1);&#125;private int newCapacity(int minCapacity) &#123; int oldCapacity = this.elementData.length; int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1); if (newCapacity - minCapacity &lt;= 0) &#123; if (this.elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123; return Math.max(10, minCapacity); &#125; else if (minCapacity &lt; 0) &#123; throw new OutOfMemoryError(); &#125; else &#123; return minCapacity; &#125; &#125; else &#123; return newCapacity - 2147483639 &lt;= 0 ? newCapacity : hugeCapacity(minCapacity); &#125;&#125; æ³¨ï¼š å¯¹äºå˜é•¿æ•°æ®ç»“æ„ï¼Œå½“ç»“æ„ä¸­æ²¡æœ‰ç©ºä½™ç©ºé—´å¯ä¾›ä½¿ç”¨æ—¶ï¼Œå°±éœ€è¦è¿›è¡Œæ‰©å®¹ã€‚åœ¨ ArrayList ä¸­ï¼Œå½“ç©ºé—´ç”¨å®Œï¼Œå…¶ä¼šæŒ‰ç…§åŸæ•°ç»„ç©ºé—´çš„1.5å€è¿›è¡Œæ‰©å®¹ã€‚","categories":[{"name":"é‡å­¦ç®—æ³•ç³»åˆ—","slug":"é‡å­¦ç®—æ³•ç³»åˆ—","permalink":"http://wangba.me/categories/%E9%87%8D%E5%AD%A6%E7%AE%97%E6%B3%95%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"Algorithm","slug":"Algorithm","permalink":"http://wangba.me/tags/Algorithm/"}]},{"title":"Algorithm","slug":"Algorithm","date":"2020-10-01T14:42:29.000Z","updated":"2020-11-23T06:13:28.521Z","comments":true,"path":"2020/10/01/Algorithm/","link":"","permalink":"http://wangba.me/2020/10/01/Algorithm/","excerpt":"","text":"â€‹ æœ€è¿‘å®ä¹ åå‘ç°è‡ªå·±çš„ç®—æ³•èƒ½åŠ›æ€¥å‰§ä¸‹é™ï¼ŒCRUD åªæ˜¯ä¸‹é™ï¼Œç®—æ³•æ‰æ˜¯ä¸Šé™ï¼Œå†³å®šé‡æ–°å¼€ä¸€ä¸ªç³»åˆ—ï¼Œå°†æ•°æ®ç»“æ„ä¸ç®—æ³•é‡æ–°å­¦ä¸€éã€‚è¿™æ¬¡ä¸»è¦å‚è€ƒçš„è¯¾ç¨‹æ˜¯ã€Šæ•°æ®ç»“æ„ä¸ç®—æ³•ä¹‹ç¾ã€‹å’Œã€Šç®—æ³•é¢è¯•é€šå…³40è®²ã€‹ã€‚è¿™é‡Œå°±ä¸åƒã€Šç®—æ³•å¯¼è®ºã€‹é‚£æ ·æ¯”è¾ƒç†è®ºåŒ–ï¼Œåº”è¯¥ä¼šæ›´åå‘äºã€Šç®—æ³•ã€‹è¿™æœ¬ä¹¦çš„ç±»å‹ã€‚ å¯ä»¥çœ‹åˆ°ä¸‹é¢è¿™äº›æœ‰è¶£çš„ç‚¹ï¼š ğŸ· å°½é‡åˆ©ç”¨å›¾ + æ–‡å­—ï¼Œæ¸…æ™°çš„è¡¨è¾¾æ„æ€ ğŸ¢ ä¸€å®šè¦ç»“åˆ Leetcode ä¸Šçš„é¢˜ç›® ğŸ­ å°½é‡ä»‹ç»ä¸€äº›æ²¡ç”¨æœ‰è¶£çš„å° Tips ğŸ¦ ä½¿ç”¨ Java æ¥å®ç°æ‰€æœ‰çš„ç®—æ³•","categories":[{"name":"é‡å­¦ç®—æ³•ç³»åˆ—","slug":"é‡å­¦ç®—æ³•ç³»åˆ—","permalink":"http://wangba.me/categories/%E9%87%8D%E5%AD%A6%E7%AE%97%E6%B3%95%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"Algorithm","slug":"Algorithm","permalink":"http://wangba.me/tags/Algorithm/"}]},{"title":"SpringBootæ•´åˆSpring Security (ä¸‰)","slug":"SpringBootæ•´åˆSpring-Security-ä¸‰","date":"2020-09-30T06:47:27.000Z","updated":"2020-09-30T08:49:43.318Z","comments":true,"path":"2020/09/30/SpringBootæ•´åˆSpring-Security-ä¸‰/","link":"","permalink":"http://wangba.me/2020/09/30/SpringBoot%E6%95%B4%E5%90%88Spring-Security-%E4%B8%89/","excerpt":"","text":"ä¸€ã€OverViewâ€‹ åœ¨å‰åç«¯ä¸åˆ†ç¦»æ—¶ä»£ï¼Œå¯èƒ½ä½¿ç”¨çš„å°±æ˜¯ä¸Šä¸€èŠ‚ä¸­è¿™ç§æ–¹æ³•ï¼›åœ¨ç°åœ¨è¿™ç§å‰åç«¯åˆ†ç¦»éåœ°èµ°çš„æƒ…å†µä¸‹ï¼Œå·²ç»ä¸å†æ¨èä½¿ç”¨ä¼ ç»Ÿçš„ session ï¼Œè€Œæ˜¯ä½¿ç”¨ç°åœ¨æ¯”è¾ƒæµè¡Œçš„ JWT è¿™ç§ token çš„æ–¹å¼è§£å†³ â€‹ å¯¹æ¯”åˆ†æä¸€ä¸‹ï¼š æœ‰çŠ¶æ€ç™»å½• æ— çŠ¶æ€ç™»å½• å®šä¹‰ æœåŠ¡ç«¯éœ€è¦è®°å½•æ¯æ¬¡ä¼šè¯çš„å®¢æˆ·ç«¯ä¿¡æ¯ï¼Œä»è€Œè¯†åˆ«å®¢æˆ·ç«¯èº«ä»½ï¼Œæ ¹æ®ç”¨æˆ·èº«ä»½è¿›è¡Œè¯·æ±‚çš„å¤„ç† æœåŠ¡ç«¯ä¸ä¿å­˜ä»»ä½•å®¢æˆ·ç«¯è¯·æ±‚è€…ä¿¡æ¯ï¼›å®¢æˆ·ç«¯çš„æ¯æ¬¡è¯·æ±‚å¿…é¡»å…·å¤‡è‡ªæè¿°ä¿¡æ¯ï¼Œé€šè¿‡è¿™äº›ä¿¡æ¯è¯†åˆ«å®¢æˆ·ç«¯èº«ä»½ ä¼˜ç‚¹ æ¯”è¾ƒæ–¹ä¾¿ï¼Œä¸éœ€è¦åšå¤šä½™çš„å¤„ç† ä½¿ç”¨ token å¾ˆçµæ´»ï¼›æœåŠ¡ç«¯ä¸éœ€è¦å­˜æ•°æ®ï¼›å®¢æˆ·ç«¯ä¹Ÿå¯ä»¥å‘é€ç»™å¤šä¸ªæœåŠ¡å™¨ ç¼ºç‚¹ åªèƒ½æ˜¯ç½‘é¡µç«¯ï¼Œåœ¨ IOSã€Androidä¸è¡Œï¼›æœåŠ¡ç«¯ä¿å­˜å¤§é‡æ•°æ®ï¼›é›†ç¾¤åŒ–ä¸å¤ªè¡Œ é…ç½®ç¨å¾®å¤æ‚(å…¶å®åœ¨æ¡†æ¶çš„åŠ æˆä¸‹ï¼Œä¸å¤æ‚) æœ‰çŠ¶æ€ç™»å½• ğŸŒ°ï¼šåœ¨ Tomcat ä¸­ï¼Œç”¨æˆ·ç™»å½•åï¼Œéœ€è¦æŠŠç”¨æˆ·çš„ä¿¡æ¯ä¿å­˜åœ¨æœåŠ¡å™¨çš„ session ä¸­ï¼Œç„¶åå‘é€ç»™ç”¨æˆ·ä¸€ä¸ª Cookie å€¼ï¼Œè®°å½•å¯¹åº”çš„ session å€¼ï¼Œç­‰ç”¨æˆ·ä¸‹ä¸€æ¬¡å†æ¬¡è®¿é—®è¯¥æœåŠ¡å™¨æ—¶ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å¸¦ä¸Šè¿™ä¸ª Cookie å€¼ï¼ŒæœåŠ¡ç«¯å†è¯†åˆ«å…¶ä¸­çš„ session å€¼ï¼Œè¿›è¡Œåˆ¤æ–­ æ— çŠ¶æ€ç™»å½• ğŸŒ°ï¼šå®¢æˆ·ç«¯å‘é€è´¦æˆ·å¯†ç åˆ°æœåŠ¡ç«¯è¿›è¡ŒéªŒè¯ï¼›è®¤è¯åæœåŠ¡ç«¯å‘é€ä¸€ä¸ª token ç»™å®¢æˆ·ç«¯ï¼›ä»¥åå®¢æˆ·ç«¯æ¯æ¬¡å‘é€è¯·æ±‚éƒ½å°† token æºå¸¦ä¸Šè¿›è¡Œè®¤è¯ï¼Œè¿›è¡Œåˆ¤æ–­ äºŒã€Testâ€‹ åœ¨å‰åç«¯åˆ†ç¦»çš„åŸºç¡€ä¸Šï¼Œç°åœ¨å‰ç«¯å’Œåç«¯åªæ˜¯é€šè¿‡ JSON è¿›è¡Œäº¤äº’ï¼Œæ‰€ä»¥ç°åœ¨çš„é¡µé¢è·³è½¬å…¨éƒ¨ç”±å‰ç«¯è¿›è¡Œæ§åˆ¶ï¼Œåç«¯åªæ˜¯è¿”å›ä¸åŒçš„ JSON ç½¢äº† é‡å†™SecurityConfigä¸­çš„ configure æ–¹æ³•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142@Overrideprotected void configure(HttpSecurity http) throws Exception &#123; http.authorizeRequests() .anyRequest().authenticated() .and() // ç™»å‡ºé¡µé¢ + ç™»å‡ºæˆåŠŸåé¡µé¢ .logout() .logoutUrl(&quot;/logout&quot;) .logoutSuccessUrl(&quot;/login.html&quot;) .logoutSuccessHandler((httpServletRequest, httpServletResponse, authentication) -&gt; &#123; httpServletResponse.setContentType(&quot;application/json;charset=utf-8&quot;); PrintWriter out = httpServletResponse.getWriter(); out.write(&quot;æ³¨é”€æˆåŠŸ&quot;); out.flush(); out.close(); &#125;) .and() // ç™»å½•é¡µé¢ + ç™»å½•æ¥å£ .formLogin().loginPage(&quot;/login.html&quot;) .loginProcessingUrl(&quot;/securityLogin&quot;) .permitAll() // ç™»å½•å¤±è´¥å¤„ç†å™¨ .failureHandler((httpServletRequest, httpServletResponse, e) -&gt; &#123; httpServletResponse.setContentType(&quot;application/json;charset=utf-8&quot;); PrintWriter out = httpServletResponse.getWriter(); out.write(e.getMessage()); out.flush(); out.close(); &#125;) // ç™»å½•æˆåŠŸå¤„ç†å™¨ .successHandler((httpServletRequest, httpServletResponse, authentication) -&gt; &#123; Object principal = authentication.getPrincipal(); httpServletResponse.setContentType(&quot;application/json;charset=utf-8&quot;); PrintWriter out = httpServletResponse.getWriter(); out.write(new ObjectMapper().writeValueAsString(principal)); out.flush(); out.close(); &#125;) .and() .csrf().disable() ;&#125; ç™»å½•æ¥å£ æ³¨ï¼š å¯ä»¥çœ‹åˆ°ä½¿ç”¨å‰åç«¯åˆ†ç¦»ï¼Œå°±ä¸éœ€è¦åç«¯æ¥æ§åˆ¶è·³è½¬é¡µé¢ç­‰ï¼Œåªéœ€è¦å°† JSON å‘ç»™å‰ç«¯å°±è¡Œ è¿™é‡Œé¢çš„ password ä¸ºç©ºï¼Œæ˜¯æ¡†æ¶åšçš„ï¼Œå…·ä½“å¯ä»¥çœ‹è¿™é‡Œ ç™»å½•å¤±è´¥ æ³¨ï¼š æ— è®ºæ˜¯ç”¨æˆ·åå’Œå¯†ç å…¶ä¸­ä¸€ä¸ªé”™è¯¯ï¼Œå°±ä¼šè¿”å› Bad credentials æç¤ºï¼Œä¸»è¦ä¹Ÿæ˜¯ä¸ºäº†å®‰å…¨ç€æƒ³ï¼Œå…·ä½“æµç¨‹å¯ä»¥çœ‹ä¸‹é¢çš„ 3.1 å°èŠ‚ æ³¨é”€ç™»å½• ä¸‰ã€Deep Learning3.1 æ·±å…¥äº†è§£ç™»å½•å¤±è´¥â€‹ åœ¨ä¸Šé¢æˆ‘ä»¬æåˆ°äº†æ— è®ºæ˜¯ç”¨æˆ·åå’Œå¯†ç å…¶ä¸­ä¸€ä¸ªé”™è¯¯ï¼Œå°±ä¼šè¿”å› Bad credentialsï¼Œå®åˆ™åœ¨å…¶ä¸­è¿˜æœ‰å¾ˆå¤šç§é”™è¯¯ï¼Œè€Œä¸”ç”¨æˆ·åæ˜¯æœ‰ç”¨æˆ·åé”™è¯¯ï¼Œåªæ˜¯æœ€ç»ˆè¢« Bad credentials è¦†ç›–äº†ï¼Œç¨å¾®åˆ†æä¸€ä¸‹ï¼š AbstractUserDetailsAuthenticationProvider 12345678910111213141516171819public Authentication authenticate(Authentication authentication) throws AuthenticationException &#123; Assert.isInstanceOf(UsernamePasswordAuthenticationToken.class, authentication, () -&gt; &#123; return this.messages.getMessage(&quot;AbstractUserDetailsAuthenticationProvider.onlySupports&quot;, &quot;Only UsernamePasswordAuthenticationToken is supported&quot;); &#125;); String username = authentication.getPrincipal() == null ? &quot;NONE_PROVIDED&quot; : authentication.getName(); boolean cacheWasUsed = true; UserDetails user = this.userCache.getUserFromCache(username); if (user == null) &#123; cacheWasUsed = false; try &#123; user = this.retrieveUser(username, (UsernamePasswordAuthenticationToken)authentication); &#125; catch (UsernameNotFoundException var6) &#123; this.logger.debug(&quot;User &#x27;&quot; + username + &quot;&#x27; not found&quot;); if (this.hideUserNotFoundExceptions) &#123; throw new BadCredentialsException(this.messages.getMessage(&quot;AbstractUserDetailsAuthenticationProvider.badCredentials&quot;, &quot;Bad credentials&quot;)); &#125; // çœç•¥&#125; åœ¨ä¸Šé¢è¿™æ®µä»£ç ä¸­ï¼Œè¿›è¡Œè°ƒè¯•å¯ä»¥çœ‹è§ï¼š ä¼šå…ˆåœ¨ç¼“å­˜ä¸­æŸ¥è¯¢ä¸€ä¸‹æ˜¯å¦æœ‰è¿‡ å†è°ƒç”¨ retrieveUser æ¥è¿›è¡Œåˆ¤æ–­ ä¸€æ—¦æŠ›å‡º UsernameNotFoundException ï¼Œå°±çœ‹ hideUserNotFoundExceptions çš„å€¼äº†ï¼Œå¦‚æœä¸º trueï¼Œå°±ä¼šæŠ›å‡º Bad credentials è¿›è¡Œæ–­ç‚¹è°ƒè¯•ï¼šè¾“é”™ç”¨æˆ·åï¼Œå¹¶æ‰“ä¸Šæ–­ç‚¹ï¼š é€šè¿‡ä¸Šå›¾å°±èƒ½çœ‹å‡ºï¼ŒhideUserNotFoundExceptions é»˜è®¤å€¼æ˜¯ true çš„ 3.2 æœªè®¤è¯å¤„ç†åœ¨å‰åç«¯åˆ†ç¦»ï¼Œå¦‚æœå‡ºç°æœªè®¤è¯çš„çŠ¶æ€ï¼Œä¸å¯èƒ½æ§åˆ¶å‰ç«¯æ¥è·³è½¬é¡µé¢ç­‰ï¼Œåªèƒ½ç»™å‰ç«¯è¿”å›ç›¸åº”çš„ä¿¡æ¯å³å¯ï¼š åœ¨ AuthenticationEntryPoint æ¥å£ä¸­æœ‰ä¸€ä¸ªæ–¹æ³•ï¼šcommence åœ¨ LoginUrlAuthenticationEntryPoint ä¸­å®ç°æ–¹å¼ä¸ºï¼š 1234567891011121314151617181920212223public void commence(HttpServletRequest request, HttpServletResponse response, AuthenticationException authException) throws IOException, ServletException &#123; String redirectUrl = null; if (this.useForward) &#123; if (this.forceHttps &amp;&amp; &quot;http&quot;.equals(request.getScheme())) &#123; redirectUrl = this.buildHttpsRedirectUrlForRequest(request); &#125; if (redirectUrl == null) &#123; String loginForm = this.determineUrlToUseForThisRequest(request, response, authException); if (logger.isDebugEnabled()) &#123; logger.debug(&quot;Server side forward to: &quot; + loginForm); &#125; RequestDispatcher dispatcher = request.getRequestDispatcher(loginForm); dispatcher.forward(request, response); return; &#125; &#125; else &#123; redirectUrl = this.buildRedirectUrlToLoginPage(request, response, authException); &#125; this.redirectStrategy.sendRedirect(request, response, redirectUrl);&#125; è¿™æ®µä»£ç ä¸­æœ€ä¸»è¦çš„æ˜¯çœ‹ä¸€ä¸‹ useForward çš„é»˜è®¤å€¼ï¼Œå¦‚æœæ˜¯ trueï¼Œé‚£ä¹ˆé»˜è®¤å°±æ˜¯èµ°è½¬å‘ï¼›å¦‚æœæ˜¯ falseï¼Œé‚£ä¹ˆé»˜è®¤èµ°çš„å°±æ˜¯é‡å®šå‘ ä½¿å‡ºæ–­ç‚¹è°ƒè¯•å¤§æ³•ï¼š åœ¨ Postman ä¸­ç›´æ¥ä½¿ç”¨ GET æ–¹å¼è¯·æ±‚ï¼šlocalhost:8080/security æ­¤æ–¹æ³•åœ¨ç¬¬ä¸€èŠ‚ä¸­å·²ç»å†™è¿‡äº†ï¼Œå°±æ˜¯è¾“å‡ºä¸€ä¸ª Spring Security åœ¨æ–¹æ³•å†…æ‰“ä¸Šæ–­ç‚¹ ä»ä¸Šé¢çš„å›¾å°±å¯ä»¥çœ‹è§ï¼ŒuseForward çš„é»˜è®¤å€¼æ˜¯ falseï¼Œé‚£ä¹ˆå°±å¯ä»¥ç¡®å®šæ˜¯èµ°çš„é‡å®šå‘ åªéœ€è¦é‡å†™è¯¥æ–¹æ³•è¦†ç›–å®ƒå°±è¡Œï¼š 12345678.exceptionHandling().authenticationEntryPoint((req, resp, authException) -&gt; &#123; resp.setContentType(&quot;application/json;charset=utf-8&quot;); PrintWriter out = resp.getWriter(); out.write(&quot;å°šæœªç™»å½•ï¼Œè¯·å…ˆç™»å½•&quot;); out.flush(); out.close();&#125;)","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Spring Security","slug":"Spring-Security","permalink":"http://wangba.me/tags/Spring-Security/"}]},{"title":"SpringBootæ•´åˆSpring Security (äºŒ)","slug":"SpringBootæ•´åˆSpring-Security-äºŒ","date":"2020-09-28T10:13:07.000Z","updated":"2020-09-30T07:09:26.232Z","comments":true,"path":"2020/09/28/SpringBootæ•´åˆSpring-Security-äºŒ/","link":"","permalink":"http://wangba.me/2020/09/28/SpringBoot%E6%95%B4%E5%90%88Spring-Security-%E4%BA%8C/","excerpt":"","text":"ä¸€ã€Testç¯å¢ƒä¸ä¸Šä¸€èŠ‚çš„ç¯å¢ƒä¸€è‡´ï¼Œè¿™ä¸€èŠ‚ä¸»è¦æ¥è¿›è¡Œè‡ªå®šä¹‰æ“ä½œ åœ¨ SecurityConfig ä¸­é‡å†™è¿™ä¸¤ä¸ªæ–¹æ³•ï¼š 12345678910111213141516@Overridepublic void configure(WebSecurity web) throws Exception &#123; web.ignoring().antMatchers(&quot;/js/**&quot;, &quot;/css/**&quot;,&quot;/images/**&quot;);&#125;@Overrideprotected void configure(HttpSecurity http) throws Exception &#123; http.authorizeRequests() .anyRequest().authenticated() .and() .formLogin().loginPage(&quot;/login.html&quot;) .permitAll() .and() .csrf().disable() ;&#125; è‡ªè¡Œå†™ä¸€ä¸ªç™»å½•é¡µé¢ï¼š login.html ä¸­çš„æ ¸å¿ƒä»£ç  123456789101112131415161718&lt;form action=&quot;/login.html&quot; method=&quot;post&quot;&gt; &lt;div class=&quot;input&quot; style=&quot;text-align: center&quot;&gt; &lt;label for=&quot;name&quot;&gt;ç”¨æˆ·å&lt;/label&gt; &lt;input type=&quot;text&quot; name=&quot;username&quot; id=&quot;name&quot;&gt; &lt;span class=&quot;spin&quot;&gt;&lt;/span&gt; &lt;/div&gt; &lt;div class=&quot;input&quot; style=&quot;text-align: center&quot;&gt; &lt;label for=&quot;pass&quot;&gt;å¯†ç &lt;/label&gt; &lt;input type=&quot;password&quot; name=&quot;password&quot; id=&quot;pass&quot;&gt; &lt;span class=&quot;spin&quot;&gt;&lt;/span&gt; &lt;/div&gt; &lt;div class=&quot;button login&quot; style=&quot;text-align: center&quot;&gt; &lt;button type=&quot;submit&quot;&gt; &lt;span&gt;ç™»å½•&lt;/span&gt; &lt;i class=&quot;fa fa-check&quot;&gt;&lt;/i&gt; &lt;/button&gt; &lt;/div&gt;&lt;/form&gt; ä¸»è¦æ³¨æ„ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š form çš„è¯·æ±‚åœ°å€æ˜¯ /login.htmlï¼Œæ–¹æ³•æ˜¯ post ç”¨æˆ·åå’Œå¯†ç çš„å±æ€§å€¼åˆ†åˆ«æ˜¯ username å’Œ password äºŒã€Deep Learning ğŸ¢ä¹‹ç–‘é—®ä¸€ï¼šä¸ºå•¥é»˜è®¤çš„ç™»å½•é¡µé¢å’Œç™»å½•æ¥å£æ˜¯ä¸€æ ·çš„ï¼Ÿè‡ªå®šä¹‰é¡µé¢åˆæ˜¯å¦‚ä½•è¦†ç›–é»˜è®¤é¡µé¢çš„å‘¢ï¼Ÿ é»˜è®¤ç™»å½•é¡µé¢ å…³äºé¡µé¢çš„ç™»å½•çš„é…ç½®éƒ½åœ¨ï¼šFormLoginConfigurer å…¶ä¸­è¿™ä¸ªç±»åˆæ˜¯ç»§æ‰¿ AbstractAuthenticationFilterConfigurer ç±»çš„ åˆ™åœ¨ FormLoginConfigurer åˆå§‹åŒ–çš„æ—¶å€™ï¼ŒAbstractAuthenticationFilterConfigurer çš„æ„é€ æ–¹æ³•ä¸­ï¼š 123protected AbstractAuthenticationFilterConfigurer() &#123; setLoginPage(&quot;/login&quot;);&#125; æ­¤æ—¶å¦‚æœæ²¡æœ‰è‡ªå®šä¹‰ç™»å½•é¡µé¢ï¼Œå°±ä¼šæ˜¯ é¡¹ç›®åœ°å€/login è¿™ä¸ªåœ°å€ å†çœ‹ä¸€ä¸‹ FormLoginConfigurer ä¸­çš„ init æ–¹æ³•ï¼š 1234public void init(H http) throws Exception &#123; super.init(http); initDefaultLoginFilter(http);&#125; è¿™ä¸ªæ–¹æ³•æ˜¯è°ƒç”¨äº†çˆ¶ç±»çš„ init æ–¹æ³•ï¼š 12345public void init(B http) throws Exception &#123; updateAuthenticationDefaults(); updateAccessDefaults(http); registerDefaultAuthenticationEntryPoint(http);&#125; åœ¨çˆ¶ç±»çš„ init æ–¹æ³•ä¸­è°ƒç”¨äº† updateAuthenticationDefaults() æ–¹æ³•ï¼š 123456789101112131415protected final void updateAuthenticationDefaults() &#123; // æœªè‡ªå®šä¹‰é¡µé¢ï¼Œå°±ä¼šå’Œ loginPage åœ°å€ä¸€æ · if (loginProcessingUrl == null) &#123; loginProcessingUrl(loginPage); &#125; if (failureHandler == null) &#123; failureUrl(loginPage + &quot;?error&quot;); &#125; final LogoutConfigurer&lt;B&gt; logoutConfigurer = getBuilder().getConfigurer( LogoutConfigurer.class); if (logoutConfigurer != null &amp;&amp; !logoutConfigurer.isCustomLogoutSuccess()) &#123; logoutConfigurer.logoutSuccessUrl(loginPage + &quot;?logout&quot;); &#125;&#125; æ­¤æ—¶å°±èƒ½çœ‹åˆ°ï¼šå¦‚æœæˆ‘ä»¬æ²¡æœ‰è‡ªå®šä¹‰ç™»å½•æ¥å£ï¼Œé‚£ä¹ˆç™»å½•æ¥å£çš„åœ°å€å°±ä¼šè¢«è®¾ç½®ä¸ºå’Œç™»å½•é¡µé¢ä¸€è‡´ è‡ªå®šä¹‰ç™»å½•é¡µé¢ å¦‚æœè‡ªå®šä¹‰äº†é¡µé¢åœ°å€ï¼Œé¦–å…ˆä¼šåˆ° FormLoginConfigurer ä¸­ 123public FormLoginConfigurer&lt;H&gt; loginPage(String loginPage) &#123; return super.loginPage(loginPage);&#125; åœ¨è¿™é‡Œé¢è°ƒç”¨äº†çˆ¶ç±»çš„ loginPage æ–¹æ³•ï¼š 123456protected T loginPage(String loginPage) &#123; setLoginPage(loginPage); updateAuthenticationDefaults(); this.customLoginPage = true; return getSelf();&#125; å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿™é‡Œé¢ set å®Œ loginPage åï¼ŒåˆåŒè°ƒç”¨äº† updateAuthenticationDefaults() æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨ â˜ï¸ æœ‰ å¦‚æœè‡ªå®šä¹‰äº†ç™»å½•æ¥å£ loginProcessingUrl ï¼Œé‚£ä¹ˆå°±ä¼šè¿›å…¥è¿™ä¸ªæ–¹æ³•ï¼š 123456public T loginProcessingUrl(String loginProcessingUrl) &#123; this.loginProcessingUrl = loginProcessingUrl; authFilter .setRequiresAuthenticationRequestMatcher(createLoginProcessingUrlMatcher(loginProcessingUrl)); return getSelf();&#125; ğŸ¢ä¹‹ç–‘é—®äºŒï¼šåœ¨æäº¤çš„è¡¨å•ä¸­ï¼Œå‚æ•°åˆ†åˆ«ä¸º username å’Œ passwordï¼Œå¯ä¸å¯ä»¥è‡ªå®šä¹‰å‘¢ï¼Ÿ é¦–å…ˆè¿˜æ˜¯å» FormLoginConfigurer ç±»ä¸­çœ‹çœ‹æ„é€ æ–¹æ³•ï¼š 12345public FormLoginConfigurer() &#123; super(new UsernamePasswordAuthenticationFilter(), null); usernameParameter(&quot;username&quot;); passwordParameter(&quot;password&quot;);&#125; è¿™é‡Œçš„ super æ ¹æ® ğŸ‘† çš„ç»§æ‰¿å…³ç³»ï¼Œå°±å¯ä»¥çŸ¥é“æ˜¯ AbstractAuthenticationFilterConfigurer ä¸­çš„æ„é€ ï¼š 123456789protected AbstractAuthenticationFilterConfigurer(F authenticationFilter, String defaultLoginProcessingUrl) &#123; this(); // å°†ä¼ è¿›æ¥çš„å‚æ•°èµ‹å€¼ç»™è¿™ä¸ªç±»çš„ authFilter this.authFilter = authenticationFilter; if (defaultLoginProcessingUrl != null) &#123; loginProcessingUrl(defaultLoginProcessingUrl); &#125;&#125; æ³¨ï¼šè¿™é‡Œä¸ºä»€ä¹ˆèƒ½ä¼ å‚ï¼Œæ˜¯ç”±äº UsernamePasswordAuthenticationFilter ç»§æ‰¿ AbstractAuthenticationProcessingFilter ä¸” F extends AbstractAuthenticationProcessingFilter æ­¤æ—¶å·²ç»æœ‰äº† UsernamePasswordAuthenticationFilter çš„å®ä¾‹äº†ï¼Œæ¥ç€æ‰§è¡Œ usernameParameter å’Œ passwordParameter æ–¹æ³•ï¼š 123456789public FormLoginConfigurer&lt;H&gt; usernameParameter(String usernameParameter) &#123; getAuthenticationFilter().setUsernameParameter(usernameParameter); return this;&#125;public FormLoginConfigurer&lt;H&gt; passwordParameter(String passwordParameter) &#123; getAuthenticationFilter().setPasswordParameter(passwordParameter); return this;&#125; è¿™é‡Œçš„ getAuthenticationFilter æ˜¯çˆ¶ç±»çš„æ–¹æ³•ï¼š 123protected final F getAuthenticationFilter() &#123; return authFilter;&#125; åˆ°è¿™é‡Œå°±å¾ˆæ˜ç¡®äº†ï¼Œå°±æ˜¯å°†åˆšæ‰çš„ new UsernamePasswordAuthenticationFilter() æ”¾åˆ°è¿™é‡Œé¢åˆ†åˆ«è°ƒç”¨ setUsernameParameter å’Œ setPasswordParameter æ–¹æ³•ï¼š 123456789public void setUsernameParameter(String usernameParameter) &#123; Assert.hasText(usernameParameter, &quot;Username parameter must not be empty or null&quot;); this.usernameParameter = usernameParameter;&#125;public void setPasswordParameter(String passwordParameter) &#123; Assert.hasText(passwordParameter, &quot;Password parameter must not be empty or null&quot;); this.passwordParameter = passwordParameter;&#125; åˆ°è¿™é‡Œï¼ŒusernameParameter å’Œ passwordParameter å°±å·²ç»è¢«èµ‹å¥½å€¼äº† å†é€šè¿‡è¿™ä¸ªç±» (UsernamePasswordAuthenticationFilter) ä¸­çš„è¿™ä¸¤ä¸ªæ–¹æ³•ä»ç™»å½•è¯·æ±‚ä¸­æ‹¿åˆ°è¿™ä¸¤ä¸ªå€¼ï¼š 123456789@Nullableprotected String obtainPassword(HttpServletRequest request) &#123; return request.getParameter(this.passwordParameter);&#125;@Nullableprotected String obtainUsername(HttpServletRequest request) &#123; return request.getParameter(this.usernameParameter);&#125; é‚£ä¹ˆè‡ªå®šä¹‰å°±å¾ˆç®€å•äº†ï¼š 1234567891011121314@Overrideprotected void configure(HttpSecurity http) throws Exception &#123; http.authorizeRequests() .anyRequest().authenticated() .and() .formLogin().loginPage(&quot;/login.html&quot;) // åªéœ€è¦è®¾ç½®ä»¥ä¸‹ä¸¤é¡¹å°±è¡Œ .usernameParameter(&quot;user&quot;) .passwordParameter(&quot;pwd&quot;) .permitAll() .and() .csrf().disable() ;&#125; ğŸ¢ä¹‹ç–‘é—®ä¸‰ï¼šç™»å½•æˆåŠŸ or å¤±è´¥åçš„é‡å®šå‘çš„åœ°å€ï¼Œæ³¨é”€ç™»å½•çš„åœ°å€å¦‚ä½•è‡ªå®šä¹‰ï¼Ÿ ç™»å½•æˆåŠŸ ç™»å½•å¤±è´¥ defaultSuccessUrl failureForwardUrl successForwardUrl failureUrl åŒºåˆ«ç®€å•æ¥è¯´å°±æ˜¯ï¼š defaultSuccessUrl å¯èƒ½ä½ è®¿é—®çš„åœ°å€æ˜¯ http://localhost:8080/security ä½†æ˜¯ä½ æ²¡ç™»å½•ï¼Œæ‰€ä»¥ä½ å°±è·³è½¬åˆ° http://localhost:8080/login é¡µé¢ä¸‹ï¼Œå¦‚æœä½ ç™»å½•æˆåŠŸï¼Œé‚£ä¹ˆå°±ä¼šå›åˆ° /security é¡µé¢ successForwardUrl ä¸ç®¡æ˜¯ä»€ä¹ˆé¡µé¢ï¼Œç™»å½•æˆåŠŸä¸€å¾‹æ˜¯ä½ è®¾ç½®çš„é¡µé¢ ç™»å½•å¤±è´¥åŒç† æ³¨é”€ç™»å½• çœ‹ä¸‹é¢çš„ä»£ç  logoutUrlï¼šç”¨æ¥æ³¨é”€çš„åœ°å€ï¼Œé»˜è®¤ä¸º â€œ/logoutâ€ logoutRequestMatcherï¼šæ”¹å˜æ³¨é”€åœ°å€ï¼Œè¿˜æœ‰è¯·æ±‚æ–¹å¼ logoutSuccessUrlï¼šæ³¨é”€ç™»å½•æˆåŠŸåï¼Œè¦è·³è½¬çš„åœ°å€ 12345678910111213141516171819202122232425262728293031@Overrideprotected void configure(HttpSecurity http) throws Exception &#123; http.authorizeRequests() .anyRequest().authenticated() .and() // æ³¨é”€ç™»å½•è®¾ç½® .logout() .logoutUrl(&quot;&quot;) .logoutRequestMatcher(new AntPathRequestMatcher(&quot;/logout&quot;,&quot;POST&quot;)) .logoutSuccessUrl(&quot;&quot;) // ç™»å½•è®¾ç½® .and() .formLogin().loginPage(&quot;/login.html&quot;) .usernameParameter(&quot;user&quot;) .passwordParameter(&quot;pwd&quot;) // ä¸‹é¢ä¸¤ä¸ªåªéœ€è¦ä¸€ä¸ª .defaultSuccessUrl(&quot;&quot;) .successForwardUrl(&quot;&quot;) // ä¸‹é¢ä¸¤ä¸ªåªéœ€è¦ä¸€ä¸ª .failureForwardUrl(&quot;&quot;) .failureUrl(&quot;&quot;) .permitAll() .and() .csrf().disable() ;&#125;","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Spring Security","slug":"Spring-Security","permalink":"http://wangba.me/tags/Spring-Security/"}]},{"title":"SpringBootæ•´åˆSpring Security (ä¸€)","slug":"SpringBootæ•´åˆSpring-Security-ä¸€","date":"2020-09-27T10:52:23.000Z","updated":"2020-09-30T07:09:23.777Z","comments":true,"path":"2020/09/27/SpringBootæ•´åˆSpring-Security-ä¸€/","link":"","permalink":"http://wangba.me/2020/09/27/SpringBoot%E6%95%B4%E5%90%88Spring-Security-%E4%B8%80/","excerpt":"","text":"ä¸€ã€OverViewJava ä¸­æƒé™ç®¡ç†æœ€å¸¸ç”¨çš„æŠ€æœ¯åº”è¯¥å°±æ˜¯ï¼šSpring Security å’Œ Shiroã€‚ è™½ç„¶ Shiro ç”¨å®ƒè½»é‡ã€ç®€å•ã€æ˜“äºé›†æˆå æ®ä¸€å¸­ä¹‹åœ°ï¼Œä½†éšç€ SpringBoot çš„æµè¡Œï¼ŒSpring Security ä¹Ÿè·Ÿç€é¸¡çŠ¬å‡å¤©ï¼Œå°±ç›®å‰çš„è¶‹åŠ¿æ¥çœ‹ï¼ŒSpring Security ç»“åˆ Oauth2ã€JWT ç­‰æ›´åŠ æ–¹ä¾¿ã€‚ è¿™æ¬¡å…ˆå°è¯•ç‰›åˆ€ä¸€ä¸‹ï¼Œå¿«é€Ÿå…¥é—¨â€¦â€¦ äºŒã€Environmentä¸æƒ³ error ï¼Œå…ˆçœ‹ä¾èµ– æ²¡çœ‹é”™ï¼Œå°±åªéœ€è¦è¿™ä¸¤ä¸ªä¾èµ–å°±è¡Œ pom.xml 12345678910&lt;!--security--&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;&lt;/dependency&gt;&lt;!--web--&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt; SecurityController 12345678@RestControllerpublic class SecurityController &#123; @GetMapping(&quot;/security&quot;) public String hello() &#123; return &quot;spring security&quot;; &#125;&#125; ä¸‰ã€Testå¯åŠ¨é¡¹ç›®å¯ä»¥çœ‹è§ï¼Œåœ¨æ§åˆ¶å°å¤šäº†ä¸€è¡Œï¼š Postman å¯ä»¥çœ‹è§æŠ¥é”™ï¼š401ï¼Œæ²¡æœ‰è¿›è¡Œè®¤è¯ åŠ ä¸Šè®¤è¯ å¯ä»¥çœ‹è§ï¼ŒåŠ ä¸Š Basic Authï¼š å…¶ä¸­ç”¨æˆ·åä¸º userï¼Œå¯†ç ä¸ºåˆšæ‰æ§åˆ¶å°æ˜¾ç¤ºçš„å³å¯ å››ã€Deep LearningğŸ¢ä¹‹ç–‘é—®ï¼šä¸ºå•¥ç”¨æˆ·åæ˜¯ userï¼Œå¯†ç å°±æ˜¯æ§åˆ¶å°æ˜¾ç¤ºçš„é‚£ä¸ªï¼Ÿ åˆ†ææ€è·¯ï¼š ç”¨æˆ·åå’Œå¯†ç è‚¯å®šåœ¨ä¸€èµ·ï¼Œè¿™ä¸ªå¯†ç åˆæ˜¯ UUID å½¢å¼ï¼ŒæŸä¸ªåœ°æ–¹è‚¯å®šç”¨äº† UUID.randomUUID().toString() æŒ‰ç…§æˆ‘ä»¬å¯¹ SpringBoot çš„ç‰¹æ€§ï¼Œè‚¯å®šåœ¨ XXXAutoConfiguration å’Œ XXXProperties ä¸­å­˜åœ¨ï¼Œæœç„¶åœ¨ SecurityProperties ä¸­çœ‹åˆ°äº†ï¼š æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦å»æ‰¾ä¸€æ‰¾ï¼Œåœ¨å“ªé‡Œæœ‰è°ƒç”¨ getPassword çš„è¿™ä¸ªæ–¹æ³•çš„ç±»ï¼š çœ‹åå­—åº”è¯¥å°±æ˜¯ï¼šUserDetailsServiceAutoConfiguration 12345678910private String getOrDeducePassword(SecurityProperties.User user, PasswordEncoder encoder) &#123; String password = user.getPassword(); if (user.isPasswordGenerated()) &#123; logger.info(String.format(&quot;%n%nUsing generated security password: %s%n&quot;, user.getPassword())); &#125; if (encoder != null || PASSWORD_ALGORITHM_PATTERN.matcher(password).matches()) &#123; return password; &#125; return NOOP_PASSWORD_PREFIX + password;&#125; å…¶ä¸­ï¼š user.isPasswordGenerated() å¦‚æœä¸º trueï¼Œåˆ™æ‰“å°è¯¥ä¿¡æ¯ å†å» ==user.isPasswordGenerated()== æ–¹æ³•ä¸­æ¢ç©¶ä¸€ä¸‹ï¼Œå›åˆ°äº†==SecurityProperties== ç±»ä¸­äº†ï¼š 1234567private boolean passwordGenerated = true; .......public boolean isPasswordGenerated() &#123; return this.passwordGenerated;&#125; é»˜è®¤æƒ…å†µä¸‹ï¼špasswordGenerated å°±æ˜¯ä¸º true ğŸ¢ä¹‹ç–‘é—®ï¼šæ¯æ¬¡å¯åŠ¨éƒ½è¦è¾“å…¥æ–°çš„çš„å¯†ç ï¼Œå¤ªéº»çƒ¦äº†ï¼Œæˆ‘éœ€è¦è‡ªå®šä¹‰ ç¬¬ä¸€ç§æ–¹æ³•ï¼š æŒ‰ç…§ SpringBoot çš„ç‰¹æ€§ï¼Œå¿…ç„¶å·²ç»ç»™ä½ å®‰æ’å¥½äº†ï¼Œè‚¯å®šæœ‰ä¸€ç§æ–¹æ³•æ˜¯åœ¨ properties æ–‡ä»¶ä¸­ç›´æ¥è¿›è¡Œï¼š idea å·²ç»é€šè¿‡æç¤ºæ˜¾ç¤ºå‡ºæ¥äº†, idea yyds ! ç›´æ¥ç‚¹è¿›å»çœ‹ä¸€ä¸‹ï¼Œå›è·³åˆ°å“ªä¸ªç±»ä¸­ï¼Œä¸å‡ºğŸ¢ğŸ¢çš„æ‰€æ–™ï¼Œåº”è¯¥å°±æ˜¯ ==SecurityProperties== ç±»ä¸­ï¼š æœä¸å…¶ç„¶ï¼Œåˆ†åˆ«è·³åˆ°äº† setName 123public void setName(String name) &#123; this.name = name;&#125; setPassword 1234567public void setPassword(String password) &#123; if (!StringUtils.hasLength(password)) &#123; return; &#125; this.passwordGenerated = false; this.password = password;&#125; æ³¨ï¼šå¦‚æœåœ¨è¿™é‡Œè‡ªå®šä¹‰äº†å¯†ç ï¼Œå°±ä¼šå°† ==passwordGenerated== è®¾ç½®ä¸º falseï¼Œé‚£ä¹ˆåœ¨ ==isPasswordGenerated== å°±æ˜¯ false äº†ï¼Œåœ¨ ==UserDetailsServiceAutoConfiguration== ä¸­å°±ä¸ä¼šè‡ªåŠ¨ç”Ÿæˆå¯†ç äº† application.properties 12spring.security.user.name=wangbaspring.security.user.password=8888 ç¬¬äºŒç§æ–¹æ³•ï¼š 123456789101112131415161718@Configurationpublic class SecurityConfig extends WebSecurityConfigurerAdapter &#123; @Bean PasswordEncoder passwordEncoder() &#123; // ä¸å¯¹å¯†ç è¿›è¡Œä»»ä½•ç¼–ç æ–¹å¼ return NoOpPasswordEncoder.getInstance(); &#125; @Override protected void configure(AuthenticationManagerBuilder auth) throws Exception &#123; auth.inMemoryAuthentication() .withUser(&quot;wangba&quot;) .password(&quot;guigui&quot;) .roles(&quot;admin&quot;) ; &#125;&#125;","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Spring Security","slug":"Spring-Security","permalink":"http://wangba.me/tags/Spring-Security/"}]},{"title":"SpringBootæ•´åˆSession","slug":"SpringBootæ•´åˆSession","date":"2020-09-22T13:43:13.000Z","updated":"2020-09-30T07:09:20.959Z","comments":true,"path":"2020/09/22/SpringBootæ•´åˆSession/","link":"","permalink":"http://wangba.me/2020/09/22/SpringBoot%E6%95%B4%E5%90%88Session/","excerpt":"","text":"ä¸€ã€OverView Spring Session has the simple goal of free up session management from the limitations of the HTTP session stored in the server. The solution makes it easy to share session data between services in the cloud without being tied to a single container (i.e. Tomcat). Additionally, it supports multiple sessions in the same browser and sending sessions in a header. ç®€å•åœ°æ¥è¯´ï¼šç”±æ¶æ„å¯¼è‡´äº†è¿™ç§æƒ…å†µçš„å‘ç”Ÿ present æœ€æ—©çš„æ¶æ„å°±æ˜¯å¾ˆç®€å•çš„å•æœåŠ¡å™¨çŠ¶æ€ï¼Œå¦‚æœæˆ‘ä»¬è¦ä¿å­˜ç”¨æˆ·çŠ¶æ€ï¼Œé‚£ä¹ˆåªéœ€è¦ä¸€ä¸ª session å°±è¡Œäº† now ç°åœ¨çš„æ¶æ„éƒ½æ˜¯é›†ç¾¤å¼äº†ï¼šå¯ä»¥å‡è®¾è¿™æ ·çš„æƒ…æ™¯ï¼Œå¦‚æœæˆ‘åœ¨å·²ç»ç™»å½•çš„çŠ¶æ€ï¼Œæˆ‘é¦–å…ˆè¦çœ‹è§†é¢‘ (è¿™ä¸ªæœåŠ¡å‡å¦‚åœ¨ A æœåŠ¡å™¨ä¸Š)ï¼Œç„¶åæˆ‘åˆæµè§ˆå›¾ç‰‡ (è¿™ä¸ªæœåŠ¡å‡å¦‚åœ¨ B æœåŠ¡å™¨ä¸Š)ï¼Œå¦‚æœä¸å…±äº« session çš„è¯ï¼Œé‚£ä¹ˆæˆ‘é€‰æ‹©çš„æœåŠ¡ä¸åœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸Šå°±è¦é‡æ–°ç™»å½•äº†ï¼Œè¿™å¯¹ç”¨æˆ·ä¹Ÿå¤ªä¸å‹å¥½äº†ã€‚ è§£å†³æ–¹æ¡ˆ ä¸»æµçš„è§£å†³æ–¹æ¡ˆï¼šå°† seesion å­˜åˆ° redis ä¸­ï¼Œæ¯æ¬¡ server è¦å‘ session ä¸­å†™æ•°æ®ï¼Œæˆ–è€…è¦è¯» session çš„æ•°æ®æ—¶ï¼Œéƒ½æ˜¯å¯¹ redis ä¸­çš„ session è¿›è¡Œæ“ä½œã€‚ äºŒã€ç¯å¢ƒæ­å»ºä¸æƒ³ error ï¼Œå…ˆçœ‹ä¾èµ– pom.xml 123456789101112131415&lt;!--redis--&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;&lt;/dependency&gt;&lt;!--web--&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt;&lt;!--spring session--&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.session&lt;/groupId&gt; &lt;artifactId&gt;spring-session-data-redis&lt;/artifactId&gt;&lt;/dependency&gt; application.properties 1234567891011# redis åŸºæœ¬é…ç½®# åœ°å€spring.redis.host=10.2.10.115# ç«¯å£å· é»˜è®¤å°±æ˜¯ 6379spring.redis.port=6379# å¯†ç spring.redis.password=123456# ç¬¬å‡ ä¸ªæ•°æ®åº“ é»˜è®¤å°±æ˜¯ç¬¬0å·æ•°æ®åº“spring.redis.database=0server.port=8080 SessionController 1234567891011121314151617@RestControllerpublic class SessionController &#123; @Value(&quot;$&#123;server.port&#125;&quot;) Integer port; @GetMapping(&quot;/set&quot;) public String set(HttpSession session) &#123; session.setAttribute(&quot;wangba&quot;, &quot;8888&quot;); return String.valueOf(port); &#125; @GetMapping(&quot;/get&quot;) public String get(HttpSession session) &#123; return session.getAttribute(&quot;user&quot;) + &quot;:&quot; + port; &#125;&#125; ä¸‰ã€æµ‹è¯•è®¿é—®ï¼šhttp://localhost:8080/set æ­¤æ—¶æ‰“å¼€ redis çœ‹ä¸€ä¸‹ï¼š å†è®¿é—®ï¼šhttp://localhost:8081/get å¯ä»¥çœ‹åˆ°æ­¤æ—¶ï¼Œåœ¨ä¸åŒçš„æœåŠ¡ä¸Šå¯ä»¥é€šè¿‡å…±äº« session æ³¨ï¼šè¿™è¾¹å¯ä»¥é€šè¿‡ nginx è¿›è¡Œè´Ÿè½½å‡è¡¡","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Session","slug":"Session","permalink":"http://wangba.me/tags/Session/"}]},{"title":"SpringBootæ•´åˆRedis","slug":"SpringBootæ•´åˆRedis","date":"2020-09-16T13:34:57.000Z","updated":"2020-09-30T07:09:18.512Z","comments":true,"path":"2020/09/16/SpringBootæ•´åˆRedis/","link":"","permalink":"http://wangba.me/2020/09/16/SpringBoot%E6%95%B4%E5%90%88Redis/","excerpt":"","text":"ä¸€ã€OverViewé¢è¯•å®˜ï¼šredis çŸ¥é“å— ğŸ¢ï¼šä¸çŸ¥é“ é¢è¯•å®˜ï¼šä½ å›å»ç­‰é€šçŸ¥å§ Redisæ˜¯ä¸€ä¸ªä½¿ç”¨ANSI Cç¼–å†™çš„å¼€æºã€æ”¯æŒç½‘ç»œã€åŸºäºå†…å­˜ã€å¯é€‰æŒä¹…æ€§çš„é”®å€¼å¯¹å­˜å‚¨æ•°æ®åº“ã€‚ä»2015å¹´6æœˆå¼€å§‹ï¼ŒRedisçš„å¼€å‘ç”±Redis LabsèµåŠ©ï¼Œè€Œ2013å¹´5æœˆè‡³2015å¹´6æœˆæœŸé—´ï¼Œå…¶å¼€å‘ç”±PivotalèµåŠ©ã€‚åœ¨2013å¹´5æœˆä¹‹å‰ï¼Œå…¶å¼€å‘ç”±VMwareèµåŠ©ã€‚https://zh.wikipedia.org/wiki/Redis#cite_note-5)æ ¹æ®æœˆåº¦æ’è¡Œç½‘ç«™DB-Engines.comçš„æ•°æ®ï¼ŒRedisæ˜¯æœ€æµè¡Œçš„é”®å€¼å¯¹å­˜å‚¨æ•°æ®åº“ã€‚ â€”â€”â€“ç»´åŸºç™¾ç§‘ æˆ‘è®°å¾—æˆ‘çœ‹è¿‡ä¸€ç¯‡è®²çš„éå¸¸å¥½çš„ NoSQL çš„æ–‡ç« ï¼Œä¸‹æ¬¡æ‰¾åˆ°åŠ è¿›æ¥ã€‚ å¢åŠ ï¼šå…³ç³»å‹æ•°æ®åº“ä¸éå…³ç³»å‹æ•°æ®åº“ äºŒã€ç¯å¢ƒæ­å»ºRedis é¦–å…ˆå‡†å¤‡å¥½ redis çš„ç¯å¢ƒï¼Œæ­¤æ¬¡ redis æ˜¯å®‰è£…åœ¨ Ubuntu 18.04 ä¸Šçš„ï¼Œä¸»è¦é…ç½®å¦‚ä¸‹ï¼š å¯ä»¥ä½¿ç”¨ sudo vi /etc/redis/redis.conf å‘½ä»¤ï¼š 123456789101112131415# è¯¥æŒ‡ä»¤å…è®¸æ‚¨å£°æ˜ä¸€ä¸ªinitç³»ç»Ÿæ¥ç®¡ç†Redisä½œä¸ºæœåŠ¡ï¼Œä»è€Œä¸ºæ‚¨æä¾›å¯¹å…¶æ“ä½œçš„æ›´å¤šæ§åˆ¶supervised systemd# ä¸ºäº†å±€åŸŸç½‘èƒ½è¿æ¥ä¸Šbind 127.0.0.1 ::1 æ”¹ä¸ºbind 0.0.0.0# ä¸ºäº†å±€åŸŸç½‘èƒ½è¿æ¥ä¸Šprotected-mode yes æ”¹ä¸ºprotected-mode no# ä¿®æ”¹å¯†ç ï¼Œéå¿…é¡»requirepass 123456 å¸¸ç”¨å‘½ä»¤ï¼š 1234567891011121314151617181920# ä¿®æ”¹ redis é…ç½®sudo vi /etc/redis/redis.conf# é‡å¯ redis æœåŠ¡sudo service redis restart# å¯åŠ¨ redis æœåŠ¡sudo service redis start# å…³é—­ redis æœåŠ¡sudo service redis stop# å¯åŠ¨ redis å®¢æˆ·ç«¯ï¼Œå…¶ä¸­ -p æŒ‡å®šç«¯å£ï¼Œ-a è¡¨ç¤ºè®¤è¯å³å¯†ç redis-cli -p 6379 -a 123456# åœ¨ redis é‡Œé¢çš„ä¸€äº›å‘½ä»¤127.0.0.1:6379&gt; pingPONG127.0.0.1:6379&gt; keys *127.0.0.1:6379&gt; get keyçš„åå­— pom.xml 12345678&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt; application.properties 123456789# redis åŸºæœ¬é…ç½®# åœ°å€spring.redis.host=10.2.10.108# ç«¯å£å· é»˜è®¤å°±æ˜¯ 6379spring.redis.port=6379# å¯†ç spring.redis.password=123456# ç¬¬å‡ ä¸ªæ•°æ®åº“ é»˜è®¤å°±æ˜¯ç¬¬0å·æ•°æ®åº“spring.redis.database=0 ä¸‰ã€æµ‹è¯•RedisController 12345678910111213141516171819202122@RestControllerpublic class RedisController &#123; private StringRedisTemplate stringRedisTemplate; @Autowired public void setStringRedisTemplate(StringRedisTemplate stringRedisTemplate) &#123; this.stringRedisTemplate = stringRedisTemplate; &#125; @GetMapping(&quot;/put&quot;) public void test1(String key, String value) &#123; ValueOperations&lt;String, String&gt; ops = stringRedisTemplate.opsForValue(); ops.set(key, value); &#125; @GetMapping(&quot;/get&quot;) public String test2(String key) &#123; ValueOperations&lt;String, String&gt; ops = stringRedisTemplate.opsForValue(); return ops.get(key); &#125;&#125; Postman é¦–å…ˆå°† redis æ¸…ç©ºï¼š æ’å…¥ï¼š çœ‹ä¸‹ redis ä¸­ï¼š æŸ¥è¯¢ï¼š","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"},{"name":"NoSQL","slug":"NoSQL","permalink":"http://wangba.me/tags/NoSQL/"}]},{"title":"é“æ°ç‹æœæ»¡æ±‰å…¨å¸­ 919","slug":"é“æ°ç‹æœæ»¡æ±‰å…¨å¸­-919","date":"2020-09-15T13:23:00.000Z","updated":"2020-09-30T07:09:13.230Z","comments":true,"path":"2020/09/15/é“æ°ç‹æœæ»¡æ±‰å…¨å¸­-919/","link":"","permalink":"http://wangba.me/2020/09/15/%E9%93%81%E6%B0%8F%E7%8E%8B%E6%9C%9D%E6%BB%A1%E6%B1%89%E5%85%A8%E5%B8%AD-919/","excerpt":"","text":"919 é“æ°ç‹æœæ»¡æ±‰å…¨å¸­ v1.3 æ¸…è’¸å¤§é—¸èŸ¹ 5åª ææ–™ï¼š é˜³æ¾„æ¹–å¤§é—¸èŸ¹ ç”Ÿå§œ è’œç“£ é¦™è‘± ç´«è‹ ç”ŸæŠ½ é¦™é†‹ æ–™é…’ é¦™æ²¹ é¸¡ç²¾ ç³– å¯ä¹é¸¡ç¿… ææ–™ï¼š é¸¡ç¿…10ä¸ª å¯ä¹300æ¯«å‡ è€æŠ½1å‹º ç›ï¼Œé¸¡ç²¾é€‚é‡ è‘±å§œï¼Œå…«è§’é€‚é‡ ç³–é†‹æ’éª¨ ææ–™ï¼š çŒªè‚‹æ’500å…‹ è‘±é€‚é‡ å§œé€‚é‡ å…«è§’2ä¸ª è€æŠ½2å‹º ç”ŸæŠ½2å‹º ç™½ç³–3å‹º é¦™é†‹4å‹º æ–™é…’5å‹º ç†Ÿç™½èŠéº»é€‚é‡ éº»è¾£å°é¾™è™¾ ææ–™ï¼š å°é¾™è™¾30æ–¤ é¦™è‘±é€‚é‡ å§œé€‚é‡ è’œé€‚é‡ å¤§è‘±é€‚é‡ æ¡‚çš®é€‚é‡ å…«è§’é€‚é‡ é¦™å¶é€‚é‡ ç´«è‹é€‚é‡ å°ç±³æ¤’é€‚é‡ å†°ç³–é€‚é‡ è—•æ¡é€‚é‡ é’æ¤’é€‚é‡ çº¢æ²¹ç«é”…åº•æ–™é€‚é‡ è±†ç“£é…±é€‚é‡ æ·€ç²‰é€‚é‡ ç™½èŠéº»é€‚é‡ èŠå£«åŸ¹æ ¹æ³¡èœå· ææ–™ï¼š è’œè“‰é‡‘é’ˆè‡ ææ–™ï¼š é‡‘é’ˆè‡1æŠŠ è’œä¸€å¤´ é£Ÿç”¨æ²¹é€‚é‡ é…±æ²¹4å‹º èšæ²¹2å‹º å°è‘±4æ ¹ é¸¡ç²¾é€‚é‡ ç³– ç› é…’é…¿å°æ±¤åœ†å†²é¸¡è›‹ ææ–™ï¼š å§œæ’å¥¶ ææ–™ï¼š è€å§œ1å¤§å— çº¯ç‰›å¥¶200æ¯«å‡ ç»†ç ‚ç³–é€‚é‡ è”“è¶Šè“å¹²å°‘è®¸","categories":[{"name":"WangBa's CookBook","slug":"WangBa-s-CookBook","permalink":"http://wangba.me/categories/WangBa-s-CookBook/"}],"tags":[{"name":"CookBook","slug":"CookBook","permalink":"http://wangba.me/tags/CookBook/"},{"name":"Life","slug":"Life","permalink":"http://wangba.me/tags/Life/"}]},{"title":"SpringBootæ•´åˆSpring Data JPA ä¹‹å¤šæ¡ä»¶æœç´¢å·¥å…·ç±»","slug":"SpringBootæ•´åˆSpring-Data-JPA-ä¹‹å¤šæ¡ä»¶æœç´¢å·¥å…·ç±»","date":"2020-09-14T12:21:20.000Z","updated":"2020-09-30T07:08:37.925Z","comments":true,"path":"2020/09/14/SpringBootæ•´åˆSpring-Data-JPA-ä¹‹å¤šæ¡ä»¶æœç´¢å·¥å…·ç±»/","link":"","permalink":"http://wangba.me/2020/09/14/SpringBoot%E6%95%B4%E5%90%88Spring-Data-JPA-%E4%B9%8B%E5%A4%9A%E6%9D%A1%E4%BB%B6%E6%90%9C%E7%B4%A2%E5%B7%A5%E5%85%B7%E7%B1%BB/","excerpt":"","text":"ä¸€ã€OverViewâ€‹ åœ¨å‰é¢å·²ç»ä»‹ç»è¿‡äº† SpringBoot æ•´åˆ JPA äº†ï¼Œä½†æ˜¯ä¸€èˆ¬åœ¨å…¬å¸ä¸šåŠ¡ä¸­ï¼Œå¦‚æœå‡ºç°å¾ˆå¤šæ¬¡å¤šæ¡ä»¶æœç´¢æŸ¥è¯¢çš„æƒ…å†µï¼Œé‚£ä¹ˆå°±ä¼šç”¨å¤§é‡å†—ä½™ä»£ç äº†ï¼›å†ç»“åˆæ³¨è§£çš„æ€æƒ³ã€‚æœ¬æ¬¡å°†å…¬å…±éƒ¨åˆ†æå–å‡ºæ¥ï¼Œå¹¶ç”¨æ³¨è§£çš„æ–¹å¼è¿›è¡Œæ“ä½œï¼Œå¯ä»¥å‚è€ƒå‰é¢ä½¿ç”¨æ³¨è§£è¿›è¡Œ AOP å¤„ç†æ—¥å¿—ï¼Œä¹Ÿç¬¦åˆäº† SpringBoot çš„æ€æƒ³ã€‚ äºŒã€BaseQueryQueryWord 12345678910111213141516171819@Target(ElementType.FIELD)@Retention(RetentionPolicy.RUNTIME)public @interface QueryWord &#123; // æ•°æ®åº“ä¸­å­—æ®µå,é»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²,åˆ™Queryç±»ä¸­çš„å­—æ®µè¦ä¸æ•°æ®åº“ä¸­å­—æ®µä¸€è‡´ String column() default &quot;&quot;; // equal, like, gt, lt... MatchType func() default MatchType.equal; // objectæ˜¯å¦å¯ä»¥ä¸ºnull boolean nullable() default false; // å­—ç¬¦ä¸²æ˜¯å¦å¯ä¸ºç©º boolean empty() default false; // between...and... æŸ¥è¯¢è¯­å¥æ ‡è¯†ï¼Œ 0æ—¶é—´ 1æ•°å­—ç±»å‹ BetweenType type() default BetweenType.datetime;&#125; æ³¨ï¼šæ³¨è§£ç±»ï¼Œåªè¦åœ¨è¦æŸ¥è¯¢çš„å±æ€§ä¸ŠåŠ ä¸Šç›¸åº”çš„æ³¨è§£å³å¯ MatchType 12345678910111213141516171819202122public enum MatchType &#123; equal, // filed = value // ä¸‹é¢å››ä¸ªç”¨äºNumberç±»å‹çš„æ¯”è¾ƒ gt, // filed &gt; value ge, // field &gt;= value lt, // field &lt; value le, // field &lt;= value notEqual, // field != value like, // field like value notLike, // field not like value between, // between value1 and value2 ,Type is Date // ä¸‹é¢å››ä¸ªç”¨äºå¯æ¯”è¾ƒç±»å‹(Comparable)çš„æ¯”è¾ƒ greaterThan, // field &gt; value greaterThanOrEqualTo, // field &gt;= value lessThan, // field &lt; value lessThanOrEqualTo // field &lt;= value&#125; æ³¨ï¼šæšä¸¾ç±»ï¼Œå¯ä»¥å¯¹æ¯”æ³¨é‡Šè¿›è¡Œç†è§£ BetweenType 1234567public enum BetweenType &#123; datetime, number_long, number_integer&#125; æ³¨ï¼šå¯¹åº”ä¸Šé¢ QueryWordä¸­çš„ BetweenType ï¼Œå¯ä»¥å¯¹æ—¶é—´æˆ–æ•°å­—ä¹‹é—´çš„å±æ€§è¿›è¡Œæ³¨è§£ BaseQuery 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189public abstract class BaseQuery&lt;T&gt; &#123; // ç¬¬å¤šå°‘é¡µ + é¡µå¤§å° private int pageNum = 0; private int pageSize = 10; // private static Map&lt;Class, List&lt;Field&gt;&gt; fieldCache = new HashMap&lt;&gt;(); // åŠ¨æ€æŸ¥è¯¢ public abstract Specification&lt;T&gt; toSpec(); // åˆ†é¡µ public Pageable toPageable() &#123; return PageRequest.of(pageNum, pageSize); &#125; // åˆ†é¡µ + æ’åº public Pageable toPageable(Sort sort) &#123; return PageRequest.of(pageNum, pageSize, sort); &#125; // åŠ¨æ€æŸ¥è¯¢ and è¿æ¥ protected Specification&lt;T&gt; toSpecWithAnd() &#123; return this.toSpecWithLogicType(&quot;and&quot;); &#125; // åŠ¨æ€æŸ¥è¯¢ or è¿æ¥ protected Specification&lt;T&gt; toSpecWithOr() &#123; return this.toSpecWithLogicType(&quot;or&quot;); &#125; // logicType = or ï½œ and @SuppressWarnings(&#123; &quot;rawtypes&quot;, &quot;unchecked&quot; &#125;) private Specification&lt;T&gt; toSpecWithLogicType(final String logicType) &#123; final BaseQuery outerThis = this; // å°è£…æ¡ä»¶æŸ¥è¯¢å¯¹è±¡ Specification Specification&lt;T&gt; specification = new Specification&lt;T&gt;() &#123; @Override // Root ç”¨äºè·å–å±æ€§å­—æ®µï¼ŒCriteriaQueryå¯ä»¥ç”¨äºç®€å•æ¡ä»¶æŸ¥è¯¢ï¼ŒCriteriaBuilder ç”¨äºæ„é€ å¤æ‚æ¡ä»¶æŸ¥è¯¢ public Predicate toPredicate(Root&lt;T&gt; root, CriteriaQuery&lt;?&gt; query, CriteriaBuilder cb) &#123; Class clazz = outerThis.getClass(); // åˆ¤æ–­ç¼“å­˜ä¸­æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œå­˜åœ¨ä¸éœ€è¦å†æ¬¡ç”Ÿæˆï¼Œä¸å­˜åœ¨éœ€è¦é‡æ–°ç”Ÿæˆ List&lt;Field&gt; fields = fieldCache.get(clazz); if (fields == null) &#123; // è·å–æŸ¥è¯¢ç±»Queryçš„æ‰€æœ‰å­—æ®µ,åŒ…æ‹¬çˆ¶ç±»å­—æ®µ fields = getAllFieldsWithRoot(clazz); fieldCache.put(clazz, fields); &#125; List&lt;Predicate&gt; predicates = new ArrayList&lt;&gt;(fields.size()); for (Field field : fields) &#123; // è·å–å­—æ®µä¸Šçš„ @QueryWord æ³¨è§£ QueryWord qw = field.getAnnotation(QueryWord.class); if (qw == null) &#123; continue; &#125; // è·å–å­—æ®µå String column = qw.column(); //å¦‚æœä¸»æ³¨è§£ä¸Š column ä¸ºé»˜è®¤å€¼&quot;&quot;,åˆ™ä»¥ field ä¸ºå‡† if (column.equals(&quot;&quot;)) &#123; column = field.getName(); &#125; field.setAccessible(true); try &#123; // nullable Object value = field.get(outerThis); // å¦‚æœå€¼ä¸º null,æ³¨è§£æœªæ ‡æ³¨ nullable,è·³è¿‡ if (value == null &amp;&amp; !qw.nullable()) &#123; continue; &#125; // can be empty if (value != null &amp;&amp; String.class.isAssignableFrom(value.getClass())) &#123; String s = (String) value; //å¦‚æœå€¼ä¸º&quot;&quot;,ä¸”æ³¨è§£æœªæ ‡æ³¨ empty ,è·³è¿‡ if (s.equals(&quot;&quot;) &amp;&amp; !qw.empty()) &#123; continue; &#125; &#125; //é€šè¿‡æ³¨è§£ä¸Š func å±æ€§,æ„å»ºè·¯å¾„è¡¨è¾¾å¼ Path path = root.get(column); switch (qw.func()) &#123; case equal: predicates.add(cb.equal(path, value)); break; case like: predicates.add(cb.like(path, &quot;%&quot; + value + &quot;%&quot;)); break; case gt: predicates.add(cb.gt(path, (Number) value)); break; case lt: predicates.add(cb.lt(path, (Number) value)); break; case ge: predicates.add(cb.ge(path, (Number) value)); break; case le: predicates.add(cb.le(path, (Number) value)); break; case notEqual: predicates.add(cb.notEqual(path, value)); break; case notLike: predicates.add(cb.notLike(path, &quot;%&quot; + value + &quot;%&quot;)); break; case greaterThan: predicates.add(cb.greaterThan(path, (Comparable) value)); break; case greaterThanOrEqualTo: predicates.add(cb.greaterThanOrEqualTo(path, (Comparable) value)); break; case lessThan: predicates.add(cb.lessThan(path, (Comparable) value)); break; case lessThanOrEqualTo: predicates.add(cb.lessThanOrEqualTo(path, (Comparable) value)); break; case between: switch (qw.type()) &#123; case datetime: List&lt;Date&gt; dateList = (List&lt;Date&gt;) value; predicates.add(cb.between(path, dateList.get(0), dateList.get(1))); break; case number_long: List&lt;Long&gt; longList = (List&lt;Long&gt;) value; predicates.add(cb.between(path, longList.get(0), longList.get(1))); break; case number_integer: List&lt;Integer&gt; integerList = (List&lt;Integer&gt;) value; predicates.add(cb.between(path, integerList.get(0), integerList.get(1))); break; &#125; &#125; &#125; catch (Exception e) &#123; continue; &#125; &#125; Predicate p = null; if (logicType == null || logicType.equals(&quot;&quot;) || logicType.equals(&quot;and&quot;)) &#123; p = cb.and(predicates.toArray(new Predicate[predicates.size()])); // and è¿æ¥ &#125; else if (logicType.equals(&quot;or&quot;)) &#123; p = cb.or(predicates.toArray(new Predicate[predicates.size()])); // or è¿æ¥ &#125; return p; &#125; &#125;; return specification; &#125; //è·å–ç±» clazz çš„æ‰€æœ‰ Fieldï¼ŒåŒ…æ‹¬å…¶çˆ¶ç±»çš„ Field private List&lt;Field&gt; getAllFieldsWithRoot(Class&lt;?&gt; clazz) &#123; List&lt;Field&gt; fieldList = new ArrayList&lt;&gt;(); Field[] dFields = clazz.getDeclaredFields(); //è·å–æœ¬ç±»æ‰€æœ‰å­—æ®µ if (null != dFields &amp;&amp; dFields.length &gt; 0) &#123; fieldList.addAll(Arrays.asList(dFields)); &#125; // è‹¥çˆ¶ç±»æ˜¯ Objectï¼Œåˆ™ç›´æ¥è¿”å›å½“å‰ Field åˆ—è¡¨ Class&lt;?&gt; superClass = clazz.getSuperclass(); if (superClass == Object.class) &#123; return Arrays.asList(dFields); &#125; // é€’å½’æŸ¥è¯¢çˆ¶ç±»çš„ Field åˆ—è¡¨ List&lt;Field&gt; superFields = getAllFieldsWithRoot(superClass); if (null != superFields &amp;&amp; !superFields.isEmpty()) &#123; for (Field field : superFields) &#123; if (!fieldList.contains(field)) &#123; fieldList.add(field); &#125; &#125; &#125; return fieldList; &#125; public int getPageIndex() &#123; return pageNum; &#125; public void setPageIndex(int pageIndex) &#123; this.pageNum = pageIndex; &#125; public int getPageSize() &#123; return pageSize; &#125; public void setPageSize(int pageSize) &#123; this.pageSize = pageSize; &#125;&#125; æ³¨ï¼šæœ€å…³é”®çš„ç±» æ‰€æœ‰åé¢è¦æŸ¥è¯¢çš„ç±»éƒ½è¦ç»§æ‰¿å®ƒ ç®€å•çš„ç†è§£ï¼šé€šè¿‡åå°„è·å–æ³¨è§£ä¸Šçš„å­—æ®µä¿¡æ¯ï¼Œæ„é€ ç›¸åº”çš„æœç´¢æ¡ä»¶ ä¸‰ã€TestStudentQuery 123456789101112131415public class StudentQuery extends BaseQuery&#123; @QueryWord(column = &quot;id&quot;, func = MatchType.equal) private Long id; @QueryWord(func = MatchType.like) private String name; // çœç•¥ set / get @Override public Specification toSpec() &#123; return super.toSpecWithOr(); &#125;&#125; åœ¨è¿™ä¸ªæŸ¥è¯¢ä¸­ï¼Œä½¿ç”¨çš„æ˜¯ or æŸ¥è¯¢ï¼Œæµ‹è¯•ç±»å¦‚ä¸‹ï¼š Test 123456789101112@Testpublic void find8() &#123; StudentQuery studentQuery = new StudentQuery(); studentQuery.setId(1L); studentQuery.setName(&quot;er&quot;); studentQuery.setPageIndex(0); studentQuery.setPageSize(10); Page page = studentRepository.findAll(studentQuery.toSpec(), studentQuery.toPageable()); for (Object o : page.getContent()) &#123; System.out.println(o); &#125;&#125; æ³¨ï¼šæ„é€ çš„æ¡ä»¶æ˜¯ id = 1çš„ï¼Œæˆ–è€… name = ? er ? çš„ student ç»“æœ é€šè¿‡è¿™ä¸ªä¾‹å­ç®€å•æ‹ä¸€ä¸‹æ•´ä¸ªè¿‡ç¨‹ï¼š é€šè¿‡ studentQuery.toSpec() è°ƒç”¨çˆ¶ç±» BaseQueryï¼› åœ¨ BaseQuery ä¸­ï¼Œé€šè¿‡åå°„è·å¾—æ‰“äº†ç›¸åº”æ³¨è§£ä¸Šçš„å­—æ®µä¿¡æ¯ï¼› å°†å­—æ®µä¿¡æ¯åŠ åˆ°æœç´¢æ¡ä»¶ä¸­ï¼Œè¿›è¡Œ or æˆ–è€… and è¿æ¥ æ³¨ï¼šå¦‚æœä½ çš„ä¸šåŠ¡ä¸­åªç”¨äº†å¾ˆå°‘çš„æ¡ä»¶æˆ–è€…åªç”¨æä¸ªåˆ«çš„å¤šæ¡ä»¶æŸ¥è¯¢ï¼Œå¯ä»¥ä¸ç”¨è¿™ä¸ªå·¥å…·ç±»","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"},{"name":"MySQL","slug":"MySQL","permalink":"http://wangba.me/tags/MySQL/"}]},{"title":"SpringBootæ•´åˆSpring Data JPA(äºŒ)","slug":"SpringBootæ•´åˆSpring-Data-JPA-äºŒ","date":"2020-09-10T10:38:46.000Z","updated":"2020-09-30T07:08:31.365Z","comments":true,"path":"2020/09/10/SpringBootæ•´åˆSpring-Data-JPA-äºŒ/","link":"","permalink":"http://wangba.me/2020/09/10/SpringBoot%E6%95%B4%E5%90%88Spring-Data-JPA-%E4%BA%8C/","excerpt":"","text":"ä¸€ã€OverViewâ€‹ åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ä»‹ç»äº†ä¸€ä¸‹ Spring Data JPA çš„ä¸€ä¸‹ç®€å•çš„ CRUDï¼Œä½†æ˜¯åœ¨å…¬å¸ä¸šåŠ¡ä¸­ï¼Œä¸å¯èƒ½è¿™ä¹ˆç®€å•ï¼›ä¸”åœ¨ä¸šåŠ¡ä¸­å¤§éƒ¨åˆ†éƒ½æ˜¯æŸ¥è¯¢ä¸šåŠ¡ï¼Œå…·ä½“ç‚¹å°±æ˜¯åŠ¨æ€æŸ¥è¯¢ï¼Œä»€ä¹ˆå•è¡¨å¤šæ¡ä»¶æŸ¥è¯¢ã€å¤šè¡¨å¤šæ¡ä»¶æŸ¥è¯¢ç­‰ç­‰â€¦â€¦ æ³¨ï¼šä½¿ç”¨ç¯å¢ƒè¿˜æ˜¯å’Œä¸Šä¸€ç¯‡ä¸€æ · äºŒã€è‡ªå®šä¹‰SQLæŸ¥è¯¢å¦‚æœæƒ³å’Œè¿™é‡Œé¢å†™åŸç”Ÿçš„ SQL è¯­å¥ï¼Œåªè¦åœ¨ repository ä¸­è¿™æ ·å†™å°±è¡Œï¼š 123@Query(nativeQuery = true, value = &quot;select * from Student where id = ?1&quot;)Student catchAllById(Long id); æ³¨ï¼š å¦‚æœè¦å†™åŸç”Ÿ SQLï¼Œ@Query æ³¨è§£ä¸­çš„ nativeQuery è¦è®¾ç½®ä¸º trueï¼Œé»˜è®¤ä¸º false å‡½æ•°åè®¾ç½®çš„ä¸èƒ½ä¸è‡ªå¸¦çš„å†²çªï¼Œä¾‹å¦‚ï¼šfindByIdï¼Œå¦‚æœè®¾ç½®äº†ä¸€æ ·ï¼Œå°±ä¼šå¯¼è‡´ä½¿ç”¨çš„è‡ªå¸¦çš„ API è¿›è¡ŒæŸ¥è¯¢ï¼Œè€Œä¸æ˜¯è‡ªå®šä¹‰çš„ï¼Œå¦‚æœçœŸçš„æƒ³ä½¿ç”¨è‡ªå®šä¹‰è¦†ç›–è‡ªå¸¦çš„ï¼Œå¯ä»¥åœ¨å®ä½“ç±»ä¸Šä½¿ç”¨ @NamedQueries æ³¨è§£ åœ¨è¿™é‡Œæˆ‘ä»¬å°±ä½¿ç”¨ @Test è¿›è¡Œæµ‹è¯•ï¼š è¿˜æœ‰ä¸€ç§ä½¿ç”¨ JPQL è¯­æ³•çš„æŸ¥è¯¢æ–¹å¼ï¼š repository: 12@Query(value = &quot;select s from Student s where s.name = ?1&quot;)List&lt;Student&gt; catchByName(String name); Test: å…³äº JPQLï¼šå’Œåœ¨ SQL ä¸­ä¸€æ ·ï¼ŒJPQL ä¸­çš„ select è¯­å¥ç”¨äºæ‰§è¡ŒæŸ¥è¯¢ã€‚å…¶è¯­æ³•å¯è¡¨ç¤ºä¸ºï¼šselect_clause form_clause [where_clause] [groupby_clause] [having_clause] [orderby_clause] å…¶ä¸­ï¼š from å­å¥æ˜¯æŸ¥è¯¢è¯­å¥çš„å¿…é€‰å­å¥ã€‚ select ç”¨æ¥æŒ‡å®šæŸ¥è¯¢è¿”å›çš„ç»“æœå®ä½“æˆ–å®ä½“çš„æŸäº›å±æ€§ã€‚ from å­å¥å£°æ˜æŸ¥è¯¢æºå®ä½“ç±»ï¼Œå¹¶æŒ‡å®šæ ‡è¯†ç¬¦å˜é‡ï¼ˆç›¸å½“äºSQLè¡¨çš„åˆ«åï¼‰ã€‚ å¦‚æœä¸å¸Œæœ›è¿”å›é‡å¤å®ä½“ï¼Œå¯ä½¿ç”¨å…³é”®å­— distinct ä¿®é¥°ã€‚selectã€from éƒ½æ˜¯ JPQL çš„å…³é”®å­—ï¼Œé€šå¸¸å…¨å¤§å†™æˆ–å…¨å°å†™ï¼Œå»ºè®®ä¸è¦å¤§å°å†™æ··ç”¨ã€‚ åœ¨ JPQL ä¸­ï¼ŒæŸ¥è¯¢æ‰€æœ‰å®ä½“çš„ JPQL æŸ¥è¯¢è¯­å¥å¾ˆç®€å•ï¼Œå¦‚ä¸‹ï¼šselect o from Order o æˆ– select o from Order as oè¿™é‡Œå…³é”®å­— as å¯ä»¥çœå»ï¼Œæ ‡è¯†ç¬¦å˜é‡çš„å‘½åè§„èŒƒä¸ Java æ ‡è¯†ç¬¦ç›¸åŒï¼Œä¸”åŒºåˆ†å¤§å°å†™ æ›´å¤šå‚è€ƒï¼šå®˜ç½‘æ–‡æ¡£ ä¸‰ã€è‡ªå®šä¹‰ç®€å•æŸ¥è¯¢åœ¨ Spring Data JPA çš„å®˜ç½‘ä¹Ÿä»‹ç»äº†è¿™ç§æ–¹å¼ï¼Œä¸€èˆ¬è¿™ç§æ–¹å¼åœ¨ä¸€äº›å°é¡¹ç›®ä¸­ä¹Ÿç»å¸¸ä½¿ç”¨ï¼š Keyword Sample JPQL snippet And findByLastnameAndFirstname â€¦ where x.lastname = ?1 and x.firstname = ?2 Or findByLastnameOrFirstname â€¦ where x.lastname = ?1 or x.firstname = ?2 Is, Equals findByFirstname,findByFirstnameIs,findByFirstnameEquals â€¦ where x.firstname = ?1 Between findByStartDateBetween â€¦ where x.startDate between ?1 and ?2 LessThan findByAgeLessThan â€¦ where x.age &lt; ?1 LessThanEqual findByAgeLessThanEqual â€¦ where x.age &lt;= ?1 GreaterThan findByAgeGreaterThan â€¦ where x.age &gt; ?1 GreaterThanEqual findByAgeGreaterThanEqual â€¦ where x.age &gt;= ?1 After findByStartDateAfter â€¦ where x.startDate &gt; ?1 Before findByStartDateBefore â€¦ where x.startDate &lt; ?1 IsNull, Null findByAge(Is)Null â€¦ where x.age is null IsNotNull, NotNull findByAge(Is)NotNull â€¦ where x.age not null Like findByFirstnameLike â€¦ where x.firstname like ?1 NotLike findByFirstnameNotLike â€¦ where x.firstname not like ?1 StartingWith findByFirstnameStartingWith â€¦ where x.firstname like ?1 (parameter bound with appended %) EndingWith findByFirstnameEndingWith â€¦ where x.firstname like ?1 (parameter bound with prepended %) Containing findByFirstnameContaining â€¦ where x.firstname like ?1 (parameter bound wrapped in %) OrderBy findByAgeOrderByLastnameDesc â€¦ where x.age = ?1 order by x.lastname desc Not findByLastnameNot â€¦ where x.lastname &lt;&gt; ?1 In findByAgeIn(Collection&lt;Age&gt; ages) â€¦ where x.age in ?1 NotIn findByAgeNotIn(Collection&lt;Age&gt; ages) â€¦ where x.age not in ?1 True findByActiveTrue() â€¦ where x.active = true False findByActiveFalse() â€¦ where x.active = false IgnoreCase findByFirstnameIgnoreCase â€¦ where UPPER(x.firstame) = UPPER(?1) åŸç†å¤§æ¦‚å¦‚ä¸‹ï¼š å‡å¦‚åˆ›å»ºå¦‚ä¸‹çš„æŸ¥è¯¢ï¼šfindByUserDepUuid()ï¼Œæ¡†æ¶åœ¨è§£æè¯¥æ–¹æ³•æ—¶ï¼Œé¦–å…ˆå‰”é™¤ findByï¼Œç„¶åå¯¹å‰©ä¸‹çš„å±æ€§è¿›è¡Œè§£æ å…ˆåˆ¤æ–­ userDepUuid ï¼ˆæ ¹æ® POJO è§„èŒƒï¼Œé¦–å­—æ¯å˜ä¸ºå°å†™ï¼‰æ˜¯å¦ä¸ºæŸ¥è¯¢å®ä½“çš„ä¸€ä¸ªå±æ€§ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¡¨ç¤ºæ ¹æ®è¯¥å±æ€§è¿›è¡ŒæŸ¥è¯¢ï¼›å¦‚æœæ²¡æœ‰è¯¥å±æ€§ï¼Œç»§ç»­ç¬¬äºŒæ­¥ï¼› ä»å³å¾€å·¦æˆªå–ç¬¬ä¸€ä¸ªå¤§å†™å­—æ¯å¼€å¤´çš„å­—ç¬¦ä¸²æ­¤å¤„ä¸ºUuidï¼‰ï¼Œç„¶åæ£€æŸ¥å‰©ä¸‹çš„å­—ç¬¦ä¸²æ˜¯å¦ä¸ºæŸ¥è¯¢å®ä½“çš„ä¸€ä¸ªå±æ€§ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¡¨ç¤ºæ ¹æ®è¯¥å±æ€§è¿›è¡ŒæŸ¥è¯¢ï¼›å¦‚æœæ²¡æœ‰è¯¥å±æ€§ï¼Œåˆ™é‡å¤ç¬¬äºŒæ­¥ï¼Œç»§ç»­ä»å³å¾€å·¦æˆªå–ï¼›æœ€åå‡è®¾userä¸ºæŸ¥è¯¢å®ä½“çš„ä¸€ä¸ªå±æ€§ï¼› æ¥ç€å¤„ç†å‰©ä¸‹éƒ¨åˆ†ï¼ˆDepUuidï¼‰ï¼Œå…ˆåˆ¤æ–­ user æ‰€å¯¹åº”çš„ç±»å‹æ˜¯å¦æœ‰depUuidå±æ€§ï¼Œå¦‚æœæœ‰ï¼Œåˆ™è¡¨ç¤ºè¯¥æ–¹æ³•æœ€ç»ˆæ˜¯æ ¹æ® Doc.user.depUuid çš„å–å€¼è¿›è¡ŒæŸ¥è¯¢ï¼›å¦åˆ™ç»§ç»­æŒ‰ç…§æ­¥éª¤ 2 çš„è§„åˆ™ä»å³å¾€å·¦æˆªå–ï¼Œæœ€ç»ˆè¡¨ç¤ºæ ¹æ® Doc.user.dep.uuid çš„å€¼è¿›è¡ŒæŸ¥è¯¢ã€‚ å¯èƒ½ä¼šå­˜åœ¨ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œæ¯”å¦‚ DocåŒ…å«ä¸€ä¸ª user çš„å±æ€§ï¼Œä¹Ÿæœ‰ä¸€ä¸ª userDep å±æ€§ï¼Œæ­¤æ—¶ä¼šå­˜åœ¨æ··æ·†ã€‚å¯ä»¥æ˜ç¡®åœ¨å±æ€§ä¹‹é—´åŠ ä¸Š â€œ_â€ ä»¥æ˜¾å¼è¡¨è¾¾æ„å›¾ï¼Œæ¯”å¦‚ findByUser_DepUuid() æˆ–è€… findByUserDep_uuid() repository: 1234567891011List&lt;Student&gt; findByName(String name);List&lt;Student&gt; findByNameAndPwd(String name, String pwd);List&lt;Student&gt; findByNameStartingWith(String name);List&lt;Student&gt; findByNameEndingWith(String name);List&lt;Student&gt; findByNameContaining(String name);List&lt;Student&gt; findByNameContainingOrderByIdDesc(String name); test: findByName findByNameAndPwd findByNameStartingWith findByNameEndingWith findByNameContaining findByNameContainingOrderByIdDesc å››ã€åˆ†é¡µæŸ¥è¯¢12345678910// åˆ†é¡µ + æ’åº@Testpublic void find6() &#123; Sort sort = Sort.by(Sort.Direction.DESC, &quot;id&quot;); PageRequest pageRequest = PageRequest.of(0, 2, sort); Page&lt;Student&gt; studentPage = studentRepository.findAll(pageRequest); for (Student student : studentPage.getContent()) &#123; System.out.println(student); &#125;&#125; æ³¨ï¼š Sort.by(æ’åºæ–¹å¼, æ’åºå­—æ®µ) PageRequest.of(ç¬¬å¤šå°‘é¡µï¼Œé¡µå¤§å°) â€”â€”â€“&gt; ä¸€èˆ¬æ˜¯å†™ä¸€ä¸ª PageUtils Test äº”ã€åŠ¨æ€æŸ¥è¯¢1234567891011121314151617// åˆ†é¡µ + æ’åº + æœç´¢@Testpublic void find7() &#123; PageRequest pageRequest = PageRequest.of(0, 2, Sort.by(Sort.Direction.DESC, &quot;id&quot;)); Specification&lt;Student&gt; specification = new Specification&lt;Student&gt;() &#123; @Override public Predicate toPredicate(Root&lt;Student&gt; root, CriteriaQuery&lt;?&gt; query, CriteriaBuilder criteriaBuilder) &#123; // å¢åŠ æœç´¢æ¡ä»¶: id &lt;= 5 Predicate predicate = criteriaBuilder.lessThanOrEqualTo(root.get(&quot;id&quot;), 5); return predicate; &#125; &#125;; Page&lt;Student&gt; studentPage = studentRepository.findAll(specification, pageRequest); for (Student student : studentPage.getContent()) &#123; System.out.println(student); &#125;&#125; æ³¨ï¼š root: ä»£è¡¨æŸ¥è¯¢çš„å®ä½“ç±» query: å¯ä»¥ä»ä¸­å¾—åˆ° Root å¯¹è±¡ criteriaBuilder: ç”¨äºåˆ›å»º Criteria ç›¸å…³å¯¹è±¡çš„å·¥å‚ Predicate: ä»£è¡¨ä¸€ä¸ªæŸ¥è¯¢æ¡ä»¶ Test: å¤šæ¡ä»¶ï¼š 123456789101112131415161718// åˆ†é¡µ + æ’åº + æœç´¢@Testpublic void find7() &#123; PageRequest pageRequest = PageRequest.of(0, 10, Sort.by(Sort.Direction.DESC, &quot;id&quot;)); List&lt;Predicate&gt; predicateList = new ArrayList&lt;&gt;(); Specification&lt;Student&gt; specification = new Specification&lt;Student&gt;() &#123; @Override public Predicate toPredicate(Root&lt;Student&gt; root, CriteriaQuery&lt;?&gt; query, CriteriaBuilder criteriaBuilder) &#123; predicateList.add(criteriaBuilder.lessThanOrEqualTo(root.get(&quot;id&quot;), 5)); predicateList.add(criteriaBuilder.like(root.get(&quot;name&quot;), &quot;%&quot; + &quot;er&quot;)); return criteriaBuilder.and(predicateList.toArray(new Predicate[predicateList.size()])); &#125; &#125;; Page&lt;Student&gt; studentPage = studentRepository.findAll(specification, pageRequest); for (Student student : studentPage.getContent()) &#123; System.out.println(student); &#125;&#125; Test:","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"},{"name":"MySQL","slug":"MySQL","permalink":"http://wangba.me/tags/MySQL/"}]},{"title":"SpringBootæ•´åˆSpring Data JPA(ä¸€)","slug":"SpringBootæ•´åˆSpring-Data-JPA-ä¸€","date":"2020-09-10T10:38:30.000Z","updated":"2020-09-30T07:08:34.596Z","comments":true,"path":"2020/09/10/SpringBootæ•´åˆSpring-Data-JPA-ä¸€/","link":"","permalink":"http://wangba.me/2020/09/10/SpringBoot%E6%95%B4%E5%90%88Spring-Data-JPA-%E4%B8%80/","excerpt":"","text":"ä¸€ã€OverView JPA(Java Persistence API)æ˜¯Sunå®˜æ–¹æå‡ºçš„JavaæŒä¹…åŒ–è§„èŒƒã€‚å®ƒä¸ºJavaå¼€å‘äººå‘˜æä¾›äº†ä¸€ç§å¯¹è±¡/å…³è”æ˜ å°„å·¥å…·æ¥ç®¡ç†Javaåº”ç”¨ä¸­çš„å…³ç³»æ•°æ®ã€‚ Spring Data JPA æ˜¯ Spring åŸºäº ORM æ¡†æ¶ã€JPA è§„èŒƒçš„åŸºç¡€ä¸Šå°è£…çš„ä¸€å¥—JPAåº”ç”¨æ¡†æ¶ï¼Œå¯ä½¿å¼€å‘è€…ç”¨æç®€çš„ä»£ç å³å¯å®ç°å¯¹æ•°æ®çš„è®¿é—®å’Œæ“ä½œã€‚å®ƒæä¾›äº†åŒ…æ‹¬å¢åˆ æ”¹æŸ¥ç­‰åœ¨å†…çš„å¸¸ç”¨åŠŸèƒ½ï¼Œä¸”æ˜“äºæ‰©å±•ï¼å­¦ä¹ å¹¶ä½¿ç”¨ Spring Data JPA å¯ä»¥æå¤§æé«˜å¼€å‘æ•ˆç‡ï¼ spring data jpaè®©æˆ‘ä»¬è§£è„±äº†DAOå±‚çš„æ“ä½œï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰CRUDéƒ½å¯ä»¥ä¾èµ–äºå®ƒæ¥å®ç° äºŒã€ç¯å¢ƒæ­å»ºpom.xml 1234567891011121314&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt;&lt;/dependency&gt;&lt;dependency&gt; application.properties 123456789101112spring.datasource.url=jdbc:mysql://localhost:3306/jpaspring.datasource.username=rootspring.datasource.password=spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driverspring.jpa.database=mysql# æ˜¯å¦åœ¨æ§åˆ¶å°æ‰“å° sql è¯­å¥spring.jpa.show-sql=true# ä½¿ç”¨ InnoDB ä½œä¸ºå¼•æ“ spring.jpa.database-platform=org.hibernate.dialect.MySQL5InnoDBDialect# æ¯æ¬¡å¯åŠ¨éƒ½ä¼šæ›´æ–°æ•°æ®åº“ï¼Œå¦‚ï¼šå¢åŠ å­—æ®µç­‰ï¼Œä½†æ˜¯å¯¹æŸä¸ªå­—æ®µè¿›è¡Œæ”¹é€ æ˜¯è¯†åˆ«ä¸å‡ºæ¥spring.jpa.hibernate.ddl-auto=update entiy Student 123456789101112131415161718@Entity@Table(name = &quot;student&quot;)public class Student &#123; @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = &quot;id&quot;, columnDefinition = &quot;INT UNSIGNED COMMENT &#x27;è‡ªå¢ä¸»é”®&#x27;&quot;) private Long id; @Column(name = &quot;name&quot;, columnDefinition = &quot;VARCHAR(50) NOT NULL COMMENT &#x27;ç”¨æˆ·å&#x27;&quot;) private String name; @Column(name = &quot;pwd&quot;, columnDefinition = &quot;VARCHAR(100) DEFAULT NULL COMMENT &#x27;å¯†ç &#x27;&quot;) private String pwd; // çœç•¥ set get&#125; Grade 1234567891011121314151617@Entity@Table(name = &quot;grade&quot;)public class Grade &#123; @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = &quot;id&quot;, columnDefinition = &quot;INT UNSIGNED COMMENT &#x27;è‡ªå¢ä¸»é”®&#x27;&quot;) private Long id; @Column(name = &quot;subject&quot;, columnDefinition = &quot;VARCHAR(50) NOT NULL COMMENT &#x27;å­¦ç§‘&#x27;&quot;) private String subject; @Column(name = &quot;score&quot;, columnDefinition = &quot;TINYINT UNSIGNED NOT NULL COMMENT &#x27;æˆç»©&#x27;&quot;) private String score; // çœç•¥ set get&#125; æ³¨ï¼šè¿™æ¬¡ä½¿ç”¨ä¸¤ä¸ªè¡¨ï¼Œä¸ºäº†åé¢è¿›è¡Œå¤æ‚æŸ¥è¯¢å‡†å¤‡ï¼Œè¿™é‡Œçš„å°†ä¸¤ä¸ªè¡¨çš„è‡ªå¢ id å…³è”åœ¨ä¸€èµ·ï¼Œå°±ä¸è€ƒè™‘å¤šå¯¹å¤šäº† repository StudentRepository 123@Repositorypublic interface StudentRepository extends JpaRepository&lt;Student, Long&gt;, JpaSpecificationExecutor&lt;Student&gt; &#123;&#125; GradeRepository 123@Repositorypublic interface GradeRepository extends JpaRepository&lt;Grade, Long&gt;, JpaSpecificationExecutor&lt;Grade&gt; &#123;&#125; åœ¨ä¸Šæ¬¡ aop é‚£é‡Œé¢å°±æè¿‡ï¼Œç”±äºç»§æ‰¿çš„æœ‰ CRUD çš„ repository å’Œä¸€äº›å…¶ä»–çš„ï¼Œè¿™ä¹Ÿæ˜¯ä¸Šé¢æåˆ°çš„è§£æ”¾ DAO å±‚çš„æ“ä½œï¼Œå…·ä½“çš„å¯ä»¥çœ‹ä¸‹å›¾ ä¸‰ã€CRUDcontroller GradeController 12345678910111213141516171819202122232425262728293031@RestController@RequestMapping(&quot;/grade&quot;)public class GradeController &#123; private GradeRepository gradeRepository; @Autowired public void setGradeRepository(GradeRepository gradeRepository) &#123; this.gradeRepository = gradeRepository; &#125; @PutMapping(&quot;/add&quot;) public Grade add(@RequestBody Grade grade) &#123; return gradeRepository.save(grade); &#125; @GetMapping(&quot;/query&quot;) public List&lt;Grade&gt; query() &#123; return gradeRepository.findAll(); &#125; @PostMapping(&quot;/update&quot;) public Grade update(@RequestBody Grade grade) &#123; return gradeRepository.save(grade); &#125; @DeleteMapping(&quot;/delete&quot;) public void delete(@RequestParam Long id) &#123; gradeRepository.deleteById(id); &#125;&#125; StudentController 1234567891011121314151617181920212223242526272829303132@RestController@RequestMapping(&quot;/student&quot;)public class StudentController &#123; private StudentRepository studentRepository; @Autowired public void setStudentRepository(StudentRepository studentRepository) &#123; this.studentRepository = studentRepository; &#125; @PutMapping(&quot;/add&quot;) public Student add(@RequestBody Student student) &#123; return studentRepository.save(student); &#125; @GetMapping(&quot;/query&quot;) public List&lt;Student&gt; query() &#123; return studentRepository.findAll(); &#125; @PostMapping(&quot;/update&quot;) public Student update(@RequestBody Student student) &#123; return studentRepository.save(student); &#125; @DeleteMapping(&quot;/delete&quot;) public void delete(@RequestParam Long id) &#123; studentRepository.deleteById(id); &#125;&#125; æ³¨ï¼š Spring å»ºè®®åœ¨è¿™é‡Œçš„æ³¨å…¥æ–¹å¼æ˜¯ set æˆ–è€… æ„é€ æ³¨å…¥ï¼Œä¸è¦ç›´æ¥æ³¨è§£æ³¨å…¥ ä¸ºäº†æ–¹ä¾¿ï¼Œåœ¨è¿™é‡Œè¿˜æ˜¯çœç•¥äº† Service å±‚çš„æ“ä½œ Postmanæµ‹è¯• å¢ æŸ¥ æ”¹ åˆ ","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"},{"name":"MySQL","slug":"MySQL","permalink":"http://wangba.me/tags/MySQL/"}]},{"title":"SpringBootæ•´åˆMyBatis","slug":"SpringBootæ•´åˆMyBatis","date":"2020-09-09T07:52:44.000Z","updated":"2020-09-30T07:08:29.310Z","comments":true,"path":"2020/09/09/SpringBootæ•´åˆMyBatis/","link":"","permalink":"http://wangba.me/2020/09/09/SpringBoot%E6%95%B4%E5%90%88MyBatis/","excerpt":"","text":"ä¸€ã€OverViewâ€‹ åœ¨ä¸Šç¯‡æ–‡ç« ä¸­å·²ç»ç®€å•çš„å†™è¿‡ SpringBoot æ•´åˆ JDBCTemplate äº†ï¼Œä½†æ˜¯ç°åœ¨çš„å…¬å¸åº”è¯¥å¾ˆå°‘æœ‰ç”¨ JDBCTemplateï¼Œå›½å†…ä¸€èˆ¬éƒ½æ˜¯ MyBatis æˆ–è€…æ˜¯ Spring Data JPAï¼Œåœ¨æœ¬ç¯‡æ–‡ç« ä¸­å°±æ¥æ•´åˆä¸€ä¸‹ MyBatisã€‚ äºŒã€ç¯å¢ƒæ­å»ºæ–°å»º SpringBoot é¡¹ç›®ï¼Œé€‰ä¸Š Webã€MySQLï¼Œåœ¨ pom.xml ä¸­é…ç½®ä¸€ä¸‹æ•°æ®åº“è¿æ¥æ± ï¼š pom.xml: 12345678910111213141516171819&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;2.1.3&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;1.1.23&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt;&lt;/dependency&gt; application.properties: 1234spring.datasource.type=com.alibaba.druid.pool.DruidDataSourcespring.datasource.url=jdbc:mysql://127.0.0.1:3306/testspring.datasource.username=rootspring.datasource.password= ä¸‰ã€CRUDUserMapper: 1234567891011121314151617181920212223242526272829@Component@Transactionalpublic interface UserMapper &#123; // å¢ @Insert(&quot;insert into mybatis(name, password) values(#&#123;name&#125;, #&#123;password&#125;)&quot;) @SelectKey(statement = &quot;select last_insert_id()&quot;, keyProperty = &quot;id&quot;, before = false, resultType = Long.class) Integer insert(User user); // æŸ¥ @Select(&quot;select * from mybatis&quot;) List&lt;User&gt; queryAllUser(); @Results(&#123; @Result(property = &quot;id&quot;, column = &quot;i&quot;), @Result(property = &quot;name&quot;, column = &quot;n&quot;), @Result(property = &quot;password&quot;, column = &quot;p&quot;) &#125;) @Select(&quot;select id as i, name as n, password as p from mybatis where id = #&#123;id&#125;&quot;) User queryById(Long id); // æ”¹ @Update(&quot;update mybatis set name = #&#123;name&#125;, password = #&#123;password&#125; where id = #&#123;id&#125;&quot;) Integer update(User user); // åˆ  @Delete(&quot;delete from mybatis where id = #&#123;id&#125;&quot;) Integer delete(Long id);&#125; æ³¨ï¼š å¦‚æœä¸ä½¿ç”¨æ³¨è§£çš„æ–¹å¼ï¼Œå°±è¦ä½¿ç”¨ xml çš„æ–¹å¼ï¼Œæ³¨æ„å…¶ä¸­çš„èµ„æºè§£æé—®é¢˜ï¼š 12345678910111213&lt;build&gt; &lt;resources&gt; &lt;resource&gt; &lt;directory&gt;src/main/java&lt;/directory&gt; &lt;includes&gt; &lt;include&gt;**/*.xml&lt;/include&gt; &lt;/includes&gt; &lt;/resource&gt; &lt;resource&gt; &lt;directory&gt;src/main/resources&lt;/directory&gt; &lt;/resource&gt; &lt;/resources&gt;&lt;/build&gt; å¢åŠ  statementæ˜¯è¦è¿è¡Œçš„SQLè¯­å¥ï¼Œå®ƒçš„è¿”å›å€¼é€šè¿‡resultTypeæ¥æŒ‡å®š beforeè¡¨ç¤ºæŸ¥è¯¢è¯­å¥statementè¿è¡Œçš„æ—¶æœº keyPropertyè¡¨ç¤ºæŸ¥è¯¢ç»“æœèµ‹å€¼ç»™ä»£ç ä¸­çš„å“ªä¸ªå¯¹è±¡ï¼ŒkeyColumnè¡¨ç¤ºå°†æŸ¥è¯¢ç»“æœèµ‹å€¼ç»™æ•°æ®åº“è¡¨ä¸­å“ªä¸€åˆ— keyPropertyå’ŒkeyColumnéƒ½ä¸æ˜¯å¿…éœ€çš„ï¼Œæœ‰æ²¡æœ‰éƒ½å¯ä»¥ before=trueï¼Œæ’å…¥ä¹‹å‰è¿›è¡ŒæŸ¥è¯¢ï¼Œå¯ä»¥å°†æŸ¥è¯¢ç»“æœèµ‹ç»™keyPropertyå’ŒkeyColumnï¼Œèµ‹ç»™keyColumnç›¸å½“äºæ›´æ”¹æ•°æ®åº“ befaore=falseï¼Œå…ˆæ’å…¥ï¼Œå†æŸ¥è¯¢ï¼Œè¿™æ—¶åªèƒ½å°†ç»“æœèµ‹ç»™keyProperty èµ‹å€¼ç»™keyPropertyç”¨æ¥â€œè¯»â€æ•°æ®åº“ï¼Œèµ‹å€¼ç»™keyColumnç”¨æ¥å†™æ•°æ®åº“ selectKeyçš„ä¸¤å¤§ä½œç”¨ï¼š1ã€ç”Ÿæˆä¸»é”®ï¼›2ã€è·å–åˆšåˆšæ’å…¥æ•°æ®çš„ä¸»é”®ã€‚ ä½¿ç”¨selectKeyï¼Œå¹¶ä¸”ä½¿ç”¨MySQLçš„last_insert_id()å‡½æ•°æ—¶ï¼Œbeforeå¿…ä¸ºfalseï¼Œä¹Ÿå°±æ˜¯è¯´å¿…é¡»å…ˆæ’å…¥ç„¶åæ‰§è¡Œlast_insert_id()æ‰èƒ½è·å¾—åˆšåˆšæ’å…¥æ•°æ®çš„IDã€‚ å‚è€ƒé“¾æ¥ï¼š@SelectKeyæ³¨è§£ æŸ¥ @Resultsæ³¨è§£ç±»ä¼¼äºXMLä¸­çš„ResultMapæ˜ å°„æ–‡ä»¶ UserController: ä¸ºäº†æ–¹ä¾¿å°±ä¸å†å†™ Service å±‚äº† 123456789101112131415161718192021222324252627282930313233343536@RestControllerpublic class UserController &#123; private UserMapper userMapper; @Autowired public void setUserMapper(UserMapper userMapper) &#123; this.userMapper = userMapper; &#125; @PutMapping(&quot;/insert&quot;) public Integer insert(@RequestBody User user) &#123; return userMapper.insert(user); &#125; @GetMapping(&quot;/query&quot;) public List&lt;User&gt; queryAllUser() &#123; return userMapper.queryAllUser(); &#125; @GetMapping(&quot;/query1&quot;) public User queryById(Long id) &#123; return userMapper.queryById(id); &#125; @PostMapping(&quot;/update&quot;) public Integer update(@RequestBody User user) &#123; return userMapper.update(user); &#125; @DeleteMapping(&quot;/delete&quot;) public Integer delete(Long id) &#123; return userMapper.delete(id); &#125;&#125; Postman æµ‹è¯•ï¼š å¢åŠ ï¼š æŸ¥è¯¢æ‰€æœ‰ï¼š é€šè¿‡ id æŸ¥è¯¢ï¼š æ›´æ–°ï¼š æŸ¥çœ‹ä¸€ä¸‹æ•°æ®åº“ï¼š åˆ é™¤ï¼š æŸ¥çœ‹ä¸€ä¸‹æ•°æ®åº“ï¼š ä½¿ç”¨æ³¨è§£è¿›è¡ŒåŠ¨æ€æŸ¥è¯¢å…·ä½“å¯ä»¥å‚è€ƒï¼šæ³¨è§£ç‰ˆåŠ¨æ€æŸ¥è¯¢ ä½¿ç”¨ xml æ–¹å¼è¿›è¡ŒåŠ¨æ€æŸ¥è¯¢å¯ä»¥å‚è€ƒï¼šxml ç‰ˆåŠ¨æ€æŸ¥è¯¢","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"},{"name":"SQL","slug":"SQL","permalink":"http://wangba.me/tags/SQL/"}]},{"title":"SpringBootæ•´åˆJDBCTemplate","slug":"SpringBootæ•´åˆJDBCTemplate","date":"2020-09-08T11:33:14.000Z","updated":"2020-09-30T07:08:27.205Z","comments":true,"path":"2020/09/08/SpringBootæ•´åˆJDBCTemplate/","link":"","permalink":"http://wangba.me/2020/09/08/SpringBoot%E6%95%B4%E5%90%88JDBCTemplate/","excerpt":"","text":"ä¸€ã€ç¯å¢ƒæ­å»º1. å¼•å…¥ä¾èµ–1234567891011121314151617181920212223242526272829303132333435363738// WEB&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt;// JDBC &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;&lt;/dependency&gt;// ä½¿ç”¨ Swagger è¿›è¡Œæ¥å£æµ‹è¯•&lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt; &lt;version&gt;2.9.2&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt; &lt;version&gt;2.9.2&lt;/version&gt;&lt;/dependency&gt;// mysql&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt;&lt;/dependency&gt;&lt;!-- https://mvnrepository.com/artifact/com.alibaba/druid --&gt;// druid&lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;1.1.23&lt;/version&gt;&lt;/dependency&gt; 2.æ•°æ®åº“è„šæœ¬1234567891011121314151617181920DROP TABLE IF EXISTS `sys_user`;CREATE TABLE `sys_user` ( `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT &#x27;ç¼–å·&#x27;, `name` varchar(50) NOT NULL COMMENT &#x27;ç”¨æˆ·å&#x27;, `nick_name` varchar(150) DEFAULT NULL COMMENT &#x27;æ˜µç§°&#x27;, `avatar` varchar(150) DEFAULT NULL COMMENT &#x27;å¤´åƒ&#x27;, `password` varchar(100) DEFAULT NULL COMMENT &#x27;å¯†ç &#x27;, `salt` varchar(40) DEFAULT NULL COMMENT &#x27;åŠ å¯†ç›&#x27;, `email` varchar(100) DEFAULT NULL COMMENT &#x27;é‚®ç®±&#x27;, `mobile` varchar(100) DEFAULT NULL COMMENT &#x27;æ‰‹æœºå·&#x27;, `status` tinyint(4) DEFAULT NULL COMMENT &#x27;çŠ¶æ€ 0ï¼šç¦ç”¨ 1ï¼šæ­£å¸¸&#x27;, `dept_id` bigint(20) DEFAULT NULL COMMENT &#x27;æœºæ„ID&#x27;, `create_by` varchar(50) DEFAULT NULL COMMENT &#x27;åˆ›å»ºäºº&#x27;, `create_time` datetime DEFAULT NULL COMMENT &#x27;åˆ›å»ºæ—¶é—´&#x27;, `last_update_by` varchar(50) DEFAULT NULL COMMENT &#x27;æ›´æ–°äºº&#x27;, `last_update_time` datetime DEFAULT NULL COMMENT &#x27;æ›´æ–°æ—¶é—´&#x27;, `del_flag` tinyint(4) DEFAULT &#x27;0&#x27; COMMENT &#x27;æ˜¯å¦åˆ é™¤ -1ï¼šå·²åˆ é™¤ 0ï¼šæ­£å¸¸&#x27;, PRIMARY KEY (`id`), UNIQUE KEY `name` (`name`)) ENGINE=InnoDB AUTO_INCREMENT=34 DEFAULT CHARSET=utf8 COMMENT=&#x27;ç”¨æˆ·ç®¡ç†&#x27;; application.properties: 1234spring.datasource.type=com.alibaba.druid.pool.DruidDataSourcespring.datasource.url=jdbc:mysql://127.0.0.1:3306/testspring.datasource.username=rootspring.datasource.password=****** äºŒã€CRUD1.ç¼–å†™å¯¹åº”çš„å®ä½“ç±»123456789101112131415161718192021222324252627282930313233public class SysUser &#123; private Long id; private String name; private String nickName; private String avatar; private String password; private String salt; private String email; private String mobile; private Byte status; private Long deptId; private String createBy; private Date createTime; private String lastUpdateBy; private Date lastUpdateTime; private Byte delFlag; // set å’Œ get çœç•¥&#125; 2.ç¼–å†™å¯¹åº”çš„ CRUD Repository1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162@Repositorypublic class SysUserRepository &#123; @Autowired private JdbcTemplate jdbcTemplate; public Integer insert(SysUser user) &#123; String sql = &quot;insert into sys_user(id, name, password) values(?,?,?)&quot;; return jdbcTemplate.update(sql, user.getId(), user.getName(), user.getPassword()); &#125; public Integer insert1(SysUser sysUser) &#123; String sql = &quot;insert into sys_user(id, name, password) values(:id, :name, :password)&quot;; NamedParameterJdbcTemplate namedParameterJdbcTemplate = new NamedParameterJdbcTemplate(this.jdbcTemplate.getDataSource()); return namedParameterJdbcTemplate.update(sql, new BeanPropertySqlParameterSource(sysUser)); &#125; // æ¨èä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œå¯ä»¥ä¸ç”¨ä¼ æ‰€æœ‰çš„å‚æ•° public Integer insert2(SysUser sysUser) &#123; String sql = &quot;insert into sys_user(id, name, password) values(:id, :name, :password)&quot;; Map&lt;String, Object&gt; map = new HashMap&lt;&gt;(16); map.put(&quot;id&quot;, sysUser.getId()); map.put(&quot;name&quot;, sysUser.getName()); map.put(&quot;password&quot;, sysUser.getPassword()); NamedParameterJdbcTemplate namedParameterJdbcTemplate = new NamedParameterJdbcTemplate(this.jdbcTemplate.getDataSource()); return namedParameterJdbcTemplate.update(sql, map); &#125; public Integer update(SysUser sysUser) &#123; String sql = &quot;update sys_user set name = ?, password = ? where id = ?&quot;; Object[] args = &#123;sysUser.getName(), sysUser.getPassword(), sysUser.getId()&#125;; int[] argTypes = &#123;Types.VARCHAR, Types.VARCHAR, Types.BIGINT&#125;; return this.jdbcTemplate.update(sql, args, argTypes); &#125; public List&lt;Map&lt;String, Object&gt;&gt; queryAllListMap() &#123; String sql = &quot;select * from sys_user&quot;; return this.jdbcTemplate.queryForList(sql); &#125; // è¿™é‡Œè¦å†™ä¸€ä¸ª SysUserMapper å®ç° RowMapper public SysUser queryById(Long id) &#123; String sql = &quot;select * from sys_user where id = ?&quot;; Object[] args = &#123;id&#125;; int[] argTypes = &#123;Types.BIGINT&#125;; List&lt;SysUser&gt; list = this.jdbcTemplate.query(sql, args, argTypes, new SysUserMapper()); if (StringUtils.isEmpty(list)) &#123; return list.get(0); &#125; else &#123; return null; &#125; &#125; public Integer deleteById(Long id) &#123; String sql = &quot;delete from sys_user where id = ?&quot;; Object[] args = &#123; id &#125;; int[] argTypes = &#123; Types.BIGINT &#125;; return this.jdbcTemplate.update(sql, args, argTypes); &#125;&#125; 3.å¯¹åº”çš„ Controller å±‚123456789101112131415161718192021222324252627282930313233343536373839404142434445@RestControllerpublic class SysUserController &#123; @Autowired private SysUserRepository sysUserRepository; @PutMapping(&quot;/insert&quot;) public Integer insert(@RequestBody SysUser sysUser) &#123; int i = sysUserRepository.insert(sysUser); return i; &#125; @PutMapping(&quot;/insert1&quot;) public Integer insert1(@RequestBody SysUser sysUser) &#123; int i = sysUserRepository.insert1(sysUser); return i; &#125; @PutMapping(&quot;/insert2&quot;) public Integer insert2(@RequestBody SysUser sysUser) &#123; int i = sysUserRepository.insert2(sysUser); return i; &#125; @PostMapping(&quot;/update&quot;) public Integer update(@RequestBody SysUser sysUser) &#123; int i = sysUserRepository.update(sysUser); return i; &#125; @GetMapping(&quot;/list&quot;) public List&lt;Map&lt;String, Object&gt;&gt; queryAllListMap() &#123; return sysUserRepository.queryAllListMap(); &#125; @GetMapping(&quot;/id1&quot;) public SysUser queryById(Long id) &#123; return sysUserRepository.queryById(id); &#125; @DeleteMapping(&quot;/id3&quot;) public Integer deleteById(Long id) &#123; return sysUserRepository.deleteById(id); &#125;&#125; æ³¨ï¼šä¸ºäº†å›¾æ–¹ä¾¿ï¼Œå°±ä¸å†æ­¤å†™ Service å±‚äº† 4.ä½¿ç”¨ Swagger è¿›è¡Œæµ‹è¯•å¢åŠ  ç¬¬ä¸€ç§æ–¹å¼ï¼š ç¬¬äºŒç§æ–¹å¼ï¼š ç¬¬ä¸‰ç§æ–¹å¼ï¼š çœ‹ä¸€ä¸‹æ•°æ®åº“æ˜¯å¦æœ‰ä¸‰æ¡æ•°æ®ï¼š ä¿®æ”¹ æŸ¥æ‰¾ æŸ¥æ‰¾æ‰€æœ‰ï¼š åˆ é™¤","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"},{"name":"SQL","slug":"SQL","permalink":"http://wangba.me/tags/SQL/"}]},{"title":"0076.Minimum Window Substring","slug":"0076-Minimum-Window-Substring","date":"2020-09-04T13:56:11.000Z","updated":"2020-09-30T07:09:40.885Z","comments":true,"path":"2020/09/04/0076-Minimum-Window-Substring/","link":"","permalink":"http://wangba.me/2020/09/04/0076-Minimum-Window-Substring/","excerpt":"","text":"76. æœ€å°è¦†ç›–å­ä¸² Hardç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² Sã€ä¸€ä¸ªå­—ç¬¦ä¸² T ã€‚è¯·ä½ è®¾è®¡ä¸€ç§ç®—æ³•ï¼Œå¯ä»¥åœ¨ O(n) çš„æ—¶é—´å¤æ‚åº¦å†…ï¼Œä»å­—ç¬¦ä¸² S é‡Œé¢æ‰¾å‡ºï¼šåŒ…å« T æ‰€æœ‰å­—ç¬¦çš„æœ€å°å­ä¸²ã€‚ ç¤ºä¾‹ï¼š 12è¾“å…¥ï¼šS &#x3D; &quot;ADOBECODEBANC&quot;, T &#x3D; &quot;ABC&quot;è¾“å‡ºï¼š&quot;BANC&quot; æç¤ºï¼š å¦‚æœ S ä¸­ä¸å­˜è¿™æ ·çš„å­ä¸²ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸² &quot;&quot;ã€‚ å¦‚æœ S ä¸­å­˜åœ¨è¿™æ ·çš„å­ä¸²ï¼Œæˆ‘ä»¬ä¿è¯å®ƒæ˜¯å”¯ä¸€çš„ç­”æ¡ˆã€‚ è§£é¢˜æ€è·¯â€‹ è¿™é¢˜åœ¨ 0003 é¢˜ä¸­å°±å·²ç»æè¿‡äº†çš„æš—å·ï¼Œå°±æ˜¯æ´’æ´’æ°´çš„ä½¿ç”¨ä¸€ä¸‹ Sliding Window å°±å¯ä»¥äº†ï¼Œæ€è·¯è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼šå…ˆä¸æ–­çš„æ‰©å¼ çª—å£å³è¾¹ï¼Œç›´åˆ°å°†æ‰€æœ‰çš„è¦åŒ…å«çš„çŸ­å­—ç¬¦ä¸²ï¼›ç„¶åå¼€å§‹å°±ç§»åŠ¨çª—å£çš„å·¦è¾¹ï¼Œç›´åˆ°å·¦è¾¹å‹ç¼©åˆ°ä¸èƒ½å†å®¹çº³è¿™ä¸ªçŸ­å­—ç¬¦ä¸²äº†ï¼Œå†è¿›è¡Œä¸æ–­æ¯”è¾ƒï¼Œå°±å¯ä»¥å¾—åˆ°æœ€ç»ˆç»“æœäº†ã€‚â€‹ è¿™ç§æ—¶å€™å°±éœ€è¦å‡ºç° ä½†æ˜¯ è¿™ä¸ªè¯è¯­ï¼Œæœç„¶åœ¨å®ç°çš„æ—¶å€™å°±éœ€è¦æ³¨æ„å¾ˆå¤šé—®é¢˜äº†ï¼Œå¯¹äºè¿™ç§æŠ½è±¡é—®é¢˜ï¼Œå…ˆæ¥ä¸ªğŸŒ°ï¼šç»™çš„ä¾‹å­å®åœ¨æ˜¯å¤ªæ™®é€šäº†ï¼Œåº”è¯¥ç”¨é‚£ç§å¸¦ç‚¹ç‰¹æ®Šæ€§çš„ä¾‹å­ S = â€œABANCDBâ€ T = â€œABCâ€ å¯¹ç€ä»£ç æ‹ä¸€éåº”è¯¥å°±æ‡‚äº†ï¼šç¬¬ä¸€éè¿‡åå¯ä»¥çœ‹è§ï¼šâ€ABANCâ€ æ˜¯ä¸€ä¸ªæ»‘åŠ¨çª—å£ï¼Œmap çš„å€¼ä¹Ÿå˜ä¸ºäº†ï¼š A B C åˆå§‹å€¼ 1 1 1 éå†åˆ° A 0 1 1 éå†åˆ° B 0 0 1 éå†åˆ° A -1 0 1 éå†åˆ° N -1 0 1 éå†åˆ° C -1 0 0 æ­¤æ—¶çš„ count == t çš„é•¿åº¦äº†ï¼Œè¿™æ ·æ‰©å¼ çª—å£å°±å®Œæˆäº† ======&gt; min = 5 æ¥ä¸‹æ¥å°±æ˜¯æ”¶ç¼©çª—å£ï¼Œå…¶æ ¹æœ¬åŸå› å°±æ˜¯è¿™æ ·å·¦è¾¹å‡ºç°é‡å¤å…ƒç´ ï¼Œå¯ä»¥å»æ‰å½¢æˆæœ€å°çš„çª—å£ï¼š å¦‚æœåœ¨ map ä¸­çš„å€¼æ˜¯ç­‰äº 0 çš„ï¼Œè¯´æ˜å®ƒæ˜¯åˆšåˆšå¥½çš„ï¼Œå¦‚æœæŠŠè¿™ä¸ªæ’é™¤çš„è¯ï¼Œè¿™ä¸ªçª—å£å°±ä¸å†æˆç«‹äº†ï¼Œè¦ç»§ç»­æ‰©å¼  çª—å£äº†ï¼›å¦‚æœ map ä¸­çš„å€¼ å°äº 0 çš„ï¼Œè¯´æ˜å®ƒæ˜¯å¤šä½™çš„ï¼Œä½†æ˜¯è¦çœ‹å®ƒçš„ä½ç½®äº†ï¼Œå¯ä»¥çœ‹ä¸‹ğŸŒ°ï¼š â€œABANCâ€ è¿™ä¸ª A å°±å¯ä»¥å»æ‰ï¼›â€BAANCâ€ è¿™ä¸ª A å°±ä¸å¯ä»¥å»æ‰ï¼Œæ­¤æ—¶å°±è¦æ‰©å¼ çª—å£äº† åå¤æ¨ªè·³ ï¼Œå®Œæˆâœ… ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748class Solution &#123; public String minWindow(String s, String t) &#123; Map&lt;Character, Integer&gt; map = new HashMap&lt;&gt;(); // ä½¿ç”¨ hashmap å°† t ä¸­çš„å­—ç¬¦å­˜å…¥ for(int i = 0; i &lt; t.length(); i++) &#123; char c = t.charAt(i); if (map.containsKey(c)) &#123; int tmp = map.get(c); map.put(c, tmp + 1); &#125; else &#123; map.put(c, 1); &#125; &#125; // ç”¨æ¥åˆ¤æ–­è¿™ä¸ªçª—å£æ˜¯å¦åŒ…å«äº† t int count = 0; // ä¸€ä¸ªçª—å£çš„å·¦å³ int left = 0, right = 0; int min = Integer.MAX_VALUE; // é•¿åº¦æœ€å°çš„çª—å£çš„å·¦å³ int minLeft = 0, minRight = 0; for (; right &lt; s.length(); right++) &#123; char temp = s.charAt(right); if (map.containsKey(temp)) &#123; count = map.get(temp) &gt; 0 ? count + 1 : count; map.put(temp, map.get(temp) - 1); &#125; while (count == t.length()) &#123; if ((right - left) &lt; min) &#123; min = right - left; minLeft = left; minRight = right; &#125; char c = s.charAt(left); // å·¦è¾¹çš„é‡å¤å­—ç¬¦å¯ä»¥ä¸ç”¨ if (map.containsKey(c)) &#123; if (map.get(c) &gt;= 0) count--; map.put(c, map.get(c) + 1); &#125; left++; &#125; &#125; return min == Integer.MAX_VALUE ? &quot;&quot; : s.substring(minLeft, minRight + 1); &#125;&#125;","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"String","slug":"String","permalink":"http://wangba.me/tags/String/"},{"name":"Sliding Window","slug":"Sliding-Window","permalink":"http://wangba.me/tags/Sliding-Window/"}]},{"title":"SpringBootæ•´åˆAOP","slug":"SpringBootæ•´åˆAOP","date":"2020-09-03T13:52:37.000Z","updated":"2020-09-30T07:08:24.891Z","comments":true,"path":"2020/09/03/SpringBootæ•´åˆAOP/","link":"","permalink":"http://wangba.me/2020/09/03/SpringBoot%E6%95%B4%E5%90%88AOP/","excerpt":"","text":"ä¸€ã€èƒŒæ™¯â€‹ åœ¨å…¬å¸å†™ä¸šåŠ¡çš„æ—¶å€™ï¼Œéƒ½ä¼šæœ‰ä¿å­˜æ—¥å¿—çš„æ“ä½œï¼Œæ–¹ä¾¿å‡ºé”™çš„æ—¶å€™è¿›è¡Œæ’æŸ¥ï¼›ä¸€èˆ¬ä¸ä»…ä»…åœ¨æ•°æ®åº“ä¸­ä¿å­˜æ—¥å¿—ï¼Œ ä¹Ÿä¼šåœ¨åç«¯æ§åˆ¶å°æ‰“å°ä¸€äº›éœ€è¦çš„ä¿¡æ¯ã€‚åœ¨è¿™é‡Œï¼Œä¸€èˆ¬ä½¿ç”¨ AOP ç»‡å…¥çš„æ–¹å¼å°†æ—¥å¿—ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œä½¿ç”¨ä¸€äº›æ—¥ å¿—åŒ…å°†æŸäº› Controller å±‚çš„ä¿¡æ¯æ‰“å°åœ¨æ§åˆ¶å°ã€‚ äºŒã€å‡†å¤‡Entiy:1234567891011121314151617181920@Entity@Table(name = &quot;log&quot;)@EntityListeners(AuditingEntityListener.class)public class Log implements Serializable &#123; @Id @GeneratedValue(strategy = GenerationType.IDENTITY ) @Column(name = &quot;id&quot;) private Long id; @Column(name = &quot;title&quot;, columnDefinition = &quot;VARCHAR(100) COMMENT &#x27;æ ‡é¢˜&#x27;&quot;) private String title; @Column(name = &quot;author&quot;, columnDefinition = &quot;VARCHAR(255) COMMENT &#x27;ä½œè€…&#x27;&quot;) private String author; @Column(name = &quot;content&quot;, columnDefinition = &quot;TEXT COMMENT &#x27;å†…å®¹&#x27;&quot;) private String content; // get å’Œ set çœç•¥ æ³¨: è¿™é‡Œæ˜¯ä½¿ç”¨ Spring Data JPA è‡ªåŠ¨ç”Ÿæˆçš„æ•°æ®åº“å¯¹åº”å®ä½“ï¼Œå¯¼å…¥ç›¸å…³ä¾èµ–åï¼Œå¯ä»¥å…ˆè¿è¡Œä¸€éï¼Œçœ‹æ•°æ®åº“ æ˜¯å¦ç”Ÿæˆå¯¹åº”å®ä½“ï¼›ç„¶åè‡ªè¡Œåœ¨æ•°æ®åº“ä¸­æ’å…¥å‡ æ¡æ•°æ®ã€‚ Repository:123public interface LogRepository extends JpaRepository&lt;Log, Long&gt; &#123;&#125; æ³¨: è¿™é‡Œåªè¦ç»§æ‰¿ JpaRepository ï¼Œè¿™ä¸ª repository ä¹Ÿç»§æ‰¿äº†åˆ«çš„ repositoryï¼ˆé‡Œé¢æœ‰ä¸€äº›å¸¸è§çš„æ–¹æ³•å¯ä»¥ è°ƒç”¨ï¼‰ Service:1234567891011@Servicepublic class LogService &#123; @Autowired LogRepository logRepository; public List&lt;Log&gt; getAllLog() &#123; List&lt;Log&gt; logs = logRepository.findAll(); return logs; &#125;&#125; æ³¨: è¿™é‡Œå°±ä¸å†™æ¥å£ï¼Œå†å»å®ç°äº† Controller:123456789101112@RestControllerpublic class LogController &#123; @Autowired LogService logService; @GetMapping(&quot;/list&quot;) public List&lt;Log&gt; getAll() &#123; List&lt;Log&gt; logs = logService.getAllLog(); return logs; &#125;&#125; å†ä½¿ç”¨ Postman ç­‰å·¥å…·è¿›è¡Œä¸€æ¬¡æµ‹è¯•å°±è¡Œ ä¸‰ã€ä½¿ç”¨æ³¨è§£çš„æ–¹å¼è¿›è¡Œ AOPé¦–å…ˆå®šä¹‰ä¸€ä¸ªæ–¹æ³•çº§åˆ«çš„ @Log æ³¨è§£ï¼Œç”¨äºæ ‡æ³¨éœ€è¦ç›‘æ§çš„æ–¹æ³•ï¼š 1234567@Target(ElementType.METHOD)@Retention(RetentionPolicy.RUNTIME)public @interface Log &#123; String value() default &quot;&quot;; &#125; å®šä¹‰ä¸€ä¸ªLogAspectç±»ï¼Œä½¿ç”¨ @Aspect æ ‡æ³¨è®©å…¶æˆä¸ºä¸€ä¸ªåˆ‡é¢ï¼Œåˆ‡ç‚¹ä¸ºä½¿ç”¨ @Log æ³¨è§£æ ‡æ³¨çš„æ–¹æ³•ï¼š 1234567891011121314151617181920@Aspect@Componentpublic class LogAspec &#123; private final static Logger logger = LoggerFactory.getLogger(LogAspec.class); @Pointcut(&quot;@annotation(org.wangba.springboot013aop.antoation.Log)&quot;) public void pointcut() &#123; &#125; @Before(&quot;pointcut()&quot;) public void doBefore(JoinPoint joinPoint) throws Throwable &#123; logger.info(&quot;Start Time: &#123;&#125;&quot;, System.currentTimeMillis()); &#125; @After(&quot;pointcut()&quot;) public void doAfter() throws Throwable &#123; logger.info(&quot;End Time: &#123;&#125;&quot;, System.currentTimeMillis()); &#125;&#125; å†åœ¨ Controller å±‚çš„æ–¹æ³•ä¸ŠåŠ ä¸Š @Log æ³¨è§£ï¼š 12345678910111213@RestControllerpublic class LogController &#123; @Autowired LogService logService; @Log(&quot;è·å¾—æ‰€æœ‰æ–‡ç« &quot;) @GetMapping(&quot;/list&quot;) public List&lt;Article&gt; getAll() &#123; List&lt;Article&gt; articles = logService.getAllLog(); return articles; &#125;&#125; æ­¤æ—¶å†åœ¨ Postman ä¸­æµ‹è¯•ä¸€æ¬¡ï¼Œä½ å°±å¯ä»¥çœ‹åˆ°æ§åˆ¶å°ä¼šæ‰“å°å¦‚ä¸‹ç»“æœï¼š åœ¨å…¬å¸ä¸šåŠ¡ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½æ˜¯åœ¨ @Before è¿›è¡Œä¸€äº›è¯·æ±‚ä¿¡æ¯ç­‰ï¼Œ @After åœ¨æ§åˆ¶å°æ‰“å°ä¸€äº›ä¿¡æ¯ï¼Œå¹¶å°†ç»“ æœç›´æ¥å­˜åˆ°æ•°æ®åº“ä¸­çš„æ—¥å¿—è¡¨ä¸­ã€‚","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"}]},{"title":"SpringBootä¸­ç±»å‹è½¬æ¢","slug":"SpringBootä¸­ç±»å‹è½¬æ¢","date":"2020-09-02T12:55:09.000Z","updated":"2020-09-30T07:08:22.269Z","comments":true,"path":"2020/09/02/SpringBootä¸­ç±»å‹è½¬æ¢/","link":"","permalink":"http://wangba.me/2020/09/02/SpringBoot%E4%B8%AD%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/","excerpt":"","text":"ä¸€ã€é—®é¢˜å¦‚æœå‰ç«¯ä¼ æ¥ä¸€ä¸ªæ—¥æœŸå‚æ•°ï¼Œæ˜¯ç”¨ String ç±»å‹çš„ï¼Œæˆ‘ä»¬å¦‚ä½•åœ¨åç«¯è¿›è¡Œä¼ å‚å‘¢ï¼Ÿ ä¹Ÿå³å¦‚ä¸‹è¿™ç§æƒ…å†µï¼š 12345678@RestControllerpublic class HelloController &#123; @GetMapping(&quot;/hello&quot;) public void hello(Date date) &#123; System.out.println(date); &#125;&#125; æµè§ˆå™¨è¾“å…¥ï¼šhttp://localhost:8080/hello?date=2020-01-01 å¯ä»¥åœ¨åå°çœ‹åˆ° WARN ï¼š Failed to convert value of type â€˜java.lang.Stringâ€™ to required type â€˜java.util.Dateâ€™ äºŒã€è§£å†³1234567891011121314151617@Componentpublic class StringTransDate implements Converter&lt;String, Date&gt; &#123; private SimpleDateFormat simpleDateFormat = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;); @Override public Date convert(String s) &#123; if (s != null &amp;&amp; !&quot;&quot;.equals(s)) &#123; try &#123; return simpleDateFormat.parse(s); &#125; catch (ParseException e) &#123; e.printStackTrace(); &#125; &#125; return null; &#125;&#125; æ³¨ï¼šè¦å°†è¯¥ç±»ä½¿ç”¨ @Component æ³¨å…¥","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"}]},{"title":"0003.Longest Substring Without Repeating Characters","slug":"0003-Longest-Substring-Without-Repeating-Characters","date":"2020-09-01T13:26:29.000Z","updated":"2020-09-30T07:09:37.081Z","comments":true,"path":"2020/09/01/0003-Longest-Substring-Without-Repeating-Characters/","link":"","permalink":"http://wangba.me/2020/09/01/0003-Longest-Substring-Without-Repeating-Characters/","excerpt":"","text":"0003. æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸² Mediumç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­ä¸å«æœ‰é‡å¤å­—ç¬¦çš„ æœ€é•¿å­ä¸² çš„é•¿åº¦ã€‚ ç¤ºä¾‹ 1: 123è¾“å…¥: &quot;abcabcbb&quot;è¾“å‡º: 3 è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ &quot;abc&quot;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚ ç¤ºä¾‹ 2: 123è¾“å…¥: &quot;bbbbb&quot;è¾“å‡º: 1è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ &quot;b&quot;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 1ã€‚ ç¤ºä¾‹ 3: 12345è¾“å…¥: &quot;pwwkew&quot;è¾“å‡º: 3è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ &quot;wke&quot;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚è¯·æ³¨æ„ï¼Œä½ çš„ç­”æ¡ˆå¿…é¡»æ˜¯ å­ä¸² çš„é•¿åº¦ï¼Œ&quot;pwke&quot; æ˜¯ä¸€ä¸ªå­åºåˆ—ï¼Œä¸æ˜¯å­ä¸²ã€‚ è§£é¢˜æ€è·¯ ğŸ·ï¼šç¬¬ä¸€ä¸ªæƒ³æ³•å°±æ˜¯è¿™ä¸ªæ˜¯ä¸æ˜¯å’Œ KMP ç®—æ³•æœ‰é‚£ä¹ˆä¸€ç‚¹ç‚¹åƒçš„ åŠ›æ‰£ï¼šè®©ä½ è§è¯†ä¸€ä¸‹ï¼Œå€¼å¾—æˆ‘ä»¬å®˜ç½‘æœ‰ä¸€ä¸ªæ ‡ç­¾çš„æ€æƒ³ â€”â€”â€”&gt; Sliding Window ğŸ·ï¼šè¯´äººè¯ åŠ›æ‰£ï¼šå°±æ˜¯ æ»‘åŠ¨çª—å£ å¤§æ³•ï¼Œä½ åé¢ä¼šçœ‹åˆ°å¾ˆå¤šæ¬¡è¿™ç§æ€æƒ³ï¼Œæƒ³ç»§ç»­çœ‹è¿™æ ·çš„é¢˜ï¼Œç‚¹è¿™é‡Œï¼Œè¿˜æœ‰ä¸€äº›æš—å·ï¼š76ã€ 438ã€567 æ»‘åŠ¨çª—å£æ€æƒ³ï¼š æ»‘åŠ¨çª—å£çš„å³è¾¹ç•Œä¸æ–­çš„å³ç§»ï¼Œåªè¦æ²¡æœ‰é‡å¤çš„å­—ç¬¦ï¼Œå°±æŒç»­å‘å³æ‰©å¤§çª—å£è¾¹ç•Œã€‚ä¸€æ—¦å‡ºç°äº†é‡å¤å­—ç¬¦ï¼Œå°±éœ€è¦ç¼©å°å·¦è¾¹ç•Œï¼Œç›´åˆ°é‡å¤çš„å­—ç¬¦ç§»å‡ºäº†å·¦è¾¹ç•Œï¼Œç„¶åç»§ç»­ç§»åŠ¨æ»‘åŠ¨çª—å£çš„å³è¾¹ç•Œã€‚ä»¥æ­¤ç±»æ¨ï¼Œæ¯æ¬¡ç§»åŠ¨éœ€è¦è®¡ç®—å½“å‰é•¿åº¦ï¼Œå¹¶åˆ¤æ–­æ˜¯å¦éœ€è¦æ›´æ–°æœ€å¤§é•¿åº¦ï¼Œæœ€ç»ˆæœ€å¤§çš„å€¼å°±æ˜¯é¢˜ç›®ä¸­çš„æ‰€æ±‚ã€‚ ğŸ·ï¼šåº”è¯¥å°±æ˜¯åŒæŒ‡é’ˆçš„å˜å½¢ç‰ˆäº†â€¦â€¦.. ä»£ç 12345678910111213class Solution &#123; public int lengthOfLongestSubstring(String s) &#123; Map&lt;Character, Integer&gt; map = new HashMap&lt;&gt;(); int max = 0; for (int i = 0, j = 0; i &lt; s.length(); i++) &#123; if (map.containsKey(s.charAt(i))) j = Math.max(j, map.get(s.charAt(i)) + 1); map.put(s.charAt(i), i); max = Math.max(max, i - j + 1); &#125; return max; &#125;&#125;","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"String","slug":"String","permalink":"http://wangba.me/tags/String/"},{"name":"Sliding Window","slug":"Sliding-Window","permalink":"http://wangba.me/tags/Sliding-Window/"},{"name":"Two pointer","slug":"Two-pointer","permalink":"http://wangba.me/tags/Two-pointer/"}]},{"title":"SpringBootä¸­çš„è·¯å¾„æ˜ å°„","slug":"SpringBootä¸­çš„è·¯å¾„æ˜ å°„","date":"2020-09-01T13:25:29.000Z","updated":"2020-09-30T07:08:15.292Z","comments":true,"path":"2020/09/01/SpringBootä¸­çš„è·¯å¾„æ˜ å°„/","link":"","permalink":"http://wangba.me/2020/09/01/SpringBoot%E4%B8%AD%E7%9A%84%E8%B7%AF%E5%BE%84%E6%98%A0%E5%B0%84/","excerpt":"","text":"ä¸€ã€åœ¨ SpringBootä¸­ä½¿ç”¨ SSM æ¡†æ¶ä¸­çš„æ˜ å°„å†™ä¸‹å¦‚ä¸‹çš„ Controllerï¼š 123456789@Controllerpublic class HelloController &#123; @RequestMapping(&quot;/hello&quot;) public String hello() &#123; return &quot;hello&quot;; &#125;&#125; å¹¶åœ¨ resources/templates ä¸­æ–°å»º hello.html 12345678910&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;Title&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Hello, Spring Boot&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt; æ³¨ï¼šåœ¨ SpringBoot ä¸­ï¼Œé»˜è®¤çš„é™æ€èµ„æºæ˜¯æ”¾åœ¨ä»¥ä¸‹å‡ ä¸ªä½ç½®ï¼š classpath:/META-INF/resources/ classpath:/resources/ classpath:/static/ classpath:/public/ / å…¶ä¸­ç¬¬ 5 ä¸ªè¡¨ç¤º webapp ç›®å½•ä¸­çš„é™æ€èµ„æºä¹Ÿä¸è¢«æ‹¦æˆª æ‰€ä»¥åœ¨è¿™é‡Œè¿™ä¸æ˜¯ä¸€ä¸ªé™æ€èµ„æºï¼Œæˆ‘ä»¬ä»¥å‰çš„åšæ³•å°±æ˜¯ç›´æ¥è¿”å›è¿™ä¸ªé¡µé¢ï¼Œæ²¡å†™ä¸Šé¢çš„ Controller ç›´æ¥ä½¿ç”¨ http://localhost:8080/hello æ˜¯è®¿é—®ä¸åˆ°è¯¥é¡µé¢çš„ äºŒã€åœ¨ SpringBoot ä¸­è¿›è¡Œè·¯å¾„æ˜ å°„åªéœ€è¦è¿›è¡Œå¦‚ä¸‹é…ç½®å°±å¯ä»¥è¿›è¡Œè·¯å¾„æ˜ å°„ 12345678@Configurationpublic class WebMvcConfig implements WebMvcConfigurer &#123; @Override public void addViewControllers(ViewControllerRegistry registry) &#123; registry.addViewController(&quot;wangba&quot;).setViewName(&quot;hello&quot;); &#125;&#125; å†æ¬¡è®¿é—®ï¼šhttp://localhost:8080/wangba ç»“æœï¼š","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"}]},{"title":"0001.Two Sum","slug":"0001-Two-Sum","date":"2020-08-31T13:26:10.000Z","updated":"2020-09-30T07:08:03.901Z","comments":true,"path":"2020/08/31/0001-Two-Sum/","link":"","permalink":"http://wangba.me/2020/08/31/0001-Two-Sum/","excerpt":"","text":"0001. ä¸¤æ•°ä¹‹å’Œ Easyç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªç›®æ ‡å€¼ targetï¼Œè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡ºå’Œä¸ºç›®æ ‡å€¼çš„é‚£ ä¸¤ä¸ª æ•´æ•°ï¼Œå¹¶è¿”å›ä»–ä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚ ä½ å¯ä»¥å‡è®¾æ¯ç§è¾“å…¥åªä¼šå¯¹åº”ä¸€ä¸ªç­”æ¡ˆã€‚ä½†æ˜¯ï¼Œæ•°ç»„ä¸­åŒä¸€ä¸ªå…ƒç´ ä¸èƒ½ä½¿ç”¨ä¸¤éã€‚ ç¤ºä¾‹: 1234ç»™å®š nums &#x3D; [2, 7, 11, 15], target &#x3D; 9å› ä¸º nums[0] + nums[1] &#x3D; 2 + 7 &#x3D; 9æ‰€ä»¥è¿”å› [0, 1] è§£é¢˜æ€è·¯ å‚»ç“œå¼æƒ³æ³•ï¼šéå†ä¸¤æ¬¡ï¼Œæ±‚å’Œï¼ˆå»é™¤é‡å¤çš„å…ƒç´ ï¼Œä½ç½®ä¸åŒçš„ç›¸ç­‰å…ƒç´ å¯ä»¥è¿›è¡Œè®¡ç®—ï¼‰ åŠ›æ‰£å†…å¿ƒOSï¼šä½ è¿™æ ·çš„æ—¶é—´å¤æ‚åº¦èƒ½è¿‡ç®—æˆ‘è¾“ï¼ï¼ï¼ ğŸ˜¯ï¼šå°±è¿™ï¼Œç•¥æ–½å°è®¡ï¼šç©ºé—´æ¢æ—¶é—´ä¹‹æœ¯ é¦–å…ˆï¼Œéå†ä¸€éæ•°ç»„å°†æ•°ç»„çš„å€¼æ”¾å…¥ Map ä¸­ï¼Œç„¶åå†éå†ä¸€æ¬¡ï¼Œå°† target - å–åˆ°çš„å€¼ï¼Œä½†æ˜¯è¦æ³¨æ„ä¸èƒ½ä»…ä»…åˆ¤æ–­æ˜¯ å¦å­˜åœ¨è¿™ä¸ªå€¼ï¼Œå› ä¸ºå¯èƒ½ä¼šå‡ºç°ä¸‹é¢è¿™ç§æƒ…å†µï¼štarget = 4ï¼Œè¯¥æ•°ç»„ä¸­å°±åªæœ‰ä¸€ä¸ª 2ï¼Œè¿™æ ·å°±ä¼šå‡ºé”™ã€‚æ‰€ä»¥è¿˜è¦åˆ¤æ–­ å–åˆ°çš„å€¼è¿˜ä¸èƒ½æ˜¯ç¬¬ä¸€æ¬¡çš„å…ƒç´ ã€‚ ä»£ç ï¼š123456789101112131415161718class Solution &#123; public int[] twoSum(int[] nums, int target) &#123; int[] res = new int[2]; HashMap&lt;Integer, Integer&gt; hashMap = new HashMap&lt;&gt;(); for (int i = 0; i &lt; nums.length; i++) &#123; hashMap.put(nums[i], i); &#125; for (int i = 0; i &lt; nums.length; i++) &#123; int temp = target - nums[i]; if (hashMap.containsKey(temp) &amp;&amp; hashMap.get(temp) != i) &#123; res[0] = hashMap.get(temp); res[1] = i; break; &#125; &#125; return res; &#125;&#125;","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"Array","slug":"Array","permalink":"http://wangba.me/tags/Array/"}]},{"title":"SpringBootä¸­çš„Servletã€Filterã€Listener","slug":"SpringBootä¸­çš„Servletã€Filterã€Listener","date":"2020-08-31T12:08:27.000Z","updated":"2020-09-30T07:07:21.821Z","comments":true,"path":"2020/08/31/SpringBootä¸­çš„Servletã€Filterã€Listener/","link":"","permalink":"http://wangba.me/2020/08/31/SpringBoot%E4%B8%AD%E7%9A%84Servlet%E3%80%81Filter%E3%80%81Listener/","excerpt":"","text":"ä¸€ã€Servlet12345678@WebServlet(urlPatterns = &quot;/MyServlet&quot;)public class MyServlet extends HttpServlet &#123; @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123; System.out.println(&quot;MyServlet&quot;); &#125;&#125; @WebServlet(urlPatterns = â€œ/MyServletâ€)ï¼šæŒ‡å®šServletæŒ‡å®šçš„ URL äºŒã€Filter12345678910111213141516171819@WebFilter(&quot;/*&quot;)public class MyFilter implements Filter &#123; @Override public void init(FilterConfig filterConfig) throws ServletException &#123; &#125; @Override public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException &#123; System.out.println(&quot;MyFilter&quot;); chain.doFilter(request, response); &#125; @Override public void destroy() &#123; &#125;&#125; @WebFilter(â€œ/*â€)ï¼šæŒ‡å®šè·¯å¾„è¿›è¡Œè¿‡æ»¤ ä¸‰ã€Listener123456789101112@WebListenerpublic class MyListener implements ServletRequestListener &#123; @Override public void requestInitialized(ServletRequestEvent sre) &#123; System.out.println(&quot;requestInitialized.............&quot;); &#125; @Override public void requestDestroyed(ServletRequestEvent sre) &#123; System.out.println(&quot;requestDestroyed................&quot;); &#125;&#125; @WebListenerï¼šæ ‡æ³¨ä¸ºç›‘å¬å™¨ å¯ä»¥è‡ªè¡Œæµ‹è¯•ä¿®æ”¹è·¯ç”±è·¯å¾„ç­‰è¿›è¡Œæµ‹è¯• å››ã€åŒºåˆ«å¯åŠ¨ç»“æœï¼šhttp://localhost:8080/MyServlet é…åˆå®˜æ–¹å›¾è§£é‡Šä¸€ä¸‹ï¼š é¦–å…ˆæ˜¯ Listener ==&gt; Filter ==&gt; Servlet ä¸‹é¢è¿˜æœ‰ä¸€æ¬¡ï¼š 12MyFilterrequestDestroyed................ å†æµè§ˆå™¨æ‰“å¼€æ§åˆ¶å°ï¼Œå¼ºåˆ¶åˆ·æ–°ä¸€ä¸‹ï¼šmacOS(å¿«æ·é”®ï¼šcommand + shift + R)ï¼Œå¯ä»¥çœ‹åˆ°ï¼š æœ€ä¸‹é¢çš„é‚£ä¸ªæ˜¯æˆ‘çš„æµè§ˆå™¨æ‰©å±•åŠ è½½çš„è„šæœ¬","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"}]},{"title":"SpringBootä¸­å®šä¹‰ç³»ç»Ÿå¯åŠ¨ä»»åŠ¡","slug":"SpringBootä¸­å®šä¹‰ç³»ç»Ÿå¯åŠ¨ä»»åŠ¡","date":"2020-08-22T11:26:24.000Z","updated":"2020-09-30T07:07:19.950Z","comments":true,"path":"2020/08/22/SpringBootä¸­å®šä¹‰ç³»ç»Ÿå¯åŠ¨ä»»åŠ¡/","link":"","permalink":"http://wangba.me/2020/08/22/SpringBoot%E4%B8%AD%E5%AE%9A%E4%B9%89%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E4%BB%BB%E5%8A%A1/","excerpt":"","text":"ä¸€ã€CommandLineRunneré€šè¿‡å®ç° CommandLineRunner æ¥å®šä¹‰å¯åŠ¨ä»»åŠ¡ï¼š 12345678@Component@Order(1)public class MyCommandLineRunner implements CommandLineRunner &#123; @Override public void run(String... args) throws Exception &#123; System.out.println(&quot;Order(1):&quot; + Arrays.toString(args)); &#125;&#125; 12345678@Component@Order(2)public class MyCommandLineRunner01 implements CommandLineRunner &#123; @Override public void run(String... args) throws Exception &#123; System.out.println(&quot;Order(2):&quot; + Arrays.toString(args)); &#125;&#125; å…¶ä¸­ï¼š @Order æ³¨è§£ä¸ºä¼˜å…ˆçº§ï¼Œæ•°å€¼è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼› args ä¸ºå¯åŠ¨ç±»ä¸­çš„ String[] argsï¼› args å‚æ•°å¯ä»¥åœ¨é…ç½®é‡Œé¢çš„ Program argumens è¿›è¡Œé…ç½®ï¼Œä¹Ÿå¯ä»¥æ‰“æˆ jar åŒ…çš„æ—¶å€™ï¼Œä½¿ç”¨å‘½ä»¤è¿›è¡Œè®¾ç½® æœ€ç»ˆç»“æœå¦‚ä¸‹ï¼š å¯ä»¥çœ‹åˆ° Order(1) çš„ä¼˜å…ˆçº§é«˜äº Order(2) äºŒã€ApplicationRunneré€šè¿‡å®ç° ApplicationRunner æ¥å®šä¹‰å¯åŠ¨ä»»åŠ¡ï¼š 1234567891011121314151617181920@Component@Order(3)public class MyApplicationRunner implements ApplicationRunner &#123; @Override public void run(ApplicationArguments args) throws Exception &#123; System.out.println(&quot;Order3:&quot;); String[] sourceArgs = args.getSourceArgs(); System.out.println(&quot;sourceArg:&quot; + Arrays.toString(sourceArgs)); System.out.println(&quot;ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°&quot;); List&lt;String&gt; nonOptionArgs = args.getNonOptionArgs(); System.out.println(&quot;nonOptionArgs:&quot; + nonOptionArgs); System.out.println(&quot;ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°&quot;); Set&lt;String&gt; optionNames = args.getOptionNames(); for (String optionName : optionNames) &#123; System.out.println(optionName + args.getOptionValues(optionName)); &#125; &#125;&#125; 123456789101112131415161718192021@Component@Order(4)public class MyApplicationRunner01 implements ApplicationRunner &#123; @Override public void run(ApplicationArguments args) throws Exception &#123; System.out.println(&quot;Order4&quot;); String[] sourceArgs = args.getSourceArgs(); System.out.println(&quot;sourceArg:&quot; + Arrays.toString(sourceArgs)); System.out.println(&quot;ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°&quot;); List&lt;String&gt; nonOptionArgs = args.getNonOptionArgs(); System.out.println(&quot;nonOptionArgs:&quot; + nonOptionArgs); System.out.println(&quot;ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°&quot;); Set&lt;String&gt; optionNames = args.getOptionNames(); for (String optionName : optionNames) &#123; System.out.println(optionName + args.getOptionValues(optionName)); &#125; System.out.println(&quot;ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°&quot;); &#125;&#125; args.getNonOptionArgs()ï¼šå¯ä»¥ç”¨æ¥è·å–å‘½ä»¤è¡Œä¸­çš„æ— keyå‚æ•°ï¼› args.getOptionNames()ï¼šå¯ä»¥ç”¨æ¥è·å–æ‰€æœ‰key/valueå½¢å¼çš„å‚æ•°çš„keyï¼› args.getOptionValues(key))ï¼šå¯ä»¥æ ¹æ®keyè·å–key/value å½¢å¼çš„å‚æ•°çš„valueï¼› args.getSourceArgs();ï¼šåˆ™è¡¨ç¤ºè·å–å‘½ä»¤è¡Œä¸­çš„æ‰€æœ‰å‚æ•°ã€‚ å‚æ•°é…ç½®ï¼š æœ€ç»ˆç»“æœï¼š æ³¨ï¼šCommandLineRunner å’Œ ApplicationRunner æ˜¯å¯ä»¥ä¸€èµ·ç”¨çš„ï¼Œä¼˜å…ˆçº§è¿˜æ˜¯é€šè¿‡ @Order è¿›è¡Œæ’åº ç»“æœï¼š","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"}]},{"title":"SpringBootæ•´åˆè¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨","slug":"SpringBootæ•´åˆè¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨","date":"2020-08-20T12:32:06.000Z","updated":"2020-09-30T07:07:15.616Z","comments":true,"path":"2020/08/20/SpringBootæ•´åˆè¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨/","link":"","permalink":"http://wangba.me/2020/08/20/SpringBoot%E6%95%B4%E5%90%88%E8%BF%87%E6%BB%A4%E5%99%A8%E5%92%8C%E6%8B%A6%E6%88%AA%E5%99%A8/","excerpt":"","text":"ä¸€ã€è¿‡æ»¤å™¨æ–°å»ºå¦‚ä¸‹çš„ Controllerï¼š 123456789@RestControllerpublic class UserController &#123; @GetMapping(&quot;user/&#123;id&#125;&quot;) public void get(@PathVariable String id) &#123; System.out.println(id); &#125;&#125; è¿‡æ»¤å™¨çš„å®ç°ï¼šå®šä¹‰ä¸€ä¸ªç±»å®ç° Filter ï¼Œå¹¶é‡å†™å…¶ä¸­çš„æ–¹æ³• 123456789101112131415161718192021222324@Component@WebFilter(urlPatterns = &quot;/*&quot;)public class TimeFilter implements Filter &#123; @Override public void init(FilterConfig filterConfig) throws ServletException &#123; System.out.println(&quot;Initialization&quot;); &#125; @Override public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException &#123; System.out.println(&quot;++++++++ Start ++++++++&quot;); Long start = new Date().getTime(); filterChain.doFilter(servletRequest, servletResponse); System.out.println(&quot;Filter costs: &quot;); System.out.println(new Date().getTime() - start); System.out.println(&quot;++++++++ End ++++++++&quot;); &#125; @Override public void destroy() &#123; System.out.println(&quot;Filter is over&quot;); &#125;&#125; init æ–¹æ³•ï¼šæ˜¯å¯¹é¡¹ç›®å¯åŠ¨æ—¶ï¼Œè¿›è¡Œçš„åˆå§‹åŒ– doFilter æ–¹æ³•ï¼šå½“æ‰§è¡Œä¸€ä¸ªè¯·æ±‚çš„æ—¶å€™ï¼Œè¿›è¡Œè¿‡æ»¤ destroy æ–¹æ³•ï¼šå½“è¿™ä¸ªé¡¹ç›®å…³é—­æ—¶ï¼Œè¯¥è¿‡æ»¤å™¨ä¹Ÿè¢«é”€æ¯äº† æµè§ˆå™¨è¿è¡Œï¼šhttp://localhost:8080/user/666 ç»“æœï¼š åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å‡ºç°äº†ä¸€ç‚¹é—®é¢˜ï¼š å½“æˆ‘ä»¬è¿›è¡Œä¸‹é¢è¿™ç§è¿‡æ»¤ä¸€éƒ¨åˆ†çš„æƒ…å†µä¸‹ï¼š TimeFilter 12345678910111213141516171819202122232425@Component@WebFilter(urlPatterns = &#123;&quot;/user/*&quot;&#125;)public class TimeFilter implements Filter &#123; @Override public void init(FilterConfig filterConfig) throws ServletException &#123; System.out.println(filterConfig.getServletContext().getContextPath()); System.out.println(&quot;Initialization........&quot;); &#125; @Override public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException &#123; System.out.println(&quot;++++++++ Start ++++++++&quot;); Long start = new Date().getTime(); filterChain.doFilter(servletRequest, servletResponse); System.out.println(&quot;Filter costs: &quot;); System.out.println(new Date().getTime() - start); System.out.println(&quot;++++++++ End ++++++++&quot;); &#125; @Override public void destroy() &#123; System.out.println(&quot;Filter is over&quot;); &#125;&#125; UserController 123456789@RestControllerpublic class UserController &#123; @GetMapping(&quot;user/&#123;id&#125;&quot;) public void get(@PathVariable String id) &#123; System.out.println(&quot;userIDï¼š&quot; +id); &#125;&#125; HelloController 12345678@RestControllerpublic class HelloController &#123; @RequestMapping(&quot;hello&quot;) public String hello() &#123; return &quot;hello&quot;; &#125;&#125; æ­¤æ—¶æˆ‘ä»¬è¿‡æ»¤çš„æ˜¯ /user åé¢æ‰€æœ‰çš„è¯·æ±‚ï¼Œä½†æ˜¯ç»“æœæ˜¯ UserController å’Œ HelloController éƒ½è¿›å…¥äº†è¿‡æ»¤å™¨ä¸­ï¼š æœ€ç»ˆè§£å†³æ–¹æ¡ˆï¼šå»æ‰åœ¨ TimeFilter ä¸­çš„ @Component æ³¨è§£ï¼Œåœ¨å¯åŠ¨ç±»ä¸ŠåŠ ä¸Š @ServletComponentScan æ³¨è§£å³å¯ï¼š åœ¨ä¸Šé¢æˆ‘ä»¬ä½¿ç”¨äº†æ³¨è§£çš„æ–¹å¼è¿›è¡Œè¿‡æ»¤ï¼š @WebFilter(urlPatterns = â€œ/*â€) ç¬¬äºŒç§æ–¹å¼ï¼š å»æ‰ @Component å’Œ *@WebFilter(urlPatterns = {â€œ/user/â€œ})** æ³¨è§£ï¼Œå¹¶é…ç½®å¦‚ä¸‹çš„é…ç½®ç±»ï¼š 123456789101112131415@Configurationpublic class WebConfig &#123; @Bean public FilterRegistrationBean timeFilter() &#123; FilterRegistrationBean filterRegistrationBean = new FilterRegistrationBean(); TimeFilter timeFilter = new TimeFilter(); filterRegistrationBean.setFilter(timeFilter); List&lt;String&gt; urlList = new ArrayList&lt;&gt;(); urlList.add(&quot;/user/*&quot;); filterRegistrationBean.setUrlPatterns(urlList); return filterRegistrationBean; &#125;&#125; äºŒã€æ‹¦æˆªå™¨ç¼–å†™ä¸€ä¸ªæ‹¦æˆªå™¨ç±»å®ç° HandlerInterceptor ï¼Œå¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425public class TimeInterceptor implements HandlerInterceptor &#123; @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; System.out.println(&quot;å¤„ç†æ‹¦æˆªä¹‹å‰&quot;); request.setAttribute(&quot;startTime&quot;, new Date().getTime()); System.out.println(((HandlerMethod) handler).getBean().getClass().getName()); System.out.println(((HandlerMethod) handler).getMethod().getName()); return true; &#125; @Override public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception &#123; System.out.println(&quot;å¼€å§‹å¤„ç†æ‹¦æˆª&quot;); Long start = (Long) request.getAttribute(&quot;startTime&quot;); System.out.println(&quot;ã€æ‹¦æˆªå™¨ã€‘è€—æ—¶ &quot; + (new Date().getTime() - start)); &#125; @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception &#123; System.out.println(&quot;å¤„ç†æ‹¦æˆªä¹‹å&quot;); Long start = (Long) request.getAttribute(&quot;startTime&quot;); System.out.println(&quot;ã€æ‹¦æˆªå™¨ã€‘è€—æ—¶ &quot; + (new Date().getTime() - start)); System.out.println(&quot;å¼‚å¸¸ä¿¡æ¯ &quot; + ex); &#125;&#125; preHandle æ–¹æ³•åœ¨å¤„ç†æ‹¦æˆªä¹‹å‰æ‰§è¡Œ postHandle æ–¹æ³•åªæœ‰å½“è¢«æ‹¦æˆªçš„æ–¹æ³•æ²¡æœ‰æŠ›å‡ºå¼‚å¸¸æˆåŠŸæ—¶æ‰ä¼šå¤„ç† afterCompletion æ–¹æ³•æ— è®ºè¢«æ‹¦æˆªçš„æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ä¸å¦éƒ½ä¼šæ‰§è¡Œ å°†æˆ‘ä»¬å†™å¥½çš„æ‹¦æˆªå™¨æ³¨å†Œåˆ°å®¹å™¨ä¸­ï¼š 123456789101112@Configurationpublic class InterceptorConfig implements WebMvcConfigurer &#123; @Autowired TimeInterceptor timeInterceptor; @Override public void addInterceptors(InterceptorRegistry registry) &#123; registry.addInterceptor(timeInterceptor).addPathPatterns(&quot;/user/*&quot;); &#125;&#125; åŒæ ·åˆ†åˆ«è¿è¡Œï¼šhttp://localhost:8080/user/888 å’Œ http://localhost:8080/hello å¯ä»¥çœ‹è§ç»“æœå¦‚ä¸‹ï¼š åªæ˜¯å¯¹ user/888 è¿›è¡Œæ‹¦æˆªäº†ï¼Œå¯¹ hello æ²¡æœ‰è¿›è¡Œæ‹¦æˆª ä¸‰ã€è¿‡æ»¤å™¨ä¸æ‹¦æˆªå™¨çš„å¯¹æ¯”æˆ‘ä»¬å†å°†å‰é¢çš„è¿‡æ»¤å™¨åŠ å…¥å…¶ä¸­ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœï¼š æœ‰ä¸€å¼ å·²ç»æ•´ç†å¥½æ‰§è¡Œé¡ºåºå›¾ï¼š","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"}]},{"title":"SpringBootä¸­è·¨åŸŸé—®é¢˜","slug":"SpringBootä¸­è·¨åŸŸé—®é¢˜","date":"2020-08-20T10:16:59.000Z","updated":"2020-09-30T07:07:17.590Z","comments":true,"path":"2020/08/20/SpringBootä¸­è·¨åŸŸé—®é¢˜/","link":"","permalink":"http://wangba.me/2020/08/20/SpringBoot%E4%B8%AD%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98/","excerpt":"","text":"ä¸€ã€åŒæºç­–ç•¥â€‹ åŒæºç­–ç•¥æ˜¯ç”± Netscape æå‡ºçš„ä¸€ä¸ªè‘—åçš„å®‰å…¨ç­–ç•¥ï¼Œå®ƒæ˜¯æµè§ˆå™¨æœ€æ ¸å¿ƒä¹Ÿæœ€åŸºæœ¬çš„å®‰å…¨åŠŸèƒ½ï¼Œç°åœ¨æ‰€æœ‰æ”¯æŒ JavaScript çš„æµè§ˆå™¨éƒ½ä¼šä½¿ç”¨è¿™ä¸ªç­–ç•¥ã€‚æ‰€è°“åŒæºæ˜¯æŒ‡åè®®ã€åŸŸåä»¥åŠç«¯å£è¦ç›¸åŒã€‚åŒæºç­–ç•¥æ˜¯åŸºäºå®‰å…¨æ–¹é¢çš„è€ƒè™‘æå‡ºæ¥çš„ï¼Œè¿™ä¸ªç­–ç•¥æœ¬èº«æ²¡é—®é¢˜ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨å®é™…å¼€å‘ä¸­ï¼Œç”±äºå„ç§åŸå› åˆç»å¸¸æœ‰è·¨åŸŸçš„éœ€æ±‚ï¼Œä¼ ç»Ÿçš„è·¨åŸŸæ–¹æ¡ˆæ˜¯ JSONPï¼ŒJSONP è™½ç„¶èƒ½è§£å†³è·¨åŸŸä½†æ˜¯æœ‰ä¸€ä¸ªå¾ˆå¤§çš„å±€é™æ€§ï¼Œé‚£å°±æ˜¯åªæ”¯æŒ GET è¯·æ±‚ï¼Œä¸æ”¯æŒå…¶ä»–ç±»å‹çš„è¯·æ±‚ï¼Œè€Œ CORSï¼ˆè·¨åŸŸæºèµ„æºå…±äº«ï¼‰ï¼ˆCORSï¼ŒCross-origin resource sharingï¼‰æ˜¯ä¸€ä¸ª W3C æ ‡å‡†ï¼Œå®ƒæ˜¯ä¸€ä»½æµè§ˆå™¨æŠ€æœ¯çš„è§„èŒƒï¼Œæä¾›äº† Web æœåŠ¡ä»ä¸åŒç½‘åŸŸä¼ æ¥æ²™ç›’è„šæœ¬çš„æ–¹æ³•ï¼Œä»¥é¿å¼€æµè§ˆå™¨çš„åŒæºç­–ç•¥ï¼Œè¿™æ˜¯ JSONP æ¨¡å¼çš„ç°ä»£ç‰ˆã€‚åœ¨ Spring æ¡†æ¶ä¸­ï¼Œå¯¹äº CORS ä¹Ÿæä¾›äº†ç›¸åº”çš„è§£å†³æ–¹æ¡ˆï¼Œ SpringBoot ä¸­å¦‚ä½•å®ç° CORSã€‚ äºŒã€å¦‚ä½•å‡ºç°å¯åŠ¨ä¸¤ä¸ª SpringBoot é¡¹ç›®ï¼Œåˆ†åˆ«ä»¥ 8080 å’Œ 8081 ç«¯å£å¯åŠ¨ï¼Œåœ¨å…¶ä¸­ä¸€ä¸ªå†™ä¸Šå¦‚ä¸‹çš„ Controllerï¼š 1234567891011121314@RestControllerpublic class HelloController &#123; @PostMapping(&quot;/hello&quot;) public String hello1() &#123; return &quot;get hello&quot;; &#125; @GetMapping(&quot;/hello&quot;) public String hello2() &#123; return &quot;post hello&quot;; &#125;&#125; åœ¨å¦ä¸€ä¸ªä¸­å†™å…¥ä¸€ä¸ªé™æ€é¡µé¢ï¼š 1234567891011121314151617181920212223242526&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot; xmlns:th=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;Title&lt;/title&gt; &lt;script src=&quot;jquery-3.5.1.js&quot;&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div id=&quot;app&quot;&gt;&lt;/div&gt;&lt;input type=&quot;button&quot; onclick=&quot;btnClick()&quot; value=&quot;get_button&quot;&gt;&lt;input type=&quot;button&quot; onclick=&quot;btnClick2()&quot; value=&quot;post_button&quot;&gt;&lt;script&gt; function btnClick() &#123; $.get(&#x27;http://localhost:8080/hello&#x27;, function (msg) &#123; $(&quot;#app&quot;).html(msg); &#125;); &#125; function btnClick2() &#123; $.post(&#x27;http://localhost:8080/hello&#x27;, function (msg) &#123; $(&quot;#app&quot;).html(msg); &#125;); &#125;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt; æ³¨ï¼šè®°å¾—å¼•å…¥ Jquery åœ¨ http://localhost:8081/hello.html ç‚¹å‡»ä»»ä½•è¯·æ±‚ï¼š å¯ä»¥çœ‹åˆ°æ­¤æ—¶å·²ç»å‘ç”Ÿè·¨åŸŸé—®é¢˜ ä¸‰ã€è§£å†³æ–¹æ¡ˆä»åç«¯è§£å†³ï¼Œä¿®æ”¹ Controller ä¸ºï¼š 12345678910111213141516@RestControllerpublic class HelloController &#123; @CrossOrigin(origins = &quot;http://localhost:8081&quot;) @PostMapping(&quot;/hello&quot;) public String hello1() &#123; return &quot;post hello&quot;; &#125; @CrossOrigin(value = &quot;http://localhost:8081&quot;) @GetMapping(&quot;/hello&quot;) public String hello2() &#123; return &quot;get hello&quot;; &#125;&#125; å…¶ä¸­ origins ä¸ value æ•ˆæœä¸€æ ·ï¼Œçœ‹æºç å¯ä»¥çŸ¥é“å®ƒä»¬äº’ç›¸æˆä¸ºå¯¹æ–¹çš„åˆ«å æ­¤æ—¶å·²ç»ä¸ä¼šå‡ºç°è·¨åŸŸé—®é¢˜ å››ã€åŠ å¼ºç‰ˆè§£å†³æ­¤æ—¶ï¼Œåœ¨æ¯ä¸€ä¸ªç±»æˆ–è€…æ–¹æ³•ä¸Šéƒ½ä½¿ç”¨è¿™ä¸ªæ³¨è§£ï¼Œæ³•å¤–ç‹‚å¾’å¼ ä¸‰éƒ½è§‰å¾—è¿™ä¸ªå¤ªéº»çƒ¦äº† åªéœ€è¦é…ç½®ä¸€ä¸ªå®ç° WebMvcConfigurer é…ç½®ç±»ï¼Œå¦‚ä¸‹ï¼š 12345678public class CORSConfig implements WebMvcConfigurer &#123; @Override public void addCorsMappings(CorsRegistry registry) &#123; registry.addMapping(&quot;/**&quot;).allowedOrigins(&quot;http://localhost:8081&quot;) .allowedMethods(&quot;*&quot;) .allowedHeaders(&quot;*&quot;); &#125;&#125; æ³¨ï¼š/** è¡¨ç¤ºæœ¬åº”ç”¨çš„æ‰€æœ‰æ–¹æ³•éƒ½ä¼šå»å¤„ç†è·¨åŸŸè¯·æ±‚ï¼›allowedMethods è¡¨ç¤ºå…è®¸é€šè¿‡çš„è¯·æ±‚æ•°ï¼›allowedHeaders åˆ™è¡¨ç¤ºå…è®¸çš„è¯·æ±‚å¤´ã€‚ äº”ã€å®‰å…¨é—®é¢˜å‡ºç°äº†ä¸€ä¸ªç‹å…«è€æœ¬è¡Œçš„é—®é¢˜ï¼šé€šè¿‡ Ajax å‘é€è·¨åŸŸè¯·æ±‚ï¼Œè™½ç„¶ç”¨æˆ·ä½“éªŒæé«˜äº†ï¼Œä½†æ˜¯ä¹Ÿæœ‰æ½œåœ¨çš„å¨èƒå­˜åœ¨ï¼Œå¸¸è§çš„å°±æ˜¯ CSRFï¼ˆCross-site request forgeryï¼‰è·¨ç«™è¯·æ±‚ä¼ªé€ ã€‚ ä¸€å¥è¯ï¼šåˆ©ç”¨æˆ‘ä»¬è¿˜åœ¨ç™»å½•çš„çŠ¶æ€ï¼Œå³ Cookie æœ‰æ•ˆï¼Œæ‰“å¼€ä¸€ä¸ªæ­£å¸¸ç½‘ç«™ï¼Œè€Œè¿™ä¸ªç½‘ç«™ä¸Šå¯èƒ½æœ‰ä¸€ä¸ªéæ­£å¸¸æ“ä½œ ( å›¾ç‰‡ï¼Œé“¾æ¥ç­‰) ï¼Œé‚£ä½ å°±å¯èƒ½å·²ç»è¢«æ”»å‡»ã€‚ åœ¨ä¿¡æ¯å®‰å…¨ä¸­ï¼Œæˆ‘ä»¬é˜²å¾¡ CSRF çš„æ–¹æ³•ä¸»è¦æ˜¯å¢åŠ  Tokenï¼Œè¿™ä¹Ÿæ˜¯ç°åœ¨å¤§å¤šæ•°é˜²å¾¡ CSRF çš„æ–¹å¼ã€‚","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"}]},{"title":"SpringBootä¸­è‡ªå®šä¹‰å¼‚å¸¸","slug":"SpringBootä¸­è‡ªå®šä¹‰å¼‚å¸¸","date":"2020-08-19T09:11:17.000Z","updated":"2020-09-30T07:07:13.559Z","comments":true,"path":"2020/08/19/SpringBootä¸­è‡ªå®šä¹‰å¼‚å¸¸/","link":"","permalink":"http://wangba.me/2020/08/19/SpringBoot%E4%B8%AD%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8/","excerpt":"","text":"ä¸€ã€æ­£å¸¸å‡ºç°å¼‚å¸¸Controllerï¼š 12345678910@RestControllerpublic class ErrorController &#123; @GetMapping(&quot;/diyError&quot;) public String error() &#123; int i = 2 / 0; return &quot;diyError&quot;; &#125; &#125; ç»“æœï¼š å¯ä»¥çœ‹è§æ­¤é”™è¯¯é¡µæ˜¯ SpringBoot æä¾›çš„ï¼Œç”±äºæˆ‘ä»¬æ²¡æœ‰æä¾› /error é¡µé¢ï¼Œé¡ºä¾¿å±•ç¤ºæˆ‘ä»¬å‡ºç°çš„é”™è¯¯ äºŒã€é™æ€é¡µé¢å¼‚å¸¸åœ¨ static ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª error ç›®å½•ï¼Œå¹¶åœ¨å…¶ä¸­æ–°å»º 404.html å’Œ 500.htmlï¼š 404.html: 12345678910&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;Title&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;404&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt; 500.htmlï¼š 12345678910&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;Title&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;500&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt; å†æ¬¡è®¿é—® http://localhost:8080/diyError å¯ä»¥çœ‹è§å·²ç»è¿›å…¥è‡ªå®šä¹‰çš„é™æ€é¡µé¢äº†ï¼š å†è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„é¡µé¢ï¼š æ³¨ï¼šä¹Ÿå¯ä»¥åªå®šä¹‰ 4xx.html ä¸ 5xx.html çš„é™æ€é¡µé¢ï¼Œåªè¦å‘ç”Ÿ 400-499 çš„çŠ¶æ€ç æˆ–è€… 500-599 çš„çŠ¶æ€ç å°±å¯¹åº” 4xx.html ä¸ 5xx.html çš„ç»“æœ ä¸‰ã€åŠ¨æ€é¡µé¢å¼‚å¸¸å¼•å…¥ thymeleaf çš„ä¾èµ–ï¼š 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;&lt;/dependency&gt; åœ¨ templates ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª error ç›®å½•ï¼Œå¹¶åœ¨å…¶ä¸­æ–°å»º 404.htmlã€ 500.htmlã€ 4xx.htmlã€5xx.html ï¼š å†æ¬¡è®¿é—® http://localhost:8080/diyError å¯ä»¥çœ‹è§å·²ç»è¿›å…¥è‡ªå®šä¹‰çš„åŠ¨æ€é¡µé¢äº†ï¼š ä¼˜å…ˆçº§ï¼š å¦‚æœæœ‰ 404 çš„é¡µé¢ï¼Œä¼šå…ˆæ‰¾ 404.htmlï¼›å¦‚æœæ²¡æœ‰å°±ä¼šæ‰¾ 4xx.html å¦‚æœåŠ¨æ€é¡µé¢å’Œé™æ€é¡µé¢åŒæ—¶å­˜åœ¨ï¼Œä¼šä¼˜å…ˆä½¿ç”¨åŠ¨æ€é¡µé¢ å®Œæ•´é¡ºåºå¤§æ¦‚å¦‚ä¸‹ï¼š å‘ç”Ÿäº†500é”™è¯¯ â€“&gt; æŸ¥æ‰¾åŠ¨æ€ 500.html é¡µé¢ â€“&gt; æŸ¥æ‰¾é™æ€ 500.html â€“&gt; æŸ¥æ‰¾åŠ¨æ€ 5xx.html â€“&gt; æŸ¥æ‰¾é™æ€ 5xx.html å››ã€SpringBoot æ€ä¹ˆè‡ªåŠ¨é…ç½®å…³é”®ç±»ï¼šErrorMvcAutoConfiguration 12345678910111213141516171819202122@Configuration(proxyBeanMethods = false)static class DefaultErrorViewResolverConfiguration &#123; private final ApplicationContext applicationContext; private final ResourceProperties resourceProperties; DefaultErrorViewResolverConfiguration(ApplicationContext applicationContext, ResourceProperties resourceProperties) &#123; this.applicationContext = applicationContext; this.resourceProperties = resourceProperties; &#125; @Bean @ConditionalOnBean(DispatcherServlet.class) @ConditionalOnMissingBean(ErrorViewResolver.class) // é»˜è®¤çš„é”™è¯¯è§†å›¾è§£æå™¨ DefaultErrorViewResolver DefaultErrorViewResolver conventionErrorViewResolver() &#123; return new DefaultErrorViewResolver(this.applicationContext, this.resourceProperties); &#125;&#125; åœ¨é»˜è®¤çš„é”™è¯¯è§†å›¾è§£æå™¨ DefaultErrorViewResolver ä¸­ï¼š 12345678@Overridepublic ModelAndView resolveErrorView(HttpServletRequest request, HttpStatus status, Map&lt;String, Object&gt; model) &#123; ModelAndView modelAndView = resolve(String.valueOf(status.value()), model); if (modelAndView == null &amp;&amp; SERIES_VIEWS.containsKey(status.series())) &#123; modelAndView = resolve(SERIES_VIEWS.get(status.series()), model); &#125; return modelAndView;&#125; å¦‚æœ modelAndView ä¸ºç©ºï¼Œå³æ²¡æ‰¾åˆ°å¯¹åº”çš„å…·ä½“ 404.htmlï¼Œå°±ä¼šç”¨ SERIES_VIEWS.containsKey(status.series()) æ‰¾ 4xx.html 123456789private ModelAndView resolve(String viewName, Map&lt;String, Object&gt; model) &#123; String errorViewName = &quot;error/&quot; + viewName; TemplateAvailabilityProvider provider = this.templateAvailabilityProviders.getProvider(errorViewName, this.applicationContext); if (provider != null) &#123; return new ModelAndView(errorViewName, model); &#125; return resolveResource(errorViewName, model);&#125; åˆ¤æ–­ error æ–‡ä»¶å¤¹ä¸‹é¢æ˜¯å¦æœ‰å¯¹åº”çš„çŠ¶æ€ç çš„æ–‡æ¡£ å†åˆ¤æ–­æ˜¯å¦æœ‰åŠ¨æ€é¡µé¢ï¼Œå³ TemplateAvailabilityProvider å¦‚æœæ˜¯åŠ¨æ€é¡µé¢ï¼Œå°±è¿”å›åŠ¨æ€é¡µé¢ï¼›å¦åˆ™è¿”å›é™æ€é¡µé¢ 1234567891011121314private ModelAndView resolveResource(String viewName, Map&lt;String, Object&gt; model) &#123; for (String location : this.resourceProperties.getStaticLocations()) &#123; try &#123; Resource resource = this.applicationContext.getResource(location); resource = resource.createRelative(viewName + &quot;.html&quot;); if (resource.exists()) &#123; return new ModelAndView(new HtmlResourceView(resource), model); &#125; &#125; catch (Exception ex) &#123; &#125; &#125; return null;&#125; äº”ã€è‡ªå®šä¹‰å¼‚å¸¸æ•°æ®åœ¨ ErrorMvcAutoConfiguration ä¸­ï¼Œå¤„ç†å¼‚å¸¸æ•°æ®çš„æ–¹æ³•ï¼š 12345@Bean@ConditionalOnMissingBean(value = ErrorAttributes.class, search = SearchStrategy.CURRENT)public DefaultErrorAttributes errorAttributes() &#123; return new DefaultErrorAttributes();&#125; åœ¨ DefaultErrorAttributes() ä¸­é€šè¿‡è®¾ç½®å‚æ•°å¾—åˆ°ç›¸åº”çš„ç»“æœ ä¾‹å¦‚ï¼šå°† error ä¸­çš„ 5xx.html æ”¹ä¸ºï¼š 123456789101112131415161718192021222324252627282930313233343536&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot; xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;Title&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;5xx&lt;/h1&gt;&lt;table border=&quot;1&quot;&gt; &lt;tr&gt; &lt;td&gt;path&lt;/td&gt; &lt;td th:text=&quot;$&#123;path&#125;&quot;&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;error&lt;/td&gt; &lt;td th:text=&quot;$&#123;error&#125;&quot;&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;message&lt;/td&gt; &lt;td th:text=&quot;$&#123;message&#125;&quot;&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;timestamp&lt;/td&gt; &lt;td th:text=&quot;$&#123;timestamp&#125;&quot;&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;status&lt;/td&gt; &lt;td th:text=&quot;$&#123;status&#125;&quot;&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;trace&lt;/td&gt; &lt;td th:text=&quot;$&#123;trace&#125;&quot;&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/body&gt;&lt;/html&gt; æ­¤æ—¶ä»”è¿è¡Œç»“æœï¼š å†çœ‹ä¸€ä¸‹ä½¿ DefaultErrorAttributes ç”Ÿæ•ˆçš„æ¡ä»¶ï¼š @ConditionalOnMissingBean(value = ErrorAttributes.class, search = SearchStrategy.CURRENT) æ‰€ä»¥åªè¦æˆ‘ä»¬è‡ªå®šä¹‰ ErrorAttributes.class å°±å¯ä»¥å®ç°è‡ªå·±å®šä¹‰çš„å¼‚å¸¸æ•°æ®å¤„ç† è‡ªå®šä¹‰ ErrorAttributes æœ‰ä¸¤ç§æ–¹å¼ ï¼š ç›´æ¥å®ç° ErrorAttributes æ¥å£ ç»§æ‰¿ DefaultErrorAttributesï¼ˆæ¨èï¼‰ï¼Œå› ä¸º DefaultErrorAttributes ä¸­å¯¹å¼‚å¸¸æ•°æ®çš„å¤„ç†å·²ç»å®Œæˆï¼Œå¼€å‘è€…å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚ æ–°å»ºä¸€ä¸ªé…ç½®ç±»ç»§æ‰¿ DefaultErrorAttributes 12345678910@Componentpublic class MyErrorConfig extends DefaultErrorAttributes &#123; @Override public Map&lt;String, Object&gt; getErrorAttributes(WebRequest webRequest, ErrorAttributeOptions options) &#123; Map&lt;String, Object&gt; errorAttributes = super.getErrorAttributes(webRequest, options); errorAttributes.put(&quot;myerror&quot;, &quot;è‡ªå®šä¹‰å¼‚å¸¸&quot;); return errorAttributes; &#125;&#125; åœ¨ 5xx.html ä¸­åŠ å…¥ï¼š 1234&lt;tr&gt; &lt;td&gt;myerror&lt;/td&gt; &lt;td th:text=&quot;$&#123;myerror&#125;&quot;&gt;&lt;/td&gt;&lt;/tr&gt; è¿è¡Œç»“æœï¼šå¯ä»¥çœ‹åˆ°æ­¤æ—¶çš„è‡ªå®šä¹‰çš„ error å·²ç»åŠ å…¥","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"}]},{"title":"SpringBootæ•´åˆJSON","slug":"SpringBootæ•´åˆJSON","date":"2020-08-18T13:01:28.000Z","updated":"2020-09-30T07:07:11.653Z","comments":true,"path":"2020/08/18/SpringBootæ•´åˆJSON/","link":"","permalink":"http://wangba.me/2020/08/18/SpringBoot%E6%95%B4%E5%90%88JSON/","excerpt":"","text":"ä¸€ã€Jackson1. ç¯å¢ƒæ­å»ºåªè¦åŠ å…¥æ™®é€šçš„ Web ä¾èµ–å°±è¡Œï¼Œä¸ºäº†æ–¹ä¾¿ä¾ç„¶å¼•å…¥ Lombok å’Œ çƒ­éƒ¨ç½² æ‰“å¼€ Maven ä¾èµ–å¯ä»¥çœ‹è§ SpringBoot è‡ªå¸¦çš„å°±æ˜¯ jackson 2. SpringBootä¸­ä½¿ç”¨2.1 å»ºç«‹å®ä½“ç±»ï¼š 12345678@Datapublic class User &#123; private Integer id; private String name; private String address; private Date date;&#125; 2.2 Controllerå±‚ï¼š 1234567891011121314151617@RestControllerpublic class UserController &#123; @GetMapping(&quot;/user&quot;) public List&lt;User&gt; getUser() &#123; List&lt;User&gt; users = new ArrayList&lt;&gt;(); for (int i = 1; i &lt;= 10; i++) &#123; User user = new User(); user.setId(i); user.setName(&quot;wang&quot; + i); user.setAddress(&quot;shanghai&quot; + i); user.setDate(new Date()); users.add(user); &#125; return users; &#125;&#125; 2.3 ç»“æœï¼š 3. æ·±å…¥äº†è§£ Springboot ä¸­çš„ JSON è½¬æ¢æ€è€ƒï¼š å‰ç«¯ä¼ å…¥çš„ json æ•°æ®å¦‚ä½•è¢«è§£ææˆ Java å¯¹è±¡ä½œä¸º APIå…¥å‚ API è¿”å›ç»“æœåˆå¦‚ä½•å°† Java å¯¹è±¡è§£ææˆ json æ ¼å¼æ•°æ®è¿”å›ç»™å‰ç«¯ å…³é”®ç±»ï¼šHttpMessageConverter å®˜æ–¹åŸè¯ï¼š 1Strategy interface that specifies a converter that can convert from and to HTTP requests and responses. ä» Structure ä¸­å¯ä»¥çœ‹è§ä¸€å…±æœ‰äº”ä¸ªæ–¹æ³•ï¼š canReadï¼šæ¥æ”¶åˆ°è¯·æ±‚æ—¶åˆ¤æ–­æ˜¯å¦èƒ½è¯» canWriteï¼šè¿”å›ç»“æœæ—¶åˆ¤æ–­æ˜¯å¦èƒ½å†™ getSupportedMediaTypesï¼šè·å–æ”¯æŒçš„ MediaType readï¼šèƒ½è¯»åˆ™è¯» writeï¼šèƒ½å†™åˆ™å†™ æ³¨ï¼šåœ¨å‰é¢æˆ‘ä»¬æ²¡æœ‰å†™ä»»ä½•é…ç½®ä¹Ÿèƒ½å®ç°è½¬æ¢ï¼Œæ˜¯ç”±äºå…¶ä¸­æœ‰ç¼ºçœé…ç½® å¯ä»¥åœ¨ WebMvcConfigurationSupport ä¸­æŸ¥çœ‹ 4.è‡ªå®šä¹‰ JSON é…ç½®æ–¹å¼ä¸€ï¼šåœ¨éœ€è¦è½¬æ¢çš„å±æ€§ä¸ŠåŠ ä¸Šæ³¨è§£ 12345678910@Datapublic class User &#123; private Integer id; private String name; private String address; @JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;) private Date date;&#125; ç»“æœï¼š æ–¹å¼äºŒï¼š é…ç½®ç±»ï¼š 1234567891011121314@Configurationpublic class JsonConfig &#123; @Bean MappingJackson2HttpMessageConverter mappingJackson2HttpMessageConverter () &#123; MappingJackson2HttpMessageConverter converter = new MappingJackson2HttpMessageConverter(); ObjectMapper objectMapper = new ObjectMapper(); objectMapper.setDateFormat(new SimpleDateFormat(&quot;yyyy-MM-dd-HH:mm:ss&quot;)); converter.setObjectMapper(objectMapper); return converter; &#125;&#125; ç»“æœï¼š ä½¿ç”¨ä¸‹é¢çš„é…ç½®ç±»ä¹Ÿå¯ä»¥ï¼š 123456789101112131415161718192021@Configurationpublic class JsonConfig &#123;// @Bean// MappingJackson2HttpMessageConverter mappingJackson2HttpMessageConverter () &#123;//// MappingJackson2HttpMessageConverter converter = new MappingJackson2HttpMessageConverter();// ObjectMapper objectMapper = new ObjectMapper();// objectMapper.setDateFormat(new SimpleDateFormat(&quot;yyyy-MM-dd-HH:mm:ss&quot;));// converter.setObjectMapper(objectMapper);// return converter;// &#125; @Bean ObjectMapper objectMapper() &#123; ObjectMapper objectMapper = new ObjectMapper(); objectMapper.setDateFormat(new SimpleDateFormat(&quot;yyyy-MM-dd&quot;)); return objectMapper; &#125;&#125; ç»“æœï¼š 5.Gson å’Œ Fastjsonå¦‚æœæƒ³è¦å’Œ Jackson ä¸€æ ·è‡ªå®šä¹‰é…ç½®ï¼š åªéœ€è¦é…ç½®ï¼šGsonHttpMessageConverter å’Œ FastJsonHttpMessageConverter","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"JSON","slug":"JSON","permalink":"http://wangba.me/tags/JSON/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"}]},{"title":"ControllerAdviceæ³¨è§£çš„ä½¿ç”¨","slug":"ControllerAdviceæ³¨è§£çš„ä½¿ç”¨","date":"2020-08-18T13:00:09.000Z","updated":"2020-09-30T07:07:09.383Z","comments":true,"path":"2020/08/18/ControllerAdviceæ³¨è§£çš„ä½¿ç”¨/","link":"","permalink":"http://wangba.me/2020/08/18/ControllerAdvice%E6%B3%A8%E8%A7%A3%E7%9A%84%E4%BD%BF%E7%94%A8/","excerpt":"","text":"ä¸€ã€ç”¨æ³• å¤„ç†å…¨å±€å¼‚å¸¸ é¢„è®¾å…¨å±€æ•°æ® è¯·æ±‚å‚æ•°é¢„å¤„ç† äºŒã€å¤„ç†å…¨å±€å¼‚å¸¸æˆ‘ä»¬åªéœ€è¦åœ¨ application.propertiesä¸­é…ç½®ï¼šspring.servlet.multipart.max-file-size=1KB å°±å¯ä»¥çœ‹è§åœ¨ä¸Šä¼ å›¾ç‰‡æ—¶å°±ä¼šæŠ¥ 500 å¼‚å¸¸ï¼š æ­¤æ—¶æˆ‘ä»¬å¯ä»¥è‡ªå·±è‡ªå®šä¹‰å¤„ç† è¿™ç§å¼‚å¸¸ï¼š 12345678910111213@ControllerAdvicepublic class MyException &#123; @ExceptionHandler(MaxUploadSizeExceededException.class) public void myException(MaxUploadSizeExceededException e, HttpServletResponse response) throws IOException &#123; response.setContentType(&quot;text/html;charset=utf-8&quot;); PrintWriter writer = response.getWriter(); writer.write(&quot;ä¸Šä¼ å¤§å°é™åˆ¶ä¸º1KB&quot;); writer.flush(); writer.close(); &#125;&#125; ä¸‰ã€é¢„è®¾å…¨å±€æ•°æ®è®¾ç½®å…¨å±€å˜é‡ï¼š 1234567891011@ControllerAdvicepublic class GlobalData &#123; @ModelAttribute(value = &quot;data&quot;) public Map&lt;String, Object&gt; map() &#123; Map&lt;String, Object&gt; map = new HashMap&lt;&gt;(); map.put(&quot;wangyi&quot;, &quot;ç‹ä¸€&quot;); map.put(&quot;wangba&quot;, &quot;ç‹å…«&quot;); return map; &#125;&#125; å–å‡ºè®¾ç½®çš„å€¼ï¼š 12345678910111213@RestControllerpublic class HelloController &#123; @GetMapping(&quot;hello&quot;) public String hello(Model model) &#123; Map&lt;String, Object&gt; map = model.asMap(); Set&lt;String&gt; set = map.keySet(); for (String s : set) &#123; System.out.println(s + &quot;:&quot; + map.get(s)); &#125; return &quot;hello&quot;; &#125;&#125; ç»“æœï¼š å››ã€è¯·æ±‚å‚æ•°é¢„å¤„ç†å®ä½“ç±»ï¼š 123456@Datapublic class Book &#123; private String name; private double price;&#125; 1234567@Datapublic class Author &#123; private String name; private int age;&#125; Controller: 12345678910@RestControllerpublic class BookController &#123; @PostMapping(&quot;/book&quot;) public void book(Book book, Author author) &#123; System.out.println(book); System.out.println(author); &#125;&#125; ä½¿ç”¨ Postman è¿›è¡Œæµ‹è¯•ï¼š å¾—åˆ°æœ€ç»ˆç»“æœä¸ºï¼š å½“å‡ºç°ç›¸åŒå‚æ•°æ—¶ï¼Œå¹¶ä¸èƒ½åˆ†æ¸…æ¥šå‚æ•°å±äºå“ªä¸ªå¯¹è±¡ï¼Œåªèƒ½å°†å‚æ•°èµ‹å€¼ç»™æ¯ä¸€ä¸ªæ‹¥æœ‰ç›¸åŒå‚æ•°çš„å¯¹è±¡ å¤„ç†ï¼š Controllerï¼š 1234567891011@RestControllerpublic class BookController &#123; @PostMapping(&quot;/book&quot;) public void book(@ModelAttribute(&quot;b&quot;) Book book, @ModelAttribute(&quot;a&quot;) Author author) &#123; System.out.println(book); System.out.println(author); &#125;&#125; å‚æ•°é…ç½®ï¼š 12345678910111213@ControllerAdvicepublic class GlobalData &#123; @InitBinder(&quot;a&quot;) public void initA(WebDataBinder binder) &#123; binder.setFieldDefaultPrefix(&quot;a.&quot;); &#125; @InitBinder(&quot;b&quot;) public void initB(WebDataBinder binder) &#123; binder.setFieldDefaultPrefix(&quot;b.&quot;); &#125;&#125; ä½¿ç”¨ Postman è¿›è¡Œæµ‹è¯•ï¼š ç»“æœï¼š","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"æ³¨è§£","slug":"æ³¨è§£","permalink":"http://wangba.me/tags/%E6%B3%A8%E8%A7%A3/"}]},{"title":"ElasticSearchå…¥é—¨","slug":"ElasticSearchå…¥é—¨","date":"2020-08-12T07:02:23.000Z","updated":"2020-08-12T07:40:52.851Z","comments":true,"path":"2020/08/12/ElasticSearchå…¥é—¨/","link":"","permalink":"http://wangba.me/2020/08/12/ElasticSearch%E5%85%A5%E9%97%A8/","excerpt":"","text":"ä¸€ã€å‚è€ƒé“¾æ¥01.ESå®˜ç½‘ 02.Spring Boot Elasticsearch å…¥é—¨ 03.å›¾è§£ Elasticsearch åŸç† äºŒã€ElasticSearchæ¦‚è¿°ä¸‰ã€Solrå’ŒElasticSearchçš„å¯¹æ¯”å››ã€ElasticSearchå®‰è£…äº”ã€Kibanaå®‰è£…5.1 ä¸‹è½½ Kibanaå®˜æ–¹ä¸‹è½½åœ°å€ æ³¨ï¼šå¯ä»¥åœ¨past releasesä¸‹è½½è€ç‰ˆæœ¬ 5.2 è¿è¡Œè§£å‹åè¿›å…¥binç›®å½•è¿è¡Œï¼š 1./kibana åœ¨æµè§ˆå™¨æ‰“å¼€ï¼š http://localhost:5601/ 5.3 æ±‰åŒ– zh-CN.jsonæ˜¯Kibanaçš„æ±‰åŒ–åŒ… å†åˆ° kibana.yml ä¸­åŠ å…¥ï¼š å…­ã€ElasticSearchæ ¸å¿ƒæ¦‚å¿µ6.1 ä¸å…³ç³»å‹æ•°æ®åº“å¯¹æ¯” elasticsearchæ˜¯é¢å‘æ–‡æ¡£ï¼Œå…³ç³»å‹æ•°æ®åº“å’Œ elasticsearch å®¢è§‚çš„å¯¹æ¯”ï¼ä¸€åˆ‡éƒ½æ˜¯JSON MySQL ElasticSearch æ•°æ®åº“ï¼ˆdatabaseï¼‰ ç´¢å¼•ï¼ˆindexï¼‰ è¡¨ï¼ˆtablesï¼‰ ç±»å‹ï¼ˆtypesï¼‰ ES æ–‡æ¡£ï¼ˆdocumentsï¼‰ åˆ—ï¼ˆcolumnsï¼‰ å­—æ®µï¼ˆfieldsï¼‰ æ³¨ï¼šå…¶ä¸­ types é€æ¸è¢«å¼ƒç”¨äº†ï¼Œ8.Xå°†è¢«åˆ é™¤ 6.2 ä¸€ä¸ªğŸŒ°ï¼š å¯¹åº”ä¸Šé¢æ•°æ®åº“ï¼š 6.3 è®¾è®¡elasticsearch(é›†ç¾¤)ä¸­å¯ä»¥åŒ…å«å¤šä¸ªç´¢å¼•(æ•°æ®åº“)ï¼Œæ¯ä¸ªç´¢å¼•ä¸­å¯ä»¥åŒ…å«å¤šä¸ªç±»å‹(è¡¨)ï¼Œæ¯ä¸ªç±»å‹ä¸‹åˆåŒ…å«å¤šä¸ªæ–‡æ¡£(è¡Œ)ï¼Œæ¯ä¸ªæ–‡æ¡£ä¸­åˆåŒ…å«å¤šä¸ªå­—æ®µ(åˆ—)ã€‚ ç‰©ç†è®¾è®¡ï¼š elasticsearch åœ¨åå°æŠŠæ¯ä¸ªç´¢å¼•åˆ’åˆ†æˆå¤šä¸ªåˆ†ç‰‡ï¼Œæ¯åˆ†åˆ†ç‰‡å¯ä»¥åœ¨é›†ç¾¤ä¸­çš„ä¸åŒæœåŠ¡å™¨é—´è¿ç§» ä¸€ä¸ªäººå°±æ˜¯ä¸€ä¸ªé›†ç¾¤ï¼é»˜è®¤çš„é›†ç¾¤åç§°å°±æ˜¯ elaticsearh å‚è€ƒä»¥ä¸‹ï¼š äº‘ä¸Šçš„é›†ç¾¤ é›†ç¾¤é‡Œçš„ç›’å­ èŠ‚ç‚¹ä¹‹é—´ ç´¢å¼•é‡Œçš„å°æ–¹å— åœ¨ ElasticSearch head ä¸­å¯ä»¥çœ‹è§é»˜è®¤é›†ç¾¤çš„åå­—ä¸ºï¼šelasticsearch é€»è¾‘è®¾è®¡ï¼š ä¸€ä¸ªç´¢å¼•ç±»å‹ä¸­ï¼ŒåŒ…å«å¤šä¸ªæ–‡æ¡£ï¼Œæ¯”å¦‚è¯´æ–‡æ¡£1ï¼Œæ–‡æ¡£2ã€‚ å½“æˆ‘ä»¬ç´¢å¼•ä¸€ç¯‡æ–‡æ¡£æ—¶ï¼Œå¯ä»¥é€šè¿‡è¿™æ ·çš„é¡ºåºæ‰¾åˆ°å®ƒ: ç´¢å¼• ----&gt; ç±»å‹ ----&gt; æ–‡æ¡£ID é€šè¿‡è¿™ä¸ªç»„åˆæˆ‘ä»¬å°±èƒ½ç´¢å¼•åˆ°æŸä¸ªå…·ä½“çš„æ–‡æ¡£ã€‚ æ³¨æ„ï¼šIDä¸å¿…æ˜¯æ•´æ•°ï¼Œå®é™…ä¸Šå®ƒæ˜¯ä¸ªå­—ç¬¦ä¸²ã€‚ 6.4 æ–‡æ¡£å°±æ˜¯æˆ‘ä»¬çš„ä¸€æ¡æ•°æ® ä¹‹å‰è¯´elasticsearchæ˜¯é¢å‘æ–‡æ¡£çš„ï¼Œé‚£ä¹ˆå°±æ„å‘³ç€ç´¢å¼•å’Œæœç´¢æ•°æ®çš„æœ€å°å•ä½æ˜¯æ–‡æ¡£ï¼Œelasticsearch ä¸­ï¼Œæ–‡æ¡£æœ‰å‡ ä¸ªé‡è¦å±æ€§ : è‡ªæˆ‘åŒ…å«ï¼Œä¸€ç¯‡æ–‡æ¡£åŒæ—¶åŒ…å«å­—æ®µå’Œå¯¹åº”çš„å€¼ï¼Œä¹Ÿå°±æ˜¯åŒæ—¶åŒ…å« keyï¼švalueï¼ å¯ä»¥æ˜¯å±‚æ¬¡å‹çš„ï¼Œä¸€ä¸ªæ–‡æ¡£ä¸­åŒ…å«è‡ªæ–‡æ¡£ï¼Œå¤æ‚çš„é€»è¾‘å®ä½“å°±æ˜¯è¿™ä¹ˆæ¥çš„ï¼å°±æ˜¯ä¸€ä¸ªjsonå¯¹è±¡ï¼ çµæ´»çš„ç»“æ„ï¼Œæ–‡æ¡£ä¸ä¾èµ–é¢„å…ˆå®šä¹‰çš„æ¨¡å¼ï¼Œæˆ‘ä»¬çŸ¥é“å…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œè¦æå‰å®šä¹‰å­—æ®µæ‰èƒ½ä½¿ç”¨ï¼Œ åœ¨elasticsearchä¸­ï¼Œå¯¹äºå­—æ®µæ˜¯éå¸¸çµæ´»çš„ï¼Œæœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å¿½ç•¥è¯¥å­—æ®µï¼Œæˆ–è€…åŠ¨æ€çš„æ·»åŠ ä¸€ä¸ªæ–°çš„å­—æ®µã€‚ å°½ç®¡æˆ‘ä»¬å¯ä»¥éšæ„çš„æ–°å¢æˆ–è€…å¿½ç•¥æŸä¸ªå­—æ®µï¼Œä½†æ˜¯ï¼Œæ¯ä¸ªå­—æ®µçš„ç±»å‹éå¸¸é‡è¦ï¼Œæ¯”å¦‚ä¸€ä¸ªå¹´é¾„å­—æ®µç±»å‹ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥æ˜¯æ•´å‹ã€‚å› ä¸ºelasticsearchä¼šä¿å­˜å­—æ®µå’Œç±»å‹ä¹‹é—´çš„æ˜ å°„åŠå…¶ä»–çš„è®¾ç½®ã€‚è¿™ç§æ˜ å°„å…·ä½“åˆ°æ¯ä¸ªæ˜ å°„çš„æ¯ç§ç±»å‹ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨elasticsearchä¸­ï¼Œç±»å‹æœ‰æ—¶å€™ä¹Ÿç§°ä¸ºæ˜ å°„ç±»å‹ ã€‚ 6.5 ç±»å‹â€‹ ç±»å‹æ˜¯æ–‡æ¡£çš„é€»è¾‘å®¹å™¨ï¼Œå°±åƒå…³ç³»å‹æ•°æ®åº“ä¸€æ ·ï¼Œè¡¨æ ¼æ˜¯è¡Œçš„å®¹å™¨ã€‚ ç±»å‹ä¸­å¯¹äºå­—æ®µçš„å®šä¹‰ç§°ä¸ºæ˜ å°„ï¼Œ æ¯”å¦‚ name æ˜ å°„ä¸ºå­—ç¬¦ä¸²ç±»å‹ã€‚ æˆ‘ä»¬è¯´æ–‡æ¡£æ˜¯æ— æ¨¡å¼çš„ï¼Œå®ƒä»¬ä¸éœ€è¦æ‹¥æœ‰æ˜ å°„ä¸­æ‰€å®šä¹‰çš„æ‰€æœ‰å­—æ®µï¼Œ æ¯”å¦‚æ–°å¢ä¸€ä¸ªå­—æ®µï¼Œé‚£ä¹ˆelasticsearchæ˜¯æ€ä¹ˆåšçš„å‘¢ï¼Ÿelasticsearchä¼šè‡ªåŠ¨çš„å°†æ–°å­—æ®µåŠ å…¥æ˜ å°„ï¼Œä½†æ˜¯è¿™ä¸ªå­—æ®µçš„ä¸ç¡®å®šå®ƒæ˜¯ä»€ä¹ˆç±»å‹ï¼Œelasticsearchå°±å¼€å§‹çŒœï¼Œå¦‚æœè¿™ä¸ªå€¼æ˜¯18ï¼Œé‚£ä¹ˆelasticsearchä¼šè®¤ä¸ºå®ƒæ˜¯æ•´å‹ã€‚ ä½†æ˜¯elasticsearchä¹Ÿå¯èƒ½çŒœä¸å¯¹ï¼Œ æ‰€ä»¥æœ€å®‰å…¨çš„æ–¹å¼å°±æ˜¯æå‰å®šä¹‰å¥½æ‰€éœ€è¦çš„æ˜ å°„ï¼Œè¿™ç‚¹è·Ÿå…³ç³»å‹æ•°æ®åº“æ®Šé€”åŒå½’äº†ï¼Œå…ˆå®šä¹‰å¥½å­—æ®µï¼Œç„¶åå†ä½¿ç”¨ã€‚ 6.6 ç´¢å¼•å°±æ˜¯æ•°æ®åº“ ç´¢å¼•æ˜¯æ˜ å°„ç±»å‹çš„å®¹å™¨ï¼Œelasticsearchä¸­çš„ç´¢å¼•æ˜¯ä¸€ä¸ªéå¸¸å¤§çš„æ–‡æ¡£é›†åˆã€‚ç´¢å¼•å­˜å‚¨äº†æ˜ å°„ç±»å‹çš„å­—æ®µå’Œå…¶ä»–è®¾ç½®ã€‚ ç„¶åå®ƒä»¬è¢«å­˜å‚¨åˆ°äº†å„ä¸ªåˆ†ç‰‡ä¸Šäº†ã€‚ æˆ‘ä»¬æ¥ç ”ç©¶ä¸‹åˆ†ç‰‡æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚ ä¸€ä¸ªé›†ç¾¤è‡³å°‘æœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè€Œä¸€ä¸ªèŠ‚ç‚¹å°±æ˜¯ä¸€ä¸ªelasricsearchè¿›ç¨‹ï¼ŒèŠ‚ç‚¹å¯ä»¥æœ‰å¤šä¸ªç´¢å¼•é»˜è®¤çš„ï¼Œå¦‚æœä½ åˆ›å»ºç´¢å¼•ï¼Œé‚£ä¹ˆç´¢å¼•å°†ä¼šæœ‰ä¸ª5ä¸ªåˆ†ç‰‡ ( primary shard ,åˆç§°ä¸»åˆ†ç‰‡ ) æ„æˆçš„ï¼Œæ¯ä¸€ä¸ªä¸»åˆ†ç‰‡ä¼šæœ‰ä¸€ä¸ªå‰¯æœ¬ ( replica shard ,åˆç§°å¤åˆ¶åˆ†ç‰‡ ) åœ¨ ElasticSearch head ä¸­å¯ä»¥çœ‹è§åˆšå»ºç«‹çš„ç´¢å¼•æ˜¯5ä¸ªåˆ†ç‰‡ï¼š 6.7 å€’æ’elasticsearchä½¿ç”¨çš„æ˜¯ä¸€ç§ç§°ä¸ºå€’æ’ç´¢å¼•çš„ç»“æ„ï¼Œé‡‡ç”¨Luceneå€’æ’ç´¢ä½œä¸ºåº•å±‚ã€‚è¿™ç§ç»“æ„é€‚ç”¨äºå¿«é€Ÿçš„å…¨æ–‡æœç´¢ï¼Œ ä¸€ä¸ªç´¢å¼•ç”±æ–‡æ¡£ä¸­æ‰€æœ‰ä¸é‡å¤çš„åˆ—è¡¨æ„æˆï¼Œå¯¹äºæ¯ä¸€ä¸ªè¯ï¼Œéƒ½æœ‰ä¸€ä¸ªåŒ…å«å®ƒçš„æ–‡æ¡£åˆ—è¡¨ã€‚ ä¾‹ å¦‚ï¼Œç°åœ¨æœ‰ä¸¤ä¸ªæ–‡æ¡£ï¼Œ æ¯ä¸ªæ–‡æ¡£åŒ…å«å¦‚ä¸‹å†…å®¹ï¼š Study every day, good good up to forever # æ–‡æ¡£1åŒ…å«çš„å†…å®¹To forever, study every day, good good up # æ–‡æ¡£2åŒ…å«çš„å†…å®¹ ä¸ºäº†åˆ›å»ºå€’æ’ç´¢å¼•ï¼Œæˆ‘ä»¬é¦–å…ˆè¦å°†æ¯ä¸ªæ–‡æ¡£æ‹†åˆ†æˆç‹¬ç«‹çš„è¯(æˆ–ç§°ä¸ºè¯æ¡æˆ–è€…tokens)ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªåŒ…å«æ‰€æœ‰ä¸é‡ å¤çš„è¯æ¡çš„æ’åºåˆ—è¡¨ï¼Œç„¶ååˆ—å‡ºæ¯ä¸ªè¯æ¡å‡ºç°åœ¨å“ªä¸ªæ–‡æ¡£ term doc_1 doc_2 Study âˆš X To X âˆš every âˆš âˆš forever âˆš âˆš day âˆš âˆš study X âˆš good âˆš âˆš every âˆš âˆš to âˆš X up âˆš âˆš ç°åœ¨ï¼Œæˆ‘ä»¬è¯•å›¾æœç´¢ to foreverï¼Œåªéœ€è¦æŸ¥çœ‹åŒ…å«æ¯ä¸ªè¯æ¡çš„æ–‡æ¡£ score term doc_1 doc_2 to âˆš X forever âˆš âˆš total 2 1 å¦‚æœæ²¡æœ‰åˆ«çš„æ¡ä»¶ï¼Œç°åœ¨ï¼Œè¿™ä¸¤ä¸ªåŒ…å«å…³é”®å­—çš„æ–‡æ¡£éƒ½å°†è¿”å›ã€‚ åœ¨elasticsearchä¸­ï¼Œ ç´¢å¼• ï¼ˆåº“ï¼‰è¿™ä¸ªè¯è¢«é¢‘ç¹ä½¿ç”¨ï¼Œè¿™å°±æ˜¯æœ¯è¯­çš„ä½¿ç”¨ã€‚ åœ¨elasticsearchä¸­ï¼Œç´¢å¼•è¢«åˆ†ä¸ºå¤šä¸ªåˆ†ç‰‡ï¼Œæ¯ä»½åˆ†ç‰‡æ˜¯ä¸€ä¸ªLuceneçš„ç´¢å¼•ã€‚æ‰€ä»¥ä¸€ä¸ªelasticsearchç´¢å¼•æ˜¯ç”±å¤šä¸ªLuceneç´¢å¼•ç»„æˆçš„ã€‚åˆ«é—®ä¸ºä»€ä¹ˆï¼Œè°è®©elasticsearchä½¿ç”¨Luceneä½œä¸ºåº•å±‚å‘¢! å¦‚æ— ç‰¹æŒ‡ï¼Œè¯´èµ·ç´¢å¼•éƒ½æ˜¯æŒ‡elasticsearch çš„ç´¢å¼•ã€‚ å…³ç³»å›¾ï¼š ä¸€ä¸ª ES ç´¢å¼• â€”â€“&gt; å¤šä¸ªåˆ†ç‰‡(shard) â€‹ ä¸€ä¸ªåˆ†ç‰‡(shard) â€”â€“&gt; ä¸€ä¸ª Lucene ç´¢å¼• ä¸€ä¸ª ES ç´¢å¼• â€”â€“&gt; â€”â€“&gt; å¤šä¸ª Lucene ç´¢å¼• ä¸ƒã€IKåˆ†è¯å™¨7.1 åˆ†è¯åˆ†è¯ï¼šå³æŠŠä¸€æ®µä¸­æ–‡æˆ–è€…åˆ«çš„åˆ’åˆ†æˆä¸€ä¸ªä¸ªçš„å…³é”®å­—ï¼Œæˆ‘ä»¬åœ¨æœç´¢æ—¶å€™ä¼šæŠŠè‡ªå·±çš„ä¿¡æ¯è¿›è¡Œåˆ†è¯ï¼Œä¼šæŠŠæ•°æ®åº“ä¸­æˆ–è€…ç´¢å¼•åº“ä¸­çš„æ•°æ®è¿›è¡Œåˆ†è¯ï¼Œç„¶åè¿›è¡Œä¸€ä¸ªåŒ¹é…æ“ä½œï¼Œé»˜è®¤çš„ä¸­æ–‡åˆ†è¯æ˜¯å°†æ¯ä¸ªå­—çœ‹æˆä¸€ä¸ª è¯ï¼Œæ¯”å¦‚ â€œæˆ‘æ˜¯ç‹å…«â€ ä¼šè¢«åˆ†ä¸ºâ€æˆ‘â€ã€â€œæ˜¯â€ã€â€œç‹â€ã€â€œå…«â€ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸ç¬¦åˆè¦æ±‚çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å®‰è£…ä¸­æ–‡åˆ†è¯å™¨ IK æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ IK æä¾›äº†ä¸¤ä¸ªåˆ†è¯ç®—æ³•ï¼šik_smart å’Œ ik_max_wordï¼Œå…¶ä¸­ ik_smart ä¸ºæœ€å°‘åˆ‡åˆ†ï¼Œik_max_wordä¸ºæœ€ç»†ç²’åº¦åˆ’åˆ†ï¼ 7.2 ä¸‹è½½å®‰è£…ä¸‹è½½åœ°å€ï¼šIK åˆ†è¯å™¨ä¸‹è½½ å®‰è£…ï¼šè§£å‹åæ”¾å…¥ plugins æ–‡ä»¶å¤¹ä¸‹ é‡å¯ ElasticSearch ï¼šçœ‹åˆ° IK åˆ†è¯å™¨å·²ç»åŠ è½½åˆ° ES é‡Œé¢äº† 7.3 IK åˆ†è¯å™¨çš„å°ğŸŒ°ï¼šä½¿ç”¨ ik_smart ç®—æ³•ï¼š æœ€å°‘åˆ‡åˆ† ä½¿ç”¨ ik_max_word ç®—æ³•ï¼š æœ€ç»†ç²’åº¦åˆ’åˆ†ï¼šé€šè¿‡å­—å…¸ï¼Œæ‰¾å¯»æ‰€æœ‰ç¬¦åˆçš„æƒ…å†µ 7.4 è‡ªè¡Œ DIY å­—å…¸åœ¨å‡ºç°ä»¥ä¸‹æƒ…å†µæ—¶ï¼šæˆ‘ä»¬éœ€è¦çš„æ˜¯ ç¥é­”æ‹ åº”è¯¥æ˜¯ä¸€ä¸ªè¯è¯­ï¼Œè€Œä¸åº”è¯¥è¢«åˆ†è¯ä¸º ç¥é­” ä¸ æ‹ åœ¨ IK çš„ config ç›®å½•ä¸‹ï¼Œé…ç½® wangba.dic å’Œ IKAnalyzer.cfg.xml å¦‚ä¸‹ï¼š IKAnalyzer.cfg.xmlï¼š wangba.dic: é‡å¯ ES å’Œ Kibanaï¼šå·²ç»å¯ä»¥çœ‹è§ wangba.dic å·²ç»åŠ è½½è¿›å»äº† æ­¤æ—¶åœ¨Kibanaä¸­å¯ä»¥çœ‹è§ï¼šæ­¤æ—¶ ç¥é­”æ‹ å·²ç»æ˜¯ä¸€ä¸ªè¯äº† å…«ã€Resté£æ ¼8.1 Restå‘½ä»¤è¯´æ˜è¯´æ˜ä¸€ç§è½¯ä»¶æ¶æ„é£æ ¼ï¼Œè€Œä¸æ˜¯æ ‡å‡†ï¼Œåªæ˜¯æä¾›äº†ä¸€ç»„è®¾è®¡åŸåˆ™å’Œçº¦æŸæ¡ä»¶ã€‚å®ƒä¸»è¦ç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨äº¤ äº’ç±»çš„è½¯ä»¶ã€‚åŸºäºè¿™ä¸ªé£æ ¼è®¾è®¡çš„è½¯ä»¶å¯ä»¥æ›´ç®€æ´ï¼Œæ›´æœ‰å±‚æ¬¡ï¼Œæ›´æ˜“äºå®ç°ç¼“å­˜ç­‰æœºåˆ¶ã€‚ åŸºæœ¬Restå‘½ä»¤è¯´æ˜ï¼š method urlåœ°å€ æè¿° PUT localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id åˆ›å»ºæ–‡æ¡£ï¼ˆæŒ‡å®šæ–‡æ¡£idï¼‰ POST localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§° åˆ›å»ºæ–‡æ¡£ï¼ˆéšæœºæ–‡æ¡£idï¼‰ _update localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id/_update ä¿®æ”¹æ–‡æ¡£ DELETE localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id åˆ é™¤æ–‡æ¡£ GET localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id æŸ¥è¯¢æ–‡æ¡£é€šè¿‡æ–‡æ¡£id POST localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/_search æŸ¥è¯¢æ‰€æœ‰æ•°æ® 8.2 åŸºæœ¬æµ‹è¯•åˆ›å»ºç´¢å¼•ï¼š PUT /ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id { â€‹ è¯·æ±‚ä½“ } æ³¨ï¼šç±»å‹å³å°†è¢«å¼ƒç”¨ åœ¨ ES head ä¸­å¯ä»¥çœ‹è§æ•°æ®å·²ç»æ’å…¥æˆåŠŸï¼š 8.3 ç±»å‹ å­—ç¬¦ä¸²ç±»å‹ text ã€ keyword æ•°å€¼ç±»å‹ longã€integerã€ shortã€byteã€doubleã€floatã€half_floatã€ scaled_float æ—¥æœŸç±»å‹ date å¸ƒå°”å€¼ç±»å‹ boolean äºŒè¿›åˆ¶ç±»å‹ binary è‡ªå®šä¹‰ç±»å‹ï¼š é€šè¿‡ GET è¯·æ±‚å¯ä»¥çœ‹è§ test2 ç´¢å¼•çš„ä¿¡æ¯ï¼š è‡ªåŠ¨åŒ¹é…ç±»å‹ï¼š 8.4 å…³äºç´¢å¼•çš„åŸºæœ¬æ“ä½œ å¢åŠ ï¼šå¦‚ä¸Š æŸ¥è¯¢ï¼šå¦‚ä¸Š ä¿®æ”¹ï¼šå¦‚ä¸‹ æ–¹æ³•ä¸€ï¼šç›´æ¥è¦†ç›– å¯ä»¥çœ‹è§ version å‘ç”Ÿäº†æ”¹å˜ æ–¹æ³•äºŒï¼š POST /ç´¢å¼•åç§°/_doc/æ–‡æ¡£id/__update { â€‹ è¯·æ±‚ä½“ } å¯ä»¥çœ‹è§ version å†æ¬¡å‘ç”Ÿäº†æ”¹å˜ åˆ é™¤ 8.5 å…³äºæ–‡æ¡£çš„åŸºæœ¬æ“ä½œåŸºæœ¬æ“ä½œï¼š å¢åŠ æ•°æ® PUT æŸ¥è¯¢æ•°æ® GET æ–¹å¼ä¸€ï¼šç®€å•çš„ ID æŸ¥è¯¢ å¯ä»¥çœ‹è§ï¼Œæ¨èä½¿ç”¨ GET /ç´¢å¼•/_doc/æ–‡æ¡£ID æ¥è¿›è¡Œæ“ä½œ æ–¹å¼äºŒï¼šç®€å•çš„æ¡ä»¶æŸ¥è¯¢ å¯ä»¥çœ‹è§ type å·²ç»è¢«ä¸¢å¼ƒäº† æ›´æ–°æ•°æ® POST å¯ä»¥çœ‹è§ï¼Œæ¨èä½¿ç”¨ POST /ç´¢å¼•/_update/æ–‡æ¡£ID æ¥è¿›è¡Œæ“ä½œ å¤æ‚æ“ä½œï¼šselect (æ’åºã€åˆ†é¡µã€é«˜äº®ã€æ¨¡ç³ŠæŸ¥è¯¢ã€ç²¾å‡†æŸ¥è¯¢ ) æŸ¥è¯¢ ES ä¸­æœ‰ zhangsan å’Œ zhangshan 008 ï¼Œé€šè¿‡å…³é”®å­—zhangsan æŸ¥è¯¢ï¼Œä¼šå°†åˆ†è¯åçš„ç»“æœå…¨éƒ¨æŸ¥è¯¢å‡ºæ¥ï¼Œä¸”æ¯ä¸€ä¸ªéƒ½æ˜¯æœ‰ _score çš„ã€‚ hitsï¼šåœ¨Javaå¯ä»¥å¾—åˆ°ç´¢å¼•å’Œæ–‡æ¡£çš„ä¿¡æ¯ã€æŸ¥è¯¢çš„ç»“æœæ€»æ•°ã€å…·ä½“æ–‡æ¡£æ•°æ®ä¿¡æ¯ï¼ˆå¯ä»¥é€šè¿‡éå†å¾—åˆ°å…·ä½“çš„å„ç§ä¿¡æ¯ï¼‰ é€šè¿‡ _source æ¥æŒ‡å®šæœ€åçš„è¾“å‡ºç»“æœ æ’åº é€šè¿‡ sort è¿›è¡Œæ’åºï¼Œç”¨ desc å’Œ asc æ¥è¿›è¡Œé™åºå’Œå‡åº åˆ†é¡µ /search/{current}/{pagesize} ç¬¬ä¸€é¡µä¸€ä¸ªæ•°æ® ç¬¬äºŒé¡µçš„ä¸€ä¸ªæ•°æ® ç¬¬ä¸€é¡µçš„ä¸¤ä¸ªæ•°æ® bool å€¼æŸ¥è¯¢ must å‘½ä»¤ == and should å‘½ä»¤ == or ä¸¤ä¸ªéƒ½æŸ¥è¯¢åˆ°äº† must_not å‘½ä»¤ == not filter å‘½ä»¤ gtï¼šå¤§äº / gteï¼šå¤§äºç­‰äº / ltï¼šå°äº / lteï¼šå°äºç­‰äº åŒ¹é…å¤šä¸ªæ¡ä»¶ ç›´æ¥åœ¨ tags ä¸­åŠ ç©ºæ ¼ ç²¾ç¡®æŸ¥è¯¢ term æŸ¥è¯¢æ˜¯ç›´æ¥é€šè¿‡å€’æ’ç´¢å¼•æŒ‡å®šçš„è¯æ¡è¿›è¡Œç²¾ç¡®çš„æŸ¥è¯¢ termï¼šç›´æ¥æŸ¥è¯¢ç²¾ç¡®çš„ matchï¼šä½¿ç”¨åˆ†è¯å™¨è§£æï¼ˆå…ˆåˆ†ææ–‡æ¡£ï¼Œåœ¨é€šè¿‡åˆ†æçš„æ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢ï¼‰ ä¸¤ä¸ªç±»å‹ï¼š textï¼š ä¼šè¢«åˆ†è¯è§£æå™¨è§£æ keywordï¼š ä¸ä¼šè¢«åˆ†è¯è§£æå™¨è§£æ ä½¿ç”¨ keywod åˆ†è¯å™¨ï¼š ä½¿ç”¨ standard åˆ†è¯å™¨ï¼š textï¼š å¯ä»¥çœ‹è§ä¸‹é¢è¢«åˆ†è¯äº†ï¼Œæ‰€ä»¥å‡ºç°äº†ä¸¤ä¸ªç»“æœ keywordï¼š å¯ä»¥çœ‹è§ä¸‹é¢æ²¡æœ‰è¢«åˆ†è¯ é«˜äº®æŸ¥è¯¢ ä¹ã€SpringBooté›†æˆElasticSearchå®˜æ–¹ ES Client æ–‡æ¡£ 1.ä¾èµ– 12345&lt;dependency&gt; &lt;groupId&gt;org.elasticsearch.client&lt;/groupId&gt; &lt;artifactId&gt;elasticsearch-rest-high-level-client&lt;/artifactId&gt; &lt;version&gt;7.6.2&lt;/version&gt;&lt;/dependency&gt; 2.æ‰¾å¯¹è±¡ 3.åˆ†æç±»ä¸­æ–¹æ³• ES çš„ç‰ˆæœ¬ä¸æœ¬æœºä¸­çš„ç‰ˆæœ¬ä¸ä¸€è‡´ è‡ªè¡Œé…ç½® SpringBoot ä¸­çš„ ES ç‰ˆæœ¬ RestClientAutoConfiguration å’Œ RestClientProperties 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104//// Source code recreated from a .class file by IntelliJ IDEA// (powered by Fernflower decompiler)//package org.springframework.boot.autoconfigure.elasticsearch.rest;import java.time.Duration;import org.apache.http.HttpHost;import org.apache.http.auth.AuthScope;import org.apache.http.auth.Credentials;import org.apache.http.auth.UsernamePasswordCredentials;import org.apache.http.client.CredentialsProvider;import org.apache.http.impl.client.BasicCredentialsProvider;import org.elasticsearch.client.RestClient;import org.elasticsearch.client.RestClientBuilder;import org.elasticsearch.client.RestHighLevelClient;import org.springframework.beans.factory.ObjectProvider;import org.springframework.boot.autoconfigure.condition.ConditionalOnClass;import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;import org.springframework.boot.context.properties.PropertyMapper;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;class RestClientConfigurations &#123; RestClientConfigurations() &#123; &#125; @Configuration( proxyBeanMethods = false ) // RestClient æ™®é€šå®¢æˆ·ç«¯ static class RestClientFallbackConfiguration &#123; RestClientFallbackConfiguration() &#123; &#125; @Bean @ConditionalOnMissingBean RestClient elasticsearchRestClient(RestClientBuilder builder) &#123; return builder.build(); &#125; &#125; @Configuration( proxyBeanMethods = false ) @ConditionalOnClass(&#123;RestHighLevelClient.class&#125;) // RestHighLevelClient é«˜çº§å®¢æˆ·ç«¯ static class RestHighLevelClientConfiguration &#123; RestHighLevelClientConfiguration() &#123; &#125; @Bean @ConditionalOnMissingBean RestHighLevelClient elasticsearchRestHighLevelClient(RestClientBuilder restClientBuilder) &#123; return new RestHighLevelClient(restClientBuilder); &#125; @Bean @ConditionalOnMissingBean RestClient elasticsearchRestClient(RestClientBuilder builder, ObjectProvider&lt;RestHighLevelClient&gt; restHighLevelClient) &#123; RestHighLevelClient client = (RestHighLevelClient)restHighLevelClient.getIfUnique(); return client != null ? client.getLowLevelClient() : builder.build(); &#125; &#125; @Configuration( proxyBeanMethods = false ) // RestClientBuilder static class RestClientBuilderConfiguration &#123; RestClientBuilderConfiguration() &#123; &#125; @Bean @ConditionalOnMissingBean RestClientBuilder elasticsearchRestClientBuilder(RestClientProperties properties, ObjectProvider&lt;RestClientBuilderCustomizer&gt; builderCustomizers) &#123; HttpHost[] hosts = (HttpHost[])properties.getUris().stream().map(HttpHost::create).toArray((x$0) -&gt; &#123; return new HttpHost[x$0]; &#125;); RestClientBuilder builder = RestClient.builder(hosts); PropertyMapper map = PropertyMapper.get(); map.from(properties::getUsername).whenHasText().to((username) -&gt; &#123; CredentialsProvider credentialsProvider = new BasicCredentialsProvider(); Credentials credentials = new UsernamePasswordCredentials(properties.getUsername(), properties.getPassword()); credentialsProvider.setCredentials(AuthScope.ANY, credentials); builder.setHttpClientConfigCallback((httpClientBuilder) -&gt; &#123; return httpClientBuilder.setDefaultCredentialsProvider(credentialsProvider); &#125;); &#125;); builder.setRequestConfigCallback((requestConfigBuilder) -&gt; &#123; properties.getClass(); map.from(properties::getConnectionTimeout).whenNonNull().asInt(Duration::toMillis).to(requestConfigBuilder::setConnectTimeout); properties.getClass(); map.from(properties::getReadTimeout).whenNonNull().asInt(Duration::toMillis).to(requestConfigBuilder::setSocketTimeout); return requestConfigBuilder; &#125;); builderCustomizers.orderedStream().forEach((customizer) -&gt; &#123; customizer.customize(builder); &#125;); return builder; &#125; &#125;&#125; åã€ç´¢å¼•ã€æ–‡æ¡£ API æ“ä½œ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289package com.wangba;import com.alibaba.fastjson.JSON;import com.wangba.enity.User;import org.apache.lucene.search.TermQuery;import org.apache.lucene.util.QueryBuilder;import org.elasticsearch.action.admin.indices.delete.DeleteIndexRequest;import org.elasticsearch.action.bulk.BulkRequest;import org.elasticsearch.action.bulk.BulkResponse;import org.elasticsearch.action.delete.DeleteRequest;import org.elasticsearch.action.delete.DeleteResponse;import org.elasticsearch.action.get.GetRequest;import org.elasticsearch.action.get.GetResponse;import org.elasticsearch.action.index.IndexRequest;import org.elasticsearch.action.index.IndexResponse;import org.elasticsearch.action.search.SearchRequest;import org.elasticsearch.action.search.SearchRequestBuilder;import org.elasticsearch.action.search.SearchResponse;import org.elasticsearch.action.support.master.AcknowledgedResponse;import org.elasticsearch.action.update.UpdateRequest;import org.elasticsearch.action.update.UpdateResponse;import org.elasticsearch.client.RequestOptions;import org.elasticsearch.client.RestHighLevelClient;import org.elasticsearch.client.indices.CreateIndexRequest;import org.elasticsearch.client.indices.CreateIndexResponse;import org.elasticsearch.client.indices.GetIndexRequest;import org.elasticsearch.common.unit.TimeValue;import org.elasticsearch.common.xcontent.XContentType;import org.elasticsearch.index.query.MatchAllQueryBuilder;import org.elasticsearch.index.query.QueryBuilders;import org.elasticsearch.index.query.TermQueryBuilder;import org.elasticsearch.search.SearchHit;import org.elasticsearch.search.builder.SearchSourceBuilder;import org.elasticsearch.search.fetch.subphase.FetchSourceContext;import org.junit.jupiter.api.Test;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.beans.factory.annotation.Qualifier;import org.springframework.boot.test.context.SpringBootTest;import org.springframework.data.repository.query.Param;import org.w3c.dom.ls.LSOutput;import java.io.IOException;import java.util.ArrayList;import java.util.concurrent.TimeUnit;@SpringBootTestclass SpringbootEsApiApplicationTests &#123; @Autowired @Qualifier(&quot;restHighLevelClient&quot;) private RestHighLevelClient client; /** * @Description: åˆ›å»ºç´¢å¼• * @Param: [] * @return: void * @Author: wang ba * @Date: 2020/7/29 */ @Test void createIndex() throws IOException &#123; // 1. åˆ›å»ºç´¢å¼•è¯·æ±‚ CreateIndexRequest request = new CreateIndexRequest(&quot;test&quot;); // 2. è®©å®¢æˆ·ç«¯æ‰§è¡Œè¯·æ±‚ indicesClient CreateIndexResponse createIndexResponse = client.indices().create(request, RequestOptions.DEFAULT); System.out.println(createIndexResponse); &#125; /** * @Description: æŸ¥è¯¢ç´¢å¼• * @Param: [] * @return: void * @Author: wang ba * @Date: 2020/7/29 */ @Test void existIndex() throws IOException &#123; GetIndexRequest request = new GetIndexRequest(&quot;test&quot;); boolean exists = client.indices().exists(request, RequestOptions.DEFAULT); System.out.println(exists); &#125; /** * @Description: åˆ é™¤ç´¢å¼• * @Param: [] * @return: void * @Author: wang ba * @Date: 2020/7/29 */ @Test void deleteIndex() throws IOException &#123; DeleteIndexRequest request = new DeleteIndexRequest(&quot;test&quot;); AcknowledgedResponse delete = client.indices().delete(request, RequestOptions.DEFAULT); System.out.println(delete); &#125; /** * @Description: æ·»åŠ æ–‡æ¡£ PUT test/_doc/1 * @Param: [] * @return: void * @Author: wang ba * @Date: 2020/7/29 */ @Test void addDocument() throws IOException &#123; // åˆ›å»ºå¯¹è±¡ User user = new User(&quot;wangba&quot;, 25); // åˆ›å»ºè¯·æ±‚ IndexRequest request = new IndexRequest(&quot;test&quot;); // è§„åˆ™ï¼š ==&gt; PUT test/_doc/1 request.id(&quot;1&quot;); request.timeout(&quot;1s&quot;); // å°†æˆ‘ä»¬çš„æ•°æ®æ”¾å…¥è¯·æ±‚ä¸­ JSONæ ¼å¼ request.source(JSON.toJSONString(user), XContentType.JSON); // å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œè¿”å›ç»“æœ IndexResponse indexResponse = client.index(request, RequestOptions.DEFAULT); System.out.println(indexResponse); System.out.println(indexResponse.toString()); System.out.println(indexResponse.status()); // å¯¹åº”çš„çŠ¶æ€å°±æ˜¯ CREATED ç­‰ &#125; /** * @Description: æ–‡æ¡£æ˜¯å¦å­˜åœ¨ * @Param: [] * @return: void * @Author: wang ba * @Date: 2020/7/29 */ @Test void existDocument() throws IOException &#123; // GET test/_doc/1 GetRequest request = new GetRequest(&quot;test&quot;, &quot;1&quot;); // _source ä¸æ˜¾ç¤ºä¸Šä¸‹æ–‡ request.fetchSourceContext(new FetchSourceContext(false)); request.storedFields(&quot;_none_&quot;); boolean exists = client.exists(request, RequestOptions.DEFAULT); System.out.println(exists); &#125; /** * @Description: æŸ¥è¯¢æ–‡æ¡£æ•°æ® GET test/_doc/1 * @Param: [] * @return: void * @Author: wang ba * @Date: 2020/7/29 */ @Test void getDocument() throws IOException &#123; GetRequest request = new GetRequest(&quot;test&quot;, &quot;1&quot;); GetResponse documentFields = client.get(request, RequestOptions.DEFAULT); System.out.println(documentFields.getSourceAsString()); System.out.println(documentFields); &#125; /** * @Description: æ›´æ–°æ–‡æ¡£ * @Param: [] * @return: void * @Author: wang ba * @Date: 2020/7/29 */ @Test void updateDocument() throws IOException &#123; UpdateRequest request = new UpdateRequest(&quot;test&quot;, &quot;1&quot;); User user = new User(&quot;zhansan&quot;, 22); request.doc(JSON.toJSONString(user), XContentType.JSON); UpdateResponse update = client.update(request, RequestOptions.DEFAULT); System.out.println(update); System.out.println(update.status()); &#125; /** * @Description: åˆ é™¤æ–‡æ¡£ DELETE test/_doc/1 * @Param: [] * @return: void * @Author: wang ba * @Date: 2020/7/29 */ @Test void deleteDocument() throws IOException &#123; DeleteRequest request = new DeleteRequest(&quot;test&quot;, &quot;1&quot;); DeleteResponse delete = client.delete(request, RequestOptions.DEFAULT); System.out.println(delete); &#125; /** * @Description: æ‰¹å¤„ç†è¯·æ±‚ * @Param: [] * @return: void * @Author: wang ba * @Date: 2020/7/29 */ @Test void addBulkDocument() throws IOException &#123; BulkRequest bulkRequest = new BulkRequest(); bulkRequest.timeout(&quot;10s&quot;); ArrayList&lt;User&gt; userArrayList = new ArrayList&lt;&gt;(); userArrayList.add(new User(&quot;zhangsan&quot;, 5)); userArrayList.add(new User(&quot;lisi&quot;, 10)); userArrayList.add(new User(&quot;xiaoxin&quot;, 25)); for (int i = 0; i &lt; userArrayList.size(); i++) &#123; bulkRequest.add( new IndexRequest(&quot;test&quot;) .id(&quot;&quot;+(i+1)) .source(JSON.toJSONString(userArrayList.get(i)), XContentType.JSON) ); &#125; BulkResponse bulk = client.bulk(bulkRequest, RequestOptions.DEFAULT); System.out.println(bulk); System.out.println(bulk.status()); System.out.println(bulk.hasFailures()); &#125; /** * @Description: æŒ‰æ¡ä»¶æœç´¢ * @Param: [] * @return: void * @Author: wang ba * @Date: 2020/7/29 */ /* æŸ¥è¯¢ï¼š SearchRequest æœç´¢è¯·æ±‚ SearchSourceBuilder æ¡ä»¶æ„é€  HighlightBuilder é«˜äº®æ„é€  TermQueryBuilder ç²¾ç¡®æŸ¥è¯¢ MatchAllQueryBuilder æ‰€æœ‰æŸ¥è¯¢ // xxxBuilder */ @Test void searchDocument() throws IOException &#123; // åˆ›å»ºæœç´¢è¯·æ±‚ SearchRequest searchRequest = new SearchRequest(&quot;test&quot;); // æ„é€ æœç´¢æ¡ä»¶ SearchSourceBuilder searchSourceBuilder = new SearchSourceBuilder(); // QueryBuilders.termQuery ç²¾ç¡®æŸ¥è¯¢ // QueryBuilders.matchAllQuery æŸ¥è¯¢æ‰€æœ‰ //TermQueryBuilder termQueryBuilder = QueryBuilders.termQuery(&quot;age&quot;, &quot;25&quot;); //searchSourceBuilder.query(termQueryBuilder); MatchAllQueryBuilder matchAllQueryBuilder = QueryBuilders.matchAllQuery(); searchSourceBuilder.query(matchAllQueryBuilder); // åˆ†é¡µ // searchSourceBuilder.from(); // searchSourceBuilder.size(); searchSourceBuilder.timeout(new TimeValue(60, TimeUnit.SECONDS)); searchRequest.source(searchSourceBuilder); SearchResponse search = client.search(searchRequest, RequestOptions.DEFAULT); System.out.println(JSON.toJSONString(search.getHits())); System.out.println(&quot;+++++++++++++æˆ‘æ˜¯åˆ†å‰²çº¿++++++++++++++&quot;); for (SearchHit documentFields : search.getHits().getHits()) &#123; System.out.println(documentFields.getSourceAsMap()); &#125; &#125;&#125; åä¸€ã€å®æˆ˜","categories":[],"tags":[{"name":"java","slug":"java","permalink":"http://wangba.me/tags/java/"},{"name":"ES","slug":"ES","permalink":"http://wangba.me/tags/ES/"}]}],"categories":[{"name":"é‡å­¦ç®—æ³•ç³»åˆ—","slug":"é‡å­¦ç®—æ³•ç³»åˆ—","permalink":"http://wangba.me/categories/%E9%87%8D%E5%AD%A6%E7%AE%97%E6%B3%95%E7%B3%BB%E5%88%97/"},{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"},{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"},{"name":"WangBa's CookBook","slug":"WangBa-s-CookBook","permalink":"http://wangba.me/categories/WangBa-s-CookBook/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"Algorithm","slug":"Algorithm","permalink":"http://wangba.me/tags/Algorithm/"},{"name":"Queue","slug":"Queue","permalink":"http://wangba.me/tags/Queue/"},{"name":"Stack","slug":"Stack","permalink":"http://wangba.me/tags/Stack/"},{"name":"Life","slug":"Life","permalink":"http://wangba.me/tags/Life/"},{"name":"LinkedList","slug":"LinkedList","permalink":"http://wangba.me/tags/LinkedList/"},{"name":"Array","slug":"Array","permalink":"http://wangba.me/tags/Array/"},{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Spring Security","slug":"Spring-Security","permalink":"http://wangba.me/tags/Spring-Security/"},{"name":"Session","slug":"Session","permalink":"http://wangba.me/tags/Session/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"},{"name":"NoSQL","slug":"NoSQL","permalink":"http://wangba.me/tags/NoSQL/"},{"name":"CookBook","slug":"CookBook","permalink":"http://wangba.me/tags/CookBook/"},{"name":"MySQL","slug":"MySQL","permalink":"http://wangba.me/tags/MySQL/"},{"name":"SQL","slug":"SQL","permalink":"http://wangba.me/tags/SQL/"},{"name":"String","slug":"String","permalink":"http://wangba.me/tags/String/"},{"name":"Sliding Window","slug":"Sliding-Window","permalink":"http://wangba.me/tags/Sliding-Window/"},{"name":"Two pointer","slug":"Two-pointer","permalink":"http://wangba.me/tags/Two-pointer/"},{"name":"JSON","slug":"JSON","permalink":"http://wangba.me/tags/JSON/"},{"name":"æ³¨è§£","slug":"æ³¨è§£","permalink":"http://wangba.me/tags/%E6%B3%A8%E8%A7%A3/"},{"name":"java","slug":"java","permalink":"http://wangba.me/tags/java/"},{"name":"ES","slug":"ES","permalink":"http://wangba.me/tags/ES/"}]}