{"meta":{"title":"wangba's blogs","subtitle":"","description":"è¾å»å·²æ— å¹´å°‘æ—¥,ç¾ç»Šæ°¸ç»“å°‘å¹´å¿ƒ","author":"wangba","url":"http://wangba.me","root":"/"},"pages":[{"title":"categories","date":"2020-08-12T00:57:07.000Z","updated":"2020-09-29T06:10:59.525Z","comments":true,"path":"categories/index.html","permalink":"http://wangba.me/categories/index.html","excerpt":"","text":""},{"title":"tags","date":"2020-08-12T00:56:53.000Z","updated":"2020-09-29T06:11:31.657Z","comments":true,"path":"tags/index.html","permalink":"http://wangba.me/tags/index.html","excerpt":"","text":""},{"title":"about","date":"2020-08-12T01:50:42.000Z","updated":"2020-09-11T12:03:23.090Z","comments":true,"path":"about/index.html","permalink":"http://wangba.me/about/index.html","excerpt":"","text":"ğŸ‘‹ &nbsp;Hey there! Iâ€™m WangbağŸ˜¯ About meIâ€™m a student of USTC, Iâ€™m a Javaer (Java NO.1 !!!)Welcome to my website: wangbaâ€™s blogs or wangbaâ€™s blog"},{"title":"link","date":"2020-08-12T00:57:15.000Z","updated":"2020-09-29T06:14:20.312Z","comments":true,"path":"friends/index.html","permalink":"http://wangba.me/friends/index.html","excerpt":"","text":""}],"posts":[{"title":"Algorithm","slug":"Algorithm","date":"2020-10-01T14:42:29.000Z","updated":"2020-10-01T14:52:58.430Z","comments":true,"path":"2020/10/01/Algorithm/","link":"","permalink":"http://wangba.me/2020/10/01/Algorithm/","excerpt":"","text":"â€‹ æœ€è¿‘å®ä¹ åå‘ç°è‡ªå·±çš„ç®—æ³•èƒ½åŠ›æ€¥å‰§ä¸‹é™ï¼ŒCRUD åªæ˜¯ä¸‹é™ï¼Œç®—æ³•æ‰æ˜¯ä¸Šé™ï¼Œå†³å®šé‡æ–°å¼€ä¸€ä¸ªç³»åˆ—ï¼Œå°†æ•°æ®ç»“æ„ä¸ç®—æ³•é‡æ–°å­¦ä¸€éã€‚è¿™æ¬¡ä¸»è¦å‚è€ƒçš„è¯¾ç¨‹æ˜¯ã€Šæ•°æ®ç»“æ„ä¸ç®—æ³•ä¹‹ç¾ã€‹å’Œã€Šç®—æ³•é¢è¯•é€šå…³40è®²ã€‹ã€‚è¿™é‡Œå°±ä¸åƒã€Šç®—æ³•å¯¼è®ºã€‹é‚£æ ·æ¯”è¾ƒç†è®ºåŒ–ï¼Œåº”è¯¥ä¼šæ›´åå‘äºã€Šç®—æ³•ã€‹è¿™æœ¬ä¹¦çš„ç±»å‹ã€‚ å¯ä»¥çœ‹åˆ°ä¸‹é¢è¿™äº›æœ‰è¶£çš„ç‚¹ï¼š ğŸ· å°½é‡åˆ©ç”¨å›¾ + æ–‡å­—ï¼Œæ¸…æ™°çš„è¡¨è¾¾æ„æ€ ğŸ¢ ä¸€å®šè¦ç»“åˆ Leetcode ä¸Šçš„é¢˜ç›® ğŸ­ å°½é‡ä»‹ç»ä¸€äº›æ²¡ç”¨æœ‰è¶£çš„å° Tips ğŸ¦ ä½¿ç”¨ Java æ¥å®ç°æ‰€æœ‰çš„ç®—æ³•","categories":[{"name":"é‡å­¦ç®—æ³•ç³»åˆ—","slug":"é‡å­¦ç®—æ³•ç³»åˆ—","permalink":"http://wangba.me/categories/%E9%87%8D%E5%AD%A6%E7%AE%97%E6%B3%95%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"Algorithm","slug":"Algorithm","permalink":"http://wangba.me/tags/Algorithm/"}]},{"title":"Array","slug":"Array","date":"2020-10-01T14:35:15.000Z","updated":"2020-10-01T14:35:15.025Z","comments":true,"path":"2020/10/01/Array/","link":"","permalink":"http://wangba.me/2020/10/01/Array/","excerpt":"","text":"","categories":[],"tags":[]},{"title":"SpringBootæ•´åˆSpring Security (ä¸‰)","slug":"SpringBootæ•´åˆSpring-Security-ä¸‰","date":"2020-09-30T06:47:27.000Z","updated":"2020-09-30T08:49:43.318Z","comments":true,"path":"2020/09/30/SpringBootæ•´åˆSpring-Security-ä¸‰/","link":"","permalink":"http://wangba.me/2020/09/30/SpringBoot%E6%95%B4%E5%90%88Spring-Security-%E4%B8%89/","excerpt":"","text":"ä¸€ã€OverViewâ€‹ åœ¨å‰åç«¯ä¸åˆ†ç¦»æ—¶ä»£ï¼Œå¯èƒ½ä½¿ç”¨çš„å°±æ˜¯ä¸Šä¸€èŠ‚ä¸­è¿™ç§æ–¹æ³•ï¼›åœ¨ç°åœ¨è¿™ç§å‰åç«¯åˆ†ç¦»éåœ°èµ°çš„æƒ…å†µä¸‹ï¼Œå·²ç»ä¸å†æ¨èä½¿ç”¨ä¼ ç»Ÿçš„ session ï¼Œè€Œæ˜¯ä½¿ç”¨ç°åœ¨æ¯”è¾ƒæµè¡Œçš„ JWT è¿™ç§ token çš„æ–¹å¼è§£å†³ â€‹ å¯¹æ¯”åˆ†æä¸€ä¸‹ï¼š æœ‰çŠ¶æ€ç™»å½• æ— çŠ¶æ€ç™»å½• å®šä¹‰ æœåŠ¡ç«¯éœ€è¦è®°å½•æ¯æ¬¡ä¼šè¯çš„å®¢æˆ·ç«¯ä¿¡æ¯ï¼Œä»è€Œè¯†åˆ«å®¢æˆ·ç«¯èº«ä»½ï¼Œæ ¹æ®ç”¨æˆ·èº«ä»½è¿›è¡Œè¯·æ±‚çš„å¤„ç† æœåŠ¡ç«¯ä¸ä¿å­˜ä»»ä½•å®¢æˆ·ç«¯è¯·æ±‚è€…ä¿¡æ¯ï¼›å®¢æˆ·ç«¯çš„æ¯æ¬¡è¯·æ±‚å¿…é¡»å…·å¤‡è‡ªæè¿°ä¿¡æ¯ï¼Œé€šè¿‡è¿™äº›ä¿¡æ¯è¯†åˆ«å®¢æˆ·ç«¯èº«ä»½ ä¼˜ç‚¹ æ¯”è¾ƒæ–¹ä¾¿ï¼Œä¸éœ€è¦åšå¤šä½™çš„å¤„ç† ä½¿ç”¨ token å¾ˆçµæ´»ï¼›æœåŠ¡ç«¯ä¸éœ€è¦å­˜æ•°æ®ï¼›å®¢æˆ·ç«¯ä¹Ÿå¯ä»¥å‘é€ç»™å¤šä¸ªæœåŠ¡å™¨ ç¼ºç‚¹ åªèƒ½æ˜¯ç½‘é¡µç«¯ï¼Œåœ¨ IOSã€Androidä¸è¡Œï¼›æœåŠ¡ç«¯ä¿å­˜å¤§é‡æ•°æ®ï¼›é›†ç¾¤åŒ–ä¸å¤ªè¡Œ é…ç½®ç¨å¾®å¤æ‚(å…¶å®åœ¨æ¡†æ¶çš„åŠ æˆä¸‹ï¼Œä¸å¤æ‚) æœ‰çŠ¶æ€ç™»å½• ğŸŒ°ï¼šåœ¨ Tomcat ä¸­ï¼Œç”¨æˆ·ç™»å½•åï¼Œéœ€è¦æŠŠç”¨æˆ·çš„ä¿¡æ¯ä¿å­˜åœ¨æœåŠ¡å™¨çš„ session ä¸­ï¼Œç„¶åå‘é€ç»™ç”¨æˆ·ä¸€ä¸ª Cookie å€¼ï¼Œè®°å½•å¯¹åº”çš„ session å€¼ï¼Œç­‰ç”¨æˆ·ä¸‹ä¸€æ¬¡å†æ¬¡è®¿é—®è¯¥æœåŠ¡å™¨æ—¶ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å¸¦ä¸Šè¿™ä¸ª Cookie å€¼ï¼ŒæœåŠ¡ç«¯å†è¯†åˆ«å…¶ä¸­çš„ session å€¼ï¼Œè¿›è¡Œåˆ¤æ–­ æ— çŠ¶æ€ç™»å½• ğŸŒ°ï¼šå®¢æˆ·ç«¯å‘é€è´¦æˆ·å¯†ç åˆ°æœåŠ¡ç«¯è¿›è¡ŒéªŒè¯ï¼›è®¤è¯åæœåŠ¡ç«¯å‘é€ä¸€ä¸ª token ç»™å®¢æˆ·ç«¯ï¼›ä»¥åå®¢æˆ·ç«¯æ¯æ¬¡å‘é€è¯·æ±‚éƒ½å°† token æºå¸¦ä¸Šè¿›è¡Œè®¤è¯ï¼Œè¿›è¡Œåˆ¤æ–­ äºŒã€Testâ€‹ åœ¨å‰åç«¯åˆ†ç¦»çš„åŸºç¡€ä¸Šï¼Œç°åœ¨å‰ç«¯å’Œåç«¯åªæ˜¯é€šè¿‡ JSON è¿›è¡Œäº¤äº’ï¼Œæ‰€ä»¥ç°åœ¨çš„é¡µé¢è·³è½¬å…¨éƒ¨ç”±å‰ç«¯è¿›è¡Œæ§åˆ¶ï¼Œåç«¯åªæ˜¯è¿”å›ä¸åŒçš„ JSON ç½¢äº† é‡å†™SecurityConfigä¸­çš„ configure æ–¹æ³•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142@Overrideprotected void configure(HttpSecurity http) throws Exception &#123; http.authorizeRequests() .anyRequest().authenticated() .and() // ç™»å‡ºé¡µé¢ + ç™»å‡ºæˆåŠŸåé¡µé¢ .logout() .logoutUrl(&quot;/logout&quot;) .logoutSuccessUrl(&quot;/login.html&quot;) .logoutSuccessHandler((httpServletRequest, httpServletResponse, authentication) -&gt; &#123; httpServletResponse.setContentType(&quot;application/json;charset=utf-8&quot;); PrintWriter out = httpServletResponse.getWriter(); out.write(&quot;æ³¨é”€æˆåŠŸ&quot;); out.flush(); out.close(); &#125;) .and() // ç™»å½•é¡µé¢ + ç™»å½•æ¥å£ .formLogin().loginPage(&quot;/login.html&quot;) .loginProcessingUrl(&quot;/securityLogin&quot;) .permitAll() // ç™»å½•å¤±è´¥å¤„ç†å™¨ .failureHandler((httpServletRequest, httpServletResponse, e) -&gt; &#123; httpServletResponse.setContentType(&quot;application/json;charset=utf-8&quot;); PrintWriter out = httpServletResponse.getWriter(); out.write(e.getMessage()); out.flush(); out.close(); &#125;) // ç™»å½•æˆåŠŸå¤„ç†å™¨ .successHandler((httpServletRequest, httpServletResponse, authentication) -&gt; &#123; Object principal = authentication.getPrincipal(); httpServletResponse.setContentType(&quot;application/json;charset=utf-8&quot;); PrintWriter out = httpServletResponse.getWriter(); out.write(new ObjectMapper().writeValueAsString(principal)); out.flush(); out.close(); &#125;) .and() .csrf().disable() ;&#125; ç™»å½•æ¥å£ æ³¨ï¼š å¯ä»¥çœ‹åˆ°ä½¿ç”¨å‰åç«¯åˆ†ç¦»ï¼Œå°±ä¸éœ€è¦åç«¯æ¥æ§åˆ¶è·³è½¬é¡µé¢ç­‰ï¼Œåªéœ€è¦å°† JSON å‘ç»™å‰ç«¯å°±è¡Œ è¿™é‡Œé¢çš„ password ä¸ºç©ºï¼Œæ˜¯æ¡†æ¶åšçš„ï¼Œå…·ä½“å¯ä»¥çœ‹è¿™é‡Œ ç™»å½•å¤±è´¥ æ³¨ï¼š æ— è®ºæ˜¯ç”¨æˆ·åå’Œå¯†ç å…¶ä¸­ä¸€ä¸ªé”™è¯¯ï¼Œå°±ä¼šè¿”å› Bad credentials æç¤ºï¼Œä¸»è¦ä¹Ÿæ˜¯ä¸ºäº†å®‰å…¨ç€æƒ³ï¼Œå…·ä½“æµç¨‹å¯ä»¥çœ‹ä¸‹é¢çš„ 3.1 å°èŠ‚ æ³¨é”€ç™»å½• ä¸‰ã€Deep Learning3.1 æ·±å…¥äº†è§£ç™»å½•å¤±è´¥â€‹ åœ¨ä¸Šé¢æˆ‘ä»¬æåˆ°äº†æ— è®ºæ˜¯ç”¨æˆ·åå’Œå¯†ç å…¶ä¸­ä¸€ä¸ªé”™è¯¯ï¼Œå°±ä¼šè¿”å› Bad credentialsï¼Œå®åˆ™åœ¨å…¶ä¸­è¿˜æœ‰å¾ˆå¤šç§é”™è¯¯ï¼Œè€Œä¸”ç”¨æˆ·åæ˜¯æœ‰ç”¨æˆ·åé”™è¯¯ï¼Œåªæ˜¯æœ€ç»ˆè¢« Bad credentials è¦†ç›–äº†ï¼Œç¨å¾®åˆ†æä¸€ä¸‹ï¼š AbstractUserDetailsAuthenticationProvider 12345678910111213141516171819public Authentication authenticate(Authentication authentication) throws AuthenticationException &#123; Assert.isInstanceOf(UsernamePasswordAuthenticationToken.class, authentication, () -&gt; &#123; return this.messages.getMessage(&quot;AbstractUserDetailsAuthenticationProvider.onlySupports&quot;, &quot;Only UsernamePasswordAuthenticationToken is supported&quot;); &#125;); String username = authentication.getPrincipal() == null ? &quot;NONE_PROVIDED&quot; : authentication.getName(); boolean cacheWasUsed = true; UserDetails user = this.userCache.getUserFromCache(username); if (user == null) &#123; cacheWasUsed = false; try &#123; user = this.retrieveUser(username, (UsernamePasswordAuthenticationToken)authentication); &#125; catch (UsernameNotFoundException var6) &#123; this.logger.debug(&quot;User &#x27;&quot; + username + &quot;&#x27; not found&quot;); if (this.hideUserNotFoundExceptions) &#123; throw new BadCredentialsException(this.messages.getMessage(&quot;AbstractUserDetailsAuthenticationProvider.badCredentials&quot;, &quot;Bad credentials&quot;)); &#125; // çœç•¥&#125; åœ¨ä¸Šé¢è¿™æ®µä»£ç ä¸­ï¼Œè¿›è¡Œè°ƒè¯•å¯ä»¥çœ‹è§ï¼š ä¼šå…ˆåœ¨ç¼“å­˜ä¸­æŸ¥è¯¢ä¸€ä¸‹æ˜¯å¦æœ‰è¿‡ å†è°ƒç”¨ retrieveUser æ¥è¿›è¡Œåˆ¤æ–­ ä¸€æ—¦æŠ›å‡º UsernameNotFoundException ï¼Œå°±çœ‹ hideUserNotFoundExceptions çš„å€¼äº†ï¼Œå¦‚æœä¸º trueï¼Œå°±ä¼šæŠ›å‡º Bad credentials è¿›è¡Œæ–­ç‚¹è°ƒè¯•ï¼šè¾“é”™ç”¨æˆ·åï¼Œå¹¶æ‰“ä¸Šæ–­ç‚¹ï¼š é€šè¿‡ä¸Šå›¾å°±èƒ½çœ‹å‡ºï¼ŒhideUserNotFoundExceptions é»˜è®¤å€¼æ˜¯ true çš„ 3.2 æœªè®¤è¯å¤„ç†åœ¨å‰åç«¯åˆ†ç¦»ï¼Œå¦‚æœå‡ºç°æœªè®¤è¯çš„çŠ¶æ€ï¼Œä¸å¯èƒ½æ§åˆ¶å‰ç«¯æ¥è·³è½¬é¡µé¢ç­‰ï¼Œåªèƒ½ç»™å‰ç«¯è¿”å›ç›¸åº”çš„ä¿¡æ¯å³å¯ï¼š åœ¨ AuthenticationEntryPoint æ¥å£ä¸­æœ‰ä¸€ä¸ªæ–¹æ³•ï¼šcommence åœ¨ LoginUrlAuthenticationEntryPoint ä¸­å®ç°æ–¹å¼ä¸ºï¼š 1234567891011121314151617181920212223public void commence(HttpServletRequest request, HttpServletResponse response, AuthenticationException authException) throws IOException, ServletException &#123; String redirectUrl = null; if (this.useForward) &#123; if (this.forceHttps &amp;&amp; &quot;http&quot;.equals(request.getScheme())) &#123; redirectUrl = this.buildHttpsRedirectUrlForRequest(request); &#125; if (redirectUrl == null) &#123; String loginForm = this.determineUrlToUseForThisRequest(request, response, authException); if (logger.isDebugEnabled()) &#123; logger.debug(&quot;Server side forward to: &quot; + loginForm); &#125; RequestDispatcher dispatcher = request.getRequestDispatcher(loginForm); dispatcher.forward(request, response); return; &#125; &#125; else &#123; redirectUrl = this.buildRedirectUrlToLoginPage(request, response, authException); &#125; this.redirectStrategy.sendRedirect(request, response, redirectUrl);&#125; è¿™æ®µä»£ç ä¸­æœ€ä¸»è¦çš„æ˜¯çœ‹ä¸€ä¸‹ useForward çš„é»˜è®¤å€¼ï¼Œå¦‚æœæ˜¯ trueï¼Œé‚£ä¹ˆé»˜è®¤å°±æ˜¯èµ°è½¬å‘ï¼›å¦‚æœæ˜¯ falseï¼Œé‚£ä¹ˆé»˜è®¤èµ°çš„å°±æ˜¯é‡å®šå‘ ä½¿å‡ºæ–­ç‚¹è°ƒè¯•å¤§æ³•ï¼š åœ¨ Postman ä¸­ç›´æ¥ä½¿ç”¨ GET æ–¹å¼è¯·æ±‚ï¼šlocalhost:8080/security æ­¤æ–¹æ³•åœ¨ç¬¬ä¸€èŠ‚ä¸­å·²ç»å†™è¿‡äº†ï¼Œå°±æ˜¯è¾“å‡ºä¸€ä¸ª Spring Security åœ¨æ–¹æ³•å†…æ‰“ä¸Šæ–­ç‚¹ ä»ä¸Šé¢çš„å›¾å°±å¯ä»¥çœ‹è§ï¼ŒuseForward çš„é»˜è®¤å€¼æ˜¯ falseï¼Œé‚£ä¹ˆå°±å¯ä»¥ç¡®å®šæ˜¯èµ°çš„é‡å®šå‘ åªéœ€è¦é‡å†™è¯¥æ–¹æ³•è¦†ç›–å®ƒå°±è¡Œï¼š 12345678.exceptionHandling().authenticationEntryPoint((req, resp, authException) -&gt; &#123; resp.setContentType(&quot;application/json;charset=utf-8&quot;); PrintWriter out = resp.getWriter(); out.write(&quot;å°šæœªç™»å½•ï¼Œè¯·å…ˆç™»å½•&quot;); out.flush(); out.close();&#125;)","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Spring Security","slug":"Spring-Security","permalink":"http://wangba.me/tags/Spring-Security/"}]},{"title":"SpringBootæ•´åˆSpring Security (äºŒ)","slug":"SpringBootæ•´åˆSpring-Security-äºŒ","date":"2020-09-28T10:13:07.000Z","updated":"2020-09-30T07:09:26.232Z","comments":true,"path":"2020/09/28/SpringBootæ•´åˆSpring-Security-äºŒ/","link":"","permalink":"http://wangba.me/2020/09/28/SpringBoot%E6%95%B4%E5%90%88Spring-Security-%E4%BA%8C/","excerpt":"","text":"ä¸€ã€Testç¯å¢ƒä¸ä¸Šä¸€èŠ‚çš„ç¯å¢ƒä¸€è‡´ï¼Œè¿™ä¸€èŠ‚ä¸»è¦æ¥è¿›è¡Œè‡ªå®šä¹‰æ“ä½œ åœ¨ SecurityConfig ä¸­é‡å†™è¿™ä¸¤ä¸ªæ–¹æ³•ï¼š 12345678910111213141516@Overridepublic void configure(WebSecurity web) throws Exception &#123; web.ignoring().antMatchers(&quot;/js/**&quot;, &quot;/css/**&quot;,&quot;/images/**&quot;);&#125;@Overrideprotected void configure(HttpSecurity http) throws Exception &#123; http.authorizeRequests() .anyRequest().authenticated() .and() .formLogin().loginPage(&quot;/login.html&quot;) .permitAll() .and() .csrf().disable() ;&#125; è‡ªè¡Œå†™ä¸€ä¸ªç™»å½•é¡µé¢ï¼š login.html ä¸­çš„æ ¸å¿ƒä»£ç  123456789101112131415161718&lt;form action=&quot;/login.html&quot; method=&quot;post&quot;&gt; &lt;div class=&quot;input&quot; style=&quot;text-align: center&quot;&gt; &lt;label for=&quot;name&quot;&gt;ç”¨æˆ·å&lt;/label&gt; &lt;input type=&quot;text&quot; name=&quot;username&quot; id=&quot;name&quot;&gt; &lt;span class=&quot;spin&quot;&gt;&lt;/span&gt; &lt;/div&gt; &lt;div class=&quot;input&quot; style=&quot;text-align: center&quot;&gt; &lt;label for=&quot;pass&quot;&gt;å¯†ç &lt;/label&gt; &lt;input type=&quot;password&quot; name=&quot;password&quot; id=&quot;pass&quot;&gt; &lt;span class=&quot;spin&quot;&gt;&lt;/span&gt; &lt;/div&gt; &lt;div class=&quot;button login&quot; style=&quot;text-align: center&quot;&gt; &lt;button type=&quot;submit&quot;&gt; &lt;span&gt;ç™»å½•&lt;/span&gt; &lt;i class=&quot;fa fa-check&quot;&gt;&lt;/i&gt; &lt;/button&gt; &lt;/div&gt;&lt;/form&gt; ä¸»è¦æ³¨æ„ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š form çš„è¯·æ±‚åœ°å€æ˜¯ /login.htmlï¼Œæ–¹æ³•æ˜¯ post ç”¨æˆ·åå’Œå¯†ç çš„å±æ€§å€¼åˆ†åˆ«æ˜¯ username å’Œ password äºŒã€Deep Learning ğŸ¢ä¹‹ç–‘é—®ä¸€ï¼šä¸ºå•¥é»˜è®¤çš„ç™»å½•é¡µé¢å’Œç™»å½•æ¥å£æ˜¯ä¸€æ ·çš„ï¼Ÿè‡ªå®šä¹‰é¡µé¢åˆæ˜¯å¦‚ä½•è¦†ç›–é»˜è®¤é¡µé¢çš„å‘¢ï¼Ÿ é»˜è®¤ç™»å½•é¡µé¢ å…³äºé¡µé¢çš„ç™»å½•çš„é…ç½®éƒ½åœ¨ï¼šFormLoginConfigurer å…¶ä¸­è¿™ä¸ªç±»åˆæ˜¯ç»§æ‰¿ AbstractAuthenticationFilterConfigurer ç±»çš„ åˆ™åœ¨ FormLoginConfigurer åˆå§‹åŒ–çš„æ—¶å€™ï¼ŒAbstractAuthenticationFilterConfigurer çš„æ„é€ æ–¹æ³•ä¸­ï¼š 123protected AbstractAuthenticationFilterConfigurer() &#123; setLoginPage(&quot;/login&quot;);&#125; æ­¤æ—¶å¦‚æœæ²¡æœ‰è‡ªå®šä¹‰ç™»å½•é¡µé¢ï¼Œå°±ä¼šæ˜¯ é¡¹ç›®åœ°å€/login è¿™ä¸ªåœ°å€ å†çœ‹ä¸€ä¸‹ FormLoginConfigurer ä¸­çš„ init æ–¹æ³•ï¼š 1234public void init(H http) throws Exception &#123; super.init(http); initDefaultLoginFilter(http);&#125; è¿™ä¸ªæ–¹æ³•æ˜¯è°ƒç”¨äº†çˆ¶ç±»çš„ init æ–¹æ³•ï¼š 12345public void init(B http) throws Exception &#123; updateAuthenticationDefaults(); updateAccessDefaults(http); registerDefaultAuthenticationEntryPoint(http);&#125; åœ¨çˆ¶ç±»çš„ init æ–¹æ³•ä¸­è°ƒç”¨äº† updateAuthenticationDefaults() æ–¹æ³•ï¼š 123456789101112131415protected final void updateAuthenticationDefaults() &#123; // æœªè‡ªå®šä¹‰é¡µé¢ï¼Œå°±ä¼šå’Œ loginPage åœ°å€ä¸€æ · if (loginProcessingUrl == null) &#123; loginProcessingUrl(loginPage); &#125; if (failureHandler == null) &#123; failureUrl(loginPage + &quot;?error&quot;); &#125; final LogoutConfigurer&lt;B&gt; logoutConfigurer = getBuilder().getConfigurer( LogoutConfigurer.class); if (logoutConfigurer != null &amp;&amp; !logoutConfigurer.isCustomLogoutSuccess()) &#123; logoutConfigurer.logoutSuccessUrl(loginPage + &quot;?logout&quot;); &#125;&#125; æ­¤æ—¶å°±èƒ½çœ‹åˆ°ï¼šå¦‚æœæˆ‘ä»¬æ²¡æœ‰è‡ªå®šä¹‰ç™»å½•æ¥å£ï¼Œé‚£ä¹ˆç™»å½•æ¥å£çš„åœ°å€å°±ä¼šè¢«è®¾ç½®ä¸ºå’Œç™»å½•é¡µé¢ä¸€è‡´ è‡ªå®šä¹‰ç™»å½•é¡µé¢ å¦‚æœè‡ªå®šä¹‰äº†é¡µé¢åœ°å€ï¼Œé¦–å…ˆä¼šåˆ° FormLoginConfigurer ä¸­ 123public FormLoginConfigurer&lt;H&gt; loginPage(String loginPage) &#123; return super.loginPage(loginPage);&#125; åœ¨è¿™é‡Œé¢è°ƒç”¨äº†çˆ¶ç±»çš„ loginPage æ–¹æ³•ï¼š 123456protected T loginPage(String loginPage) &#123; setLoginPage(loginPage); updateAuthenticationDefaults(); this.customLoginPage = true; return getSelf();&#125; å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿™é‡Œé¢ set å®Œ loginPage åï¼ŒåˆåŒè°ƒç”¨äº† updateAuthenticationDefaults() æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨ â˜ï¸ æœ‰ å¦‚æœè‡ªå®šä¹‰äº†ç™»å½•æ¥å£ loginProcessingUrl ï¼Œé‚£ä¹ˆå°±ä¼šè¿›å…¥è¿™ä¸ªæ–¹æ³•ï¼š 123456public T loginProcessingUrl(String loginProcessingUrl) &#123; this.loginProcessingUrl = loginProcessingUrl; authFilter .setRequiresAuthenticationRequestMatcher(createLoginProcessingUrlMatcher(loginProcessingUrl)); return getSelf();&#125; ğŸ¢ä¹‹ç–‘é—®äºŒï¼šåœ¨æäº¤çš„è¡¨å•ä¸­ï¼Œå‚æ•°åˆ†åˆ«ä¸º username å’Œ passwordï¼Œå¯ä¸å¯ä»¥è‡ªå®šä¹‰å‘¢ï¼Ÿ é¦–å…ˆè¿˜æ˜¯å» FormLoginConfigurer ç±»ä¸­çœ‹çœ‹æ„é€ æ–¹æ³•ï¼š 12345public FormLoginConfigurer() &#123; super(new UsernamePasswordAuthenticationFilter(), null); usernameParameter(&quot;username&quot;); passwordParameter(&quot;password&quot;);&#125; è¿™é‡Œçš„ super æ ¹æ® ğŸ‘† çš„ç»§æ‰¿å…³ç³»ï¼Œå°±å¯ä»¥çŸ¥é“æ˜¯ AbstractAuthenticationFilterConfigurer ä¸­çš„æ„é€ ï¼š 123456789protected AbstractAuthenticationFilterConfigurer(F authenticationFilter, String defaultLoginProcessingUrl) &#123; this(); // å°†ä¼ è¿›æ¥çš„å‚æ•°èµ‹å€¼ç»™è¿™ä¸ªç±»çš„ authFilter this.authFilter = authenticationFilter; if (defaultLoginProcessingUrl != null) &#123; loginProcessingUrl(defaultLoginProcessingUrl); &#125;&#125; æ³¨ï¼šè¿™é‡Œä¸ºä»€ä¹ˆèƒ½ä¼ å‚ï¼Œæ˜¯ç”±äº UsernamePasswordAuthenticationFilter ç»§æ‰¿ AbstractAuthenticationProcessingFilter ä¸” F extends AbstractAuthenticationProcessingFilter æ­¤æ—¶å·²ç»æœ‰äº† UsernamePasswordAuthenticationFilter çš„å®ä¾‹äº†ï¼Œæ¥ç€æ‰§è¡Œ usernameParameter å’Œ passwordParameter æ–¹æ³•ï¼š 123456789public FormLoginConfigurer&lt;H&gt; usernameParameter(String usernameParameter) &#123; getAuthenticationFilter().setUsernameParameter(usernameParameter); return this;&#125;public FormLoginConfigurer&lt;H&gt; passwordParameter(String passwordParameter) &#123; getAuthenticationFilter().setPasswordParameter(passwordParameter); return this;&#125; è¿™é‡Œçš„ getAuthenticationFilter æ˜¯çˆ¶ç±»çš„æ–¹æ³•ï¼š 123protected final F getAuthenticationFilter() &#123; return authFilter;&#125; åˆ°è¿™é‡Œå°±å¾ˆæ˜ç¡®äº†ï¼Œå°±æ˜¯å°†åˆšæ‰çš„ new UsernamePasswordAuthenticationFilter() æ”¾åˆ°è¿™é‡Œé¢åˆ†åˆ«è°ƒç”¨ setUsernameParameter å’Œ setPasswordParameter æ–¹æ³•ï¼š 123456789public void setUsernameParameter(String usernameParameter) &#123; Assert.hasText(usernameParameter, &quot;Username parameter must not be empty or null&quot;); this.usernameParameter = usernameParameter;&#125;public void setPasswordParameter(String passwordParameter) &#123; Assert.hasText(passwordParameter, &quot;Password parameter must not be empty or null&quot;); this.passwordParameter = passwordParameter;&#125; åˆ°è¿™é‡Œï¼ŒusernameParameter å’Œ passwordParameter å°±å·²ç»è¢«èµ‹å¥½å€¼äº† å†é€šè¿‡è¿™ä¸ªç±» (UsernamePasswordAuthenticationFilter) ä¸­çš„è¿™ä¸¤ä¸ªæ–¹æ³•ä»ç™»å½•è¯·æ±‚ä¸­æ‹¿åˆ°è¿™ä¸¤ä¸ªå€¼ï¼š 123456789@Nullableprotected String obtainPassword(HttpServletRequest request) &#123; return request.getParameter(this.passwordParameter);&#125;@Nullableprotected String obtainUsername(HttpServletRequest request) &#123; return request.getParameter(this.usernameParameter);&#125; é‚£ä¹ˆè‡ªå®šä¹‰å°±å¾ˆç®€å•äº†ï¼š 1234567891011121314@Overrideprotected void configure(HttpSecurity http) throws Exception &#123; http.authorizeRequests() .anyRequest().authenticated() .and() .formLogin().loginPage(&quot;/login.html&quot;) // åªéœ€è¦è®¾ç½®ä»¥ä¸‹ä¸¤é¡¹å°±è¡Œ .usernameParameter(&quot;user&quot;) .passwordParameter(&quot;pwd&quot;) .permitAll() .and() .csrf().disable() ;&#125; ğŸ¢ä¹‹ç–‘é—®ä¸‰ï¼šç™»å½•æˆåŠŸ or å¤±è´¥åçš„é‡å®šå‘çš„åœ°å€ï¼Œæ³¨é”€ç™»å½•çš„åœ°å€å¦‚ä½•è‡ªå®šä¹‰ï¼Ÿ ç™»å½•æˆåŠŸ ç™»å½•å¤±è´¥ defaultSuccessUrl failureForwardUrl successForwardUrl failureUrl åŒºåˆ«ç®€å•æ¥è¯´å°±æ˜¯ï¼š defaultSuccessUrl å¯èƒ½ä½ è®¿é—®çš„åœ°å€æ˜¯ http://localhost:8080/security ä½†æ˜¯ä½ æ²¡ç™»å½•ï¼Œæ‰€ä»¥ä½ å°±è·³è½¬åˆ° http://localhost:8080/login é¡µé¢ä¸‹ï¼Œå¦‚æœä½ ç™»å½•æˆåŠŸï¼Œé‚£ä¹ˆå°±ä¼šå›åˆ° /security é¡µé¢ successForwardUrl ä¸ç®¡æ˜¯ä»€ä¹ˆé¡µé¢ï¼Œç™»å½•æˆåŠŸä¸€å¾‹æ˜¯ä½ è®¾ç½®çš„é¡µé¢ ç™»å½•å¤±è´¥åŒç† æ³¨é”€ç™»å½• çœ‹ä¸‹é¢çš„ä»£ç  logoutUrlï¼šç”¨æ¥æ³¨é”€çš„åœ°å€ï¼Œé»˜è®¤ä¸º â€œ/logoutâ€ logoutRequestMatcherï¼šæ”¹å˜æ³¨é”€åœ°å€ï¼Œè¿˜æœ‰è¯·æ±‚æ–¹å¼ logoutSuccessUrlï¼šæ³¨é”€ç™»å½•æˆåŠŸåï¼Œè¦è·³è½¬çš„åœ°å€ 12345678910111213141516171819202122232425262728293031@Overrideprotected void configure(HttpSecurity http) throws Exception &#123; http.authorizeRequests() .anyRequest().authenticated() .and() // æ³¨é”€ç™»å½•è®¾ç½® .logout() .logoutUrl(&quot;&quot;) .logoutRequestMatcher(new AntPathRequestMatcher(&quot;/logout&quot;,&quot;POST&quot;)) .logoutSuccessUrl(&quot;&quot;) // ç™»å½•è®¾ç½® .and() .formLogin().loginPage(&quot;/login.html&quot;) .usernameParameter(&quot;user&quot;) .passwordParameter(&quot;pwd&quot;) // ä¸‹é¢ä¸¤ä¸ªåªéœ€è¦ä¸€ä¸ª .defaultSuccessUrl(&quot;&quot;) .successForwardUrl(&quot;&quot;) // ä¸‹é¢ä¸¤ä¸ªåªéœ€è¦ä¸€ä¸ª .failureForwardUrl(&quot;&quot;) .failureUrl(&quot;&quot;) .permitAll() .and() .csrf().disable() ;&#125;","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Spring Security","slug":"Spring-Security","permalink":"http://wangba.me/tags/Spring-Security/"}]},{"title":"SpringBootæ•´åˆSpring Security (ä¸€)","slug":"SpringBootæ•´åˆSpring-Security-ä¸€","date":"2020-09-27T10:52:23.000Z","updated":"2020-09-30T07:09:23.777Z","comments":true,"path":"2020/09/27/SpringBootæ•´åˆSpring-Security-ä¸€/","link":"","permalink":"http://wangba.me/2020/09/27/SpringBoot%E6%95%B4%E5%90%88Spring-Security-%E4%B8%80/","excerpt":"","text":"ä¸€ã€OverViewJava ä¸­æƒé™ç®¡ç†æœ€å¸¸ç”¨çš„æŠ€æœ¯åº”è¯¥å°±æ˜¯ï¼šSpring Security å’Œ Shiroã€‚ è™½ç„¶ Shiro ç”¨å®ƒè½»é‡ã€ç®€å•ã€æ˜“äºé›†æˆå æ®ä¸€å¸­ä¹‹åœ°ï¼Œä½†éšç€ SpringBoot çš„æµè¡Œï¼ŒSpring Security ä¹Ÿè·Ÿç€é¸¡çŠ¬å‡å¤©ï¼Œå°±ç›®å‰çš„è¶‹åŠ¿æ¥çœ‹ï¼ŒSpring Security ç»“åˆ Oauth2ã€JWT ç­‰æ›´åŠ æ–¹ä¾¿ã€‚ è¿™æ¬¡å…ˆå°è¯•ç‰›åˆ€ä¸€ä¸‹ï¼Œå¿«é€Ÿå…¥é—¨â€¦â€¦ äºŒã€Environmentä¸æƒ³ error ï¼Œå…ˆçœ‹ä¾èµ– æ²¡çœ‹é”™ï¼Œå°±åªéœ€è¦è¿™ä¸¤ä¸ªä¾èµ–å°±è¡Œ pom.xml 12345678910&lt;!--security--&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;&lt;/dependency&gt;&lt;!--web--&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt; SecurityController 12345678@RestControllerpublic class SecurityController &#123; @GetMapping(&quot;/security&quot;) public String hello() &#123; return &quot;spring security&quot;; &#125;&#125; ä¸‰ã€Testå¯åŠ¨é¡¹ç›®å¯ä»¥çœ‹è§ï¼Œåœ¨æ§åˆ¶å°å¤šäº†ä¸€è¡Œï¼š Postman å¯ä»¥çœ‹è§æŠ¥é”™ï¼š401ï¼Œæ²¡æœ‰è¿›è¡Œè®¤è¯ åŠ ä¸Šè®¤è¯ å¯ä»¥çœ‹è§ï¼ŒåŠ ä¸Š Basic Authï¼š å…¶ä¸­ç”¨æˆ·åä¸º userï¼Œå¯†ç ä¸ºåˆšæ‰æ§åˆ¶å°æ˜¾ç¤ºçš„å³å¯ å››ã€Deep LearningğŸ¢ä¹‹ç–‘é—®ï¼šä¸ºå•¥ç”¨æˆ·åæ˜¯ userï¼Œå¯†ç å°±æ˜¯æ§åˆ¶å°æ˜¾ç¤ºçš„é‚£ä¸ªï¼Ÿ åˆ†ææ€è·¯ï¼š ç”¨æˆ·åå’Œå¯†ç è‚¯å®šåœ¨ä¸€èµ·ï¼Œè¿™ä¸ªå¯†ç åˆæ˜¯ UUID å½¢å¼ï¼ŒæŸä¸ªåœ°æ–¹è‚¯å®šç”¨äº† UUID.randomUUID().toString() æŒ‰ç…§æˆ‘ä»¬å¯¹ SpringBoot çš„ç‰¹æ€§ï¼Œè‚¯å®šåœ¨ XXXAutoConfiguration å’Œ XXXProperties ä¸­å­˜åœ¨ï¼Œæœç„¶åœ¨ SecurityProperties ä¸­çœ‹åˆ°äº†ï¼š æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦å»æ‰¾ä¸€æ‰¾ï¼Œåœ¨å“ªé‡Œæœ‰è°ƒç”¨ getPassword çš„è¿™ä¸ªæ–¹æ³•çš„ç±»ï¼š çœ‹åå­—åº”è¯¥å°±æ˜¯ï¼šUserDetailsServiceAutoConfiguration 12345678910private String getOrDeducePassword(SecurityProperties.User user, PasswordEncoder encoder) &#123; String password = user.getPassword(); if (user.isPasswordGenerated()) &#123; logger.info(String.format(&quot;%n%nUsing generated security password: %s%n&quot;, user.getPassword())); &#125; if (encoder != null || PASSWORD_ALGORITHM_PATTERN.matcher(password).matches()) &#123; return password; &#125; return NOOP_PASSWORD_PREFIX + password;&#125; å…¶ä¸­ï¼š user.isPasswordGenerated() å¦‚æœä¸º trueï¼Œåˆ™æ‰“å°è¯¥ä¿¡æ¯ å†å» ==user.isPasswordGenerated()== æ–¹æ³•ä¸­æ¢ç©¶ä¸€ä¸‹ï¼Œå›åˆ°äº†==SecurityProperties== ç±»ä¸­äº†ï¼š 1234567private boolean passwordGenerated = true; .......public boolean isPasswordGenerated() &#123; return this.passwordGenerated;&#125; é»˜è®¤æƒ…å†µä¸‹ï¼špasswordGenerated å°±æ˜¯ä¸º true ğŸ¢ä¹‹ç–‘é—®ï¼šæ¯æ¬¡å¯åŠ¨éƒ½è¦è¾“å…¥æ–°çš„çš„å¯†ç ï¼Œå¤ªéº»çƒ¦äº†ï¼Œæˆ‘éœ€è¦è‡ªå®šä¹‰ ç¬¬ä¸€ç§æ–¹æ³•ï¼š æŒ‰ç…§ SpringBoot çš„ç‰¹æ€§ï¼Œå¿…ç„¶å·²ç»ç»™ä½ å®‰æ’å¥½äº†ï¼Œè‚¯å®šæœ‰ä¸€ç§æ–¹æ³•æ˜¯åœ¨ properties æ–‡ä»¶ä¸­ç›´æ¥è¿›è¡Œï¼š idea å·²ç»é€šè¿‡æç¤ºæ˜¾ç¤ºå‡ºæ¥äº†, idea yyds ! ç›´æ¥ç‚¹è¿›å»çœ‹ä¸€ä¸‹ï¼Œå›è·³åˆ°å“ªä¸ªç±»ä¸­ï¼Œä¸å‡ºğŸ¢ğŸ¢çš„æ‰€æ–™ï¼Œåº”è¯¥å°±æ˜¯ ==SecurityProperties== ç±»ä¸­ï¼š æœä¸å…¶ç„¶ï¼Œåˆ†åˆ«è·³åˆ°äº† setName 123public void setName(String name) &#123; this.name = name;&#125; setPassword 1234567public void setPassword(String password) &#123; if (!StringUtils.hasLength(password)) &#123; return; &#125; this.passwordGenerated = false; this.password = password;&#125; æ³¨ï¼šå¦‚æœåœ¨è¿™é‡Œè‡ªå®šä¹‰äº†å¯†ç ï¼Œå°±ä¼šå°† ==passwordGenerated== è®¾ç½®ä¸º falseï¼Œé‚£ä¹ˆåœ¨ ==isPasswordGenerated== å°±æ˜¯ false äº†ï¼Œåœ¨ ==UserDetailsServiceAutoConfiguration== ä¸­å°±ä¸ä¼šè‡ªåŠ¨ç”Ÿæˆå¯†ç äº† application.properties 12spring.security.user.name=wangbaspring.security.user.password=8888 ç¬¬äºŒç§æ–¹æ³•ï¼š 123456789101112131415161718@Configurationpublic class SecurityConfig extends WebSecurityConfigurerAdapter &#123; @Bean PasswordEncoder passwordEncoder() &#123; // ä¸å¯¹å¯†ç è¿›è¡Œä»»ä½•ç¼–ç æ–¹å¼ return NoOpPasswordEncoder.getInstance(); &#125; @Override protected void configure(AuthenticationManagerBuilder auth) throws Exception &#123; auth.inMemoryAuthentication() .withUser(&quot;wangba&quot;) .password(&quot;guigui&quot;) .roles(&quot;admin&quot;) ; &#125;&#125;","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Spring Security","slug":"Spring-Security","permalink":"http://wangba.me/tags/Spring-Security/"}]},{"title":"SpringBootæ•´åˆSession","slug":"SpringBootæ•´åˆSession","date":"2020-09-22T13:43:13.000Z","updated":"2020-09-30T07:09:20.959Z","comments":true,"path":"2020/09/22/SpringBootæ•´åˆSession/","link":"","permalink":"http://wangba.me/2020/09/22/SpringBoot%E6%95%B4%E5%90%88Session/","excerpt":"","text":"ä¸€ã€OverView Spring Session has the simple goal of free up session management from the limitations of the HTTP session stored in the server. The solution makes it easy to share session data between services in the cloud without being tied to a single container (i.e. Tomcat). Additionally, it supports multiple sessions in the same browser and sending sessions in a header. ç®€å•åœ°æ¥è¯´ï¼šç”±æ¶æ„å¯¼è‡´äº†è¿™ç§æƒ…å†µçš„å‘ç”Ÿ present æœ€æ—©çš„æ¶æ„å°±æ˜¯å¾ˆç®€å•çš„å•æœåŠ¡å™¨çŠ¶æ€ï¼Œå¦‚æœæˆ‘ä»¬è¦ä¿å­˜ç”¨æˆ·çŠ¶æ€ï¼Œé‚£ä¹ˆåªéœ€è¦ä¸€ä¸ª session å°±è¡Œäº† now ç°åœ¨çš„æ¶æ„éƒ½æ˜¯é›†ç¾¤å¼äº†ï¼šå¯ä»¥å‡è®¾è¿™æ ·çš„æƒ…æ™¯ï¼Œå¦‚æœæˆ‘åœ¨å·²ç»ç™»å½•çš„çŠ¶æ€ï¼Œæˆ‘é¦–å…ˆè¦çœ‹è§†é¢‘ (è¿™ä¸ªæœåŠ¡å‡å¦‚åœ¨ A æœåŠ¡å™¨ä¸Š)ï¼Œç„¶åæˆ‘åˆæµè§ˆå›¾ç‰‡ (è¿™ä¸ªæœåŠ¡å‡å¦‚åœ¨ B æœåŠ¡å™¨ä¸Š)ï¼Œå¦‚æœä¸å…±äº« session çš„è¯ï¼Œé‚£ä¹ˆæˆ‘é€‰æ‹©çš„æœåŠ¡ä¸åœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸Šå°±è¦é‡æ–°ç™»å½•äº†ï¼Œè¿™å¯¹ç”¨æˆ·ä¹Ÿå¤ªä¸å‹å¥½äº†ã€‚ è§£å†³æ–¹æ¡ˆ ä¸»æµçš„è§£å†³æ–¹æ¡ˆï¼šå°† seesion å­˜åˆ° redis ä¸­ï¼Œæ¯æ¬¡ server è¦å‘ session ä¸­å†™æ•°æ®ï¼Œæˆ–è€…è¦è¯» session çš„æ•°æ®æ—¶ï¼Œéƒ½æ˜¯å¯¹ redis ä¸­çš„ session è¿›è¡Œæ“ä½œã€‚ äºŒã€ç¯å¢ƒæ­å»ºä¸æƒ³ error ï¼Œå…ˆçœ‹ä¾èµ– pom.xml 123456789101112131415&lt;!--redis--&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;&lt;/dependency&gt;&lt;!--web--&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt;&lt;!--spring session--&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.session&lt;/groupId&gt; &lt;artifactId&gt;spring-session-data-redis&lt;/artifactId&gt;&lt;/dependency&gt; application.properties 1234567891011# redis åŸºæœ¬é…ç½®# åœ°å€spring.redis.host=10.2.10.115# ç«¯å£å· é»˜è®¤å°±æ˜¯ 6379spring.redis.port=6379# å¯†ç spring.redis.password=123456# ç¬¬å‡ ä¸ªæ•°æ®åº“ é»˜è®¤å°±æ˜¯ç¬¬0å·æ•°æ®åº“spring.redis.database=0server.port=8080 SessionController 1234567891011121314151617@RestControllerpublic class SessionController &#123; @Value(&quot;$&#123;server.port&#125;&quot;) Integer port; @GetMapping(&quot;/set&quot;) public String set(HttpSession session) &#123; session.setAttribute(&quot;wangba&quot;, &quot;8888&quot;); return String.valueOf(port); &#125; @GetMapping(&quot;/get&quot;) public String get(HttpSession session) &#123; return session.getAttribute(&quot;user&quot;) + &quot;:&quot; + port; &#125;&#125; ä¸‰ã€æµ‹è¯•è®¿é—®ï¼šhttp://localhost:8080/set æ­¤æ—¶æ‰“å¼€ redis çœ‹ä¸€ä¸‹ï¼š å†è®¿é—®ï¼šhttp://localhost:8081/get å¯ä»¥çœ‹åˆ°æ­¤æ—¶ï¼Œåœ¨ä¸åŒçš„æœåŠ¡ä¸Šå¯ä»¥é€šè¿‡å…±äº« session æ³¨ï¼šè¿™è¾¹å¯ä»¥é€šè¿‡ nginx è¿›è¡Œè´Ÿè½½å‡è¡¡","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Session","slug":"Session","permalink":"http://wangba.me/tags/Session/"}]},{"title":"SpringBootæ•´åˆRedis","slug":"SpringBootæ•´åˆRedis","date":"2020-09-16T13:34:57.000Z","updated":"2020-09-30T07:09:18.512Z","comments":true,"path":"2020/09/16/SpringBootæ•´åˆRedis/","link":"","permalink":"http://wangba.me/2020/09/16/SpringBoot%E6%95%B4%E5%90%88Redis/","excerpt":"","text":"ä¸€ã€OverViewé¢è¯•å®˜ï¼šredis çŸ¥é“å— ğŸ¢ï¼šä¸çŸ¥é“ é¢è¯•å®˜ï¼šä½ å›å»ç­‰é€šçŸ¥å§ Redisæ˜¯ä¸€ä¸ªä½¿ç”¨ANSI Cç¼–å†™çš„å¼€æºã€æ”¯æŒç½‘ç»œã€åŸºäºå†…å­˜ã€å¯é€‰æŒä¹…æ€§çš„é”®å€¼å¯¹å­˜å‚¨æ•°æ®åº“ã€‚ä»2015å¹´6æœˆå¼€å§‹ï¼ŒRedisçš„å¼€å‘ç”±Redis LabsèµåŠ©ï¼Œè€Œ2013å¹´5æœˆè‡³2015å¹´6æœˆæœŸé—´ï¼Œå…¶å¼€å‘ç”±PivotalèµåŠ©ã€‚åœ¨2013å¹´5æœˆä¹‹å‰ï¼Œå…¶å¼€å‘ç”±VMwareèµåŠ©ã€‚https://zh.wikipedia.org/wiki/Redis#cite_note-5)æ ¹æ®æœˆåº¦æ’è¡Œç½‘ç«™DB-Engines.comçš„æ•°æ®ï¼ŒRedisæ˜¯æœ€æµè¡Œçš„é”®å€¼å¯¹å­˜å‚¨æ•°æ®åº“ã€‚ â€”â€”â€“ç»´åŸºç™¾ç§‘ æˆ‘è®°å¾—æˆ‘çœ‹è¿‡ä¸€ç¯‡è®²çš„éå¸¸å¥½çš„ NoSQL çš„æ–‡ç« ï¼Œä¸‹æ¬¡æ‰¾åˆ°åŠ è¿›æ¥ã€‚ å¢åŠ ï¼šå…³ç³»å‹æ•°æ®åº“ä¸éå…³ç³»å‹æ•°æ®åº“ äºŒã€ç¯å¢ƒæ­å»ºRedis é¦–å…ˆå‡†å¤‡å¥½ redis çš„ç¯å¢ƒï¼Œæ­¤æ¬¡ redis æ˜¯å®‰è£…åœ¨ Ubuntu 18.04 ä¸Šçš„ï¼Œä¸»è¦é…ç½®å¦‚ä¸‹ï¼š å¯ä»¥ä½¿ç”¨ sudo vi /etc/redis/redis.conf å‘½ä»¤ï¼š 123456789101112131415# è¯¥æŒ‡ä»¤å…è®¸æ‚¨å£°æ˜ä¸€ä¸ªinitç³»ç»Ÿæ¥ç®¡ç†Redisä½œä¸ºæœåŠ¡ï¼Œä»è€Œä¸ºæ‚¨æä¾›å¯¹å…¶æ“ä½œçš„æ›´å¤šæ§åˆ¶supervised systemd# ä¸ºäº†å±€åŸŸç½‘èƒ½è¿æ¥ä¸Šbind 127.0.0.1 ::1 æ”¹ä¸ºbind 0.0.0.0# ä¸ºäº†å±€åŸŸç½‘èƒ½è¿æ¥ä¸Šprotected-mode yes æ”¹ä¸ºprotected-mode no# ä¿®æ”¹å¯†ç ï¼Œéå¿…é¡»requirepass 123456 å¸¸ç”¨å‘½ä»¤ï¼š 1234567891011121314151617181920# ä¿®æ”¹ redis é…ç½®sudo vi /etc/redis/redis.conf# é‡å¯ redis æœåŠ¡sudo service redis restart# å¯åŠ¨ redis æœåŠ¡sudo service redis start# å…³é—­ redis æœåŠ¡sudo service redis stop# å¯åŠ¨ redis å®¢æˆ·ç«¯ï¼Œå…¶ä¸­ -p æŒ‡å®šç«¯å£ï¼Œ-a è¡¨ç¤ºè®¤è¯å³å¯†ç redis-cli -p 6379 -a 123456# åœ¨ redis é‡Œé¢çš„ä¸€äº›å‘½ä»¤127.0.0.1:6379&gt; pingPONG127.0.0.1:6379&gt; keys *127.0.0.1:6379&gt; get keyçš„åå­— pom.xml 12345678&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt; application.properties 123456789# redis åŸºæœ¬é…ç½®# åœ°å€spring.redis.host=10.2.10.108# ç«¯å£å· é»˜è®¤å°±æ˜¯ 6379spring.redis.port=6379# å¯†ç spring.redis.password=123456# ç¬¬å‡ ä¸ªæ•°æ®åº“ é»˜è®¤å°±æ˜¯ç¬¬0å·æ•°æ®åº“spring.redis.database=0 ä¸‰ã€æµ‹è¯•RedisController 12345678910111213141516171819202122@RestControllerpublic class RedisController &#123; private StringRedisTemplate stringRedisTemplate; @Autowired public void setStringRedisTemplate(StringRedisTemplate stringRedisTemplate) &#123; this.stringRedisTemplate = stringRedisTemplate; &#125; @GetMapping(&quot;/put&quot;) public void test1(String key, String value) &#123; ValueOperations&lt;String, String&gt; ops = stringRedisTemplate.opsForValue(); ops.set(key, value); &#125; @GetMapping(&quot;/get&quot;) public String test2(String key) &#123; ValueOperations&lt;String, String&gt; ops = stringRedisTemplate.opsForValue(); return ops.get(key); &#125;&#125; Postman é¦–å…ˆå°† redis æ¸…ç©ºï¼š æ’å…¥ï¼š çœ‹ä¸‹ redis ä¸­ï¼š æŸ¥è¯¢ï¼š","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"},{"name":"NoSQL","slug":"NoSQL","permalink":"http://wangba.me/tags/NoSQL/"}]},{"title":"é“æ°ç‹æœæ»¡æ±‰å…¨å¸­ 919","slug":"é“æ°ç‹æœæ»¡æ±‰å…¨å¸­-919","date":"2020-09-15T13:23:00.000Z","updated":"2020-09-30T07:09:13.230Z","comments":true,"path":"2020/09/15/é“æ°ç‹æœæ»¡æ±‰å…¨å¸­-919/","link":"","permalink":"http://wangba.me/2020/09/15/%E9%93%81%E6%B0%8F%E7%8E%8B%E6%9C%9D%E6%BB%A1%E6%B1%89%E5%85%A8%E5%B8%AD-919/","excerpt":"","text":"919 é“æ°ç‹æœæ»¡æ±‰å…¨å¸­ v1.3 æ¸…è’¸å¤§é—¸èŸ¹ 5åª ææ–™ï¼š é˜³æ¾„æ¹–å¤§é—¸èŸ¹ ç”Ÿå§œ è’œç“£ é¦™è‘± ç´«è‹ ç”ŸæŠ½ é¦™é†‹ æ–™é…’ é¦™æ²¹ é¸¡ç²¾ ç³– å¯ä¹é¸¡ç¿… ææ–™ï¼š é¸¡ç¿…10ä¸ª å¯ä¹300æ¯«å‡ è€æŠ½1å‹º ç›ï¼Œé¸¡ç²¾é€‚é‡ è‘±å§œï¼Œå…«è§’é€‚é‡ ç³–é†‹æ’éª¨ ææ–™ï¼š çŒªè‚‹æ’500å…‹ è‘±é€‚é‡ å§œé€‚é‡ å…«è§’2ä¸ª è€æŠ½2å‹º ç”ŸæŠ½2å‹º ç™½ç³–3å‹º é¦™é†‹4å‹º æ–™é…’5å‹º ç†Ÿç™½èŠéº»é€‚é‡ éº»è¾£å°é¾™è™¾ ææ–™ï¼š å°é¾™è™¾30æ–¤ é¦™è‘±é€‚é‡ å§œé€‚é‡ è’œé€‚é‡ å¤§è‘±é€‚é‡ æ¡‚çš®é€‚é‡ å…«è§’é€‚é‡ é¦™å¶é€‚é‡ ç´«è‹é€‚é‡ å°ç±³æ¤’é€‚é‡ å†°ç³–é€‚é‡ è—•æ¡é€‚é‡ é’æ¤’é€‚é‡ çº¢æ²¹ç«é”…åº•æ–™é€‚é‡ è±†ç“£é…±é€‚é‡ æ·€ç²‰é€‚é‡ ç™½èŠéº»é€‚é‡ èŠå£«åŸ¹æ ¹æ³¡èœå· ææ–™ï¼š è’œè“‰é‡‘é’ˆè‡ ææ–™ï¼š é‡‘é’ˆè‡1æŠŠ è’œä¸€å¤´ é£Ÿç”¨æ²¹é€‚é‡ é…±æ²¹4å‹º èšæ²¹2å‹º å°è‘±4æ ¹ é¸¡ç²¾é€‚é‡ ç³– ç› é…’é…¿å°æ±¤åœ†å†²é¸¡è›‹ ææ–™ï¼š å§œæ’å¥¶ ææ–™ï¼š è€å§œ1å¤§å— çº¯ç‰›å¥¶200æ¯«å‡ ç»†ç ‚ç³–é€‚é‡ è”“è¶Šè“å¹²å°‘è®¸","categories":[{"name":"WangBa's CookBook","slug":"WangBa-s-CookBook","permalink":"http://wangba.me/categories/WangBa-s-CookBook/"}],"tags":[{"name":"CookBook","slug":"CookBook","permalink":"http://wangba.me/tags/CookBook/"},{"name":"Life","slug":"Life","permalink":"http://wangba.me/tags/Life/"}]},{"title":"SpringBootæ•´åˆSpring Data JPA ä¹‹å¤šæ¡ä»¶æœç´¢å·¥å…·ç±»","slug":"SpringBootæ•´åˆSpring-Data-JPA-ä¹‹å¤šæ¡ä»¶æœç´¢å·¥å…·ç±»","date":"2020-09-14T12:21:20.000Z","updated":"2020-09-30T07:08:37.925Z","comments":true,"path":"2020/09/14/SpringBootæ•´åˆSpring-Data-JPA-ä¹‹å¤šæ¡ä»¶æœç´¢å·¥å…·ç±»/","link":"","permalink":"http://wangba.me/2020/09/14/SpringBoot%E6%95%B4%E5%90%88Spring-Data-JPA-%E4%B9%8B%E5%A4%9A%E6%9D%A1%E4%BB%B6%E6%90%9C%E7%B4%A2%E5%B7%A5%E5%85%B7%E7%B1%BB/","excerpt":"","text":"ä¸€ã€OverViewâ€‹ åœ¨å‰é¢å·²ç»ä»‹ç»è¿‡äº† SpringBoot æ•´åˆ JPA äº†ï¼Œä½†æ˜¯ä¸€èˆ¬åœ¨å…¬å¸ä¸šåŠ¡ä¸­ï¼Œå¦‚æœå‡ºç°å¾ˆå¤šæ¬¡å¤šæ¡ä»¶æœç´¢æŸ¥è¯¢çš„æƒ…å†µï¼Œé‚£ä¹ˆå°±ä¼šç”¨å¤§é‡å†—ä½™ä»£ç äº†ï¼›å†ç»“åˆæ³¨è§£çš„æ€æƒ³ã€‚æœ¬æ¬¡å°†å…¬å…±éƒ¨åˆ†æå–å‡ºæ¥ï¼Œå¹¶ç”¨æ³¨è§£çš„æ–¹å¼è¿›è¡Œæ“ä½œï¼Œå¯ä»¥å‚è€ƒå‰é¢ä½¿ç”¨æ³¨è§£è¿›è¡Œ AOP å¤„ç†æ—¥å¿—ï¼Œä¹Ÿç¬¦åˆäº† SpringBoot çš„æ€æƒ³ã€‚ äºŒã€BaseQueryQueryWord 12345678910111213141516171819@Target(ElementType.FIELD)@Retention(RetentionPolicy.RUNTIME)public @interface QueryWord &#123; // æ•°æ®åº“ä¸­å­—æ®µå,é»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²,åˆ™Queryç±»ä¸­çš„å­—æ®µè¦ä¸æ•°æ®åº“ä¸­å­—æ®µä¸€è‡´ String column() default &quot;&quot;; // equal, like, gt, lt... MatchType func() default MatchType.equal; // objectæ˜¯å¦å¯ä»¥ä¸ºnull boolean nullable() default false; // å­—ç¬¦ä¸²æ˜¯å¦å¯ä¸ºç©º boolean empty() default false; // between...and... æŸ¥è¯¢è¯­å¥æ ‡è¯†ï¼Œ 0æ—¶é—´ 1æ•°å­—ç±»å‹ BetweenType type() default BetweenType.datetime;&#125; æ³¨ï¼šæ³¨è§£ç±»ï¼Œåªè¦åœ¨è¦æŸ¥è¯¢çš„å±æ€§ä¸ŠåŠ ä¸Šç›¸åº”çš„æ³¨è§£å³å¯ MatchType 12345678910111213141516171819202122public enum MatchType &#123; equal, // filed = value // ä¸‹é¢å››ä¸ªç”¨äºNumberç±»å‹çš„æ¯”è¾ƒ gt, // filed &gt; value ge, // field &gt;= value lt, // field &lt; value le, // field &lt;= value notEqual, // field != value like, // field like value notLike, // field not like value between, // between value1 and value2 ,Type is Date // ä¸‹é¢å››ä¸ªç”¨äºå¯æ¯”è¾ƒç±»å‹(Comparable)çš„æ¯”è¾ƒ greaterThan, // field &gt; value greaterThanOrEqualTo, // field &gt;= value lessThan, // field &lt; value lessThanOrEqualTo // field &lt;= value&#125; æ³¨ï¼šæšä¸¾ç±»ï¼Œå¯ä»¥å¯¹æ¯”æ³¨é‡Šè¿›è¡Œç†è§£ BetweenType 1234567public enum BetweenType &#123; datetime, number_long, number_integer&#125; æ³¨ï¼šå¯¹åº”ä¸Šé¢ QueryWordä¸­çš„ BetweenType ï¼Œå¯ä»¥å¯¹æ—¶é—´æˆ–æ•°å­—ä¹‹é—´çš„å±æ€§è¿›è¡Œæ³¨è§£ BaseQuery 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189public abstract class BaseQuery&lt;T&gt; &#123; // ç¬¬å¤šå°‘é¡µ + é¡µå¤§å° private int pageNum = 0; private int pageSize = 10; // private static Map&lt;Class, List&lt;Field&gt;&gt; fieldCache = new HashMap&lt;&gt;(); // åŠ¨æ€æŸ¥è¯¢ public abstract Specification&lt;T&gt; toSpec(); // åˆ†é¡µ public Pageable toPageable() &#123; return PageRequest.of(pageNum, pageSize); &#125; // åˆ†é¡µ + æ’åº public Pageable toPageable(Sort sort) &#123; return PageRequest.of(pageNum, pageSize, sort); &#125; // åŠ¨æ€æŸ¥è¯¢ and è¿æ¥ protected Specification&lt;T&gt; toSpecWithAnd() &#123; return this.toSpecWithLogicType(&quot;and&quot;); &#125; // åŠ¨æ€æŸ¥è¯¢ or è¿æ¥ protected Specification&lt;T&gt; toSpecWithOr() &#123; return this.toSpecWithLogicType(&quot;or&quot;); &#125; // logicType = or ï½œ and @SuppressWarnings(&#123; &quot;rawtypes&quot;, &quot;unchecked&quot; &#125;) private Specification&lt;T&gt; toSpecWithLogicType(final String logicType) &#123; final BaseQuery outerThis = this; // å°è£…æ¡ä»¶æŸ¥è¯¢å¯¹è±¡ Specification Specification&lt;T&gt; specification = new Specification&lt;T&gt;() &#123; @Override // Root ç”¨äºè·å–å±æ€§å­—æ®µï¼ŒCriteriaQueryå¯ä»¥ç”¨äºç®€å•æ¡ä»¶æŸ¥è¯¢ï¼ŒCriteriaBuilder ç”¨äºæ„é€ å¤æ‚æ¡ä»¶æŸ¥è¯¢ public Predicate toPredicate(Root&lt;T&gt; root, CriteriaQuery&lt;?&gt; query, CriteriaBuilder cb) &#123; Class clazz = outerThis.getClass(); // åˆ¤æ–­ç¼“å­˜ä¸­æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œå­˜åœ¨ä¸éœ€è¦å†æ¬¡ç”Ÿæˆï¼Œä¸å­˜åœ¨éœ€è¦é‡æ–°ç”Ÿæˆ List&lt;Field&gt; fields = fieldCache.get(clazz); if (fields == null) &#123; // è·å–æŸ¥è¯¢ç±»Queryçš„æ‰€æœ‰å­—æ®µ,åŒ…æ‹¬çˆ¶ç±»å­—æ®µ fields = getAllFieldsWithRoot(clazz); fieldCache.put(clazz, fields); &#125; List&lt;Predicate&gt; predicates = new ArrayList&lt;&gt;(fields.size()); for (Field field : fields) &#123; // è·å–å­—æ®µä¸Šçš„ @QueryWord æ³¨è§£ QueryWord qw = field.getAnnotation(QueryWord.class); if (qw == null) &#123; continue; &#125; // è·å–å­—æ®µå String column = qw.column(); //å¦‚æœä¸»æ³¨è§£ä¸Š column ä¸ºé»˜è®¤å€¼&quot;&quot;,åˆ™ä»¥ field ä¸ºå‡† if (column.equals(&quot;&quot;)) &#123; column = field.getName(); &#125; field.setAccessible(true); try &#123; // nullable Object value = field.get(outerThis); // å¦‚æœå€¼ä¸º null,æ³¨è§£æœªæ ‡æ³¨ nullable,è·³è¿‡ if (value == null &amp;&amp; !qw.nullable()) &#123; continue; &#125; // can be empty if (value != null &amp;&amp; String.class.isAssignableFrom(value.getClass())) &#123; String s = (String) value; //å¦‚æœå€¼ä¸º&quot;&quot;,ä¸”æ³¨è§£æœªæ ‡æ³¨ empty ,è·³è¿‡ if (s.equals(&quot;&quot;) &amp;&amp; !qw.empty()) &#123; continue; &#125; &#125; //é€šè¿‡æ³¨è§£ä¸Š func å±æ€§,æ„å»ºè·¯å¾„è¡¨è¾¾å¼ Path path = root.get(column); switch (qw.func()) &#123; case equal: predicates.add(cb.equal(path, value)); break; case like: predicates.add(cb.like(path, &quot;%&quot; + value + &quot;%&quot;)); break; case gt: predicates.add(cb.gt(path, (Number) value)); break; case lt: predicates.add(cb.lt(path, (Number) value)); break; case ge: predicates.add(cb.ge(path, (Number) value)); break; case le: predicates.add(cb.le(path, (Number) value)); break; case notEqual: predicates.add(cb.notEqual(path, value)); break; case notLike: predicates.add(cb.notLike(path, &quot;%&quot; + value + &quot;%&quot;)); break; case greaterThan: predicates.add(cb.greaterThan(path, (Comparable) value)); break; case greaterThanOrEqualTo: predicates.add(cb.greaterThanOrEqualTo(path, (Comparable) value)); break; case lessThan: predicates.add(cb.lessThan(path, (Comparable) value)); break; case lessThanOrEqualTo: predicates.add(cb.lessThanOrEqualTo(path, (Comparable) value)); break; case between: switch (qw.type()) &#123; case datetime: List&lt;Date&gt; dateList = (List&lt;Date&gt;) value; predicates.add(cb.between(path, dateList.get(0), dateList.get(1))); break; case number_long: List&lt;Long&gt; longList = (List&lt;Long&gt;) value; predicates.add(cb.between(path, longList.get(0), longList.get(1))); break; case number_integer: List&lt;Integer&gt; integerList = (List&lt;Integer&gt;) value; predicates.add(cb.between(path, integerList.get(0), integerList.get(1))); break; &#125; &#125; &#125; catch (Exception e) &#123; continue; &#125; &#125; Predicate p = null; if (logicType == null || logicType.equals(&quot;&quot;) || logicType.equals(&quot;and&quot;)) &#123; p = cb.and(predicates.toArray(new Predicate[predicates.size()])); // and è¿æ¥ &#125; else if (logicType.equals(&quot;or&quot;)) &#123; p = cb.or(predicates.toArray(new Predicate[predicates.size()])); // or è¿æ¥ &#125; return p; &#125; &#125;; return specification; &#125; //è·å–ç±» clazz çš„æ‰€æœ‰ Fieldï¼ŒåŒ…æ‹¬å…¶çˆ¶ç±»çš„ Field private List&lt;Field&gt; getAllFieldsWithRoot(Class&lt;?&gt; clazz) &#123; List&lt;Field&gt; fieldList = new ArrayList&lt;&gt;(); Field[] dFields = clazz.getDeclaredFields(); //è·å–æœ¬ç±»æ‰€æœ‰å­—æ®µ if (null != dFields &amp;&amp; dFields.length &gt; 0) &#123; fieldList.addAll(Arrays.asList(dFields)); &#125; // è‹¥çˆ¶ç±»æ˜¯ Objectï¼Œåˆ™ç›´æ¥è¿”å›å½“å‰ Field åˆ—è¡¨ Class&lt;?&gt; superClass = clazz.getSuperclass(); if (superClass == Object.class) &#123; return Arrays.asList(dFields); &#125; // é€’å½’æŸ¥è¯¢çˆ¶ç±»çš„ Field åˆ—è¡¨ List&lt;Field&gt; superFields = getAllFieldsWithRoot(superClass); if (null != superFields &amp;&amp; !superFields.isEmpty()) &#123; for (Field field : superFields) &#123; if (!fieldList.contains(field)) &#123; fieldList.add(field); &#125; &#125; &#125; return fieldList; &#125; public int getPageIndex() &#123; return pageNum; &#125; public void setPageIndex(int pageIndex) &#123; this.pageNum = pageIndex; &#125; public int getPageSize() &#123; return pageSize; &#125; public void setPageSize(int pageSize) &#123; this.pageSize = pageSize; &#125;&#125; æ³¨ï¼šæœ€å…³é”®çš„ç±» æ‰€æœ‰åé¢è¦æŸ¥è¯¢çš„ç±»éƒ½è¦ç»§æ‰¿å®ƒ ç®€å•çš„ç†è§£ï¼šé€šè¿‡åå°„è·å–æ³¨è§£ä¸Šçš„å­—æ®µä¿¡æ¯ï¼Œæ„é€ ç›¸åº”çš„æœç´¢æ¡ä»¶ ä¸‰ã€TestStudentQuery 123456789101112131415public class StudentQuery extends BaseQuery&#123; @QueryWord(column = &quot;id&quot;, func = MatchType.equal) private Long id; @QueryWord(func = MatchType.like) private String name; // çœç•¥ set / get @Override public Specification toSpec() &#123; return super.toSpecWithOr(); &#125;&#125; åœ¨è¿™ä¸ªæŸ¥è¯¢ä¸­ï¼Œä½¿ç”¨çš„æ˜¯ or æŸ¥è¯¢ï¼Œæµ‹è¯•ç±»å¦‚ä¸‹ï¼š Test 123456789101112@Testpublic void find8() &#123; StudentQuery studentQuery = new StudentQuery(); studentQuery.setId(1L); studentQuery.setName(&quot;er&quot;); studentQuery.setPageIndex(0); studentQuery.setPageSize(10); Page page = studentRepository.findAll(studentQuery.toSpec(), studentQuery.toPageable()); for (Object o : page.getContent()) &#123; System.out.println(o); &#125;&#125; æ³¨ï¼šæ„é€ çš„æ¡ä»¶æ˜¯ id = 1çš„ï¼Œæˆ–è€… name = ? er ? çš„ student ç»“æœ é€šè¿‡è¿™ä¸ªä¾‹å­ç®€å•æ‹ä¸€ä¸‹æ•´ä¸ªè¿‡ç¨‹ï¼š é€šè¿‡ studentQuery.toSpec() è°ƒç”¨çˆ¶ç±» BaseQueryï¼› åœ¨ BaseQuery ä¸­ï¼Œé€šè¿‡åå°„è·å¾—æ‰“äº†ç›¸åº”æ³¨è§£ä¸Šçš„å­—æ®µä¿¡æ¯ï¼› å°†å­—æ®µä¿¡æ¯åŠ åˆ°æœç´¢æ¡ä»¶ä¸­ï¼Œè¿›è¡Œ or æˆ–è€… and è¿æ¥ æ³¨ï¼šå¦‚æœä½ çš„ä¸šåŠ¡ä¸­åªç”¨äº†å¾ˆå°‘çš„æ¡ä»¶æˆ–è€…åªç”¨æä¸ªåˆ«çš„å¤šæ¡ä»¶æŸ¥è¯¢ï¼Œå¯ä»¥ä¸ç”¨è¿™ä¸ªå·¥å…·ç±»","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"},{"name":"MySQL","slug":"MySQL","permalink":"http://wangba.me/tags/MySQL/"}]},{"title":"SpringBootæ•´åˆSpring Data JPA(äºŒ)","slug":"SpringBootæ•´åˆSpring-Data-JPA-äºŒ","date":"2020-09-10T10:38:46.000Z","updated":"2020-09-30T07:08:31.365Z","comments":true,"path":"2020/09/10/SpringBootæ•´åˆSpring-Data-JPA-äºŒ/","link":"","permalink":"http://wangba.me/2020/09/10/SpringBoot%E6%95%B4%E5%90%88Spring-Data-JPA-%E4%BA%8C/","excerpt":"","text":"ä¸€ã€OverViewâ€‹ åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ä»‹ç»äº†ä¸€ä¸‹ Spring Data JPA çš„ä¸€ä¸‹ç®€å•çš„ CRUDï¼Œä½†æ˜¯åœ¨å…¬å¸ä¸šåŠ¡ä¸­ï¼Œä¸å¯èƒ½è¿™ä¹ˆç®€å•ï¼›ä¸”åœ¨ä¸šåŠ¡ä¸­å¤§éƒ¨åˆ†éƒ½æ˜¯æŸ¥è¯¢ä¸šåŠ¡ï¼Œå…·ä½“ç‚¹å°±æ˜¯åŠ¨æ€æŸ¥è¯¢ï¼Œä»€ä¹ˆå•è¡¨å¤šæ¡ä»¶æŸ¥è¯¢ã€å¤šè¡¨å¤šæ¡ä»¶æŸ¥è¯¢ç­‰ç­‰â€¦â€¦ æ³¨ï¼šä½¿ç”¨ç¯å¢ƒè¿˜æ˜¯å’Œä¸Šä¸€ç¯‡ä¸€æ · äºŒã€è‡ªå®šä¹‰SQLæŸ¥è¯¢å¦‚æœæƒ³å’Œè¿™é‡Œé¢å†™åŸç”Ÿçš„ SQL è¯­å¥ï¼Œåªè¦åœ¨ repository ä¸­è¿™æ ·å†™å°±è¡Œï¼š 123@Query(nativeQuery = true, value = &quot;select * from Student where id = ?1&quot;)Student catchAllById(Long id); æ³¨ï¼š å¦‚æœè¦å†™åŸç”Ÿ SQLï¼Œ@Query æ³¨è§£ä¸­çš„ nativeQuery è¦è®¾ç½®ä¸º trueï¼Œé»˜è®¤ä¸º false å‡½æ•°åè®¾ç½®çš„ä¸èƒ½ä¸è‡ªå¸¦çš„å†²çªï¼Œä¾‹å¦‚ï¼šfindByIdï¼Œå¦‚æœè®¾ç½®äº†ä¸€æ ·ï¼Œå°±ä¼šå¯¼è‡´ä½¿ç”¨çš„è‡ªå¸¦çš„ API è¿›è¡ŒæŸ¥è¯¢ï¼Œè€Œä¸æ˜¯è‡ªå®šä¹‰çš„ï¼Œå¦‚æœçœŸçš„æƒ³ä½¿ç”¨è‡ªå®šä¹‰è¦†ç›–è‡ªå¸¦çš„ï¼Œå¯ä»¥åœ¨å®ä½“ç±»ä¸Šä½¿ç”¨ @NamedQueries æ³¨è§£ åœ¨è¿™é‡Œæˆ‘ä»¬å°±ä½¿ç”¨ @Test è¿›è¡Œæµ‹è¯•ï¼š è¿˜æœ‰ä¸€ç§ä½¿ç”¨ JPQL è¯­æ³•çš„æŸ¥è¯¢æ–¹å¼ï¼š repository: 12@Query(value = &quot;select s from Student s where s.name = ?1&quot;)List&lt;Student&gt; catchByName(String name); Test: å…³äº JPQLï¼šå’Œåœ¨ SQL ä¸­ä¸€æ ·ï¼ŒJPQL ä¸­çš„ select è¯­å¥ç”¨äºæ‰§è¡ŒæŸ¥è¯¢ã€‚å…¶è¯­æ³•å¯è¡¨ç¤ºä¸ºï¼šselect_clause form_clause [where_clause] [groupby_clause] [having_clause] [orderby_clause] å…¶ä¸­ï¼š from å­å¥æ˜¯æŸ¥è¯¢è¯­å¥çš„å¿…é€‰å­å¥ã€‚ select ç”¨æ¥æŒ‡å®šæŸ¥è¯¢è¿”å›çš„ç»“æœå®ä½“æˆ–å®ä½“çš„æŸäº›å±æ€§ã€‚ from å­å¥å£°æ˜æŸ¥è¯¢æºå®ä½“ç±»ï¼Œå¹¶æŒ‡å®šæ ‡è¯†ç¬¦å˜é‡ï¼ˆç›¸å½“äºSQLè¡¨çš„åˆ«åï¼‰ã€‚ å¦‚æœä¸å¸Œæœ›è¿”å›é‡å¤å®ä½“ï¼Œå¯ä½¿ç”¨å…³é”®å­— distinct ä¿®é¥°ã€‚selectã€from éƒ½æ˜¯ JPQL çš„å…³é”®å­—ï¼Œé€šå¸¸å…¨å¤§å†™æˆ–å…¨å°å†™ï¼Œå»ºè®®ä¸è¦å¤§å°å†™æ··ç”¨ã€‚ åœ¨ JPQL ä¸­ï¼ŒæŸ¥è¯¢æ‰€æœ‰å®ä½“çš„ JPQL æŸ¥è¯¢è¯­å¥å¾ˆç®€å•ï¼Œå¦‚ä¸‹ï¼šselect o from Order o æˆ– select o from Order as oè¿™é‡Œå…³é”®å­— as å¯ä»¥çœå»ï¼Œæ ‡è¯†ç¬¦å˜é‡çš„å‘½åè§„èŒƒä¸ Java æ ‡è¯†ç¬¦ç›¸åŒï¼Œä¸”åŒºåˆ†å¤§å°å†™ æ›´å¤šå‚è€ƒï¼šå®˜ç½‘æ–‡æ¡£ ä¸‰ã€è‡ªå®šä¹‰ç®€å•æŸ¥è¯¢åœ¨ Spring Data JPA çš„å®˜ç½‘ä¹Ÿä»‹ç»äº†è¿™ç§æ–¹å¼ï¼Œä¸€èˆ¬è¿™ç§æ–¹å¼åœ¨ä¸€äº›å°é¡¹ç›®ä¸­ä¹Ÿç»å¸¸ä½¿ç”¨ï¼š Keyword Sample JPQL snippet And findByLastnameAndFirstname â€¦ where x.lastname = ?1 and x.firstname = ?2 Or findByLastnameOrFirstname â€¦ where x.lastname = ?1 or x.firstname = ?2 Is, Equals findByFirstname,findByFirstnameIs,findByFirstnameEquals â€¦ where x.firstname = ?1 Between findByStartDateBetween â€¦ where x.startDate between ?1 and ?2 LessThan findByAgeLessThan â€¦ where x.age &lt; ?1 LessThanEqual findByAgeLessThanEqual â€¦ where x.age &lt;= ?1 GreaterThan findByAgeGreaterThan â€¦ where x.age &gt; ?1 GreaterThanEqual findByAgeGreaterThanEqual â€¦ where x.age &gt;= ?1 After findByStartDateAfter â€¦ where x.startDate &gt; ?1 Before findByStartDateBefore â€¦ where x.startDate &lt; ?1 IsNull, Null findByAge(Is)Null â€¦ where x.age is null IsNotNull, NotNull findByAge(Is)NotNull â€¦ where x.age not null Like findByFirstnameLike â€¦ where x.firstname like ?1 NotLike findByFirstnameNotLike â€¦ where x.firstname not like ?1 StartingWith findByFirstnameStartingWith â€¦ where x.firstname like ?1 (parameter bound with appended %) EndingWith findByFirstnameEndingWith â€¦ where x.firstname like ?1 (parameter bound with prepended %) Containing findByFirstnameContaining â€¦ where x.firstname like ?1 (parameter bound wrapped in %) OrderBy findByAgeOrderByLastnameDesc â€¦ where x.age = ?1 order by x.lastname desc Not findByLastnameNot â€¦ where x.lastname &lt;&gt; ?1 In findByAgeIn(Collection&lt;Age&gt; ages) â€¦ where x.age in ?1 NotIn findByAgeNotIn(Collection&lt;Age&gt; ages) â€¦ where x.age not in ?1 True findByActiveTrue() â€¦ where x.active = true False findByActiveFalse() â€¦ where x.active = false IgnoreCase findByFirstnameIgnoreCase â€¦ where UPPER(x.firstame) = UPPER(?1) åŸç†å¤§æ¦‚å¦‚ä¸‹ï¼š å‡å¦‚åˆ›å»ºå¦‚ä¸‹çš„æŸ¥è¯¢ï¼šfindByUserDepUuid()ï¼Œæ¡†æ¶åœ¨è§£æè¯¥æ–¹æ³•æ—¶ï¼Œé¦–å…ˆå‰”é™¤ findByï¼Œç„¶åå¯¹å‰©ä¸‹çš„å±æ€§è¿›è¡Œè§£æ å…ˆåˆ¤æ–­ userDepUuid ï¼ˆæ ¹æ® POJO è§„èŒƒï¼Œé¦–å­—æ¯å˜ä¸ºå°å†™ï¼‰æ˜¯å¦ä¸ºæŸ¥è¯¢å®ä½“çš„ä¸€ä¸ªå±æ€§ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¡¨ç¤ºæ ¹æ®è¯¥å±æ€§è¿›è¡ŒæŸ¥è¯¢ï¼›å¦‚æœæ²¡æœ‰è¯¥å±æ€§ï¼Œç»§ç»­ç¬¬äºŒæ­¥ï¼› ä»å³å¾€å·¦æˆªå–ç¬¬ä¸€ä¸ªå¤§å†™å­—æ¯å¼€å¤´çš„å­—ç¬¦ä¸²æ­¤å¤„ä¸ºUuidï¼‰ï¼Œç„¶åæ£€æŸ¥å‰©ä¸‹çš„å­—ç¬¦ä¸²æ˜¯å¦ä¸ºæŸ¥è¯¢å®ä½“çš„ä¸€ä¸ªå±æ€§ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¡¨ç¤ºæ ¹æ®è¯¥å±æ€§è¿›è¡ŒæŸ¥è¯¢ï¼›å¦‚æœæ²¡æœ‰è¯¥å±æ€§ï¼Œåˆ™é‡å¤ç¬¬äºŒæ­¥ï¼Œç»§ç»­ä»å³å¾€å·¦æˆªå–ï¼›æœ€åå‡è®¾userä¸ºæŸ¥è¯¢å®ä½“çš„ä¸€ä¸ªå±æ€§ï¼› æ¥ç€å¤„ç†å‰©ä¸‹éƒ¨åˆ†ï¼ˆDepUuidï¼‰ï¼Œå…ˆåˆ¤æ–­ user æ‰€å¯¹åº”çš„ç±»å‹æ˜¯å¦æœ‰depUuidå±æ€§ï¼Œå¦‚æœæœ‰ï¼Œåˆ™è¡¨ç¤ºè¯¥æ–¹æ³•æœ€ç»ˆæ˜¯æ ¹æ® Doc.user.depUuid çš„å–å€¼è¿›è¡ŒæŸ¥è¯¢ï¼›å¦åˆ™ç»§ç»­æŒ‰ç…§æ­¥éª¤ 2 çš„è§„åˆ™ä»å³å¾€å·¦æˆªå–ï¼Œæœ€ç»ˆè¡¨ç¤ºæ ¹æ® Doc.user.dep.uuid çš„å€¼è¿›è¡ŒæŸ¥è¯¢ã€‚ å¯èƒ½ä¼šå­˜åœ¨ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œæ¯”å¦‚ DocåŒ…å«ä¸€ä¸ª user çš„å±æ€§ï¼Œä¹Ÿæœ‰ä¸€ä¸ª userDep å±æ€§ï¼Œæ­¤æ—¶ä¼šå­˜åœ¨æ··æ·†ã€‚å¯ä»¥æ˜ç¡®åœ¨å±æ€§ä¹‹é—´åŠ ä¸Š â€œ_â€ ä»¥æ˜¾å¼è¡¨è¾¾æ„å›¾ï¼Œæ¯”å¦‚ findByUser_DepUuid() æˆ–è€… findByUserDep_uuid() repository: 1234567891011List&lt;Student&gt; findByName(String name);List&lt;Student&gt; findByNameAndPwd(String name, String pwd);List&lt;Student&gt; findByNameStartingWith(String name);List&lt;Student&gt; findByNameEndingWith(String name);List&lt;Student&gt; findByNameContaining(String name);List&lt;Student&gt; findByNameContainingOrderByIdDesc(String name); test: findByName findByNameAndPwd findByNameStartingWith findByNameEndingWith findByNameContaining findByNameContainingOrderByIdDesc å››ã€åˆ†é¡µæŸ¥è¯¢12345678910// åˆ†é¡µ + æ’åº@Testpublic void find6() &#123; Sort sort = Sort.by(Sort.Direction.DESC, &quot;id&quot;); PageRequest pageRequest = PageRequest.of(0, 2, sort); Page&lt;Student&gt; studentPage = studentRepository.findAll(pageRequest); for (Student student : studentPage.getContent()) &#123; System.out.println(student); &#125;&#125; æ³¨ï¼š Sort.by(æ’åºæ–¹å¼, æ’åºå­—æ®µ) PageRequest.of(ç¬¬å¤šå°‘é¡µï¼Œé¡µå¤§å°) â€”â€”â€“&gt; ä¸€èˆ¬æ˜¯å†™ä¸€ä¸ª PageUtils Test äº”ã€åŠ¨æ€æŸ¥è¯¢1234567891011121314151617// åˆ†é¡µ + æ’åº + æœç´¢@Testpublic void find7() &#123; PageRequest pageRequest = PageRequest.of(0, 2, Sort.by(Sort.Direction.DESC, &quot;id&quot;)); Specification&lt;Student&gt; specification = new Specification&lt;Student&gt;() &#123; @Override public Predicate toPredicate(Root&lt;Student&gt; root, CriteriaQuery&lt;?&gt; query, CriteriaBuilder criteriaBuilder) &#123; // å¢åŠ æœç´¢æ¡ä»¶: id &lt;= 5 Predicate predicate = criteriaBuilder.lessThanOrEqualTo(root.get(&quot;id&quot;), 5); return predicate; &#125; &#125;; Page&lt;Student&gt; studentPage = studentRepository.findAll(specification, pageRequest); for (Student student : studentPage.getContent()) &#123; System.out.println(student); &#125;&#125; æ³¨ï¼š root: ä»£è¡¨æŸ¥è¯¢çš„å®ä½“ç±» query: å¯ä»¥ä»ä¸­å¾—åˆ° Root å¯¹è±¡ criteriaBuilder: ç”¨äºåˆ›å»º Criteria ç›¸å…³å¯¹è±¡çš„å·¥å‚ Predicate: ä»£è¡¨ä¸€ä¸ªæŸ¥è¯¢æ¡ä»¶ Test: å¤šæ¡ä»¶ï¼š 123456789101112131415161718// åˆ†é¡µ + æ’åº + æœç´¢@Testpublic void find7() &#123; PageRequest pageRequest = PageRequest.of(0, 10, Sort.by(Sort.Direction.DESC, &quot;id&quot;)); List&lt;Predicate&gt; predicateList = new ArrayList&lt;&gt;(); Specification&lt;Student&gt; specification = new Specification&lt;Student&gt;() &#123; @Override public Predicate toPredicate(Root&lt;Student&gt; root, CriteriaQuery&lt;?&gt; query, CriteriaBuilder criteriaBuilder) &#123; predicateList.add(criteriaBuilder.lessThanOrEqualTo(root.get(&quot;id&quot;), 5)); predicateList.add(criteriaBuilder.like(root.get(&quot;name&quot;), &quot;%&quot; + &quot;er&quot;)); return criteriaBuilder.and(predicateList.toArray(new Predicate[predicateList.size()])); &#125; &#125;; Page&lt;Student&gt; studentPage = studentRepository.findAll(specification, pageRequest); for (Student student : studentPage.getContent()) &#123; System.out.println(student); &#125;&#125; Test:","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"},{"name":"MySQL","slug":"MySQL","permalink":"http://wangba.me/tags/MySQL/"}]},{"title":"SpringBootæ•´åˆSpring Data JPA(ä¸€)","slug":"SpringBootæ•´åˆSpring-Data-JPA-ä¸€","date":"2020-09-10T10:38:30.000Z","updated":"2020-09-30T07:08:34.596Z","comments":true,"path":"2020/09/10/SpringBootæ•´åˆSpring-Data-JPA-ä¸€/","link":"","permalink":"http://wangba.me/2020/09/10/SpringBoot%E6%95%B4%E5%90%88Spring-Data-JPA-%E4%B8%80/","excerpt":"","text":"ä¸€ã€OverView JPA(Java Persistence API)æ˜¯Sunå®˜æ–¹æå‡ºçš„JavaæŒä¹…åŒ–è§„èŒƒã€‚å®ƒä¸ºJavaå¼€å‘äººå‘˜æä¾›äº†ä¸€ç§å¯¹è±¡/å…³è”æ˜ å°„å·¥å…·æ¥ç®¡ç†Javaåº”ç”¨ä¸­çš„å…³ç³»æ•°æ®ã€‚ Spring Data JPA æ˜¯ Spring åŸºäº ORM æ¡†æ¶ã€JPA è§„èŒƒçš„åŸºç¡€ä¸Šå°è£…çš„ä¸€å¥—JPAåº”ç”¨æ¡†æ¶ï¼Œå¯ä½¿å¼€å‘è€…ç”¨æç®€çš„ä»£ç å³å¯å®ç°å¯¹æ•°æ®çš„è®¿é—®å’Œæ“ä½œã€‚å®ƒæä¾›äº†åŒ…æ‹¬å¢åˆ æ”¹æŸ¥ç­‰åœ¨å†…çš„å¸¸ç”¨åŠŸèƒ½ï¼Œä¸”æ˜“äºæ‰©å±•ï¼å­¦ä¹ å¹¶ä½¿ç”¨ Spring Data JPA å¯ä»¥æå¤§æé«˜å¼€å‘æ•ˆç‡ï¼ spring data jpaè®©æˆ‘ä»¬è§£è„±äº†DAOå±‚çš„æ“ä½œï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰CRUDéƒ½å¯ä»¥ä¾èµ–äºå®ƒæ¥å®ç° äºŒã€ç¯å¢ƒæ­å»ºpom.xml 1234567891011121314&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt;&lt;/dependency&gt;&lt;dependency&gt; application.properties 123456789101112spring.datasource.url=jdbc:mysql://localhost:3306/jpaspring.datasource.username=rootspring.datasource.password=spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driverspring.jpa.database=mysql# æ˜¯å¦åœ¨æ§åˆ¶å°æ‰“å° sql è¯­å¥spring.jpa.show-sql=true# ä½¿ç”¨ InnoDB ä½œä¸ºå¼•æ“ spring.jpa.database-platform=org.hibernate.dialect.MySQL5InnoDBDialect# æ¯æ¬¡å¯åŠ¨éƒ½ä¼šæ›´æ–°æ•°æ®åº“ï¼Œå¦‚ï¼šå¢åŠ å­—æ®µç­‰ï¼Œä½†æ˜¯å¯¹æŸä¸ªå­—æ®µè¿›è¡Œæ”¹é€ æ˜¯è¯†åˆ«ä¸å‡ºæ¥spring.jpa.hibernate.ddl-auto=update entiy Student 123456789101112131415161718@Entity@Table(name = &quot;student&quot;)public class Student &#123; @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = &quot;id&quot;, columnDefinition = &quot;INT UNSIGNED COMMENT &#x27;è‡ªå¢ä¸»é”®&#x27;&quot;) private Long id; @Column(name = &quot;name&quot;, columnDefinition = &quot;VARCHAR(50) NOT NULL COMMENT &#x27;ç”¨æˆ·å&#x27;&quot;) private String name; @Column(name = &quot;pwd&quot;, columnDefinition = &quot;VARCHAR(100) DEFAULT NULL COMMENT &#x27;å¯†ç &#x27;&quot;) private String pwd; // çœç•¥ set get&#125; Grade 1234567891011121314151617@Entity@Table(name = &quot;grade&quot;)public class Grade &#123; @Id @GeneratedValue(strategy = GenerationType.IDENTITY) @Column(name = &quot;id&quot;, columnDefinition = &quot;INT UNSIGNED COMMENT &#x27;è‡ªå¢ä¸»é”®&#x27;&quot;) private Long id; @Column(name = &quot;subject&quot;, columnDefinition = &quot;VARCHAR(50) NOT NULL COMMENT &#x27;å­¦ç§‘&#x27;&quot;) private String subject; @Column(name = &quot;score&quot;, columnDefinition = &quot;TINYINT UNSIGNED NOT NULL COMMENT &#x27;æˆç»©&#x27;&quot;) private String score; // çœç•¥ set get&#125; æ³¨ï¼šè¿™æ¬¡ä½¿ç”¨ä¸¤ä¸ªè¡¨ï¼Œä¸ºäº†åé¢è¿›è¡Œå¤æ‚æŸ¥è¯¢å‡†å¤‡ï¼Œè¿™é‡Œçš„å°†ä¸¤ä¸ªè¡¨çš„è‡ªå¢ id å…³è”åœ¨ä¸€èµ·ï¼Œå°±ä¸è€ƒè™‘å¤šå¯¹å¤šäº† repository StudentRepository 123@Repositorypublic interface StudentRepository extends JpaRepository&lt;Student, Long&gt;, JpaSpecificationExecutor&lt;Student&gt; &#123;&#125; GradeRepository 123@Repositorypublic interface GradeRepository extends JpaRepository&lt;Grade, Long&gt;, JpaSpecificationExecutor&lt;Grade&gt; &#123;&#125; åœ¨ä¸Šæ¬¡ aop é‚£é‡Œé¢å°±æè¿‡ï¼Œç”±äºç»§æ‰¿çš„æœ‰ CRUD çš„ repository å’Œä¸€äº›å…¶ä»–çš„ï¼Œè¿™ä¹Ÿæ˜¯ä¸Šé¢æåˆ°çš„è§£æ”¾ DAO å±‚çš„æ“ä½œï¼Œå…·ä½“çš„å¯ä»¥çœ‹ä¸‹å›¾ ä¸‰ã€CRUDcontroller GradeController 12345678910111213141516171819202122232425262728293031@RestController@RequestMapping(&quot;/grade&quot;)public class GradeController &#123; private GradeRepository gradeRepository; @Autowired public void setGradeRepository(GradeRepository gradeRepository) &#123; this.gradeRepository = gradeRepository; &#125; @PutMapping(&quot;/add&quot;) public Grade add(@RequestBody Grade grade) &#123; return gradeRepository.save(grade); &#125; @GetMapping(&quot;/query&quot;) public List&lt;Grade&gt; query() &#123; return gradeRepository.findAll(); &#125; @PostMapping(&quot;/update&quot;) public Grade update(@RequestBody Grade grade) &#123; return gradeRepository.save(grade); &#125; @DeleteMapping(&quot;/delete&quot;) public void delete(@RequestParam Long id) &#123; gradeRepository.deleteById(id); &#125;&#125; StudentController 1234567891011121314151617181920212223242526272829303132@RestController@RequestMapping(&quot;/student&quot;)public class StudentController &#123; private StudentRepository studentRepository; @Autowired public void setStudentRepository(StudentRepository studentRepository) &#123; this.studentRepository = studentRepository; &#125; @PutMapping(&quot;/add&quot;) public Student add(@RequestBody Student student) &#123; return studentRepository.save(student); &#125; @GetMapping(&quot;/query&quot;) public List&lt;Student&gt; query() &#123; return studentRepository.findAll(); &#125; @PostMapping(&quot;/update&quot;) public Student update(@RequestBody Student student) &#123; return studentRepository.save(student); &#125; @DeleteMapping(&quot;/delete&quot;) public void delete(@RequestParam Long id) &#123; studentRepository.deleteById(id); &#125;&#125; æ³¨ï¼š Spring å»ºè®®åœ¨è¿™é‡Œçš„æ³¨å…¥æ–¹å¼æ˜¯ set æˆ–è€… æ„é€ æ³¨å…¥ï¼Œä¸è¦ç›´æ¥æ³¨è§£æ³¨å…¥ ä¸ºäº†æ–¹ä¾¿ï¼Œåœ¨è¿™é‡Œè¿˜æ˜¯çœç•¥äº† Service å±‚çš„æ“ä½œ Postmanæµ‹è¯• å¢ æŸ¥ æ”¹ åˆ ","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"},{"name":"MySQL","slug":"MySQL","permalink":"http://wangba.me/tags/MySQL/"}]},{"title":"SpringBootæ•´åˆMyBatis","slug":"SpringBootæ•´åˆMyBatis","date":"2020-09-09T07:52:44.000Z","updated":"2020-09-30T07:08:29.310Z","comments":true,"path":"2020/09/09/SpringBootæ•´åˆMyBatis/","link":"","permalink":"http://wangba.me/2020/09/09/SpringBoot%E6%95%B4%E5%90%88MyBatis/","excerpt":"","text":"ä¸€ã€OverViewâ€‹ åœ¨ä¸Šç¯‡æ–‡ç« ä¸­å·²ç»ç®€å•çš„å†™è¿‡ SpringBoot æ•´åˆ JDBCTemplate äº†ï¼Œä½†æ˜¯ç°åœ¨çš„å…¬å¸åº”è¯¥å¾ˆå°‘æœ‰ç”¨ JDBCTemplateï¼Œå›½å†…ä¸€èˆ¬éƒ½æ˜¯ MyBatis æˆ–è€…æ˜¯ Spring Data JPAï¼Œåœ¨æœ¬ç¯‡æ–‡ç« ä¸­å°±æ¥æ•´åˆä¸€ä¸‹ MyBatisã€‚ äºŒã€ç¯å¢ƒæ­å»ºæ–°å»º SpringBoot é¡¹ç›®ï¼Œé€‰ä¸Š Webã€MySQLï¼Œåœ¨ pom.xml ä¸­é…ç½®ä¸€ä¸‹æ•°æ®åº“è¿æ¥æ± ï¼š pom.xml: 12345678910111213141516171819&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;2.1.3&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;1.1.23&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt;&lt;/dependency&gt; application.properties: 1234spring.datasource.type=com.alibaba.druid.pool.DruidDataSourcespring.datasource.url=jdbc:mysql://127.0.0.1:3306/testspring.datasource.username=rootspring.datasource.password= ä¸‰ã€CRUDUserMapper: 1234567891011121314151617181920212223242526272829@Component@Transactionalpublic interface UserMapper &#123; // å¢ @Insert(&quot;insert into mybatis(name, password) values(#&#123;name&#125;, #&#123;password&#125;)&quot;) @SelectKey(statement = &quot;select last_insert_id()&quot;, keyProperty = &quot;id&quot;, before = false, resultType = Long.class) Integer insert(User user); // æŸ¥ @Select(&quot;select * from mybatis&quot;) List&lt;User&gt; queryAllUser(); @Results(&#123; @Result(property = &quot;id&quot;, column = &quot;i&quot;), @Result(property = &quot;name&quot;, column = &quot;n&quot;), @Result(property = &quot;password&quot;, column = &quot;p&quot;) &#125;) @Select(&quot;select id as i, name as n, password as p from mybatis where id = #&#123;id&#125;&quot;) User queryById(Long id); // æ”¹ @Update(&quot;update mybatis set name = #&#123;name&#125;, password = #&#123;password&#125; where id = #&#123;id&#125;&quot;) Integer update(User user); // åˆ  @Delete(&quot;delete from mybatis where id = #&#123;id&#125;&quot;) Integer delete(Long id);&#125; æ³¨ï¼š å¦‚æœä¸ä½¿ç”¨æ³¨è§£çš„æ–¹å¼ï¼Œå°±è¦ä½¿ç”¨ xml çš„æ–¹å¼ï¼Œæ³¨æ„å…¶ä¸­çš„èµ„æºè§£æé—®é¢˜ï¼š 12345678910111213&lt;build&gt; &lt;resources&gt; &lt;resource&gt; &lt;directory&gt;src/main/java&lt;/directory&gt; &lt;includes&gt; &lt;include&gt;**/*.xml&lt;/include&gt; &lt;/includes&gt; &lt;/resource&gt; &lt;resource&gt; &lt;directory&gt;src/main/resources&lt;/directory&gt; &lt;/resource&gt; &lt;/resources&gt;&lt;/build&gt; å¢åŠ  statementæ˜¯è¦è¿è¡Œçš„SQLè¯­å¥ï¼Œå®ƒçš„è¿”å›å€¼é€šè¿‡resultTypeæ¥æŒ‡å®š beforeè¡¨ç¤ºæŸ¥è¯¢è¯­å¥statementè¿è¡Œçš„æ—¶æœº keyPropertyè¡¨ç¤ºæŸ¥è¯¢ç»“æœèµ‹å€¼ç»™ä»£ç ä¸­çš„å“ªä¸ªå¯¹è±¡ï¼ŒkeyColumnè¡¨ç¤ºå°†æŸ¥è¯¢ç»“æœèµ‹å€¼ç»™æ•°æ®åº“è¡¨ä¸­å“ªä¸€åˆ— keyPropertyå’ŒkeyColumnéƒ½ä¸æ˜¯å¿…éœ€çš„ï¼Œæœ‰æ²¡æœ‰éƒ½å¯ä»¥ before=trueï¼Œæ’å…¥ä¹‹å‰è¿›è¡ŒæŸ¥è¯¢ï¼Œå¯ä»¥å°†æŸ¥è¯¢ç»“æœèµ‹ç»™keyPropertyå’ŒkeyColumnï¼Œèµ‹ç»™keyColumnç›¸å½“äºæ›´æ”¹æ•°æ®åº“ befaore=falseï¼Œå…ˆæ’å…¥ï¼Œå†æŸ¥è¯¢ï¼Œè¿™æ—¶åªèƒ½å°†ç»“æœèµ‹ç»™keyProperty èµ‹å€¼ç»™keyPropertyç”¨æ¥â€œè¯»â€æ•°æ®åº“ï¼Œèµ‹å€¼ç»™keyColumnç”¨æ¥å†™æ•°æ®åº“ selectKeyçš„ä¸¤å¤§ä½œç”¨ï¼š1ã€ç”Ÿæˆä¸»é”®ï¼›2ã€è·å–åˆšåˆšæ’å…¥æ•°æ®çš„ä¸»é”®ã€‚ ä½¿ç”¨selectKeyï¼Œå¹¶ä¸”ä½¿ç”¨MySQLçš„last_insert_id()å‡½æ•°æ—¶ï¼Œbeforeå¿…ä¸ºfalseï¼Œä¹Ÿå°±æ˜¯è¯´å¿…é¡»å…ˆæ’å…¥ç„¶åæ‰§è¡Œlast_insert_id()æ‰èƒ½è·å¾—åˆšåˆšæ’å…¥æ•°æ®çš„IDã€‚ å‚è€ƒé“¾æ¥ï¼š@SelectKeyæ³¨è§£ æŸ¥ @Resultsæ³¨è§£ç±»ä¼¼äºXMLä¸­çš„ResultMapæ˜ å°„æ–‡ä»¶ UserController: ä¸ºäº†æ–¹ä¾¿å°±ä¸å†å†™ Service å±‚äº† 123456789101112131415161718192021222324252627282930313233343536@RestControllerpublic class UserController &#123; private UserMapper userMapper; @Autowired public void setUserMapper(UserMapper userMapper) &#123; this.userMapper = userMapper; &#125; @PutMapping(&quot;/insert&quot;) public Integer insert(@RequestBody User user) &#123; return userMapper.insert(user); &#125; @GetMapping(&quot;/query&quot;) public List&lt;User&gt; queryAllUser() &#123; return userMapper.queryAllUser(); &#125; @GetMapping(&quot;/query1&quot;) public User queryById(Long id) &#123; return userMapper.queryById(id); &#125; @PostMapping(&quot;/update&quot;) public Integer update(@RequestBody User user) &#123; return userMapper.update(user); &#125; @DeleteMapping(&quot;/delete&quot;) public Integer delete(Long id) &#123; return userMapper.delete(id); &#125;&#125; Postman æµ‹è¯•ï¼š å¢åŠ ï¼š æŸ¥è¯¢æ‰€æœ‰ï¼š é€šè¿‡ id æŸ¥è¯¢ï¼š æ›´æ–°ï¼š æŸ¥çœ‹ä¸€ä¸‹æ•°æ®åº“ï¼š åˆ é™¤ï¼š æŸ¥çœ‹ä¸€ä¸‹æ•°æ®åº“ï¼š ä½¿ç”¨æ³¨è§£è¿›è¡ŒåŠ¨æ€æŸ¥è¯¢å…·ä½“å¯ä»¥å‚è€ƒï¼šæ³¨è§£ç‰ˆåŠ¨æ€æŸ¥è¯¢ ä½¿ç”¨ xml æ–¹å¼è¿›è¡ŒåŠ¨æ€æŸ¥è¯¢å¯ä»¥å‚è€ƒï¼šxml ç‰ˆåŠ¨æ€æŸ¥è¯¢","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"},{"name":"SQL","slug":"SQL","permalink":"http://wangba.me/tags/SQL/"}]},{"title":"SpringBootæ•´åˆJDBCTemplate","slug":"SpringBootæ•´åˆJDBCTemplate","date":"2020-09-08T11:33:14.000Z","updated":"2020-09-30T07:08:27.205Z","comments":true,"path":"2020/09/08/SpringBootæ•´åˆJDBCTemplate/","link":"","permalink":"http://wangba.me/2020/09/08/SpringBoot%E6%95%B4%E5%90%88JDBCTemplate/","excerpt":"","text":"ä¸€ã€ç¯å¢ƒæ­å»º1. å¼•å…¥ä¾èµ–1234567891011121314151617181920212223242526272829303132333435363738// WEB&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt;// JDBC &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;&lt;/dependency&gt;// ä½¿ç”¨ Swagger è¿›è¡Œæ¥å£æµ‹è¯•&lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt; &lt;version&gt;2.9.2&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt; &lt;version&gt;2.9.2&lt;/version&gt;&lt;/dependency&gt;// mysql&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt;&lt;/dependency&gt;&lt;!-- https://mvnrepository.com/artifact/com.alibaba/druid --&gt;// druid&lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;1.1.23&lt;/version&gt;&lt;/dependency&gt; 2.æ•°æ®åº“è„šæœ¬1234567891011121314151617181920DROP TABLE IF EXISTS `sys_user`;CREATE TABLE `sys_user` ( `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT &#x27;ç¼–å·&#x27;, `name` varchar(50) NOT NULL COMMENT &#x27;ç”¨æˆ·å&#x27;, `nick_name` varchar(150) DEFAULT NULL COMMENT &#x27;æ˜µç§°&#x27;, `avatar` varchar(150) DEFAULT NULL COMMENT &#x27;å¤´åƒ&#x27;, `password` varchar(100) DEFAULT NULL COMMENT &#x27;å¯†ç &#x27;, `salt` varchar(40) DEFAULT NULL COMMENT &#x27;åŠ å¯†ç›&#x27;, `email` varchar(100) DEFAULT NULL COMMENT &#x27;é‚®ç®±&#x27;, `mobile` varchar(100) DEFAULT NULL COMMENT &#x27;æ‰‹æœºå·&#x27;, `status` tinyint(4) DEFAULT NULL COMMENT &#x27;çŠ¶æ€ 0ï¼šç¦ç”¨ 1ï¼šæ­£å¸¸&#x27;, `dept_id` bigint(20) DEFAULT NULL COMMENT &#x27;æœºæ„ID&#x27;, `create_by` varchar(50) DEFAULT NULL COMMENT &#x27;åˆ›å»ºäºº&#x27;, `create_time` datetime DEFAULT NULL COMMENT &#x27;åˆ›å»ºæ—¶é—´&#x27;, `last_update_by` varchar(50) DEFAULT NULL COMMENT &#x27;æ›´æ–°äºº&#x27;, `last_update_time` datetime DEFAULT NULL COMMENT &#x27;æ›´æ–°æ—¶é—´&#x27;, `del_flag` tinyint(4) DEFAULT &#x27;0&#x27; COMMENT &#x27;æ˜¯å¦åˆ é™¤ -1ï¼šå·²åˆ é™¤ 0ï¼šæ­£å¸¸&#x27;, PRIMARY KEY (`id`), UNIQUE KEY `name` (`name`)) ENGINE=InnoDB AUTO_INCREMENT=34 DEFAULT CHARSET=utf8 COMMENT=&#x27;ç”¨æˆ·ç®¡ç†&#x27;; application.properties: 1234spring.datasource.type=com.alibaba.druid.pool.DruidDataSourcespring.datasource.url=jdbc:mysql://127.0.0.1:3306/testspring.datasource.username=rootspring.datasource.password=****** äºŒã€CRUD1.ç¼–å†™å¯¹åº”çš„å®ä½“ç±»123456789101112131415161718192021222324252627282930313233public class SysUser &#123; private Long id; private String name; private String nickName; private String avatar; private String password; private String salt; private String email; private String mobile; private Byte status; private Long deptId; private String createBy; private Date createTime; private String lastUpdateBy; private Date lastUpdateTime; private Byte delFlag; // set å’Œ get çœç•¥&#125; 2.ç¼–å†™å¯¹åº”çš„ CRUD Repository1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162@Repositorypublic class SysUserRepository &#123; @Autowired private JdbcTemplate jdbcTemplate; public Integer insert(SysUser user) &#123; String sql = &quot;insert into sys_user(id, name, password) values(?,?,?)&quot;; return jdbcTemplate.update(sql, user.getId(), user.getName(), user.getPassword()); &#125; public Integer insert1(SysUser sysUser) &#123; String sql = &quot;insert into sys_user(id, name, password) values(:id, :name, :password)&quot;; NamedParameterJdbcTemplate namedParameterJdbcTemplate = new NamedParameterJdbcTemplate(this.jdbcTemplate.getDataSource()); return namedParameterJdbcTemplate.update(sql, new BeanPropertySqlParameterSource(sysUser)); &#125; // æ¨èä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œå¯ä»¥ä¸ç”¨ä¼ æ‰€æœ‰çš„å‚æ•° public Integer insert2(SysUser sysUser) &#123; String sql = &quot;insert into sys_user(id, name, password) values(:id, :name, :password)&quot;; Map&lt;String, Object&gt; map = new HashMap&lt;&gt;(16); map.put(&quot;id&quot;, sysUser.getId()); map.put(&quot;name&quot;, sysUser.getName()); map.put(&quot;password&quot;, sysUser.getPassword()); NamedParameterJdbcTemplate namedParameterJdbcTemplate = new NamedParameterJdbcTemplate(this.jdbcTemplate.getDataSource()); return namedParameterJdbcTemplate.update(sql, map); &#125; public Integer update(SysUser sysUser) &#123; String sql = &quot;update sys_user set name = ?, password = ? where id = ?&quot;; Object[] args = &#123;sysUser.getName(), sysUser.getPassword(), sysUser.getId()&#125;; int[] argTypes = &#123;Types.VARCHAR, Types.VARCHAR, Types.BIGINT&#125;; return this.jdbcTemplate.update(sql, args, argTypes); &#125; public List&lt;Map&lt;String, Object&gt;&gt; queryAllListMap() &#123; String sql = &quot;select * from sys_user&quot;; return this.jdbcTemplate.queryForList(sql); &#125; // è¿™é‡Œè¦å†™ä¸€ä¸ª SysUserMapper å®ç° RowMapper public SysUser queryById(Long id) &#123; String sql = &quot;select * from sys_user where id = ?&quot;; Object[] args = &#123;id&#125;; int[] argTypes = &#123;Types.BIGINT&#125;; List&lt;SysUser&gt; list = this.jdbcTemplate.query(sql, args, argTypes, new SysUserMapper()); if (StringUtils.isEmpty(list)) &#123; return list.get(0); &#125; else &#123; return null; &#125; &#125; public Integer deleteById(Long id) &#123; String sql = &quot;delete from sys_user where id = ?&quot;; Object[] args = &#123; id &#125;; int[] argTypes = &#123; Types.BIGINT &#125;; return this.jdbcTemplate.update(sql, args, argTypes); &#125;&#125; 3.å¯¹åº”çš„ Controller å±‚123456789101112131415161718192021222324252627282930313233343536373839404142434445@RestControllerpublic class SysUserController &#123; @Autowired private SysUserRepository sysUserRepository; @PutMapping(&quot;/insert&quot;) public Integer insert(@RequestBody SysUser sysUser) &#123; int i = sysUserRepository.insert(sysUser); return i; &#125; @PutMapping(&quot;/insert1&quot;) public Integer insert1(@RequestBody SysUser sysUser) &#123; int i = sysUserRepository.insert1(sysUser); return i; &#125; @PutMapping(&quot;/insert2&quot;) public Integer insert2(@RequestBody SysUser sysUser) &#123; int i = sysUserRepository.insert2(sysUser); return i; &#125; @PostMapping(&quot;/update&quot;) public Integer update(@RequestBody SysUser sysUser) &#123; int i = sysUserRepository.update(sysUser); return i; &#125; @GetMapping(&quot;/list&quot;) public List&lt;Map&lt;String, Object&gt;&gt; queryAllListMap() &#123; return sysUserRepository.queryAllListMap(); &#125; @GetMapping(&quot;/id1&quot;) public SysUser queryById(Long id) &#123; return sysUserRepository.queryById(id); &#125; @DeleteMapping(&quot;/id3&quot;) public Integer deleteById(Long id) &#123; return sysUserRepository.deleteById(id); &#125;&#125; æ³¨ï¼šä¸ºäº†å›¾æ–¹ä¾¿ï¼Œå°±ä¸å†æ­¤å†™ Service å±‚äº† 4.ä½¿ç”¨ Swagger è¿›è¡Œæµ‹è¯•å¢åŠ  ç¬¬ä¸€ç§æ–¹å¼ï¼š ç¬¬äºŒç§æ–¹å¼ï¼š ç¬¬ä¸‰ç§æ–¹å¼ï¼š çœ‹ä¸€ä¸‹æ•°æ®åº“æ˜¯å¦æœ‰ä¸‰æ¡æ•°æ®ï¼š ä¿®æ”¹ æŸ¥æ‰¾ æŸ¥æ‰¾æ‰€æœ‰ï¼š åˆ é™¤","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"},{"name":"SQL","slug":"SQL","permalink":"http://wangba.me/tags/SQL/"}]},{"title":"0076.Minimum Window Substring","slug":"0076-Minimum-Window-Substring","date":"2020-09-04T13:56:11.000Z","updated":"2020-09-30T07:09:40.885Z","comments":true,"path":"2020/09/04/0076-Minimum-Window-Substring/","link":"","permalink":"http://wangba.me/2020/09/04/0076-Minimum-Window-Substring/","excerpt":"","text":"76. æœ€å°è¦†ç›–å­ä¸² Hardç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² Sã€ä¸€ä¸ªå­—ç¬¦ä¸² T ã€‚è¯·ä½ è®¾è®¡ä¸€ç§ç®—æ³•ï¼Œå¯ä»¥åœ¨ O(n) çš„æ—¶é—´å¤æ‚åº¦å†…ï¼Œä»å­—ç¬¦ä¸² S é‡Œé¢æ‰¾å‡ºï¼šåŒ…å« T æ‰€æœ‰å­—ç¬¦çš„æœ€å°å­ä¸²ã€‚ ç¤ºä¾‹ï¼š 12è¾“å…¥ï¼šS &#x3D; &quot;ADOBECODEBANC&quot;, T &#x3D; &quot;ABC&quot;è¾“å‡ºï¼š&quot;BANC&quot; æç¤ºï¼š å¦‚æœ S ä¸­ä¸å­˜è¿™æ ·çš„å­ä¸²ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸² &quot;&quot;ã€‚ å¦‚æœ S ä¸­å­˜åœ¨è¿™æ ·çš„å­ä¸²ï¼Œæˆ‘ä»¬ä¿è¯å®ƒæ˜¯å”¯ä¸€çš„ç­”æ¡ˆã€‚ è§£é¢˜æ€è·¯â€‹ è¿™é¢˜åœ¨ 0003 é¢˜ä¸­å°±å·²ç»æè¿‡äº†çš„æš—å·ï¼Œå°±æ˜¯æ´’æ´’æ°´çš„ä½¿ç”¨ä¸€ä¸‹ Sliding Window å°±å¯ä»¥äº†ï¼Œæ€è·¯è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼šå…ˆä¸æ–­çš„æ‰©å¼ çª—å£å³è¾¹ï¼Œç›´åˆ°å°†æ‰€æœ‰çš„è¦åŒ…å«çš„çŸ­å­—ç¬¦ä¸²ï¼›ç„¶åå¼€å§‹å°±ç§»åŠ¨çª—å£çš„å·¦è¾¹ï¼Œç›´åˆ°å·¦è¾¹å‹ç¼©åˆ°ä¸èƒ½å†å®¹çº³è¿™ä¸ªçŸ­å­—ç¬¦ä¸²äº†ï¼Œå†è¿›è¡Œä¸æ–­æ¯”è¾ƒï¼Œå°±å¯ä»¥å¾—åˆ°æœ€ç»ˆç»“æœäº†ã€‚â€‹ è¿™ç§æ—¶å€™å°±éœ€è¦å‡ºç° ä½†æ˜¯ è¿™ä¸ªè¯è¯­ï¼Œæœç„¶åœ¨å®ç°çš„æ—¶å€™å°±éœ€è¦æ³¨æ„å¾ˆå¤šé—®é¢˜äº†ï¼Œå¯¹äºè¿™ç§æŠ½è±¡é—®é¢˜ï¼Œå…ˆæ¥ä¸ªğŸŒ°ï¼šç»™çš„ä¾‹å­å®åœ¨æ˜¯å¤ªæ™®é€šäº†ï¼Œåº”è¯¥ç”¨é‚£ç§å¸¦ç‚¹ç‰¹æ®Šæ€§çš„ä¾‹å­ S = â€œABANCDBâ€ T = â€œABCâ€ å¯¹ç€ä»£ç æ‹ä¸€éåº”è¯¥å°±æ‡‚äº†ï¼šç¬¬ä¸€éè¿‡åå¯ä»¥çœ‹è§ï¼šâ€ABANCâ€ æ˜¯ä¸€ä¸ªæ»‘åŠ¨çª—å£ï¼Œmap çš„å€¼ä¹Ÿå˜ä¸ºäº†ï¼š A B C åˆå§‹å€¼ 1 1 1 éå†åˆ° A 0 1 1 éå†åˆ° B 0 0 1 éå†åˆ° A -1 0 1 éå†åˆ° N -1 0 1 éå†åˆ° C -1 0 0 æ­¤æ—¶çš„ count == t çš„é•¿åº¦äº†ï¼Œè¿™æ ·æ‰©å¼ çª—å£å°±å®Œæˆäº† ======&gt; min = 5 æ¥ä¸‹æ¥å°±æ˜¯æ”¶ç¼©çª—å£ï¼Œå…¶æ ¹æœ¬åŸå› å°±æ˜¯è¿™æ ·å·¦è¾¹å‡ºç°é‡å¤å…ƒç´ ï¼Œå¯ä»¥å»æ‰å½¢æˆæœ€å°çš„çª—å£ï¼š å¦‚æœåœ¨ map ä¸­çš„å€¼æ˜¯ç­‰äº 0 çš„ï¼Œè¯´æ˜å®ƒæ˜¯åˆšåˆšå¥½çš„ï¼Œå¦‚æœæŠŠè¿™ä¸ªæ’é™¤çš„è¯ï¼Œè¿™ä¸ªçª—å£å°±ä¸å†æˆç«‹äº†ï¼Œè¦ç»§ç»­æ‰©å¼  çª—å£äº†ï¼›å¦‚æœ map ä¸­çš„å€¼ å°äº 0 çš„ï¼Œè¯´æ˜å®ƒæ˜¯å¤šä½™çš„ï¼Œä½†æ˜¯è¦çœ‹å®ƒçš„ä½ç½®äº†ï¼Œå¯ä»¥çœ‹ä¸‹ğŸŒ°ï¼š â€œABANCâ€ è¿™ä¸ª A å°±å¯ä»¥å»æ‰ï¼›â€BAANCâ€ è¿™ä¸ª A å°±ä¸å¯ä»¥å»æ‰ï¼Œæ­¤æ—¶å°±è¦æ‰©å¼ çª—å£äº† åå¤æ¨ªè·³ ï¼Œå®Œæˆâœ… ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748class Solution &#123; public String minWindow(String s, String t) &#123; Map&lt;Character, Integer&gt; map = new HashMap&lt;&gt;(); // ä½¿ç”¨ hashmap å°† t ä¸­çš„å­—ç¬¦å­˜å…¥ for(int i = 0; i &lt; t.length(); i++) &#123; char c = t.charAt(i); if (map.containsKey(c)) &#123; int tmp = map.get(c); map.put(c, tmp + 1); &#125; else &#123; map.put(c, 1); &#125; &#125; // ç”¨æ¥åˆ¤æ–­è¿™ä¸ªçª—å£æ˜¯å¦åŒ…å«äº† t int count = 0; // ä¸€ä¸ªçª—å£çš„å·¦å³ int left = 0, right = 0; int min = Integer.MAX_VALUE; // é•¿åº¦æœ€å°çš„çª—å£çš„å·¦å³ int minLeft = 0, minRight = 0; for (; right &lt; s.length(); right++) &#123; char temp = s.charAt(right); if (map.containsKey(temp)) &#123; count = map.get(temp) &gt; 0 ? count + 1 : count; map.put(temp, map.get(temp) - 1); &#125; while (count == t.length()) &#123; if ((right - left) &lt; min) &#123; min = right - left; minLeft = left; minRight = right; &#125; char c = s.charAt(left); // å·¦è¾¹çš„é‡å¤å­—ç¬¦å¯ä»¥ä¸ç”¨ if (map.containsKey(c)) &#123; if (map.get(c) &gt;= 0) count--; map.put(c, map.get(c) + 1); &#125; left++; &#125; &#125; return min == Integer.MAX_VALUE ? &quot;&quot; : s.substring(minLeft, minRight + 1); &#125;&#125;","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"String","slug":"String","permalink":"http://wangba.me/tags/String/"},{"name":"Sliding Window","slug":"Sliding-Window","permalink":"http://wangba.me/tags/Sliding-Window/"}]},{"title":"SpringBootæ•´åˆAOP","slug":"SpringBootæ•´åˆAOP","date":"2020-09-03T13:52:37.000Z","updated":"2020-09-30T07:08:24.891Z","comments":true,"path":"2020/09/03/SpringBootæ•´åˆAOP/","link":"","permalink":"http://wangba.me/2020/09/03/SpringBoot%E6%95%B4%E5%90%88AOP/","excerpt":"","text":"ä¸€ã€èƒŒæ™¯â€‹ åœ¨å…¬å¸å†™ä¸šåŠ¡çš„æ—¶å€™ï¼Œéƒ½ä¼šæœ‰ä¿å­˜æ—¥å¿—çš„æ“ä½œï¼Œæ–¹ä¾¿å‡ºé”™çš„æ—¶å€™è¿›è¡Œæ’æŸ¥ï¼›ä¸€èˆ¬ä¸ä»…ä»…åœ¨æ•°æ®åº“ä¸­ä¿å­˜æ—¥å¿—ï¼Œ ä¹Ÿä¼šåœ¨åç«¯æ§åˆ¶å°æ‰“å°ä¸€äº›éœ€è¦çš„ä¿¡æ¯ã€‚åœ¨è¿™é‡Œï¼Œä¸€èˆ¬ä½¿ç”¨ AOP ç»‡å…¥çš„æ–¹å¼å°†æ—¥å¿—ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œä½¿ç”¨ä¸€äº›æ—¥ å¿—åŒ…å°†æŸäº› Controller å±‚çš„ä¿¡æ¯æ‰“å°åœ¨æ§åˆ¶å°ã€‚ äºŒã€å‡†å¤‡Entiy:1234567891011121314151617181920@Entity@Table(name = &quot;log&quot;)@EntityListeners(AuditingEntityListener.class)public class Log implements Serializable &#123; @Id @GeneratedValue(strategy = GenerationType.IDENTITY ) @Column(name = &quot;id&quot;) private Long id; @Column(name = &quot;title&quot;, columnDefinition = &quot;VARCHAR(100) COMMENT &#x27;æ ‡é¢˜&#x27;&quot;) private String title; @Column(name = &quot;author&quot;, columnDefinition = &quot;VARCHAR(255) COMMENT &#x27;ä½œè€…&#x27;&quot;) private String author; @Column(name = &quot;content&quot;, columnDefinition = &quot;TEXT COMMENT &#x27;å†…å®¹&#x27;&quot;) private String content; // get å’Œ set çœç•¥ æ³¨: è¿™é‡Œæ˜¯ä½¿ç”¨ Spring Data JPA è‡ªåŠ¨ç”Ÿæˆçš„æ•°æ®åº“å¯¹åº”å®ä½“ï¼Œå¯¼å…¥ç›¸å…³ä¾èµ–åï¼Œå¯ä»¥å…ˆè¿è¡Œä¸€éï¼Œçœ‹æ•°æ®åº“ æ˜¯å¦ç”Ÿæˆå¯¹åº”å®ä½“ï¼›ç„¶åè‡ªè¡Œåœ¨æ•°æ®åº“ä¸­æ’å…¥å‡ æ¡æ•°æ®ã€‚ Repository:123public interface LogRepository extends JpaRepository&lt;Log, Long&gt; &#123;&#125; æ³¨: è¿™é‡Œåªè¦ç»§æ‰¿ JpaRepository ï¼Œè¿™ä¸ª repository ä¹Ÿç»§æ‰¿äº†åˆ«çš„ repositoryï¼ˆé‡Œé¢æœ‰ä¸€äº›å¸¸è§çš„æ–¹æ³•å¯ä»¥ è°ƒç”¨ï¼‰ Service:1234567891011@Servicepublic class LogService &#123; @Autowired LogRepository logRepository; public List&lt;Log&gt; getAllLog() &#123; List&lt;Log&gt; logs = logRepository.findAll(); return logs; &#125;&#125; æ³¨: è¿™é‡Œå°±ä¸å†™æ¥å£ï¼Œå†å»å®ç°äº† Controller:123456789101112@RestControllerpublic class LogController &#123; @Autowired LogService logService; @GetMapping(&quot;/list&quot;) public List&lt;Log&gt; getAll() &#123; List&lt;Log&gt; logs = logService.getAllLog(); return logs; &#125;&#125; å†ä½¿ç”¨ Postman ç­‰å·¥å…·è¿›è¡Œä¸€æ¬¡æµ‹è¯•å°±è¡Œ ä¸‰ã€ä½¿ç”¨æ³¨è§£çš„æ–¹å¼è¿›è¡Œ AOPé¦–å…ˆå®šä¹‰ä¸€ä¸ªæ–¹æ³•çº§åˆ«çš„ @Log æ³¨è§£ï¼Œç”¨äºæ ‡æ³¨éœ€è¦ç›‘æ§çš„æ–¹æ³•ï¼š 1234567@Target(ElementType.METHOD)@Retention(RetentionPolicy.RUNTIME)public @interface Log &#123; String value() default &quot;&quot;; &#125; å®šä¹‰ä¸€ä¸ªLogAspectç±»ï¼Œä½¿ç”¨ @Aspect æ ‡æ³¨è®©å…¶æˆä¸ºä¸€ä¸ªåˆ‡é¢ï¼Œåˆ‡ç‚¹ä¸ºä½¿ç”¨ @Log æ³¨è§£æ ‡æ³¨çš„æ–¹æ³•ï¼š 1234567891011121314151617181920@Aspect@Componentpublic class LogAspec &#123; private final static Logger logger = LoggerFactory.getLogger(LogAspec.class); @Pointcut(&quot;@annotation(org.wangba.springboot013aop.antoation.Log)&quot;) public void pointcut() &#123; &#125; @Before(&quot;pointcut()&quot;) public void doBefore(JoinPoint joinPoint) throws Throwable &#123; logger.info(&quot;Start Time: &#123;&#125;&quot;, System.currentTimeMillis()); &#125; @After(&quot;pointcut()&quot;) public void doAfter() throws Throwable &#123; logger.info(&quot;End Time: &#123;&#125;&quot;, System.currentTimeMillis()); &#125;&#125; å†åœ¨ Controller å±‚çš„æ–¹æ³•ä¸ŠåŠ ä¸Š @Log æ³¨è§£ï¼š 12345678910111213@RestControllerpublic class LogController &#123; @Autowired LogService logService; @Log(&quot;è·å¾—æ‰€æœ‰æ–‡ç« &quot;) @GetMapping(&quot;/list&quot;) public List&lt;Article&gt; getAll() &#123; List&lt;Article&gt; articles = logService.getAllLog(); return articles; &#125;&#125; æ­¤æ—¶å†åœ¨ Postman ä¸­æµ‹è¯•ä¸€æ¬¡ï¼Œä½ å°±å¯ä»¥çœ‹åˆ°æ§åˆ¶å°ä¼šæ‰“å°å¦‚ä¸‹ç»“æœï¼š åœ¨å…¬å¸ä¸šåŠ¡ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½æ˜¯åœ¨ @Before è¿›è¡Œä¸€äº›è¯·æ±‚ä¿¡æ¯ç­‰ï¼Œ @After åœ¨æ§åˆ¶å°æ‰“å°ä¸€äº›ä¿¡æ¯ï¼Œå¹¶å°†ç»“ æœç›´æ¥å­˜åˆ°æ•°æ®åº“ä¸­çš„æ—¥å¿—è¡¨ä¸­ã€‚","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"}]},{"title":"SpringBootä¸­ç±»å‹è½¬æ¢","slug":"SpringBootä¸­ç±»å‹è½¬æ¢","date":"2020-09-02T12:55:09.000Z","updated":"2020-09-30T07:08:22.269Z","comments":true,"path":"2020/09/02/SpringBootä¸­ç±»å‹è½¬æ¢/","link":"","permalink":"http://wangba.me/2020/09/02/SpringBoot%E4%B8%AD%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/","excerpt":"","text":"ä¸€ã€é—®é¢˜å¦‚æœå‰ç«¯ä¼ æ¥ä¸€ä¸ªæ—¥æœŸå‚æ•°ï¼Œæ˜¯ç”¨ String ç±»å‹çš„ï¼Œæˆ‘ä»¬å¦‚ä½•åœ¨åç«¯è¿›è¡Œä¼ å‚å‘¢ï¼Ÿ ä¹Ÿå³å¦‚ä¸‹è¿™ç§æƒ…å†µï¼š 12345678@RestControllerpublic class HelloController &#123; @GetMapping(&quot;/hello&quot;) public void hello(Date date) &#123; System.out.println(date); &#125;&#125; æµè§ˆå™¨è¾“å…¥ï¼šhttp://localhost:8080/hello?date=2020-01-01 å¯ä»¥åœ¨åå°çœ‹åˆ° WARN ï¼š Failed to convert value of type â€˜java.lang.Stringâ€™ to required type â€˜java.util.Dateâ€™ äºŒã€è§£å†³1234567891011121314151617@Componentpublic class StringTransDate implements Converter&lt;String, Date&gt; &#123; private SimpleDateFormat simpleDateFormat = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;); @Override public Date convert(String s) &#123; if (s != null &amp;&amp; !&quot;&quot;.equals(s)) &#123; try &#123; return simpleDateFormat.parse(s); &#125; catch (ParseException e) &#123; e.printStackTrace(); &#125; &#125; return null; &#125;&#125; æ³¨ï¼šè¦å°†è¯¥ç±»ä½¿ç”¨ @Component æ³¨å…¥","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"}]},{"title":"0003.Longest Substring Without Repeating Characters","slug":"0003-Longest-Substring-Without-Repeating-Characters","date":"2020-09-01T13:26:29.000Z","updated":"2020-09-30T07:09:37.081Z","comments":true,"path":"2020/09/01/0003-Longest-Substring-Without-Repeating-Characters/","link":"","permalink":"http://wangba.me/2020/09/01/0003-Longest-Substring-Without-Repeating-Characters/","excerpt":"","text":"0003. æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸² Mediumç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­ä¸å«æœ‰é‡å¤å­—ç¬¦çš„ æœ€é•¿å­ä¸² çš„é•¿åº¦ã€‚ ç¤ºä¾‹ 1: 123è¾“å…¥: &quot;abcabcbb&quot;è¾“å‡º: 3 è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ &quot;abc&quot;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚ ç¤ºä¾‹ 2: 123è¾“å…¥: &quot;bbbbb&quot;è¾“å‡º: 1è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ &quot;b&quot;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 1ã€‚ ç¤ºä¾‹ 3: 12345è¾“å…¥: &quot;pwwkew&quot;è¾“å‡º: 3è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ &quot;wke&quot;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚è¯·æ³¨æ„ï¼Œä½ çš„ç­”æ¡ˆå¿…é¡»æ˜¯ å­ä¸² çš„é•¿åº¦ï¼Œ&quot;pwke&quot; æ˜¯ä¸€ä¸ªå­åºåˆ—ï¼Œä¸æ˜¯å­ä¸²ã€‚ è§£é¢˜æ€è·¯ ğŸ·ï¼šç¬¬ä¸€ä¸ªæƒ³æ³•å°±æ˜¯è¿™ä¸ªæ˜¯ä¸æ˜¯å’Œ KMP ç®—æ³•æœ‰é‚£ä¹ˆä¸€ç‚¹ç‚¹åƒçš„ åŠ›æ‰£ï¼šè®©ä½ è§è¯†ä¸€ä¸‹ï¼Œå€¼å¾—æˆ‘ä»¬å®˜ç½‘æœ‰ä¸€ä¸ªæ ‡ç­¾çš„æ€æƒ³ â€”â€”â€”&gt; Sliding Window ğŸ·ï¼šè¯´äººè¯ åŠ›æ‰£ï¼šå°±æ˜¯ æ»‘åŠ¨çª—å£ å¤§æ³•ï¼Œä½ åé¢ä¼šçœ‹åˆ°å¾ˆå¤šæ¬¡è¿™ç§æ€æƒ³ï¼Œæƒ³ç»§ç»­çœ‹è¿™æ ·çš„é¢˜ï¼Œç‚¹è¿™é‡Œï¼Œè¿˜æœ‰ä¸€äº›æš—å·ï¼š76ã€ 438ã€567 æ»‘åŠ¨çª—å£æ€æƒ³ï¼š æ»‘åŠ¨çª—å£çš„å³è¾¹ç•Œä¸æ–­çš„å³ç§»ï¼Œåªè¦æ²¡æœ‰é‡å¤çš„å­—ç¬¦ï¼Œå°±æŒç»­å‘å³æ‰©å¤§çª—å£è¾¹ç•Œã€‚ä¸€æ—¦å‡ºç°äº†é‡å¤å­—ç¬¦ï¼Œå°±éœ€è¦ç¼©å°å·¦è¾¹ç•Œï¼Œç›´åˆ°é‡å¤çš„å­—ç¬¦ç§»å‡ºäº†å·¦è¾¹ç•Œï¼Œç„¶åç»§ç»­ç§»åŠ¨æ»‘åŠ¨çª—å£çš„å³è¾¹ç•Œã€‚ä»¥æ­¤ç±»æ¨ï¼Œæ¯æ¬¡ç§»åŠ¨éœ€è¦è®¡ç®—å½“å‰é•¿åº¦ï¼Œå¹¶åˆ¤æ–­æ˜¯å¦éœ€è¦æ›´æ–°æœ€å¤§é•¿åº¦ï¼Œæœ€ç»ˆæœ€å¤§çš„å€¼å°±æ˜¯é¢˜ç›®ä¸­çš„æ‰€æ±‚ã€‚ ğŸ·ï¼šåº”è¯¥å°±æ˜¯åŒæŒ‡é’ˆçš„å˜å½¢ç‰ˆäº†â€¦â€¦.. ä»£ç 12345678910111213class Solution &#123; public int lengthOfLongestSubstring(String s) &#123; Map&lt;Character, Integer&gt; map = new HashMap&lt;&gt;(); int max = 0; for (int i = 0, j = 0; i &lt; s.length(); i++) &#123; if (map.containsKey(s.charAt(i))) j = Math.max(j, map.get(s.charAt(i)) + 1); map.put(s.charAt(i), i); max = Math.max(max, i - j + 1); &#125; return max; &#125;&#125;","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"String","slug":"String","permalink":"http://wangba.me/tags/String/"},{"name":"Sliding Window","slug":"Sliding-Window","permalink":"http://wangba.me/tags/Sliding-Window/"},{"name":"Two pointer","slug":"Two-pointer","permalink":"http://wangba.me/tags/Two-pointer/"}]},{"title":"SpringBootä¸­çš„è·¯å¾„æ˜ å°„","slug":"SpringBootä¸­çš„è·¯å¾„æ˜ å°„","date":"2020-09-01T13:25:29.000Z","updated":"2020-09-30T07:08:15.292Z","comments":true,"path":"2020/09/01/SpringBootä¸­çš„è·¯å¾„æ˜ å°„/","link":"","permalink":"http://wangba.me/2020/09/01/SpringBoot%E4%B8%AD%E7%9A%84%E8%B7%AF%E5%BE%84%E6%98%A0%E5%B0%84/","excerpt":"","text":"ä¸€ã€åœ¨ SpringBootä¸­ä½¿ç”¨ SSM æ¡†æ¶ä¸­çš„æ˜ å°„å†™ä¸‹å¦‚ä¸‹çš„ Controllerï¼š 123456789@Controllerpublic class HelloController &#123; @RequestMapping(&quot;/hello&quot;) public String hello() &#123; return &quot;hello&quot;; &#125;&#125; å¹¶åœ¨ resources/templates ä¸­æ–°å»º hello.html 12345678910&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;Title&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Hello, Spring Boot&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt; æ³¨ï¼šåœ¨ SpringBoot ä¸­ï¼Œé»˜è®¤çš„é™æ€èµ„æºæ˜¯æ”¾åœ¨ä»¥ä¸‹å‡ ä¸ªä½ç½®ï¼š classpath:/META-INF/resources/ classpath:/resources/ classpath:/static/ classpath:/public/ / å…¶ä¸­ç¬¬ 5 ä¸ªè¡¨ç¤º webapp ç›®å½•ä¸­çš„é™æ€èµ„æºä¹Ÿä¸è¢«æ‹¦æˆª æ‰€ä»¥åœ¨è¿™é‡Œè¿™ä¸æ˜¯ä¸€ä¸ªé™æ€èµ„æºï¼Œæˆ‘ä»¬ä»¥å‰çš„åšæ³•å°±æ˜¯ç›´æ¥è¿”å›è¿™ä¸ªé¡µé¢ï¼Œæ²¡å†™ä¸Šé¢çš„ Controller ç›´æ¥ä½¿ç”¨ http://localhost:8080/hello æ˜¯è®¿é—®ä¸åˆ°è¯¥é¡µé¢çš„ äºŒã€åœ¨ SpringBoot ä¸­è¿›è¡Œè·¯å¾„æ˜ å°„åªéœ€è¦è¿›è¡Œå¦‚ä¸‹é…ç½®å°±å¯ä»¥è¿›è¡Œè·¯å¾„æ˜ å°„ 12345678@Configurationpublic class WebMvcConfig implements WebMvcConfigurer &#123; @Override public void addViewControllers(ViewControllerRegistry registry) &#123; registry.addViewController(&quot;wangba&quot;).setViewName(&quot;hello&quot;); &#125;&#125; å†æ¬¡è®¿é—®ï¼šhttp://localhost:8080/wangba ç»“æœï¼š","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"}]},{"title":"0001.Two Sum","slug":"0001-Two-Sum","date":"2020-08-31T13:26:10.000Z","updated":"2020-09-30T07:08:03.901Z","comments":true,"path":"2020/08/31/0001-Two-Sum/","link":"","permalink":"http://wangba.me/2020/08/31/0001-Two-Sum/","excerpt":"","text":"0001. ä¸¤æ•°ä¹‹å’Œ Easyç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªç›®æ ‡å€¼ targetï¼Œè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡ºå’Œä¸ºç›®æ ‡å€¼çš„é‚£ ä¸¤ä¸ª æ•´æ•°ï¼Œå¹¶è¿”å›ä»–ä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚ ä½ å¯ä»¥å‡è®¾æ¯ç§è¾“å…¥åªä¼šå¯¹åº”ä¸€ä¸ªç­”æ¡ˆã€‚ä½†æ˜¯ï¼Œæ•°ç»„ä¸­åŒä¸€ä¸ªå…ƒç´ ä¸èƒ½ä½¿ç”¨ä¸¤éã€‚ ç¤ºä¾‹: 1234ç»™å®š nums &#x3D; [2, 7, 11, 15], target &#x3D; 9å› ä¸º nums[0] + nums[1] &#x3D; 2 + 7 &#x3D; 9æ‰€ä»¥è¿”å› [0, 1] è§£é¢˜æ€è·¯ å‚»ç“œå¼æƒ³æ³•ï¼šéå†ä¸¤æ¬¡ï¼Œæ±‚å’Œï¼ˆå»é™¤é‡å¤çš„å…ƒç´ ï¼Œä½ç½®ä¸åŒçš„ç›¸ç­‰å…ƒç´ å¯ä»¥è¿›è¡Œè®¡ç®—ï¼‰ åŠ›æ‰£å†…å¿ƒOSï¼šä½ è¿™æ ·çš„æ—¶é—´å¤æ‚åº¦èƒ½è¿‡ç®—æˆ‘è¾“ï¼ï¼ï¼ ğŸ˜¯ï¼šå°±è¿™ï¼Œç•¥æ–½å°è®¡ï¼šç©ºé—´æ¢æ—¶é—´ä¹‹æœ¯ é¦–å…ˆï¼Œéå†ä¸€éæ•°ç»„å°†æ•°ç»„çš„å€¼æ”¾å…¥ Map ä¸­ï¼Œç„¶åå†éå†ä¸€æ¬¡ï¼Œå°† target - å–åˆ°çš„å€¼ï¼Œä½†æ˜¯è¦æ³¨æ„ä¸èƒ½ä»…ä»…åˆ¤æ–­æ˜¯ å¦å­˜åœ¨è¿™ä¸ªå€¼ï¼Œå› ä¸ºå¯èƒ½ä¼šå‡ºç°ä¸‹é¢è¿™ç§æƒ…å†µï¼štarget = 4ï¼Œè¯¥æ•°ç»„ä¸­å°±åªæœ‰ä¸€ä¸ª 2ï¼Œè¿™æ ·å°±ä¼šå‡ºé”™ã€‚æ‰€ä»¥è¿˜è¦åˆ¤æ–­ å–åˆ°çš„å€¼è¿˜ä¸èƒ½æ˜¯ç¬¬ä¸€æ¬¡çš„å…ƒç´ ã€‚ ä»£ç ï¼š123456789101112131415161718class Solution &#123; public int[] twoSum(int[] nums, int target) &#123; int[] res = new int[2]; HashMap&lt;Integer, Integer&gt; hashMap = new HashMap&lt;&gt;(); for (int i = 0; i &lt; nums.length; i++) &#123; hashMap.put(nums[i], i); &#125; for (int i = 0; i &lt; nums.length; i++) &#123; int temp = target - nums[i]; if (hashMap.containsKey(temp) &amp;&amp; hashMap.get(temp) != i) &#123; res[0] = hashMap.get(temp); res[1] = i; break; &#125; &#125; return res; &#125;&#125;","categories":[{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"Array","slug":"Array","permalink":"http://wangba.me/tags/Array/"}]},{"title":"SpringBootä¸­çš„Servletã€Filterã€Listener","slug":"SpringBootä¸­çš„Servletã€Filterã€Listener","date":"2020-08-31T12:08:27.000Z","updated":"2020-09-30T07:07:21.821Z","comments":true,"path":"2020/08/31/SpringBootä¸­çš„Servletã€Filterã€Listener/","link":"","permalink":"http://wangba.me/2020/08/31/SpringBoot%E4%B8%AD%E7%9A%84Servlet%E3%80%81Filter%E3%80%81Listener/","excerpt":"","text":"ä¸€ã€Servlet12345678@WebServlet(urlPatterns = &quot;/MyServlet&quot;)public class MyServlet extends HttpServlet &#123; @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123; System.out.println(&quot;MyServlet&quot;); &#125;&#125; @WebServlet(urlPatterns = â€œ/MyServletâ€)ï¼šæŒ‡å®šServletæŒ‡å®šçš„ URL äºŒã€Filter12345678910111213141516171819@WebFilter(&quot;/*&quot;)public class MyFilter implements Filter &#123; @Override public void init(FilterConfig filterConfig) throws ServletException &#123; &#125; @Override public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException &#123; System.out.println(&quot;MyFilter&quot;); chain.doFilter(request, response); &#125; @Override public void destroy() &#123; &#125;&#125; @WebFilter(â€œ/*â€)ï¼šæŒ‡å®šè·¯å¾„è¿›è¡Œè¿‡æ»¤ ä¸‰ã€Listener123456789101112@WebListenerpublic class MyListener implements ServletRequestListener &#123; @Override public void requestInitialized(ServletRequestEvent sre) &#123; System.out.println(&quot;requestInitialized.............&quot;); &#125; @Override public void requestDestroyed(ServletRequestEvent sre) &#123; System.out.println(&quot;requestDestroyed................&quot;); &#125;&#125; @WebListenerï¼šæ ‡æ³¨ä¸ºç›‘å¬å™¨ å¯ä»¥è‡ªè¡Œæµ‹è¯•ä¿®æ”¹è·¯ç”±è·¯å¾„ç­‰è¿›è¡Œæµ‹è¯• å››ã€åŒºåˆ«å¯åŠ¨ç»“æœï¼šhttp://localhost:8080/MyServlet é…åˆå®˜æ–¹å›¾è§£é‡Šä¸€ä¸‹ï¼š é¦–å…ˆæ˜¯ Listener ==&gt; Filter ==&gt; Servlet ä¸‹é¢è¿˜æœ‰ä¸€æ¬¡ï¼š 12MyFilterrequestDestroyed................ å†æµè§ˆå™¨æ‰“å¼€æ§åˆ¶å°ï¼Œå¼ºåˆ¶åˆ·æ–°ä¸€ä¸‹ï¼šmacOS(å¿«æ·é”®ï¼šcommand + shift + R)ï¼Œå¯ä»¥çœ‹åˆ°ï¼š æœ€ä¸‹é¢çš„é‚£ä¸ªæ˜¯æˆ‘çš„æµè§ˆå™¨æ‰©å±•åŠ è½½çš„è„šæœ¬","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"}]},{"title":"SpringBootä¸­å®šä¹‰ç³»ç»Ÿå¯åŠ¨ä»»åŠ¡","slug":"SpringBootä¸­å®šä¹‰ç³»ç»Ÿå¯åŠ¨ä»»åŠ¡","date":"2020-08-22T11:26:24.000Z","updated":"2020-09-30T07:07:19.950Z","comments":true,"path":"2020/08/22/SpringBootä¸­å®šä¹‰ç³»ç»Ÿå¯åŠ¨ä»»åŠ¡/","link":"","permalink":"http://wangba.me/2020/08/22/SpringBoot%E4%B8%AD%E5%AE%9A%E4%B9%89%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E4%BB%BB%E5%8A%A1/","excerpt":"","text":"ä¸€ã€CommandLineRunneré€šè¿‡å®ç° CommandLineRunner æ¥å®šä¹‰å¯åŠ¨ä»»åŠ¡ï¼š 12345678@Component@Order(1)public class MyCommandLineRunner implements CommandLineRunner &#123; @Override public void run(String... args) throws Exception &#123; System.out.println(&quot;Order(1):&quot; + Arrays.toString(args)); &#125;&#125; 12345678@Component@Order(2)public class MyCommandLineRunner01 implements CommandLineRunner &#123; @Override public void run(String... args) throws Exception &#123; System.out.println(&quot;Order(2):&quot; + Arrays.toString(args)); &#125;&#125; å…¶ä¸­ï¼š @Order æ³¨è§£ä¸ºä¼˜å…ˆçº§ï¼Œæ•°å€¼è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼› args ä¸ºå¯åŠ¨ç±»ä¸­çš„ String[] argsï¼› args å‚æ•°å¯ä»¥åœ¨é…ç½®é‡Œé¢çš„ Program argumens è¿›è¡Œé…ç½®ï¼Œä¹Ÿå¯ä»¥æ‰“æˆ jar åŒ…çš„æ—¶å€™ï¼Œä½¿ç”¨å‘½ä»¤è¿›è¡Œè®¾ç½® æœ€ç»ˆç»“æœå¦‚ä¸‹ï¼š å¯ä»¥çœ‹åˆ° Order(1) çš„ä¼˜å…ˆçº§é«˜äº Order(2) äºŒã€ApplicationRunneré€šè¿‡å®ç° ApplicationRunner æ¥å®šä¹‰å¯åŠ¨ä»»åŠ¡ï¼š 1234567891011121314151617181920@Component@Order(3)public class MyApplicationRunner implements ApplicationRunner &#123; @Override public void run(ApplicationArguments args) throws Exception &#123; System.out.println(&quot;Order3:&quot;); String[] sourceArgs = args.getSourceArgs(); System.out.println(&quot;sourceArg:&quot; + Arrays.toString(sourceArgs)); System.out.println(&quot;ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°&quot;); List&lt;String&gt; nonOptionArgs = args.getNonOptionArgs(); System.out.println(&quot;nonOptionArgs:&quot; + nonOptionArgs); System.out.println(&quot;ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°&quot;); Set&lt;String&gt; optionNames = args.getOptionNames(); for (String optionName : optionNames) &#123; System.out.println(optionName + args.getOptionValues(optionName)); &#125; &#125;&#125; 123456789101112131415161718192021@Component@Order(4)public class MyApplicationRunner01 implements ApplicationRunner &#123; @Override public void run(ApplicationArguments args) throws Exception &#123; System.out.println(&quot;Order4&quot;); String[] sourceArgs = args.getSourceArgs(); System.out.println(&quot;sourceArg:&quot; + Arrays.toString(sourceArgs)); System.out.println(&quot;ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°&quot;); List&lt;String&gt; nonOptionArgs = args.getNonOptionArgs(); System.out.println(&quot;nonOptionArgs:&quot; + nonOptionArgs); System.out.println(&quot;ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°&quot;); Set&lt;String&gt; optionNames = args.getOptionNames(); for (String optionName : optionNames) &#123; System.out.println(optionName + args.getOptionValues(optionName)); &#125; System.out.println(&quot;ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°&quot;); &#125;&#125; args.getNonOptionArgs()ï¼šå¯ä»¥ç”¨æ¥è·å–å‘½ä»¤è¡Œä¸­çš„æ— keyå‚æ•°ï¼› args.getOptionNames()ï¼šå¯ä»¥ç”¨æ¥è·å–æ‰€æœ‰key/valueå½¢å¼çš„å‚æ•°çš„keyï¼› args.getOptionValues(key))ï¼šå¯ä»¥æ ¹æ®keyè·å–key/value å½¢å¼çš„å‚æ•°çš„valueï¼› args.getSourceArgs();ï¼šåˆ™è¡¨ç¤ºè·å–å‘½ä»¤è¡Œä¸­çš„æ‰€æœ‰å‚æ•°ã€‚ å‚æ•°é…ç½®ï¼š æœ€ç»ˆç»“æœï¼š æ³¨ï¼šCommandLineRunner å’Œ ApplicationRunner æ˜¯å¯ä»¥ä¸€èµ·ç”¨çš„ï¼Œä¼˜å…ˆçº§è¿˜æ˜¯é€šè¿‡ @Order è¿›è¡Œæ’åº ç»“æœï¼š","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"}]},{"title":"SpringBootæ•´åˆè¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨","slug":"SpringBootæ•´åˆè¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨","date":"2020-08-20T12:32:06.000Z","updated":"2020-09-30T07:07:15.616Z","comments":true,"path":"2020/08/20/SpringBootæ•´åˆè¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨/","link":"","permalink":"http://wangba.me/2020/08/20/SpringBoot%E6%95%B4%E5%90%88%E8%BF%87%E6%BB%A4%E5%99%A8%E5%92%8C%E6%8B%A6%E6%88%AA%E5%99%A8/","excerpt":"","text":"ä¸€ã€è¿‡æ»¤å™¨æ–°å»ºå¦‚ä¸‹çš„ Controllerï¼š 123456789@RestControllerpublic class UserController &#123; @GetMapping(&quot;user/&#123;id&#125;&quot;) public void get(@PathVariable String id) &#123; System.out.println(id); &#125;&#125; è¿‡æ»¤å™¨çš„å®ç°ï¼šå®šä¹‰ä¸€ä¸ªç±»å®ç° Filter ï¼Œå¹¶é‡å†™å…¶ä¸­çš„æ–¹æ³• 123456789101112131415161718192021222324@Component@WebFilter(urlPatterns = &quot;/*&quot;)public class TimeFilter implements Filter &#123; @Override public void init(FilterConfig filterConfig) throws ServletException &#123; System.out.println(&quot;Initialization&quot;); &#125; @Override public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException &#123; System.out.println(&quot;++++++++ Start ++++++++&quot;); Long start = new Date().getTime(); filterChain.doFilter(servletRequest, servletResponse); System.out.println(&quot;Filter costs: &quot;); System.out.println(new Date().getTime() - start); System.out.println(&quot;++++++++ End ++++++++&quot;); &#125; @Override public void destroy() &#123; System.out.println(&quot;Filter is over&quot;); &#125;&#125; init æ–¹æ³•ï¼šæ˜¯å¯¹é¡¹ç›®å¯åŠ¨æ—¶ï¼Œè¿›è¡Œçš„åˆå§‹åŒ– doFilter æ–¹æ³•ï¼šå½“æ‰§è¡Œä¸€ä¸ªè¯·æ±‚çš„æ—¶å€™ï¼Œè¿›è¡Œè¿‡æ»¤ destroy æ–¹æ³•ï¼šå½“è¿™ä¸ªé¡¹ç›®å…³é—­æ—¶ï¼Œè¯¥è¿‡æ»¤å™¨ä¹Ÿè¢«é”€æ¯äº† æµè§ˆå™¨è¿è¡Œï¼šhttp://localhost:8080/user/666 ç»“æœï¼š åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å‡ºç°äº†ä¸€ç‚¹é—®é¢˜ï¼š å½“æˆ‘ä»¬è¿›è¡Œä¸‹é¢è¿™ç§è¿‡æ»¤ä¸€éƒ¨åˆ†çš„æƒ…å†µä¸‹ï¼š TimeFilter 12345678910111213141516171819202122232425@Component@WebFilter(urlPatterns = &#123;&quot;/user/*&quot;&#125;)public class TimeFilter implements Filter &#123; @Override public void init(FilterConfig filterConfig) throws ServletException &#123; System.out.println(filterConfig.getServletContext().getContextPath()); System.out.println(&quot;Initialization........&quot;); &#125; @Override public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException &#123; System.out.println(&quot;++++++++ Start ++++++++&quot;); Long start = new Date().getTime(); filterChain.doFilter(servletRequest, servletResponse); System.out.println(&quot;Filter costs: &quot;); System.out.println(new Date().getTime() - start); System.out.println(&quot;++++++++ End ++++++++&quot;); &#125; @Override public void destroy() &#123; System.out.println(&quot;Filter is over&quot;); &#125;&#125; UserController 123456789@RestControllerpublic class UserController &#123; @GetMapping(&quot;user/&#123;id&#125;&quot;) public void get(@PathVariable String id) &#123; System.out.println(&quot;userIDï¼š&quot; +id); &#125;&#125; HelloController 12345678@RestControllerpublic class HelloController &#123; @RequestMapping(&quot;hello&quot;) public String hello() &#123; return &quot;hello&quot;; &#125;&#125; æ­¤æ—¶æˆ‘ä»¬è¿‡æ»¤çš„æ˜¯ /user åé¢æ‰€æœ‰çš„è¯·æ±‚ï¼Œä½†æ˜¯ç»“æœæ˜¯ UserController å’Œ HelloController éƒ½è¿›å…¥äº†è¿‡æ»¤å™¨ä¸­ï¼š æœ€ç»ˆè§£å†³æ–¹æ¡ˆï¼šå»æ‰åœ¨ TimeFilter ä¸­çš„ @Component æ³¨è§£ï¼Œåœ¨å¯åŠ¨ç±»ä¸ŠåŠ ä¸Š @ServletComponentScan æ³¨è§£å³å¯ï¼š åœ¨ä¸Šé¢æˆ‘ä»¬ä½¿ç”¨äº†æ³¨è§£çš„æ–¹å¼è¿›è¡Œè¿‡æ»¤ï¼š @WebFilter(urlPatterns = â€œ/*â€) ç¬¬äºŒç§æ–¹å¼ï¼š å»æ‰ @Component å’Œ *@WebFilter(urlPatterns = {â€œ/user/â€œ})** æ³¨è§£ï¼Œå¹¶é…ç½®å¦‚ä¸‹çš„é…ç½®ç±»ï¼š 123456789101112131415@Configurationpublic class WebConfig &#123; @Bean public FilterRegistrationBean timeFilter() &#123; FilterRegistrationBean filterRegistrationBean = new FilterRegistrationBean(); TimeFilter timeFilter = new TimeFilter(); filterRegistrationBean.setFilter(timeFilter); List&lt;String&gt; urlList = new ArrayList&lt;&gt;(); urlList.add(&quot;/user/*&quot;); filterRegistrationBean.setUrlPatterns(urlList); return filterRegistrationBean; &#125;&#125; äºŒã€æ‹¦æˆªå™¨ç¼–å†™ä¸€ä¸ªæ‹¦æˆªå™¨ç±»å®ç° HandlerInterceptor ï¼Œå¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425public class TimeInterceptor implements HandlerInterceptor &#123; @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; System.out.println(&quot;å¤„ç†æ‹¦æˆªä¹‹å‰&quot;); request.setAttribute(&quot;startTime&quot;, new Date().getTime()); System.out.println(((HandlerMethod) handler).getBean().getClass().getName()); System.out.println(((HandlerMethod) handler).getMethod().getName()); return true; &#125; @Override public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception &#123; System.out.println(&quot;å¼€å§‹å¤„ç†æ‹¦æˆª&quot;); Long start = (Long) request.getAttribute(&quot;startTime&quot;); System.out.println(&quot;ã€æ‹¦æˆªå™¨ã€‘è€—æ—¶ &quot; + (new Date().getTime() - start)); &#125; @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception &#123; System.out.println(&quot;å¤„ç†æ‹¦æˆªä¹‹å&quot;); Long start = (Long) request.getAttribute(&quot;startTime&quot;); System.out.println(&quot;ã€æ‹¦æˆªå™¨ã€‘è€—æ—¶ &quot; + (new Date().getTime() - start)); System.out.println(&quot;å¼‚å¸¸ä¿¡æ¯ &quot; + ex); &#125;&#125; preHandle æ–¹æ³•åœ¨å¤„ç†æ‹¦æˆªä¹‹å‰æ‰§è¡Œ postHandle æ–¹æ³•åªæœ‰å½“è¢«æ‹¦æˆªçš„æ–¹æ³•æ²¡æœ‰æŠ›å‡ºå¼‚å¸¸æˆåŠŸæ—¶æ‰ä¼šå¤„ç† afterCompletion æ–¹æ³•æ— è®ºè¢«æ‹¦æˆªçš„æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ä¸å¦éƒ½ä¼šæ‰§è¡Œ å°†æˆ‘ä»¬å†™å¥½çš„æ‹¦æˆªå™¨æ³¨å†Œåˆ°å®¹å™¨ä¸­ï¼š 123456789101112@Configurationpublic class InterceptorConfig implements WebMvcConfigurer &#123; @Autowired TimeInterceptor timeInterceptor; @Override public void addInterceptors(InterceptorRegistry registry) &#123; registry.addInterceptor(timeInterceptor).addPathPatterns(&quot;/user/*&quot;); &#125;&#125; åŒæ ·åˆ†åˆ«è¿è¡Œï¼šhttp://localhost:8080/user/888 å’Œ http://localhost:8080/hello å¯ä»¥çœ‹è§ç»“æœå¦‚ä¸‹ï¼š åªæ˜¯å¯¹ user/888 è¿›è¡Œæ‹¦æˆªäº†ï¼Œå¯¹ hello æ²¡æœ‰è¿›è¡Œæ‹¦æˆª ä¸‰ã€è¿‡æ»¤å™¨ä¸æ‹¦æˆªå™¨çš„å¯¹æ¯”æˆ‘ä»¬å†å°†å‰é¢çš„è¿‡æ»¤å™¨åŠ å…¥å…¶ä¸­ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœï¼š æœ‰ä¸€å¼ å·²ç»æ•´ç†å¥½æ‰§è¡Œé¡ºåºå›¾ï¼š","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"}]},{"title":"SpringBootä¸­è·¨åŸŸé—®é¢˜","slug":"SpringBootä¸­è·¨åŸŸé—®é¢˜","date":"2020-08-20T10:16:59.000Z","updated":"2020-09-30T07:07:17.590Z","comments":true,"path":"2020/08/20/SpringBootä¸­è·¨åŸŸé—®é¢˜/","link":"","permalink":"http://wangba.me/2020/08/20/SpringBoot%E4%B8%AD%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98/","excerpt":"","text":"ä¸€ã€åŒæºç­–ç•¥â€‹ åŒæºç­–ç•¥æ˜¯ç”± Netscape æå‡ºçš„ä¸€ä¸ªè‘—åçš„å®‰å…¨ç­–ç•¥ï¼Œå®ƒæ˜¯æµè§ˆå™¨æœ€æ ¸å¿ƒä¹Ÿæœ€åŸºæœ¬çš„å®‰å…¨åŠŸèƒ½ï¼Œç°åœ¨æ‰€æœ‰æ”¯æŒ JavaScript çš„æµè§ˆå™¨éƒ½ä¼šä½¿ç”¨è¿™ä¸ªç­–ç•¥ã€‚æ‰€è°“åŒæºæ˜¯æŒ‡åè®®ã€åŸŸåä»¥åŠç«¯å£è¦ç›¸åŒã€‚åŒæºç­–ç•¥æ˜¯åŸºäºå®‰å…¨æ–¹é¢çš„è€ƒè™‘æå‡ºæ¥çš„ï¼Œè¿™ä¸ªç­–ç•¥æœ¬èº«æ²¡é—®é¢˜ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨å®é™…å¼€å‘ä¸­ï¼Œç”±äºå„ç§åŸå› åˆç»å¸¸æœ‰è·¨åŸŸçš„éœ€æ±‚ï¼Œä¼ ç»Ÿçš„è·¨åŸŸæ–¹æ¡ˆæ˜¯ JSONPï¼ŒJSONP è™½ç„¶èƒ½è§£å†³è·¨åŸŸä½†æ˜¯æœ‰ä¸€ä¸ªå¾ˆå¤§çš„å±€é™æ€§ï¼Œé‚£å°±æ˜¯åªæ”¯æŒ GET è¯·æ±‚ï¼Œä¸æ”¯æŒå…¶ä»–ç±»å‹çš„è¯·æ±‚ï¼Œè€Œ CORSï¼ˆè·¨åŸŸæºèµ„æºå…±äº«ï¼‰ï¼ˆCORSï¼ŒCross-origin resource sharingï¼‰æ˜¯ä¸€ä¸ª W3C æ ‡å‡†ï¼Œå®ƒæ˜¯ä¸€ä»½æµè§ˆå™¨æŠ€æœ¯çš„è§„èŒƒï¼Œæä¾›äº† Web æœåŠ¡ä»ä¸åŒç½‘åŸŸä¼ æ¥æ²™ç›’è„šæœ¬çš„æ–¹æ³•ï¼Œä»¥é¿å¼€æµè§ˆå™¨çš„åŒæºç­–ç•¥ï¼Œè¿™æ˜¯ JSONP æ¨¡å¼çš„ç°ä»£ç‰ˆã€‚åœ¨ Spring æ¡†æ¶ä¸­ï¼Œå¯¹äº CORS ä¹Ÿæä¾›äº†ç›¸åº”çš„è§£å†³æ–¹æ¡ˆï¼Œ SpringBoot ä¸­å¦‚ä½•å®ç° CORSã€‚ äºŒã€å¦‚ä½•å‡ºç°å¯åŠ¨ä¸¤ä¸ª SpringBoot é¡¹ç›®ï¼Œåˆ†åˆ«ä»¥ 8080 å’Œ 8081 ç«¯å£å¯åŠ¨ï¼Œåœ¨å…¶ä¸­ä¸€ä¸ªå†™ä¸Šå¦‚ä¸‹çš„ Controllerï¼š 1234567891011121314@RestControllerpublic class HelloController &#123; @PostMapping(&quot;/hello&quot;) public String hello1() &#123; return &quot;get hello&quot;; &#125; @GetMapping(&quot;/hello&quot;) public String hello2() &#123; return &quot;post hello&quot;; &#125;&#125; åœ¨å¦ä¸€ä¸ªä¸­å†™å…¥ä¸€ä¸ªé™æ€é¡µé¢ï¼š 1234567891011121314151617181920212223242526&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot; xmlns:th=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;Title&lt;/title&gt; &lt;script src=&quot;jquery-3.5.1.js&quot;&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div id=&quot;app&quot;&gt;&lt;/div&gt;&lt;input type=&quot;button&quot; onclick=&quot;btnClick()&quot; value=&quot;get_button&quot;&gt;&lt;input type=&quot;button&quot; onclick=&quot;btnClick2()&quot; value=&quot;post_button&quot;&gt;&lt;script&gt; function btnClick() &#123; $.get(&#x27;http://localhost:8080/hello&#x27;, function (msg) &#123; $(&quot;#app&quot;).html(msg); &#125;); &#125; function btnClick2() &#123; $.post(&#x27;http://localhost:8080/hello&#x27;, function (msg) &#123; $(&quot;#app&quot;).html(msg); &#125;); &#125;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt; æ³¨ï¼šè®°å¾—å¼•å…¥ Jquery åœ¨ http://localhost:8081/hello.html ç‚¹å‡»ä»»ä½•è¯·æ±‚ï¼š å¯ä»¥çœ‹åˆ°æ­¤æ—¶å·²ç»å‘ç”Ÿè·¨åŸŸé—®é¢˜ ä¸‰ã€è§£å†³æ–¹æ¡ˆä»åç«¯è§£å†³ï¼Œä¿®æ”¹ Controller ä¸ºï¼š 12345678910111213141516@RestControllerpublic class HelloController &#123; @CrossOrigin(origins = &quot;http://localhost:8081&quot;) @PostMapping(&quot;/hello&quot;) public String hello1() &#123; return &quot;post hello&quot;; &#125; @CrossOrigin(value = &quot;http://localhost:8081&quot;) @GetMapping(&quot;/hello&quot;) public String hello2() &#123; return &quot;get hello&quot;; &#125;&#125; å…¶ä¸­ origins ä¸ value æ•ˆæœä¸€æ ·ï¼Œçœ‹æºç å¯ä»¥çŸ¥é“å®ƒä»¬äº’ç›¸æˆä¸ºå¯¹æ–¹çš„åˆ«å æ­¤æ—¶å·²ç»ä¸ä¼šå‡ºç°è·¨åŸŸé—®é¢˜ å››ã€åŠ å¼ºç‰ˆè§£å†³æ­¤æ—¶ï¼Œåœ¨æ¯ä¸€ä¸ªç±»æˆ–è€…æ–¹æ³•ä¸Šéƒ½ä½¿ç”¨è¿™ä¸ªæ³¨è§£ï¼Œæ³•å¤–ç‹‚å¾’å¼ ä¸‰éƒ½è§‰å¾—è¿™ä¸ªå¤ªéº»çƒ¦äº† åªéœ€è¦é…ç½®ä¸€ä¸ªå®ç° WebMvcConfigurer é…ç½®ç±»ï¼Œå¦‚ä¸‹ï¼š 12345678public class CORSConfig implements WebMvcConfigurer &#123; @Override public void addCorsMappings(CorsRegistry registry) &#123; registry.addMapping(&quot;/**&quot;).allowedOrigins(&quot;http://localhost:8081&quot;) .allowedMethods(&quot;*&quot;) .allowedHeaders(&quot;*&quot;); &#125;&#125; æ³¨ï¼š/** è¡¨ç¤ºæœ¬åº”ç”¨çš„æ‰€æœ‰æ–¹æ³•éƒ½ä¼šå»å¤„ç†è·¨åŸŸè¯·æ±‚ï¼›allowedMethods è¡¨ç¤ºå…è®¸é€šè¿‡çš„è¯·æ±‚æ•°ï¼›allowedHeaders åˆ™è¡¨ç¤ºå…è®¸çš„è¯·æ±‚å¤´ã€‚ äº”ã€å®‰å…¨é—®é¢˜å‡ºç°äº†ä¸€ä¸ªç‹å…«è€æœ¬è¡Œçš„é—®é¢˜ï¼šé€šè¿‡ Ajax å‘é€è·¨åŸŸè¯·æ±‚ï¼Œè™½ç„¶ç”¨æˆ·ä½“éªŒæé«˜äº†ï¼Œä½†æ˜¯ä¹Ÿæœ‰æ½œåœ¨çš„å¨èƒå­˜åœ¨ï¼Œå¸¸è§çš„å°±æ˜¯ CSRFï¼ˆCross-site request forgeryï¼‰è·¨ç«™è¯·æ±‚ä¼ªé€ ã€‚ ä¸€å¥è¯ï¼šåˆ©ç”¨æˆ‘ä»¬è¿˜åœ¨ç™»å½•çš„çŠ¶æ€ï¼Œå³ Cookie æœ‰æ•ˆï¼Œæ‰“å¼€ä¸€ä¸ªæ­£å¸¸ç½‘ç«™ï¼Œè€Œè¿™ä¸ªç½‘ç«™ä¸Šå¯èƒ½æœ‰ä¸€ä¸ªéæ­£å¸¸æ“ä½œ ( å›¾ç‰‡ï¼Œé“¾æ¥ç­‰) ï¼Œé‚£ä½ å°±å¯èƒ½å·²ç»è¢«æ”»å‡»ã€‚ åœ¨ä¿¡æ¯å®‰å…¨ä¸­ï¼Œæˆ‘ä»¬é˜²å¾¡ CSRF çš„æ–¹æ³•ä¸»è¦æ˜¯å¢åŠ  Tokenï¼Œè¿™ä¹Ÿæ˜¯ç°åœ¨å¤§å¤šæ•°é˜²å¾¡ CSRF çš„æ–¹å¼ã€‚","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"}]},{"title":"SpringBootä¸­è‡ªå®šä¹‰å¼‚å¸¸","slug":"SpringBootä¸­è‡ªå®šä¹‰å¼‚å¸¸","date":"2020-08-19T09:11:17.000Z","updated":"2020-09-30T07:07:13.559Z","comments":true,"path":"2020/08/19/SpringBootä¸­è‡ªå®šä¹‰å¼‚å¸¸/","link":"","permalink":"http://wangba.me/2020/08/19/SpringBoot%E4%B8%AD%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8/","excerpt":"","text":"ä¸€ã€æ­£å¸¸å‡ºç°å¼‚å¸¸Controllerï¼š 12345678910@RestControllerpublic class ErrorController &#123; @GetMapping(&quot;/diyError&quot;) public String error() &#123; int i = 2 / 0; return &quot;diyError&quot;; &#125; &#125; ç»“æœï¼š å¯ä»¥çœ‹è§æ­¤é”™è¯¯é¡µæ˜¯ SpringBoot æä¾›çš„ï¼Œç”±äºæˆ‘ä»¬æ²¡æœ‰æä¾› /error é¡µé¢ï¼Œé¡ºä¾¿å±•ç¤ºæˆ‘ä»¬å‡ºç°çš„é”™è¯¯ äºŒã€é™æ€é¡µé¢å¼‚å¸¸åœ¨ static ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª error ç›®å½•ï¼Œå¹¶åœ¨å…¶ä¸­æ–°å»º 404.html å’Œ 500.htmlï¼š 404.html: 12345678910&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;Title&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;404&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt; 500.htmlï¼š 12345678910&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;Title&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;500&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt; å†æ¬¡è®¿é—® http://localhost:8080/diyError å¯ä»¥çœ‹è§å·²ç»è¿›å…¥è‡ªå®šä¹‰çš„é™æ€é¡µé¢äº†ï¼š å†è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„é¡µé¢ï¼š æ³¨ï¼šä¹Ÿå¯ä»¥åªå®šä¹‰ 4xx.html ä¸ 5xx.html çš„é™æ€é¡µé¢ï¼Œåªè¦å‘ç”Ÿ 400-499 çš„çŠ¶æ€ç æˆ–è€… 500-599 çš„çŠ¶æ€ç å°±å¯¹åº” 4xx.html ä¸ 5xx.html çš„ç»“æœ ä¸‰ã€åŠ¨æ€é¡µé¢å¼‚å¸¸å¼•å…¥ thymeleaf çš„ä¾èµ–ï¼š 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;&lt;/dependency&gt; åœ¨ templates ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª error ç›®å½•ï¼Œå¹¶åœ¨å…¶ä¸­æ–°å»º 404.htmlã€ 500.htmlã€ 4xx.htmlã€5xx.html ï¼š å†æ¬¡è®¿é—® http://localhost:8080/diyError å¯ä»¥çœ‹è§å·²ç»è¿›å…¥è‡ªå®šä¹‰çš„åŠ¨æ€é¡µé¢äº†ï¼š ä¼˜å…ˆçº§ï¼š å¦‚æœæœ‰ 404 çš„é¡µé¢ï¼Œä¼šå…ˆæ‰¾ 404.htmlï¼›å¦‚æœæ²¡æœ‰å°±ä¼šæ‰¾ 4xx.html å¦‚æœåŠ¨æ€é¡µé¢å’Œé™æ€é¡µé¢åŒæ—¶å­˜åœ¨ï¼Œä¼šä¼˜å…ˆä½¿ç”¨åŠ¨æ€é¡µé¢ å®Œæ•´é¡ºåºå¤§æ¦‚å¦‚ä¸‹ï¼š å‘ç”Ÿäº†500é”™è¯¯ â€“&gt; æŸ¥æ‰¾åŠ¨æ€ 500.html é¡µé¢ â€“&gt; æŸ¥æ‰¾é™æ€ 500.html â€“&gt; æŸ¥æ‰¾åŠ¨æ€ 5xx.html â€“&gt; æŸ¥æ‰¾é™æ€ 5xx.html å››ã€SpringBoot æ€ä¹ˆè‡ªåŠ¨é…ç½®å…³é”®ç±»ï¼šErrorMvcAutoConfiguration 12345678910111213141516171819202122@Configuration(proxyBeanMethods = false)static class DefaultErrorViewResolverConfiguration &#123; private final ApplicationContext applicationContext; private final ResourceProperties resourceProperties; DefaultErrorViewResolverConfiguration(ApplicationContext applicationContext, ResourceProperties resourceProperties) &#123; this.applicationContext = applicationContext; this.resourceProperties = resourceProperties; &#125; @Bean @ConditionalOnBean(DispatcherServlet.class) @ConditionalOnMissingBean(ErrorViewResolver.class) // é»˜è®¤çš„é”™è¯¯è§†å›¾è§£æå™¨ DefaultErrorViewResolver DefaultErrorViewResolver conventionErrorViewResolver() &#123; return new DefaultErrorViewResolver(this.applicationContext, this.resourceProperties); &#125;&#125; åœ¨é»˜è®¤çš„é”™è¯¯è§†å›¾è§£æå™¨ DefaultErrorViewResolver ä¸­ï¼š 12345678@Overridepublic ModelAndView resolveErrorView(HttpServletRequest request, HttpStatus status, Map&lt;String, Object&gt; model) &#123; ModelAndView modelAndView = resolve(String.valueOf(status.value()), model); if (modelAndView == null &amp;&amp; SERIES_VIEWS.containsKey(status.series())) &#123; modelAndView = resolve(SERIES_VIEWS.get(status.series()), model); &#125; return modelAndView;&#125; å¦‚æœ modelAndView ä¸ºç©ºï¼Œå³æ²¡æ‰¾åˆ°å¯¹åº”çš„å…·ä½“ 404.htmlï¼Œå°±ä¼šç”¨ SERIES_VIEWS.containsKey(status.series()) æ‰¾ 4xx.html 123456789private ModelAndView resolve(String viewName, Map&lt;String, Object&gt; model) &#123; String errorViewName = &quot;error/&quot; + viewName; TemplateAvailabilityProvider provider = this.templateAvailabilityProviders.getProvider(errorViewName, this.applicationContext); if (provider != null) &#123; return new ModelAndView(errorViewName, model); &#125; return resolveResource(errorViewName, model);&#125; åˆ¤æ–­ error æ–‡ä»¶å¤¹ä¸‹é¢æ˜¯å¦æœ‰å¯¹åº”çš„çŠ¶æ€ç çš„æ–‡æ¡£ å†åˆ¤æ–­æ˜¯å¦æœ‰åŠ¨æ€é¡µé¢ï¼Œå³ TemplateAvailabilityProvider å¦‚æœæ˜¯åŠ¨æ€é¡µé¢ï¼Œå°±è¿”å›åŠ¨æ€é¡µé¢ï¼›å¦åˆ™è¿”å›é™æ€é¡µé¢ 1234567891011121314private ModelAndView resolveResource(String viewName, Map&lt;String, Object&gt; model) &#123; for (String location : this.resourceProperties.getStaticLocations()) &#123; try &#123; Resource resource = this.applicationContext.getResource(location); resource = resource.createRelative(viewName + &quot;.html&quot;); if (resource.exists()) &#123; return new ModelAndView(new HtmlResourceView(resource), model); &#125; &#125; catch (Exception ex) &#123; &#125; &#125; return null;&#125; äº”ã€è‡ªå®šä¹‰å¼‚å¸¸æ•°æ®åœ¨ ErrorMvcAutoConfiguration ä¸­ï¼Œå¤„ç†å¼‚å¸¸æ•°æ®çš„æ–¹æ³•ï¼š 12345@Bean@ConditionalOnMissingBean(value = ErrorAttributes.class, search = SearchStrategy.CURRENT)public DefaultErrorAttributes errorAttributes() &#123; return new DefaultErrorAttributes();&#125; åœ¨ DefaultErrorAttributes() ä¸­é€šè¿‡è®¾ç½®å‚æ•°å¾—åˆ°ç›¸åº”çš„ç»“æœ ä¾‹å¦‚ï¼šå°† error ä¸­çš„ 5xx.html æ”¹ä¸ºï¼š 123456789101112131415161718192021222324252627282930313233343536&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot; xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;Title&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;5xx&lt;/h1&gt;&lt;table border=&quot;1&quot;&gt; &lt;tr&gt; &lt;td&gt;path&lt;/td&gt; &lt;td th:text=&quot;$&#123;path&#125;&quot;&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;error&lt;/td&gt; &lt;td th:text=&quot;$&#123;error&#125;&quot;&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;message&lt;/td&gt; &lt;td th:text=&quot;$&#123;message&#125;&quot;&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;timestamp&lt;/td&gt; &lt;td th:text=&quot;$&#123;timestamp&#125;&quot;&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;status&lt;/td&gt; &lt;td th:text=&quot;$&#123;status&#125;&quot;&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;trace&lt;/td&gt; &lt;td th:text=&quot;$&#123;trace&#125;&quot;&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/body&gt;&lt;/html&gt; æ­¤æ—¶ä»”è¿è¡Œç»“æœï¼š å†çœ‹ä¸€ä¸‹ä½¿ DefaultErrorAttributes ç”Ÿæ•ˆçš„æ¡ä»¶ï¼š @ConditionalOnMissingBean(value = ErrorAttributes.class, search = SearchStrategy.CURRENT) æ‰€ä»¥åªè¦æˆ‘ä»¬è‡ªå®šä¹‰ ErrorAttributes.class å°±å¯ä»¥å®ç°è‡ªå·±å®šä¹‰çš„å¼‚å¸¸æ•°æ®å¤„ç† è‡ªå®šä¹‰ ErrorAttributes æœ‰ä¸¤ç§æ–¹å¼ ï¼š ç›´æ¥å®ç° ErrorAttributes æ¥å£ ç»§æ‰¿ DefaultErrorAttributesï¼ˆæ¨èï¼‰ï¼Œå› ä¸º DefaultErrorAttributes ä¸­å¯¹å¼‚å¸¸æ•°æ®çš„å¤„ç†å·²ç»å®Œæˆï¼Œå¼€å‘è€…å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚ æ–°å»ºä¸€ä¸ªé…ç½®ç±»ç»§æ‰¿ DefaultErrorAttributes 12345678910@Componentpublic class MyErrorConfig extends DefaultErrorAttributes &#123; @Override public Map&lt;String, Object&gt; getErrorAttributes(WebRequest webRequest, ErrorAttributeOptions options) &#123; Map&lt;String, Object&gt; errorAttributes = super.getErrorAttributes(webRequest, options); errorAttributes.put(&quot;myerror&quot;, &quot;è‡ªå®šä¹‰å¼‚å¸¸&quot;); return errorAttributes; &#125;&#125; åœ¨ 5xx.html ä¸­åŠ å…¥ï¼š 1234&lt;tr&gt; &lt;td&gt;myerror&lt;/td&gt; &lt;td th:text=&quot;$&#123;myerror&#125;&quot;&gt;&lt;/td&gt;&lt;/tr&gt; è¿è¡Œç»“æœï¼šå¯ä»¥çœ‹åˆ°æ­¤æ—¶çš„è‡ªå®šä¹‰çš„ error å·²ç»åŠ å…¥","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"}]},{"title":"SpringBootæ•´åˆJSON","slug":"SpringBootæ•´åˆJSON","date":"2020-08-18T13:01:28.000Z","updated":"2020-09-30T07:07:11.653Z","comments":true,"path":"2020/08/18/SpringBootæ•´åˆJSON/","link":"","permalink":"http://wangba.me/2020/08/18/SpringBoot%E6%95%B4%E5%90%88JSON/","excerpt":"","text":"ä¸€ã€Jackson1. ç¯å¢ƒæ­å»ºåªè¦åŠ å…¥æ™®é€šçš„ Web ä¾èµ–å°±è¡Œï¼Œä¸ºäº†æ–¹ä¾¿ä¾ç„¶å¼•å…¥ Lombok å’Œ çƒ­éƒ¨ç½² æ‰“å¼€ Maven ä¾èµ–å¯ä»¥çœ‹è§ SpringBoot è‡ªå¸¦çš„å°±æ˜¯ jackson 2. SpringBootä¸­ä½¿ç”¨2.1 å»ºç«‹å®ä½“ç±»ï¼š 12345678@Datapublic class User &#123; private Integer id; private String name; private String address; private Date date;&#125; 2.2 Controllerå±‚ï¼š 1234567891011121314151617@RestControllerpublic class UserController &#123; @GetMapping(&quot;/user&quot;) public List&lt;User&gt; getUser() &#123; List&lt;User&gt; users = new ArrayList&lt;&gt;(); for (int i = 1; i &lt;= 10; i++) &#123; User user = new User(); user.setId(i); user.setName(&quot;wang&quot; + i); user.setAddress(&quot;shanghai&quot; + i); user.setDate(new Date()); users.add(user); &#125; return users; &#125;&#125; 2.3 ç»“æœï¼š 3. æ·±å…¥äº†è§£ Springboot ä¸­çš„ JSON è½¬æ¢æ€è€ƒï¼š å‰ç«¯ä¼ å…¥çš„ json æ•°æ®å¦‚ä½•è¢«è§£ææˆ Java å¯¹è±¡ä½œä¸º APIå…¥å‚ API è¿”å›ç»“æœåˆå¦‚ä½•å°† Java å¯¹è±¡è§£ææˆ json æ ¼å¼æ•°æ®è¿”å›ç»™å‰ç«¯ å…³é”®ç±»ï¼šHttpMessageConverter å®˜æ–¹åŸè¯ï¼š 1Strategy interface that specifies a converter that can convert from and to HTTP requests and responses. ä» Structure ä¸­å¯ä»¥çœ‹è§ä¸€å…±æœ‰äº”ä¸ªæ–¹æ³•ï¼š canReadï¼šæ¥æ”¶åˆ°è¯·æ±‚æ—¶åˆ¤æ–­æ˜¯å¦èƒ½è¯» canWriteï¼šè¿”å›ç»“æœæ—¶åˆ¤æ–­æ˜¯å¦èƒ½å†™ getSupportedMediaTypesï¼šè·å–æ”¯æŒçš„ MediaType readï¼šèƒ½è¯»åˆ™è¯» writeï¼šèƒ½å†™åˆ™å†™ æ³¨ï¼šåœ¨å‰é¢æˆ‘ä»¬æ²¡æœ‰å†™ä»»ä½•é…ç½®ä¹Ÿèƒ½å®ç°è½¬æ¢ï¼Œæ˜¯ç”±äºå…¶ä¸­æœ‰ç¼ºçœé…ç½® å¯ä»¥åœ¨ WebMvcConfigurationSupport ä¸­æŸ¥çœ‹ 4.è‡ªå®šä¹‰ JSON é…ç½®æ–¹å¼ä¸€ï¼šåœ¨éœ€è¦è½¬æ¢çš„å±æ€§ä¸ŠåŠ ä¸Šæ³¨è§£ 12345678910@Datapublic class User &#123; private Integer id; private String name; private String address; @JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;) private Date date;&#125; ç»“æœï¼š æ–¹å¼äºŒï¼š é…ç½®ç±»ï¼š 1234567891011121314@Configurationpublic class JsonConfig &#123; @Bean MappingJackson2HttpMessageConverter mappingJackson2HttpMessageConverter () &#123; MappingJackson2HttpMessageConverter converter = new MappingJackson2HttpMessageConverter(); ObjectMapper objectMapper = new ObjectMapper(); objectMapper.setDateFormat(new SimpleDateFormat(&quot;yyyy-MM-dd-HH:mm:ss&quot;)); converter.setObjectMapper(objectMapper); return converter; &#125;&#125; ç»“æœï¼š ä½¿ç”¨ä¸‹é¢çš„é…ç½®ç±»ä¹Ÿå¯ä»¥ï¼š 123456789101112131415161718192021@Configurationpublic class JsonConfig &#123;// @Bean// MappingJackson2HttpMessageConverter mappingJackson2HttpMessageConverter () &#123;//// MappingJackson2HttpMessageConverter converter = new MappingJackson2HttpMessageConverter();// ObjectMapper objectMapper = new ObjectMapper();// objectMapper.setDateFormat(new SimpleDateFormat(&quot;yyyy-MM-dd-HH:mm:ss&quot;));// converter.setObjectMapper(objectMapper);// return converter;// &#125; @Bean ObjectMapper objectMapper() &#123; ObjectMapper objectMapper = new ObjectMapper(); objectMapper.setDateFormat(new SimpleDateFormat(&quot;yyyy-MM-dd&quot;)); return objectMapper; &#125;&#125; ç»“æœï¼š 5.Gson å’Œ Fastjsonå¦‚æœæƒ³è¦å’Œ Jackson ä¸€æ ·è‡ªå®šä¹‰é…ç½®ï¼š åªéœ€è¦é…ç½®ï¼šGsonHttpMessageConverter å’Œ FastJsonHttpMessageConverter","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"JSON","slug":"JSON","permalink":"http://wangba.me/tags/JSON/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"}]},{"title":"ControllerAdviceæ³¨è§£çš„ä½¿ç”¨","slug":"ControllerAdviceæ³¨è§£çš„ä½¿ç”¨","date":"2020-08-18T13:00:09.000Z","updated":"2020-09-30T07:07:09.383Z","comments":true,"path":"2020/08/18/ControllerAdviceæ³¨è§£çš„ä½¿ç”¨/","link":"","permalink":"http://wangba.me/2020/08/18/ControllerAdvice%E6%B3%A8%E8%A7%A3%E7%9A%84%E4%BD%BF%E7%94%A8/","excerpt":"","text":"ä¸€ã€ç”¨æ³• å¤„ç†å…¨å±€å¼‚å¸¸ é¢„è®¾å…¨å±€æ•°æ® è¯·æ±‚å‚æ•°é¢„å¤„ç† äºŒã€å¤„ç†å…¨å±€å¼‚å¸¸æˆ‘ä»¬åªéœ€è¦åœ¨ application.propertiesä¸­é…ç½®ï¼šspring.servlet.multipart.max-file-size=1KB å°±å¯ä»¥çœ‹è§åœ¨ä¸Šä¼ å›¾ç‰‡æ—¶å°±ä¼šæŠ¥ 500 å¼‚å¸¸ï¼š æ­¤æ—¶æˆ‘ä»¬å¯ä»¥è‡ªå·±è‡ªå®šä¹‰å¤„ç† è¿™ç§å¼‚å¸¸ï¼š 12345678910111213@ControllerAdvicepublic class MyException &#123; @ExceptionHandler(MaxUploadSizeExceededException.class) public void myException(MaxUploadSizeExceededException e, HttpServletResponse response) throws IOException &#123; response.setContentType(&quot;text/html;charset=utf-8&quot;); PrintWriter writer = response.getWriter(); writer.write(&quot;ä¸Šä¼ å¤§å°é™åˆ¶ä¸º1KB&quot;); writer.flush(); writer.close(); &#125;&#125; ä¸‰ã€é¢„è®¾å…¨å±€æ•°æ®è®¾ç½®å…¨å±€å˜é‡ï¼š 1234567891011@ControllerAdvicepublic class GlobalData &#123; @ModelAttribute(value = &quot;data&quot;) public Map&lt;String, Object&gt; map() &#123; Map&lt;String, Object&gt; map = new HashMap&lt;&gt;(); map.put(&quot;wangyi&quot;, &quot;ç‹ä¸€&quot;); map.put(&quot;wangba&quot;, &quot;ç‹å…«&quot;); return map; &#125;&#125; å–å‡ºè®¾ç½®çš„å€¼ï¼š 12345678910111213@RestControllerpublic class HelloController &#123; @GetMapping(&quot;hello&quot;) public String hello(Model model) &#123; Map&lt;String, Object&gt; map = model.asMap(); Set&lt;String&gt; set = map.keySet(); for (String s : set) &#123; System.out.println(s + &quot;:&quot; + map.get(s)); &#125; return &quot;hello&quot;; &#125;&#125; ç»“æœï¼š å››ã€è¯·æ±‚å‚æ•°é¢„å¤„ç†å®ä½“ç±»ï¼š 123456@Datapublic class Book &#123; private String name; private double price;&#125; 1234567@Datapublic class Author &#123; private String name; private int age;&#125; Controller: 12345678910@RestControllerpublic class BookController &#123; @PostMapping(&quot;/book&quot;) public void book(Book book, Author author) &#123; System.out.println(book); System.out.println(author); &#125;&#125; ä½¿ç”¨ Postman è¿›è¡Œæµ‹è¯•ï¼š å¾—åˆ°æœ€ç»ˆç»“æœä¸ºï¼š å½“å‡ºç°ç›¸åŒå‚æ•°æ—¶ï¼Œå¹¶ä¸èƒ½åˆ†æ¸…æ¥šå‚æ•°å±äºå“ªä¸ªå¯¹è±¡ï¼Œåªèƒ½å°†å‚æ•°èµ‹å€¼ç»™æ¯ä¸€ä¸ªæ‹¥æœ‰ç›¸åŒå‚æ•°çš„å¯¹è±¡ å¤„ç†ï¼š Controllerï¼š 1234567891011@RestControllerpublic class BookController &#123; @PostMapping(&quot;/book&quot;) public void book(@ModelAttribute(&quot;b&quot;) Book book, @ModelAttribute(&quot;a&quot;) Author author) &#123; System.out.println(book); System.out.println(author); &#125;&#125; å‚æ•°é…ç½®ï¼š 12345678910111213@ControllerAdvicepublic class GlobalData &#123; @InitBinder(&quot;a&quot;) public void initA(WebDataBinder binder) &#123; binder.setFieldDefaultPrefix(&quot;a.&quot;); &#125; @InitBinder(&quot;b&quot;) public void initB(WebDataBinder binder) &#123; binder.setFieldDefaultPrefix(&quot;b.&quot;); &#125;&#125; ä½¿ç”¨ Postman è¿›è¡Œæµ‹è¯•ï¼š ç»“æœï¼š","categories":[{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"æ³¨è§£","slug":"æ³¨è§£","permalink":"http://wangba.me/tags/%E6%B3%A8%E8%A7%A3/"}]},{"title":"ElasticSearchå…¥é—¨","slug":"ElasticSearchå…¥é—¨","date":"2020-08-12T07:02:23.000Z","updated":"2020-08-12T07:40:52.851Z","comments":true,"path":"2020/08/12/ElasticSearchå…¥é—¨/","link":"","permalink":"http://wangba.me/2020/08/12/ElasticSearch%E5%85%A5%E9%97%A8/","excerpt":"","text":"ä¸€ã€å‚è€ƒé“¾æ¥01.ESå®˜ç½‘ 02.Spring Boot Elasticsearch å…¥é—¨ 03.å›¾è§£ Elasticsearch åŸç† äºŒã€ElasticSearchæ¦‚è¿°ä¸‰ã€Solrå’ŒElasticSearchçš„å¯¹æ¯”å››ã€ElasticSearchå®‰è£…äº”ã€Kibanaå®‰è£…5.1 ä¸‹è½½ Kibanaå®˜æ–¹ä¸‹è½½åœ°å€ æ³¨ï¼šå¯ä»¥åœ¨past releasesä¸‹è½½è€ç‰ˆæœ¬ 5.2 è¿è¡Œè§£å‹åè¿›å…¥binç›®å½•è¿è¡Œï¼š 1./kibana åœ¨æµè§ˆå™¨æ‰“å¼€ï¼š http://localhost:5601/ 5.3 æ±‰åŒ– zh-CN.jsonæ˜¯Kibanaçš„æ±‰åŒ–åŒ… å†åˆ° kibana.yml ä¸­åŠ å…¥ï¼š å…­ã€ElasticSearchæ ¸å¿ƒæ¦‚å¿µ6.1 ä¸å…³ç³»å‹æ•°æ®åº“å¯¹æ¯” elasticsearchæ˜¯é¢å‘æ–‡æ¡£ï¼Œå…³ç³»å‹æ•°æ®åº“å’Œ elasticsearch å®¢è§‚çš„å¯¹æ¯”ï¼ä¸€åˆ‡éƒ½æ˜¯JSON MySQL ElasticSearch æ•°æ®åº“ï¼ˆdatabaseï¼‰ ç´¢å¼•ï¼ˆindexï¼‰ è¡¨ï¼ˆtablesï¼‰ ç±»å‹ï¼ˆtypesï¼‰ ES æ–‡æ¡£ï¼ˆdocumentsï¼‰ åˆ—ï¼ˆcolumnsï¼‰ å­—æ®µï¼ˆfieldsï¼‰ æ³¨ï¼šå…¶ä¸­ types é€æ¸è¢«å¼ƒç”¨äº†ï¼Œ8.Xå°†è¢«åˆ é™¤ 6.2 ä¸€ä¸ªğŸŒ°ï¼š å¯¹åº”ä¸Šé¢æ•°æ®åº“ï¼š 6.3 è®¾è®¡elasticsearch(é›†ç¾¤)ä¸­å¯ä»¥åŒ…å«å¤šä¸ªç´¢å¼•(æ•°æ®åº“)ï¼Œæ¯ä¸ªç´¢å¼•ä¸­å¯ä»¥åŒ…å«å¤šä¸ªç±»å‹(è¡¨)ï¼Œæ¯ä¸ªç±»å‹ä¸‹åˆåŒ…å«å¤šä¸ªæ–‡æ¡£(è¡Œ)ï¼Œæ¯ä¸ªæ–‡æ¡£ä¸­åˆåŒ…å«å¤šä¸ªå­—æ®µ(åˆ—)ã€‚ ç‰©ç†è®¾è®¡ï¼š elasticsearch åœ¨åå°æŠŠæ¯ä¸ªç´¢å¼•åˆ’åˆ†æˆå¤šä¸ªåˆ†ç‰‡ï¼Œæ¯åˆ†åˆ†ç‰‡å¯ä»¥åœ¨é›†ç¾¤ä¸­çš„ä¸åŒæœåŠ¡å™¨é—´è¿ç§» ä¸€ä¸ªäººå°±æ˜¯ä¸€ä¸ªé›†ç¾¤ï¼é»˜è®¤çš„é›†ç¾¤åç§°å°±æ˜¯ elaticsearh å‚è€ƒä»¥ä¸‹ï¼š äº‘ä¸Šçš„é›†ç¾¤ é›†ç¾¤é‡Œçš„ç›’å­ èŠ‚ç‚¹ä¹‹é—´ ç´¢å¼•é‡Œçš„å°æ–¹å— åœ¨ ElasticSearch head ä¸­å¯ä»¥çœ‹è§é»˜è®¤é›†ç¾¤çš„åå­—ä¸ºï¼šelasticsearch é€»è¾‘è®¾è®¡ï¼š ä¸€ä¸ªç´¢å¼•ç±»å‹ä¸­ï¼ŒåŒ…å«å¤šä¸ªæ–‡æ¡£ï¼Œæ¯”å¦‚è¯´æ–‡æ¡£1ï¼Œæ–‡æ¡£2ã€‚ å½“æˆ‘ä»¬ç´¢å¼•ä¸€ç¯‡æ–‡æ¡£æ—¶ï¼Œå¯ä»¥é€šè¿‡è¿™æ ·çš„é¡ºåºæ‰¾åˆ°å®ƒ: ç´¢å¼• ----&gt; ç±»å‹ ----&gt; æ–‡æ¡£ID é€šè¿‡è¿™ä¸ªç»„åˆæˆ‘ä»¬å°±èƒ½ç´¢å¼•åˆ°æŸä¸ªå…·ä½“çš„æ–‡æ¡£ã€‚ æ³¨æ„ï¼šIDä¸å¿…æ˜¯æ•´æ•°ï¼Œå®é™…ä¸Šå®ƒæ˜¯ä¸ªå­—ç¬¦ä¸²ã€‚ 6.4 æ–‡æ¡£å°±æ˜¯æˆ‘ä»¬çš„ä¸€æ¡æ•°æ® ä¹‹å‰è¯´elasticsearchæ˜¯é¢å‘æ–‡æ¡£çš„ï¼Œé‚£ä¹ˆå°±æ„å‘³ç€ç´¢å¼•å’Œæœç´¢æ•°æ®çš„æœ€å°å•ä½æ˜¯æ–‡æ¡£ï¼Œelasticsearch ä¸­ï¼Œæ–‡æ¡£æœ‰å‡ ä¸ªé‡è¦å±æ€§ : è‡ªæˆ‘åŒ…å«ï¼Œä¸€ç¯‡æ–‡æ¡£åŒæ—¶åŒ…å«å­—æ®µå’Œå¯¹åº”çš„å€¼ï¼Œä¹Ÿå°±æ˜¯åŒæ—¶åŒ…å« keyï¼švalueï¼ å¯ä»¥æ˜¯å±‚æ¬¡å‹çš„ï¼Œä¸€ä¸ªæ–‡æ¡£ä¸­åŒ…å«è‡ªæ–‡æ¡£ï¼Œå¤æ‚çš„é€»è¾‘å®ä½“å°±æ˜¯è¿™ä¹ˆæ¥çš„ï¼å°±æ˜¯ä¸€ä¸ªjsonå¯¹è±¡ï¼ çµæ´»çš„ç»“æ„ï¼Œæ–‡æ¡£ä¸ä¾èµ–é¢„å…ˆå®šä¹‰çš„æ¨¡å¼ï¼Œæˆ‘ä»¬çŸ¥é“å…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œè¦æå‰å®šä¹‰å­—æ®µæ‰èƒ½ä½¿ç”¨ï¼Œ åœ¨elasticsearchä¸­ï¼Œå¯¹äºå­—æ®µæ˜¯éå¸¸çµæ´»çš„ï¼Œæœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å¿½ç•¥è¯¥å­—æ®µï¼Œæˆ–è€…åŠ¨æ€çš„æ·»åŠ ä¸€ä¸ªæ–°çš„å­—æ®µã€‚ å°½ç®¡æˆ‘ä»¬å¯ä»¥éšæ„çš„æ–°å¢æˆ–è€…å¿½ç•¥æŸä¸ªå­—æ®µï¼Œä½†æ˜¯ï¼Œæ¯ä¸ªå­—æ®µçš„ç±»å‹éå¸¸é‡è¦ï¼Œæ¯”å¦‚ä¸€ä¸ªå¹´é¾„å­—æ®µç±»å‹ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥æ˜¯æ•´å‹ã€‚å› ä¸ºelasticsearchä¼šä¿å­˜å­—æ®µå’Œç±»å‹ä¹‹é—´çš„æ˜ å°„åŠå…¶ä»–çš„è®¾ç½®ã€‚è¿™ç§æ˜ å°„å…·ä½“åˆ°æ¯ä¸ªæ˜ å°„çš„æ¯ç§ç±»å‹ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨elasticsearchä¸­ï¼Œç±»å‹æœ‰æ—¶å€™ä¹Ÿç§°ä¸ºæ˜ å°„ç±»å‹ ã€‚ 6.5 ç±»å‹â€‹ ç±»å‹æ˜¯æ–‡æ¡£çš„é€»è¾‘å®¹å™¨ï¼Œå°±åƒå…³ç³»å‹æ•°æ®åº“ä¸€æ ·ï¼Œè¡¨æ ¼æ˜¯è¡Œçš„å®¹å™¨ã€‚ ç±»å‹ä¸­å¯¹äºå­—æ®µçš„å®šä¹‰ç§°ä¸ºæ˜ å°„ï¼Œ æ¯”å¦‚ name æ˜ å°„ä¸ºå­—ç¬¦ä¸²ç±»å‹ã€‚ æˆ‘ä»¬è¯´æ–‡æ¡£æ˜¯æ— æ¨¡å¼çš„ï¼Œå®ƒä»¬ä¸éœ€è¦æ‹¥æœ‰æ˜ å°„ä¸­æ‰€å®šä¹‰çš„æ‰€æœ‰å­—æ®µï¼Œ æ¯”å¦‚æ–°å¢ä¸€ä¸ªå­—æ®µï¼Œé‚£ä¹ˆelasticsearchæ˜¯æ€ä¹ˆåšçš„å‘¢ï¼Ÿelasticsearchä¼šè‡ªåŠ¨çš„å°†æ–°å­—æ®µåŠ å…¥æ˜ å°„ï¼Œä½†æ˜¯è¿™ä¸ªå­—æ®µçš„ä¸ç¡®å®šå®ƒæ˜¯ä»€ä¹ˆç±»å‹ï¼Œelasticsearchå°±å¼€å§‹çŒœï¼Œå¦‚æœè¿™ä¸ªå€¼æ˜¯18ï¼Œé‚£ä¹ˆelasticsearchä¼šè®¤ä¸ºå®ƒæ˜¯æ•´å‹ã€‚ ä½†æ˜¯elasticsearchä¹Ÿå¯èƒ½çŒœä¸å¯¹ï¼Œ æ‰€ä»¥æœ€å®‰å…¨çš„æ–¹å¼å°±æ˜¯æå‰å®šä¹‰å¥½æ‰€éœ€è¦çš„æ˜ å°„ï¼Œè¿™ç‚¹è·Ÿå…³ç³»å‹æ•°æ®åº“æ®Šé€”åŒå½’äº†ï¼Œå…ˆå®šä¹‰å¥½å­—æ®µï¼Œç„¶åå†ä½¿ç”¨ã€‚ 6.6 ç´¢å¼•å°±æ˜¯æ•°æ®åº“ ç´¢å¼•æ˜¯æ˜ å°„ç±»å‹çš„å®¹å™¨ï¼Œelasticsearchä¸­çš„ç´¢å¼•æ˜¯ä¸€ä¸ªéå¸¸å¤§çš„æ–‡æ¡£é›†åˆã€‚ç´¢å¼•å­˜å‚¨äº†æ˜ å°„ç±»å‹çš„å­—æ®µå’Œå…¶ä»–è®¾ç½®ã€‚ ç„¶åå®ƒä»¬è¢«å­˜å‚¨åˆ°äº†å„ä¸ªåˆ†ç‰‡ä¸Šäº†ã€‚ æˆ‘ä»¬æ¥ç ”ç©¶ä¸‹åˆ†ç‰‡æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚ ä¸€ä¸ªé›†ç¾¤è‡³å°‘æœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè€Œä¸€ä¸ªèŠ‚ç‚¹å°±æ˜¯ä¸€ä¸ªelasricsearchè¿›ç¨‹ï¼ŒèŠ‚ç‚¹å¯ä»¥æœ‰å¤šä¸ªç´¢å¼•é»˜è®¤çš„ï¼Œå¦‚æœä½ åˆ›å»ºç´¢å¼•ï¼Œé‚£ä¹ˆç´¢å¼•å°†ä¼šæœ‰ä¸ª5ä¸ªåˆ†ç‰‡ ( primary shard ,åˆç§°ä¸»åˆ†ç‰‡ ) æ„æˆçš„ï¼Œæ¯ä¸€ä¸ªä¸»åˆ†ç‰‡ä¼šæœ‰ä¸€ä¸ªå‰¯æœ¬ ( replica shard ,åˆç§°å¤åˆ¶åˆ†ç‰‡ ) åœ¨ ElasticSearch head ä¸­å¯ä»¥çœ‹è§åˆšå»ºç«‹çš„ç´¢å¼•æ˜¯5ä¸ªåˆ†ç‰‡ï¼š 6.7 å€’æ’elasticsearchä½¿ç”¨çš„æ˜¯ä¸€ç§ç§°ä¸ºå€’æ’ç´¢å¼•çš„ç»“æ„ï¼Œé‡‡ç”¨Luceneå€’æ’ç´¢ä½œä¸ºåº•å±‚ã€‚è¿™ç§ç»“æ„é€‚ç”¨äºå¿«é€Ÿçš„å…¨æ–‡æœç´¢ï¼Œ ä¸€ä¸ªç´¢å¼•ç”±æ–‡æ¡£ä¸­æ‰€æœ‰ä¸é‡å¤çš„åˆ—è¡¨æ„æˆï¼Œå¯¹äºæ¯ä¸€ä¸ªè¯ï¼Œéƒ½æœ‰ä¸€ä¸ªåŒ…å«å®ƒçš„æ–‡æ¡£åˆ—è¡¨ã€‚ ä¾‹ å¦‚ï¼Œç°åœ¨æœ‰ä¸¤ä¸ªæ–‡æ¡£ï¼Œ æ¯ä¸ªæ–‡æ¡£åŒ…å«å¦‚ä¸‹å†…å®¹ï¼š Study every day, good good up to forever # æ–‡æ¡£1åŒ…å«çš„å†…å®¹To forever, study every day, good good up # æ–‡æ¡£2åŒ…å«çš„å†…å®¹ ä¸ºäº†åˆ›å»ºå€’æ’ç´¢å¼•ï¼Œæˆ‘ä»¬é¦–å…ˆè¦å°†æ¯ä¸ªæ–‡æ¡£æ‹†åˆ†æˆç‹¬ç«‹çš„è¯(æˆ–ç§°ä¸ºè¯æ¡æˆ–è€…tokens)ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªåŒ…å«æ‰€æœ‰ä¸é‡ å¤çš„è¯æ¡çš„æ’åºåˆ—è¡¨ï¼Œç„¶ååˆ—å‡ºæ¯ä¸ªè¯æ¡å‡ºç°åœ¨å“ªä¸ªæ–‡æ¡£ term doc_1 doc_2 Study âˆš X To X âˆš every âˆš âˆš forever âˆš âˆš day âˆš âˆš study X âˆš good âˆš âˆš every âˆš âˆš to âˆš X up âˆš âˆš ç°åœ¨ï¼Œæˆ‘ä»¬è¯•å›¾æœç´¢ to foreverï¼Œåªéœ€è¦æŸ¥çœ‹åŒ…å«æ¯ä¸ªè¯æ¡çš„æ–‡æ¡£ score term doc_1 doc_2 to âˆš X forever âˆš âˆš total 2 1 å¦‚æœæ²¡æœ‰åˆ«çš„æ¡ä»¶ï¼Œç°åœ¨ï¼Œè¿™ä¸¤ä¸ªåŒ…å«å…³é”®å­—çš„æ–‡æ¡£éƒ½å°†è¿”å›ã€‚ åœ¨elasticsearchä¸­ï¼Œ ç´¢å¼• ï¼ˆåº“ï¼‰è¿™ä¸ªè¯è¢«é¢‘ç¹ä½¿ç”¨ï¼Œè¿™å°±æ˜¯æœ¯è¯­çš„ä½¿ç”¨ã€‚ åœ¨elasticsearchä¸­ï¼Œç´¢å¼•è¢«åˆ†ä¸ºå¤šä¸ªåˆ†ç‰‡ï¼Œæ¯ä»½åˆ†ç‰‡æ˜¯ä¸€ä¸ªLuceneçš„ç´¢å¼•ã€‚æ‰€ä»¥ä¸€ä¸ªelasticsearchç´¢å¼•æ˜¯ç”±å¤šä¸ªLuceneç´¢å¼•ç»„æˆçš„ã€‚åˆ«é—®ä¸ºä»€ä¹ˆï¼Œè°è®©elasticsearchä½¿ç”¨Luceneä½œä¸ºåº•å±‚å‘¢! å¦‚æ— ç‰¹æŒ‡ï¼Œè¯´èµ·ç´¢å¼•éƒ½æ˜¯æŒ‡elasticsearch çš„ç´¢å¼•ã€‚ å…³ç³»å›¾ï¼š ä¸€ä¸ª ES ç´¢å¼• â€”â€“&gt; å¤šä¸ªåˆ†ç‰‡(shard) â€‹ ä¸€ä¸ªåˆ†ç‰‡(shard) â€”â€“&gt; ä¸€ä¸ª Lucene ç´¢å¼• ä¸€ä¸ª ES ç´¢å¼• â€”â€“&gt; â€”â€“&gt; å¤šä¸ª Lucene ç´¢å¼• ä¸ƒã€IKåˆ†è¯å™¨7.1 åˆ†è¯åˆ†è¯ï¼šå³æŠŠä¸€æ®µä¸­æ–‡æˆ–è€…åˆ«çš„åˆ’åˆ†æˆä¸€ä¸ªä¸ªçš„å…³é”®å­—ï¼Œæˆ‘ä»¬åœ¨æœç´¢æ—¶å€™ä¼šæŠŠè‡ªå·±çš„ä¿¡æ¯è¿›è¡Œåˆ†è¯ï¼Œä¼šæŠŠæ•°æ®åº“ä¸­æˆ–è€…ç´¢å¼•åº“ä¸­çš„æ•°æ®è¿›è¡Œåˆ†è¯ï¼Œç„¶åè¿›è¡Œä¸€ä¸ªåŒ¹é…æ“ä½œï¼Œé»˜è®¤çš„ä¸­æ–‡åˆ†è¯æ˜¯å°†æ¯ä¸ªå­—çœ‹æˆä¸€ä¸ª è¯ï¼Œæ¯”å¦‚ â€œæˆ‘æ˜¯ç‹å…«â€ ä¼šè¢«åˆ†ä¸ºâ€æˆ‘â€ã€â€œæ˜¯â€ã€â€œç‹â€ã€â€œå…«â€ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸ç¬¦åˆè¦æ±‚çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å®‰è£…ä¸­æ–‡åˆ†è¯å™¨ IK æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ IK æä¾›äº†ä¸¤ä¸ªåˆ†è¯ç®—æ³•ï¼šik_smart å’Œ ik_max_wordï¼Œå…¶ä¸­ ik_smart ä¸ºæœ€å°‘åˆ‡åˆ†ï¼Œik_max_wordä¸ºæœ€ç»†ç²’åº¦åˆ’åˆ†ï¼ 7.2 ä¸‹è½½å®‰è£…ä¸‹è½½åœ°å€ï¼šIK åˆ†è¯å™¨ä¸‹è½½ å®‰è£…ï¼šè§£å‹åæ”¾å…¥ plugins æ–‡ä»¶å¤¹ä¸‹ é‡å¯ ElasticSearch ï¼šçœ‹åˆ° IK åˆ†è¯å™¨å·²ç»åŠ è½½åˆ° ES é‡Œé¢äº† 7.3 IK åˆ†è¯å™¨çš„å°ğŸŒ°ï¼šä½¿ç”¨ ik_smart ç®—æ³•ï¼š æœ€å°‘åˆ‡åˆ† ä½¿ç”¨ ik_max_word ç®—æ³•ï¼š æœ€ç»†ç²’åº¦åˆ’åˆ†ï¼šé€šè¿‡å­—å…¸ï¼Œæ‰¾å¯»æ‰€æœ‰ç¬¦åˆçš„æƒ…å†µ 7.4 è‡ªè¡Œ DIY å­—å…¸åœ¨å‡ºç°ä»¥ä¸‹æƒ…å†µæ—¶ï¼šæˆ‘ä»¬éœ€è¦çš„æ˜¯ ç¥é­”æ‹ åº”è¯¥æ˜¯ä¸€ä¸ªè¯è¯­ï¼Œè€Œä¸åº”è¯¥è¢«åˆ†è¯ä¸º ç¥é­” ä¸ æ‹ åœ¨ IK çš„ config ç›®å½•ä¸‹ï¼Œé…ç½® wangba.dic å’Œ IKAnalyzer.cfg.xml å¦‚ä¸‹ï¼š IKAnalyzer.cfg.xmlï¼š wangba.dic: é‡å¯ ES å’Œ Kibanaï¼šå·²ç»å¯ä»¥çœ‹è§ wangba.dic å·²ç»åŠ è½½è¿›å»äº† æ­¤æ—¶åœ¨Kibanaä¸­å¯ä»¥çœ‹è§ï¼šæ­¤æ—¶ ç¥é­”æ‹ å·²ç»æ˜¯ä¸€ä¸ªè¯äº† å…«ã€Resté£æ ¼8.1 Restå‘½ä»¤è¯´æ˜è¯´æ˜ä¸€ç§è½¯ä»¶æ¶æ„é£æ ¼ï¼Œè€Œä¸æ˜¯æ ‡å‡†ï¼Œåªæ˜¯æä¾›äº†ä¸€ç»„è®¾è®¡åŸåˆ™å’Œçº¦æŸæ¡ä»¶ã€‚å®ƒä¸»è¦ç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨äº¤ äº’ç±»çš„è½¯ä»¶ã€‚åŸºäºè¿™ä¸ªé£æ ¼è®¾è®¡çš„è½¯ä»¶å¯ä»¥æ›´ç®€æ´ï¼Œæ›´æœ‰å±‚æ¬¡ï¼Œæ›´æ˜“äºå®ç°ç¼“å­˜ç­‰æœºåˆ¶ã€‚ åŸºæœ¬Restå‘½ä»¤è¯´æ˜ï¼š method urlåœ°å€ æè¿° PUT localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id åˆ›å»ºæ–‡æ¡£ï¼ˆæŒ‡å®šæ–‡æ¡£idï¼‰ POST localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§° åˆ›å»ºæ–‡æ¡£ï¼ˆéšæœºæ–‡æ¡£idï¼‰ _update localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id/_update ä¿®æ”¹æ–‡æ¡£ DELETE localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id åˆ é™¤æ–‡æ¡£ GET localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id æŸ¥è¯¢æ–‡æ¡£é€šè¿‡æ–‡æ¡£id POST localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/_search æŸ¥è¯¢æ‰€æœ‰æ•°æ® 8.2 åŸºæœ¬æµ‹è¯•åˆ›å»ºç´¢å¼•ï¼š PUT /ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id { â€‹ è¯·æ±‚ä½“ } æ³¨ï¼šç±»å‹å³å°†è¢«å¼ƒç”¨ åœ¨ ES head ä¸­å¯ä»¥çœ‹è§æ•°æ®å·²ç»æ’å…¥æˆåŠŸï¼š 8.3 ç±»å‹ å­—ç¬¦ä¸²ç±»å‹ text ã€ keyword æ•°å€¼ç±»å‹ longã€integerã€ shortã€byteã€doubleã€floatã€half_floatã€ scaled_float æ—¥æœŸç±»å‹ date å¸ƒå°”å€¼ç±»å‹ boolean äºŒè¿›åˆ¶ç±»å‹ binary è‡ªå®šä¹‰ç±»å‹ï¼š é€šè¿‡ GET è¯·æ±‚å¯ä»¥çœ‹è§ test2 ç´¢å¼•çš„ä¿¡æ¯ï¼š è‡ªåŠ¨åŒ¹é…ç±»å‹ï¼š 8.4 å…³äºç´¢å¼•çš„åŸºæœ¬æ“ä½œ å¢åŠ ï¼šå¦‚ä¸Š æŸ¥è¯¢ï¼šå¦‚ä¸Š ä¿®æ”¹ï¼šå¦‚ä¸‹ æ–¹æ³•ä¸€ï¼šç›´æ¥è¦†ç›– å¯ä»¥çœ‹è§ version å‘ç”Ÿäº†æ”¹å˜ æ–¹æ³•äºŒï¼š POST /ç´¢å¼•åç§°/_doc/æ–‡æ¡£id/__update { â€‹ è¯·æ±‚ä½“ } å¯ä»¥çœ‹è§ version å†æ¬¡å‘ç”Ÿäº†æ”¹å˜ åˆ é™¤ 8.5 å…³äºæ–‡æ¡£çš„åŸºæœ¬æ“ä½œåŸºæœ¬æ“ä½œï¼š å¢åŠ æ•°æ® PUT æŸ¥è¯¢æ•°æ® GET æ–¹å¼ä¸€ï¼šç®€å•çš„ ID æŸ¥è¯¢ å¯ä»¥çœ‹è§ï¼Œæ¨èä½¿ç”¨ GET /ç´¢å¼•/_doc/æ–‡æ¡£ID æ¥è¿›è¡Œæ“ä½œ æ–¹å¼äºŒï¼šç®€å•çš„æ¡ä»¶æŸ¥è¯¢ å¯ä»¥çœ‹è§ type å·²ç»è¢«ä¸¢å¼ƒäº† æ›´æ–°æ•°æ® POST å¯ä»¥çœ‹è§ï¼Œæ¨èä½¿ç”¨ POST /ç´¢å¼•/_update/æ–‡æ¡£ID æ¥è¿›è¡Œæ“ä½œ å¤æ‚æ“ä½œï¼šselect (æ’åºã€åˆ†é¡µã€é«˜äº®ã€æ¨¡ç³ŠæŸ¥è¯¢ã€ç²¾å‡†æŸ¥è¯¢ ) æŸ¥è¯¢ ES ä¸­æœ‰ zhangsan å’Œ zhangshan 008 ï¼Œé€šè¿‡å…³é”®å­—zhangsan æŸ¥è¯¢ï¼Œä¼šå°†åˆ†è¯åçš„ç»“æœå…¨éƒ¨æŸ¥è¯¢å‡ºæ¥ï¼Œä¸”æ¯ä¸€ä¸ªéƒ½æ˜¯æœ‰ _score çš„ã€‚ hitsï¼šåœ¨Javaå¯ä»¥å¾—åˆ°ç´¢å¼•å’Œæ–‡æ¡£çš„ä¿¡æ¯ã€æŸ¥è¯¢çš„ç»“æœæ€»æ•°ã€å…·ä½“æ–‡æ¡£æ•°æ®ä¿¡æ¯ï¼ˆå¯ä»¥é€šè¿‡éå†å¾—åˆ°å…·ä½“çš„å„ç§ä¿¡æ¯ï¼‰ é€šè¿‡ _source æ¥æŒ‡å®šæœ€åçš„è¾“å‡ºç»“æœ æ’åº é€šè¿‡ sort è¿›è¡Œæ’åºï¼Œç”¨ desc å’Œ asc æ¥è¿›è¡Œé™åºå’Œå‡åº åˆ†é¡µ /search/{current}/{pagesize} ç¬¬ä¸€é¡µä¸€ä¸ªæ•°æ® ç¬¬äºŒé¡µçš„ä¸€ä¸ªæ•°æ® ç¬¬ä¸€é¡µçš„ä¸¤ä¸ªæ•°æ® bool å€¼æŸ¥è¯¢ must å‘½ä»¤ == and should å‘½ä»¤ == or ä¸¤ä¸ªéƒ½æŸ¥è¯¢åˆ°äº† must_not å‘½ä»¤ == not filter å‘½ä»¤ gtï¼šå¤§äº / gteï¼šå¤§äºç­‰äº / ltï¼šå°äº / lteï¼šå°äºç­‰äº åŒ¹é…å¤šä¸ªæ¡ä»¶ ç›´æ¥åœ¨ tags ä¸­åŠ ç©ºæ ¼ ç²¾ç¡®æŸ¥è¯¢ term æŸ¥è¯¢æ˜¯ç›´æ¥é€šè¿‡å€’æ’ç´¢å¼•æŒ‡å®šçš„è¯æ¡è¿›è¡Œç²¾ç¡®çš„æŸ¥è¯¢ termï¼šç›´æ¥æŸ¥è¯¢ç²¾ç¡®çš„ matchï¼šä½¿ç”¨åˆ†è¯å™¨è§£æï¼ˆå…ˆåˆ†ææ–‡æ¡£ï¼Œåœ¨é€šè¿‡åˆ†æçš„æ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢ï¼‰ ä¸¤ä¸ªç±»å‹ï¼š textï¼š ä¼šè¢«åˆ†è¯è§£æå™¨è§£æ keywordï¼š ä¸ä¼šè¢«åˆ†è¯è§£æå™¨è§£æ ä½¿ç”¨ keywod åˆ†è¯å™¨ï¼š ä½¿ç”¨ standard åˆ†è¯å™¨ï¼š textï¼š å¯ä»¥çœ‹è§ä¸‹é¢è¢«åˆ†è¯äº†ï¼Œæ‰€ä»¥å‡ºç°äº†ä¸¤ä¸ªç»“æœ keywordï¼š å¯ä»¥çœ‹è§ä¸‹é¢æ²¡æœ‰è¢«åˆ†è¯ é«˜äº®æŸ¥è¯¢ ä¹ã€SpringBooté›†æˆElasticSearchå®˜æ–¹ ES Client æ–‡æ¡£ 1.ä¾èµ– 12345&lt;dependency&gt; &lt;groupId&gt;org.elasticsearch.client&lt;/groupId&gt; &lt;artifactId&gt;elasticsearch-rest-high-level-client&lt;/artifactId&gt; &lt;version&gt;7.6.2&lt;/version&gt;&lt;/dependency&gt; 2.æ‰¾å¯¹è±¡ 3.åˆ†æç±»ä¸­æ–¹æ³• ES çš„ç‰ˆæœ¬ä¸æœ¬æœºä¸­çš„ç‰ˆæœ¬ä¸ä¸€è‡´ è‡ªè¡Œé…ç½® SpringBoot ä¸­çš„ ES ç‰ˆæœ¬ RestClientAutoConfiguration å’Œ RestClientProperties 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104//// Source code recreated from a .class file by IntelliJ IDEA// (powered by Fernflower decompiler)//package org.springframework.boot.autoconfigure.elasticsearch.rest;import java.time.Duration;import org.apache.http.HttpHost;import org.apache.http.auth.AuthScope;import org.apache.http.auth.Credentials;import org.apache.http.auth.UsernamePasswordCredentials;import org.apache.http.client.CredentialsProvider;import org.apache.http.impl.client.BasicCredentialsProvider;import org.elasticsearch.client.RestClient;import org.elasticsearch.client.RestClientBuilder;import org.elasticsearch.client.RestHighLevelClient;import org.springframework.beans.factory.ObjectProvider;import org.springframework.boot.autoconfigure.condition.ConditionalOnClass;import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;import org.springframework.boot.context.properties.PropertyMapper;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;class RestClientConfigurations &#123; RestClientConfigurations() &#123; &#125; @Configuration( proxyBeanMethods = false ) // RestClient æ™®é€šå®¢æˆ·ç«¯ static class RestClientFallbackConfiguration &#123; RestClientFallbackConfiguration() &#123; &#125; @Bean @ConditionalOnMissingBean RestClient elasticsearchRestClient(RestClientBuilder builder) &#123; return builder.build(); &#125; &#125; @Configuration( proxyBeanMethods = false ) @ConditionalOnClass(&#123;RestHighLevelClient.class&#125;) // RestHighLevelClient é«˜çº§å®¢æˆ·ç«¯ static class RestHighLevelClientConfiguration &#123; RestHighLevelClientConfiguration() &#123; &#125; @Bean @ConditionalOnMissingBean RestHighLevelClient elasticsearchRestHighLevelClient(RestClientBuilder restClientBuilder) &#123; return new RestHighLevelClient(restClientBuilder); &#125; @Bean @ConditionalOnMissingBean RestClient elasticsearchRestClient(RestClientBuilder builder, ObjectProvider&lt;RestHighLevelClient&gt; restHighLevelClient) &#123; RestHighLevelClient client = (RestHighLevelClient)restHighLevelClient.getIfUnique(); return client != null ? client.getLowLevelClient() : builder.build(); &#125; &#125; @Configuration( proxyBeanMethods = false ) // RestClientBuilder static class RestClientBuilderConfiguration &#123; RestClientBuilderConfiguration() &#123; &#125; @Bean @ConditionalOnMissingBean RestClientBuilder elasticsearchRestClientBuilder(RestClientProperties properties, ObjectProvider&lt;RestClientBuilderCustomizer&gt; builderCustomizers) &#123; HttpHost[] hosts = (HttpHost[])properties.getUris().stream().map(HttpHost::create).toArray((x$0) -&gt; &#123; return new HttpHost[x$0]; &#125;); RestClientBuilder builder = RestClient.builder(hosts); PropertyMapper map = PropertyMapper.get(); map.from(properties::getUsername).whenHasText().to((username) -&gt; &#123; CredentialsProvider credentialsProvider = new BasicCredentialsProvider(); Credentials credentials = new UsernamePasswordCredentials(properties.getUsername(), properties.getPassword()); credentialsProvider.setCredentials(AuthScope.ANY, credentials); builder.setHttpClientConfigCallback((httpClientBuilder) -&gt; &#123; return httpClientBuilder.setDefaultCredentialsProvider(credentialsProvider); &#125;); &#125;); builder.setRequestConfigCallback((requestConfigBuilder) -&gt; &#123; properties.getClass(); map.from(properties::getConnectionTimeout).whenNonNull().asInt(Duration::toMillis).to(requestConfigBuilder::setConnectTimeout); properties.getClass(); map.from(properties::getReadTimeout).whenNonNull().asInt(Duration::toMillis).to(requestConfigBuilder::setSocketTimeout); return requestConfigBuilder; &#125;); builderCustomizers.orderedStream().forEach((customizer) -&gt; &#123; customizer.customize(builder); &#125;); return builder; &#125; &#125;&#125; åã€ç´¢å¼•ã€æ–‡æ¡£ API æ“ä½œ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289package com.wangba;import com.alibaba.fastjson.JSON;import com.wangba.enity.User;import org.apache.lucene.search.TermQuery;import org.apache.lucene.util.QueryBuilder;import org.elasticsearch.action.admin.indices.delete.DeleteIndexRequest;import org.elasticsearch.action.bulk.BulkRequest;import org.elasticsearch.action.bulk.BulkResponse;import org.elasticsearch.action.delete.DeleteRequest;import org.elasticsearch.action.delete.DeleteResponse;import org.elasticsearch.action.get.GetRequest;import org.elasticsearch.action.get.GetResponse;import org.elasticsearch.action.index.IndexRequest;import org.elasticsearch.action.index.IndexResponse;import org.elasticsearch.action.search.SearchRequest;import org.elasticsearch.action.search.SearchRequestBuilder;import org.elasticsearch.action.search.SearchResponse;import org.elasticsearch.action.support.master.AcknowledgedResponse;import org.elasticsearch.action.update.UpdateRequest;import org.elasticsearch.action.update.UpdateResponse;import org.elasticsearch.client.RequestOptions;import org.elasticsearch.client.RestHighLevelClient;import org.elasticsearch.client.indices.CreateIndexRequest;import org.elasticsearch.client.indices.CreateIndexResponse;import org.elasticsearch.client.indices.GetIndexRequest;import org.elasticsearch.common.unit.TimeValue;import org.elasticsearch.common.xcontent.XContentType;import org.elasticsearch.index.query.MatchAllQueryBuilder;import org.elasticsearch.index.query.QueryBuilders;import org.elasticsearch.index.query.TermQueryBuilder;import org.elasticsearch.search.SearchHit;import org.elasticsearch.search.builder.SearchSourceBuilder;import org.elasticsearch.search.fetch.subphase.FetchSourceContext;import org.junit.jupiter.api.Test;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.beans.factory.annotation.Qualifier;import org.springframework.boot.test.context.SpringBootTest;import org.springframework.data.repository.query.Param;import org.w3c.dom.ls.LSOutput;import java.io.IOException;import java.util.ArrayList;import java.util.concurrent.TimeUnit;@SpringBootTestclass SpringbootEsApiApplicationTests &#123; @Autowired @Qualifier(&quot;restHighLevelClient&quot;) private RestHighLevelClient client; /** * @Description: åˆ›å»ºç´¢å¼• * @Param: [] * @return: void * @Author: wang ba * @Date: 2020/7/29 */ @Test void createIndex() throws IOException &#123; // 1. åˆ›å»ºç´¢å¼•è¯·æ±‚ CreateIndexRequest request = new CreateIndexRequest(&quot;test&quot;); // 2. è®©å®¢æˆ·ç«¯æ‰§è¡Œè¯·æ±‚ indicesClient CreateIndexResponse createIndexResponse = client.indices().create(request, RequestOptions.DEFAULT); System.out.println(createIndexResponse); &#125; /** * @Description: æŸ¥è¯¢ç´¢å¼• * @Param: [] * @return: void * @Author: wang ba * @Date: 2020/7/29 */ @Test void existIndex() throws IOException &#123; GetIndexRequest request = new GetIndexRequest(&quot;test&quot;); boolean exists = client.indices().exists(request, RequestOptions.DEFAULT); System.out.println(exists); &#125; /** * @Description: åˆ é™¤ç´¢å¼• * @Param: [] * @return: void * @Author: wang ba * @Date: 2020/7/29 */ @Test void deleteIndex() throws IOException &#123; DeleteIndexRequest request = new DeleteIndexRequest(&quot;test&quot;); AcknowledgedResponse delete = client.indices().delete(request, RequestOptions.DEFAULT); System.out.println(delete); &#125; /** * @Description: æ·»åŠ æ–‡æ¡£ PUT test/_doc/1 * @Param: [] * @return: void * @Author: wang ba * @Date: 2020/7/29 */ @Test void addDocument() throws IOException &#123; // åˆ›å»ºå¯¹è±¡ User user = new User(&quot;wangba&quot;, 25); // åˆ›å»ºè¯·æ±‚ IndexRequest request = new IndexRequest(&quot;test&quot;); // è§„åˆ™ï¼š ==&gt; PUT test/_doc/1 request.id(&quot;1&quot;); request.timeout(&quot;1s&quot;); // å°†æˆ‘ä»¬çš„æ•°æ®æ”¾å…¥è¯·æ±‚ä¸­ JSONæ ¼å¼ request.source(JSON.toJSONString(user), XContentType.JSON); // å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œè¿”å›ç»“æœ IndexResponse indexResponse = client.index(request, RequestOptions.DEFAULT); System.out.println(indexResponse); System.out.println(indexResponse.toString()); System.out.println(indexResponse.status()); // å¯¹åº”çš„çŠ¶æ€å°±æ˜¯ CREATED ç­‰ &#125; /** * @Description: æ–‡æ¡£æ˜¯å¦å­˜åœ¨ * @Param: [] * @return: void * @Author: wang ba * @Date: 2020/7/29 */ @Test void existDocument() throws IOException &#123; // GET test/_doc/1 GetRequest request = new GetRequest(&quot;test&quot;, &quot;1&quot;); // _source ä¸æ˜¾ç¤ºä¸Šä¸‹æ–‡ request.fetchSourceContext(new FetchSourceContext(false)); request.storedFields(&quot;_none_&quot;); boolean exists = client.exists(request, RequestOptions.DEFAULT); System.out.println(exists); &#125; /** * @Description: æŸ¥è¯¢æ–‡æ¡£æ•°æ® GET test/_doc/1 * @Param: [] * @return: void * @Author: wang ba * @Date: 2020/7/29 */ @Test void getDocument() throws IOException &#123; GetRequest request = new GetRequest(&quot;test&quot;, &quot;1&quot;); GetResponse documentFields = client.get(request, RequestOptions.DEFAULT); System.out.println(documentFields.getSourceAsString()); System.out.println(documentFields); &#125; /** * @Description: æ›´æ–°æ–‡æ¡£ * @Param: [] * @return: void * @Author: wang ba * @Date: 2020/7/29 */ @Test void updateDocument() throws IOException &#123; UpdateRequest request = new UpdateRequest(&quot;test&quot;, &quot;1&quot;); User user = new User(&quot;zhansan&quot;, 22); request.doc(JSON.toJSONString(user), XContentType.JSON); UpdateResponse update = client.update(request, RequestOptions.DEFAULT); System.out.println(update); System.out.println(update.status()); &#125; /** * @Description: åˆ é™¤æ–‡æ¡£ DELETE test/_doc/1 * @Param: [] * @return: void * @Author: wang ba * @Date: 2020/7/29 */ @Test void deleteDocument() throws IOException &#123; DeleteRequest request = new DeleteRequest(&quot;test&quot;, &quot;1&quot;); DeleteResponse delete = client.delete(request, RequestOptions.DEFAULT); System.out.println(delete); &#125; /** * @Description: æ‰¹å¤„ç†è¯·æ±‚ * @Param: [] * @return: void * @Author: wang ba * @Date: 2020/7/29 */ @Test void addBulkDocument() throws IOException &#123; BulkRequest bulkRequest = new BulkRequest(); bulkRequest.timeout(&quot;10s&quot;); ArrayList&lt;User&gt; userArrayList = new ArrayList&lt;&gt;(); userArrayList.add(new User(&quot;zhangsan&quot;, 5)); userArrayList.add(new User(&quot;lisi&quot;, 10)); userArrayList.add(new User(&quot;xiaoxin&quot;, 25)); for (int i = 0; i &lt; userArrayList.size(); i++) &#123; bulkRequest.add( new IndexRequest(&quot;test&quot;) .id(&quot;&quot;+(i+1)) .source(JSON.toJSONString(userArrayList.get(i)), XContentType.JSON) ); &#125; BulkResponse bulk = client.bulk(bulkRequest, RequestOptions.DEFAULT); System.out.println(bulk); System.out.println(bulk.status()); System.out.println(bulk.hasFailures()); &#125; /** * @Description: æŒ‰æ¡ä»¶æœç´¢ * @Param: [] * @return: void * @Author: wang ba * @Date: 2020/7/29 */ /* æŸ¥è¯¢ï¼š SearchRequest æœç´¢è¯·æ±‚ SearchSourceBuilder æ¡ä»¶æ„é€  HighlightBuilder é«˜äº®æ„é€  TermQueryBuilder ç²¾ç¡®æŸ¥è¯¢ MatchAllQueryBuilder æ‰€æœ‰æŸ¥è¯¢ // xxxBuilder */ @Test void searchDocument() throws IOException &#123; // åˆ›å»ºæœç´¢è¯·æ±‚ SearchRequest searchRequest = new SearchRequest(&quot;test&quot;); // æ„é€ æœç´¢æ¡ä»¶ SearchSourceBuilder searchSourceBuilder = new SearchSourceBuilder(); // QueryBuilders.termQuery ç²¾ç¡®æŸ¥è¯¢ // QueryBuilders.matchAllQuery æŸ¥è¯¢æ‰€æœ‰ //TermQueryBuilder termQueryBuilder = QueryBuilders.termQuery(&quot;age&quot;, &quot;25&quot;); //searchSourceBuilder.query(termQueryBuilder); MatchAllQueryBuilder matchAllQueryBuilder = QueryBuilders.matchAllQuery(); searchSourceBuilder.query(matchAllQueryBuilder); // åˆ†é¡µ // searchSourceBuilder.from(); // searchSourceBuilder.size(); searchSourceBuilder.timeout(new TimeValue(60, TimeUnit.SECONDS)); searchRequest.source(searchSourceBuilder); SearchResponse search = client.search(searchRequest, RequestOptions.DEFAULT); System.out.println(JSON.toJSONString(search.getHits())); System.out.println(&quot;+++++++++++++æˆ‘æ˜¯åˆ†å‰²çº¿++++++++++++++&quot;); for (SearchHit documentFields : search.getHits().getHits()) &#123; System.out.println(documentFields.getSourceAsMap()); &#125; &#125;&#125; åä¸€ã€å®æˆ˜","categories":[],"tags":[{"name":"java","slug":"java","permalink":"http://wangba.me/tags/java/"},{"name":"ES","slug":"ES","permalink":"http://wangba.me/tags/ES/"}]}],"categories":[{"name":"é‡å­¦ç®—æ³•ç³»åˆ—","slug":"é‡å­¦ç®—æ³•ç³»åˆ—","permalink":"http://wangba.me/categories/%E9%87%8D%E5%AD%A6%E7%AE%97%E6%B3%95%E7%B3%BB%E5%88%97/"},{"name":"Spring BootçœŸçš„é¦™ç³»åˆ—","slug":"Spring-BootçœŸçš„é¦™ç³»åˆ—","permalink":"http://wangba.me/categories/Spring-Boot%E7%9C%9F%E7%9A%84%E9%A6%99%E7%B3%BB%E5%88%97/"},{"name":"WangBa's CookBook","slug":"WangBa-s-CookBook","permalink":"http://wangba.me/categories/WangBa-s-CookBook/"},{"name":"LeetCodeçœŸçš„éš¾ç³»åˆ—","slug":"LeetCodeçœŸçš„éš¾ç³»åˆ—","permalink":"http://wangba.me/categories/LeetCode%E7%9C%9F%E7%9A%84%E9%9A%BE%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"http://wangba.me/tags/Leetcode/"},{"name":"Algorithm","slug":"Algorithm","permalink":"http://wangba.me/tags/Algorithm/"},{"name":"Spring Boot","slug":"Spring-Boot","permalink":"http://wangba.me/tags/Spring-Boot/"},{"name":"Spring Security","slug":"Spring-Security","permalink":"http://wangba.me/tags/Spring-Security/"},{"name":"Session","slug":"Session","permalink":"http://wangba.me/tags/Session/"},{"name":"Java","slug":"Java","permalink":"http://wangba.me/tags/Java/"},{"name":"NoSQL","slug":"NoSQL","permalink":"http://wangba.me/tags/NoSQL/"},{"name":"CookBook","slug":"CookBook","permalink":"http://wangba.me/tags/CookBook/"},{"name":"Life","slug":"Life","permalink":"http://wangba.me/tags/Life/"},{"name":"MySQL","slug":"MySQL","permalink":"http://wangba.me/tags/MySQL/"},{"name":"SQL","slug":"SQL","permalink":"http://wangba.me/tags/SQL/"},{"name":"String","slug":"String","permalink":"http://wangba.me/tags/String/"},{"name":"Sliding Window","slug":"Sliding-Window","permalink":"http://wangba.me/tags/Sliding-Window/"},{"name":"Two pointer","slug":"Two-pointer","permalink":"http://wangba.me/tags/Two-pointer/"},{"name":"Array","slug":"Array","permalink":"http://wangba.me/tags/Array/"},{"name":"JSON","slug":"JSON","permalink":"http://wangba.me/tags/JSON/"},{"name":"æ³¨è§£","slug":"æ³¨è§£","permalink":"http://wangba.me/tags/%E6%B3%A8%E8%A7%A3/"},{"name":"java","slug":"java","permalink":"http://wangba.me/tags/java/"},{"name":"ES","slug":"ES","permalink":"http://wangba.me/tags/ES/"}]}