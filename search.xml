<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>0003.Longest Substring Without Repeating Characters</title>
      <link href="/2020/09/01/0003-Longest-Substring-Without-Repeating-Characters/"/>
      <url>/2020/09/01/0003-Longest-Substring-Without-Repeating-Characters/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="0003-æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²-Medium"><a href="#0003-æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²-Medium" class="headerlink" title="0003. æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸² Medium"></a><a href="https://leetcode-cn.com/problems/longest-substring-without-repeating-characters/">0003. æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²</a> <font color="#fd9016" size=5>Medium</font></h2><p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­ä¸å«æœ‰é‡å¤å­—ç¬¦çš„ <strong>æœ€é•¿å­ä¸²</strong> çš„é•¿åº¦ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: &quot;abcabcbb&quot;</span><br><span class="line">è¾“å‡º: 3 </span><br><span class="line">è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ &quot;abc&quot;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: &quot;bbbbb&quot;</span><br><span class="line">è¾“å‡º: 1</span><br><span class="line">è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ &quot;b&quot;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 1ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: &quot;pwwkew&quot;</span><br><span class="line">è¾“å‡º: 3</span><br><span class="line">è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ &quot;wke&quot;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚</span><br><span class="line"></span><br><span class="line">è¯·æ³¨æ„ï¼Œä½ çš„ç­”æ¡ˆå¿…é¡»æ˜¯ å­ä¸² çš„é•¿åº¦ï¼Œ&quot;pwke&quot; æ˜¯ä¸€ä¸ªå­åºåˆ—ï¼Œä¸æ˜¯å­ä¸²ã€‚</span><br></pre></td></tr></table></figure><h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p> ğŸ·ï¼šç¬¬ä¸€ä¸ªæƒ³æ³•å°±æ˜¯è¿™ä¸ªæ˜¯ä¸æ˜¯å’Œ KMP ç®—æ³•æœ‰é‚£ä¹ˆä¸€ç‚¹ç‚¹åƒçš„</p><p> åŠ›æ‰£ï¼šè®©ä½ è§è¯†ä¸€ä¸‹ï¼Œå€¼å¾—æˆ‘ä»¬å®˜ç½‘æœ‰ä¸€ä¸ªæ ‡ç­¾çš„æ€æƒ³ â€”â€”â€”&gt;  <code>Sliding Window</code> </p><p>ğŸ·ï¼šè¯´äººè¯</p><p>åŠ›æ‰£ï¼šå°±æ˜¯ <code>æ»‘åŠ¨çª—å£</code> å¤§æ³•ï¼Œä½ åé¢ä¼šçœ‹åˆ°å¾ˆå¤šæ¬¡è¿™ç§æ€æƒ³ï¼Œæƒ³ç»§ç»­çœ‹è¿™æ ·çš„é¢˜ï¼Œç‚¹<a href="https://leetcode-cn.com/tag/sliding-window/">è¿™é‡Œ</a>ï¼Œè¿˜æœ‰ä¸€äº›æš—å·ï¼š76ã€</p><p>438ã€567</p><blockquote><p>æ»‘åŠ¨çª—å£æ€æƒ³ï¼š</p><p>æ»‘åŠ¨çª—å£çš„å³è¾¹ç•Œä¸æ–­çš„å³ç§»ï¼Œåªè¦æ²¡æœ‰é‡å¤çš„å­—ç¬¦ï¼Œå°±æŒç»­å‘å³æ‰©å¤§çª—å£è¾¹ç•Œã€‚ä¸€æ—¦å‡ºç°äº†é‡å¤å­—ç¬¦ï¼Œå°±éœ€è¦ç¼©å°å·¦è¾¹ç•Œï¼Œç›´åˆ°é‡å¤çš„å­—ç¬¦ç§»å‡ºäº†å·¦è¾¹ç•Œï¼Œç„¶åç»§ç»­ç§»åŠ¨æ»‘åŠ¨çª—å£çš„å³è¾¹ç•Œã€‚ä»¥æ­¤ç±»æ¨ï¼Œæ¯æ¬¡ç§»åŠ¨éœ€è¦è®¡ç®—å½“å‰é•¿åº¦ï¼Œå¹¶åˆ¤æ–­æ˜¯å¦éœ€è¦æ›´æ–°æœ€å¤§é•¿åº¦ï¼Œæœ€ç»ˆæœ€å¤§çš„å€¼å°±æ˜¯é¢˜ç›®ä¸­çš„æ‰€æ±‚ã€‚</p></blockquote><p>ğŸ·ï¼šåº”è¯¥å°±æ˜¯åŒæŒ‡é’ˆçš„å˜å½¢ç‰ˆäº†â€¦â€¦..</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        Map&lt;Character, Integer&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        <span class="keyword">int</span> max = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; s.length(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (map.containsKey(s.charAt(i)))</span><br><span class="line">                j = Math.max(j, map.get(s.charAt(i)) + <span class="number">1</span>);</span><br><span class="line">            map.put(s.charAt(i), i);</span><br><span class="line">            max = Math.max(max, i - j + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> max;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Leetcode </tag>
            
            <tag> String </tag>
            
            <tag> Sliding Window </tag>
            
            <tag> Two pointer </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBootä¸­çš„è·¯å¾„æ˜ å°„</title>
      <link href="/2020/09/01/SpringBoot%E4%B8%AD%E7%9A%84%E8%B7%AF%E5%BE%84%E6%98%A0%E5%B0%84/"/>
      <url>/2020/09/01/SpringBoot%E4%B8%AD%E7%9A%84%E8%B7%AF%E5%BE%84%E6%98%A0%E5%B0%84/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä¸€ã€åœ¨-SpringBootä¸­ä½¿ç”¨-SSM-æ¡†æ¶ä¸­çš„æ˜ å°„"><a href="#ä¸€ã€åœ¨-SpringBootä¸­ä½¿ç”¨-SSM-æ¡†æ¶ä¸­çš„æ˜ å°„" class="headerlink" title="ä¸€ã€åœ¨ SpringBootä¸­ä½¿ç”¨ SSM æ¡†æ¶ä¸­çš„æ˜ å°„"></a>ä¸€ã€åœ¨ SpringBootä¸­ä½¿ç”¨ SSM æ¡†æ¶ä¸­çš„æ˜ å°„</h2><p>å†™ä¸‹å¦‚ä¸‹çš„ Controllerï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¹¶åœ¨ <code>resources/templates</code> ä¸­æ–°å»º <code>hello.html</code> </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, Spring Boot<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>æ³¨ï¼šåœ¨ SpringBoot ä¸­ï¼Œé»˜è®¤çš„é™æ€èµ„æºæ˜¯æ”¾åœ¨ä»¥ä¸‹å‡ ä¸ªä½ç½®ï¼š</p><ol><li>classpath:/META-INF/resources/</li><li>classpath:/resources/</li><li>classpath:/static/</li><li>classpath:/public/</li><li>/</li></ol><p>å…¶ä¸­ç¬¬ 5 ä¸ªè¡¨ç¤º webapp ç›®å½•ä¸­çš„é™æ€èµ„æºä¹Ÿä¸è¢«æ‹¦æˆª</p></blockquote><p>æ‰€ä»¥åœ¨è¿™é‡Œè¿™ä¸æ˜¯ä¸€ä¸ªé™æ€èµ„æºï¼Œæˆ‘ä»¬ä»¥å‰çš„åšæ³•å°±æ˜¯ç›´æ¥è¿”å›è¿™ä¸ªé¡µé¢ï¼Œæ²¡å†™ä¸Šé¢çš„ Controller ç›´æ¥ä½¿ç”¨ <a href="http://localhost:8080/hello">http://localhost:8080/hello</a> æ˜¯è®¿é—®ä¸åˆ°è¯¥é¡µé¢çš„</p><h2 id="äºŒã€åœ¨-SpringBoot-ä¸­è¿›è¡Œè·¯å¾„æ˜ å°„"><a href="#äºŒã€åœ¨-SpringBoot-ä¸­è¿›è¡Œè·¯å¾„æ˜ å°„" class="headerlink" title="äºŒã€åœ¨ SpringBoot ä¸­è¿›è¡Œè·¯å¾„æ˜ å°„"></a>äºŒã€åœ¨ SpringBoot ä¸­è¿›è¡Œè·¯å¾„æ˜ å°„</h2><p>åªéœ€è¦è¿›è¡Œå¦‚ä¸‹é…ç½®å°±å¯ä»¥è¿›è¡Œè·¯å¾„æ˜ å°„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebMvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> </span>&#123;</span><br><span class="line">        registry.addViewController(<span class="string">&quot;wangba&quot;</span>).setViewName(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†æ¬¡è®¿é—®ï¼š<a href="http://localhost:8080/wangba">http://localhost:8080/wangba</a></p><p>ç»“æœï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200901203239.png" alt="image-20200901203234294"></p>]]></content>
      
      
      
        <tags>
            
            <tag> SpringBoot </tag>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>0001.Two Sum</title>
      <link href="/2020/08/31/0001-Two-Sum/"/>
      <url>/2020/08/31/0001-Two-Sum/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="0001-ä¸¤æ•°ä¹‹å’Œ-Easy"><a href="#0001-ä¸¤æ•°ä¹‹å’Œ-Easy" class="headerlink" title="0001. ä¸¤æ•°ä¹‹å’Œ  Easy"></a><a href="https://leetcode-cn.com/problems/two-sum/">0001. ä¸¤æ•°ä¹‹å’Œ</a>  <font color="green" size=5>Easy</font></h2><p>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>nums</code> å’Œä¸€ä¸ªç›®æ ‡å€¼ <code>target</code>ï¼Œè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡ºå’Œä¸ºç›®æ ‡å€¼çš„é‚£ <strong>ä¸¤ä¸ª</strong> æ•´æ•°ï¼Œå¹¶è¿”å›ä»–ä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚</p><p>ä½ å¯ä»¥å‡è®¾æ¯ç§è¾“å…¥åªä¼šå¯¹åº”ä¸€ä¸ªç­”æ¡ˆã€‚ä½†æ˜¯ï¼Œæ•°ç»„ä¸­åŒä¸€ä¸ªå…ƒç´ ä¸èƒ½ä½¿ç”¨ä¸¤éã€‚</p><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ç»™å®š nums &#x3D; [2, 7, 11, 15], target &#x3D; 9</span><br><span class="line"></span><br><span class="line">å› ä¸º nums[0] + nums[1] &#x3D; 2 + 7 &#x3D; 9</span><br><span class="line">æ‰€ä»¥è¿”å› [0, 1]</span><br></pre></td></tr></table></figure><h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><blockquote><p>å‚»ç“œå¼æƒ³æ³•ï¼šéå†ä¸¤æ¬¡ï¼Œæ±‚å’Œï¼ˆå»é™¤é‡å¤çš„å…ƒç´ ï¼Œä½ç½®ä¸åŒçš„ç›¸ç­‰å…ƒç´ å¯ä»¥è¿›è¡Œè®¡ç®—ï¼‰</p><p>åŠ›æ‰£å†…å¿ƒOSï¼šä½ è¿™æ ·çš„æ—¶é—´å¤æ‚åº¦èƒ½è¿‡ç®—æˆ‘è¾“ï¼ï¼ï¼</p><p>ğŸ˜¯ï¼šå°±è¿™ï¼Œç•¥æ–½å°è®¡ï¼š<code>ç©ºé—´æ¢æ—¶é—´ä¹‹æœ¯</code> </p></blockquote><p>é¦–å…ˆï¼Œéå†ä¸€éæ•°ç»„å°†æ•°ç»„çš„å€¼æ”¾å…¥ Map ä¸­ï¼Œç„¶åå†éå†ä¸€æ¬¡ï¼Œå°† target - å–åˆ°çš„å€¼ï¼Œä½†æ˜¯è¦æ³¨æ„ä¸èƒ½ä»…ä»…åˆ¤æ–­æ˜¯</p><p>å¦å­˜åœ¨è¿™ä¸ªå€¼ï¼Œå› ä¸ºå¯èƒ½ä¼šå‡ºç°ä¸‹é¢è¿™ç§æƒ…å†µï¼štarget = 4ï¼Œè¯¥æ•°ç»„ä¸­å°±åªæœ‰ä¸€ä¸ª 2ï¼Œè¿™æ ·å°±ä¼šå‡ºé”™ã€‚æ‰€ä»¥è¿˜è¦åˆ¤æ–­</p><p>å–åˆ°çš„å€¼è¿˜ä¸èƒ½æ˜¯ç¬¬ä¸€æ¬¡çš„å…ƒç´ ã€‚</p><h2 id="ä»£ç ï¼š"><a href="#ä»£ç ï¼š" class="headerlink" title="ä»£ç ï¼š"></a>ä»£ç ï¼š</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] twoSum(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target) &#123;</span><br><span class="line">        <span class="keyword">int</span>[] res = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>];</span><br><span class="line">        HashMap&lt;Integer, Integer&gt; hashMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">            hashMap.put(nums[i], i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> temp = target - nums[i];</span><br><span class="line">            <span class="keyword">if</span> (hashMap.containsKey(temp) &amp;&amp; hashMap.get(temp) != i) &#123;</span><br><span class="line">                res[<span class="number">0</span>] = hashMap.get(temp);</span><br><span class="line">                res[<span class="number">1</span>] = i;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Leetcode </tag>
            
            <tag> Array </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBootä¸­çš„Servletã€Filterã€Listener</title>
      <link href="/2020/08/31/SpringBoot%E4%B8%AD%E7%9A%84Servlet%E3%80%81Filter%E3%80%81Listener/"/>
      <url>/2020/08/31/SpringBoot%E4%B8%AD%E7%9A%84Servlet%E3%80%81Filter%E3%80%81Listener/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä¸€ã€Servlet"><a href="#ä¸€ã€Servlet" class="headerlink" title="ä¸€ã€Servlet"></a>ä¸€ã€Servlet</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(urlPatterns = &quot;/MyServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;MyServlet&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>@WebServlet(urlPatterns = â€œ/MyServletâ€)ï¼šæŒ‡å®šServletæŒ‡å®šçš„ URL</p></blockquote><h2 id="äºŒã€Filter"><a href="#äºŒã€Filter" class="headerlink" title="äºŒã€Filter"></a>äºŒã€Filter</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebFilter(&quot;/*&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;MyFilter&quot;</span>);</span><br><span class="line">        chain.doFilter(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>@WebFilter(â€œ/*â€)ï¼šæŒ‡å®šè·¯å¾„è¿›è¡Œè¿‡æ»¤</p></blockquote><h2 id="ä¸‰ã€Listener"><a href="#ä¸‰ã€Listener" class="headerlink" title="ä¸‰ã€Listener"></a>ä¸‰ã€Listener</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebListener</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyListener</span> <span class="keyword">implements</span> <span class="title">ServletRequestListener</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">requestInitialized</span><span class="params">(ServletRequestEvent sre)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;requestInitialized.............&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">requestDestroyed</span><span class="params">(ServletRequestEvent sre)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;requestDestroyed................&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>@WebListenerï¼šæ ‡æ³¨ä¸ºç›‘å¬å™¨</p></blockquote><p><code>å¯ä»¥è‡ªè¡Œæµ‹è¯•ä¿®æ”¹è·¯ç”±è·¯å¾„ç­‰è¿›è¡Œæµ‹è¯•</code></p><h2 id="å››ã€åŒºåˆ«"><a href="#å››ã€åŒºåˆ«" class="headerlink" title="å››ã€åŒºåˆ«"></a>å››ã€åŒºåˆ«</h2><p>å¯åŠ¨ç»“æœï¼š<a href="http://localhost:8080/MyServlet">http://localhost:8080/MyServlet</a></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200831195105.png" alt="image-20200831195100184"></p><p>é…åˆå®˜æ–¹å›¾è§£é‡Šä¸€ä¸‹ï¼š</p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200831195155.png" alt="image-20200831195155569" style="zoom: 50%;" /><p>é¦–å…ˆæ˜¯ <strong><code>Listener</code></strong> ==&gt; <strong><code>Filter</code></strong> ==&gt; <strong><code>Servlet</code></strong> </p><p>ä¸‹é¢è¿˜æœ‰ä¸€æ¬¡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MyFilter</span><br><span class="line">requestDestroyed................</span><br></pre></td></tr></table></figure><p>å†æµè§ˆå™¨æ‰“å¼€æ§åˆ¶å°ï¼Œå¼ºåˆ¶åˆ·æ–°ä¸€ä¸‹ï¼šmacOS(å¿«æ·é”®ï¼šcommand + shift + R)ï¼Œå¯ä»¥çœ‹åˆ°ï¼š</p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200831195932.png" alt="image-20200831195932817" style="zoom: 200%;" /><p>æœ€ä¸‹é¢çš„é‚£ä¸ªæ˜¯æˆ‘çš„æµè§ˆå™¨æ‰©å±•åŠ è½½çš„è„šæœ¬</p>]]></content>
      
      
      
        <tags>
            
            <tag> SpringBoot </tag>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBootä¸­å®šä¹‰ç³»ç»Ÿå¯åŠ¨ä»»åŠ¡</title>
      <link href="/2020/08/22/SpringBoot%E4%B8%AD%E5%AE%9A%E4%B9%89%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E4%BB%BB%E5%8A%A1/"/>
      <url>/2020/08/22/SpringBoot%E4%B8%AD%E5%AE%9A%E4%B9%89%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E4%BB%BB%E5%8A%A1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä¸€ã€CommandLineRunner"><a href="#ä¸€ã€CommandLineRunner" class="headerlink" title="ä¸€ã€CommandLineRunner"></a>ä¸€ã€CommandLineRunner</h2><p>é€šè¿‡å®ç° <code>CommandLineRunner</code> æ¥å®šä¹‰å¯åŠ¨ä»»åŠ¡ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Order(1)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyCommandLineRunner</span> <span class="keyword">implements</span> <span class="title">CommandLineRunner</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(String... args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Order(1):&quot;</span> + Arrays.toString(args));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Order(2)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyCommandLineRunner01</span> <span class="keyword">implements</span> <span class="title">CommandLineRunner</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(String... args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Order(2):&quot;</span> + Arrays.toString(args));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼š</p><blockquote><ul><li><strong>@Order</strong> æ³¨è§£ä¸ºä¼˜å…ˆçº§ï¼Œæ•°å€¼è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼›</li><li><strong>args</strong> ä¸ºå¯åŠ¨ç±»ä¸­çš„ String[] argsï¼›</li><li><strong>args</strong> å‚æ•°å¯ä»¥åœ¨é…ç½®é‡Œé¢çš„ Program argumens è¿›è¡Œé…ç½®ï¼Œä¹Ÿå¯ä»¥æ‰“æˆ jar åŒ…çš„æ—¶å€™ï¼Œä½¿ç”¨å‘½ä»¤è¿›è¡Œè®¾ç½®</li></ul></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200821142114.png" alt="image-20200821142109335"></p><p>æœ€ç»ˆç»“æœå¦‚ä¸‹ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200821142416.png" alt="image-20200821142416869"></p><blockquote><p>å¯ä»¥çœ‹åˆ° Order(1) çš„ä¼˜å…ˆçº§é«˜äº Order(2)</p></blockquote><h2 id="äºŒã€ApplicationRunner"><a href="#äºŒã€ApplicationRunner" class="headerlink" title="äºŒã€ApplicationRunner"></a>äºŒã€ApplicationRunner</h2><p>é€šè¿‡å®ç° <code>ApplicationRunner</code> æ¥å®šä¹‰å¯åŠ¨ä»»åŠ¡ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Order(3)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyApplicationRunner</span> <span class="keyword">implements</span> <span class="title">ApplicationRunner</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(ApplicationArguments args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Order3:&quot;</span>);</span><br><span class="line">        String[] sourceArgs = args.getSourceArgs();</span><br><span class="line">        System.out.println(<span class="string">&quot;sourceArg:&quot;</span> + Arrays.toString(sourceArgs));</span><br><span class="line">        System.out.println(<span class="string">&quot;ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°&quot;</span>);</span><br><span class="line"></span><br><span class="line">        List&lt;String&gt; nonOptionArgs = args.getNonOptionArgs();</span><br><span class="line">        System.out.println(<span class="string">&quot;nonOptionArgs:&quot;</span> + nonOptionArgs);</span><br><span class="line">        System.out.println(<span class="string">&quot;ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Set&lt;String&gt; optionNames = args.getOptionNames();</span><br><span class="line">        <span class="keyword">for</span> (String optionName : optionNames) &#123;</span><br><span class="line">            System.out.println(optionName + args.getOptionValues(optionName));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Order(4)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyApplicationRunner01</span> <span class="keyword">implements</span> <span class="title">ApplicationRunner</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(ApplicationArguments args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Order4&quot;</span>);</span><br><span class="line">        String[] sourceArgs = args.getSourceArgs();</span><br><span class="line">        System.out.println(<span class="string">&quot;sourceArg:&quot;</span> + Arrays.toString(sourceArgs));</span><br><span class="line">        System.out.println(<span class="string">&quot;ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°&quot;</span>);</span><br><span class="line"></span><br><span class="line">        List&lt;String&gt; nonOptionArgs = args.getNonOptionArgs();</span><br><span class="line">        System.out.println(<span class="string">&quot;nonOptionArgs:&quot;</span> + nonOptionArgs);</span><br><span class="line">        System.out.println(<span class="string">&quot;ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Set&lt;String&gt; optionNames = args.getOptionNames();</span><br><span class="line">        <span class="keyword">for</span> (String optionName : optionNames) &#123;</span><br><span class="line">            System.out.println(optionName + args.getOptionValues(optionName));</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°ğŸŒ°&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><ol><li>args.getNonOptionArgs()ï¼šå¯ä»¥ç”¨æ¥è·å–å‘½ä»¤è¡Œä¸­çš„æ— keyå‚æ•°ï¼›</li><li>args.getOptionNames()ï¼šå¯ä»¥ç”¨æ¥è·å–æ‰€æœ‰key/valueå½¢å¼çš„å‚æ•°çš„keyï¼›</li><li>args.getOptionValues(key))ï¼šå¯ä»¥æ ¹æ®keyè·å–key/value å½¢å¼çš„å‚æ•°çš„valueï¼›</li><li>args.getSourceArgs();ï¼šåˆ™è¡¨ç¤ºè·å–å‘½ä»¤è¡Œä¸­çš„æ‰€æœ‰å‚æ•°ã€‚</li></ol></blockquote><p>å‚æ•°é…ç½®ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200821150447.png" alt="image-20200821150447765"></p><p>æœ€ç»ˆç»“æœï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200821150509.png" alt="image-20200821150509271"></p><blockquote><p>æ³¨ï¼š<code>CommandLineRunner</code> å’Œ <code>ApplicationRunner</code> æ˜¯å¯ä»¥ä¸€èµ·ç”¨çš„ï¼Œä¼˜å…ˆçº§è¿˜æ˜¯é€šè¿‡ <code>@Order</code> è¿›è¡Œæ’åº</p></blockquote><p>ç»“æœï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200821150916.png" alt="image-20200821150916948"></p>]]></content>
      
      
      
        <tags>
            
            <tag> SpringBoot </tag>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBootæ•´åˆè¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨</title>
      <link href="/2020/08/20/SpringBoot%E6%95%B4%E5%90%88%E8%BF%87%E6%BB%A4%E5%99%A8%E5%92%8C%E6%8B%A6%E6%88%AA%E5%99%A8/"/>
      <url>/2020/08/20/SpringBoot%E6%95%B4%E5%90%88%E8%BF%87%E6%BB%A4%E5%99%A8%E5%92%8C%E6%8B%A6%E6%88%AA%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä¸€ã€è¿‡æ»¤å™¨"><a href="#ä¸€ã€è¿‡æ»¤å™¨" class="headerlink" title="ä¸€ã€è¿‡æ»¤å™¨"></a>ä¸€ã€è¿‡æ»¤å™¨</h2><p>æ–°å»ºå¦‚ä¸‹çš„ Controllerï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;user/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">get</span><span class="params">(<span class="meta">@PathVariable</span> String id)</span> </span>&#123;</span><br><span class="line">        System.out.println(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤å™¨çš„å®ç°ï¼šå®šä¹‰ä¸€ä¸ªç±»å®ç° <code>Filter</code> ï¼Œå¹¶é‡å†™å…¶ä¸­çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@WebFilter(urlPatterns = &quot;/*&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TimeFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Initialization&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;++++++++ Start ++++++++&quot;</span>);</span><br><span class="line">        Long start = <span class="keyword">new</span> Date().getTime();</span><br><span class="line">        filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line">        System.out.println(<span class="string">&quot;Filter costs: &quot;</span>);</span><br><span class="line">        System.out.println(<span class="keyword">new</span> Date().getTime() - start);</span><br><span class="line">        System.out.println(<span class="string">&quot;++++++++ End ++++++++&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Filter is over&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>init æ–¹æ³•ï¼šæ˜¯å¯¹é¡¹ç›®å¯åŠ¨æ—¶ï¼Œè¿›è¡Œçš„åˆå§‹åŒ–</p><p>doFilter æ–¹æ³•ï¼šå½“æ‰§è¡Œä¸€ä¸ªè¯·æ±‚çš„æ—¶å€™ï¼Œè¿›è¡Œè¿‡æ»¤</p><p>destroy æ–¹æ³•ï¼šå½“è¿™ä¸ªé¡¹ç›®å…³é—­æ—¶ï¼Œè¯¥è¿‡æ»¤å™¨ä¹Ÿè¢«é”€æ¯äº†</p></blockquote><p>æµè§ˆå™¨è¿è¡Œï¼š<a href="http://localhost:8080/user/666">http://localhost:8080/user/666</a></p><p>ç»“æœï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200820151800.png" alt="image-20200820151800190"></p><p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å‡ºç°äº†ä¸€ç‚¹é—®é¢˜ï¼š</p><p>å½“æˆ‘ä»¬è¿›è¡Œä¸‹é¢è¿™ç§è¿‡æ»¤ä¸€éƒ¨åˆ†çš„æƒ…å†µä¸‹ï¼š</p><p><code>TimeFilter</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@WebFilter(urlPatterns = &#123;&quot;/user/*&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TimeFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        System.out.println(filterConfig.getServletContext().getContextPath());</span><br><span class="line">        System.out.println(<span class="string">&quot;Initialization........&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;++++++++ Start ++++++++&quot;</span>);</span><br><span class="line">        Long start = <span class="keyword">new</span> Date().getTime();</span><br><span class="line">        filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line">        System.out.println(<span class="string">&quot;Filter costs: &quot;</span>);</span><br><span class="line">        System.out.println(<span class="keyword">new</span> Date().getTime() - start);</span><br><span class="line">        System.out.println(<span class="string">&quot;++++++++ End ++++++++&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Filter is over&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>UserController</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;user/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">get</span><span class="params">(<span class="meta">@PathVariable</span> String id)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;userIDï¼š&quot;</span> +id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>HelloController</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;hello&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶æˆ‘ä»¬è¿‡æ»¤çš„æ˜¯ <code>/user</code> åé¢æ‰€æœ‰çš„è¯·æ±‚ï¼Œä½†æ˜¯ç»“æœæ˜¯ <code>UserController</code> å’Œ <code>HelloController</code> éƒ½è¿›å…¥äº†è¿‡æ»¤å™¨ä¸­ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200820202233.png" alt="image-20200820194717715"></p><p>æœ€ç»ˆè§£å†³æ–¹æ¡ˆï¼šå»æ‰åœ¨ <code>TimeFilter</code> ä¸­çš„ <strong>@Component</strong> æ³¨è§£ï¼Œåœ¨å¯åŠ¨ç±»ä¸ŠåŠ ä¸Š <strong>@ServletComponentScan</strong> æ³¨è§£å³å¯ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200820202230.png" alt="image-20200820194815278"></p><p>åœ¨ä¸Šé¢æˆ‘ä»¬ä½¿ç”¨äº†æ³¨è§£çš„æ–¹å¼è¿›è¡Œè¿‡æ»¤ï¼š</p><blockquote><p>@WebFilter(urlPatterns = â€œ/*â€)</p></blockquote><p>ç¬¬äºŒç§æ–¹å¼ï¼š</p><p>å»æ‰  <strong>@Component</strong> å’Œ *<em>@WebFilter(urlPatterns = {â€œ/user/</em>â€œ})** æ³¨è§£ï¼Œå¹¶é…ç½®å¦‚ä¸‹çš„é…ç½®ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> FilterRegistrationBean <span class="title">timeFilter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        FilterRegistrationBean filterRegistrationBean = <span class="keyword">new</span> FilterRegistrationBean();</span><br><span class="line">        TimeFilter timeFilter = <span class="keyword">new</span> TimeFilter();</span><br><span class="line">        filterRegistrationBean.setFilter(timeFilter);</span><br><span class="line"></span><br><span class="line">        List&lt;String&gt; urlList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        urlList.add(<span class="string">&quot;/user/*&quot;</span>);</span><br><span class="line"></span><br><span class="line">        filterRegistrationBean.setUrlPatterns(urlList);</span><br><span class="line">        <span class="keyword">return</span> filterRegistrationBean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="äºŒã€æ‹¦æˆªå™¨"><a href="#äºŒã€æ‹¦æˆªå™¨" class="headerlink" title="äºŒã€æ‹¦æˆªå™¨"></a>äºŒã€æ‹¦æˆªå™¨</h2><p>ç¼–å†™ä¸€ä¸ªæ‹¦æˆªå™¨ç±»å®ç° <code>HandlerInterceptor</code> ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TimeInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å¤„ç†æ‹¦æˆªä¹‹å‰&quot;</span>);</span><br><span class="line">        request.setAttribute(<span class="string">&quot;startTime&quot;</span>, <span class="keyword">new</span> Date().getTime());</span><br><span class="line">        System.out.println(((HandlerMethod) handler).getBean().getClass().getName());</span><br><span class="line">        System.out.println(((HandlerMethod) handler).getMethod().getName());</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å¼€å§‹å¤„ç†æ‹¦æˆª&quot;</span>);</span><br><span class="line">        Long start = (Long) request.getAttribute(<span class="string">&quot;startTime&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;ã€æ‹¦æˆªå™¨ã€‘è€—æ—¶ &quot;</span> + (<span class="keyword">new</span> Date().getTime() - start));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å¤„ç†æ‹¦æˆªä¹‹å&quot;</span>);</span><br><span class="line">        Long start = (Long) request.getAttribute(<span class="string">&quot;startTime&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;ã€æ‹¦æˆªå™¨ã€‘è€—æ—¶ &quot;</span> + (<span class="keyword">new</span> Date().getTime() - start));</span><br><span class="line">        System.out.println(<span class="string">&quot;å¼‚å¸¸ä¿¡æ¯ &quot;</span> + ex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><code>preHandle</code> æ–¹æ³•åœ¨å¤„ç†æ‹¦æˆªä¹‹å‰æ‰§è¡Œ</p><p><code>postHandle </code>æ–¹æ³•åªæœ‰å½“è¢«æ‹¦æˆªçš„æ–¹æ³•æ²¡æœ‰æŠ›å‡ºå¼‚å¸¸æˆåŠŸæ—¶æ‰ä¼šå¤„ç†</p><p><code>afterCompletion</code> æ–¹æ³•æ— è®ºè¢«æ‹¦æˆªçš„æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ä¸å¦éƒ½ä¼šæ‰§è¡Œ</p></blockquote><p>å°†æˆ‘ä»¬å†™å¥½çš„æ‹¦æˆªå™¨æ³¨å†Œåˆ°å®¹å™¨ä¸­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InterceptorConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    TimeInterceptor timeInterceptor;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> </span>&#123;</span><br><span class="line">        registry.addInterceptor(timeInterceptor).addPathPatterns(<span class="string">&quot;/user/*&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ ·åˆ†åˆ«è¿è¡Œï¼š<a href="http://localhost:8080/user/888">http://localhost:8080/user/888</a> å’Œ <a href="http://localhost:8080/hello">http://localhost:8080/hello</a></p><p>å¯ä»¥çœ‹è§ç»“æœå¦‚ä¸‹ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200820202209.png" alt="image-20200820202151954"></p><p>åªæ˜¯å¯¹ <strong>user/888</strong> è¿›è¡Œæ‹¦æˆªäº†ï¼Œå¯¹ <strong>hello</strong> æ²¡æœ‰è¿›è¡Œæ‹¦æˆª</p><h2 id="ä¸‰ã€è¿‡æ»¤å™¨ä¸æ‹¦æˆªå™¨çš„å¯¹æ¯”"><a href="#ä¸‰ã€è¿‡æ»¤å™¨ä¸æ‹¦æˆªå™¨çš„å¯¹æ¯”" class="headerlink" title="ä¸‰ã€è¿‡æ»¤å™¨ä¸æ‹¦æˆªå™¨çš„å¯¹æ¯”"></a>ä¸‰ã€è¿‡æ»¤å™¨ä¸æ‹¦æˆªå™¨çš„å¯¹æ¯”</h2><p>æˆ‘ä»¬å†å°†å‰é¢çš„è¿‡æ»¤å™¨åŠ å…¥å…¶ä¸­ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200820202751.png" alt="image-20200820202751525"></p><p>æœ‰ä¸€å¼ å·²ç»æ•´ç†å¥½æ‰§è¡Œé¡ºåºå›¾ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200820202854.png" alt="32361-20180530095349427-444141538"></p>]]></content>
      
      
      
        <tags>
            
            <tag> SpringBoot </tag>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBootä¸­è·¨åŸŸé—®é¢˜</title>
      <link href="/2020/08/20/SpringBoot%E4%B8%AD%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98/"/>
      <url>/2020/08/20/SpringBoot%E4%B8%AD%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä¸€ã€åŒæºç­–ç•¥"><a href="#ä¸€ã€åŒæºç­–ç•¥" class="headerlink" title="ä¸€ã€åŒæºç­–ç•¥"></a>ä¸€ã€åŒæºç­–ç•¥</h2><p>â€‹        åŒæºç­–ç•¥æ˜¯ç”± Netscape æå‡ºçš„ä¸€ä¸ªè‘—åçš„å®‰å…¨ç­–ç•¥ï¼Œå®ƒæ˜¯æµè§ˆå™¨æœ€æ ¸å¿ƒä¹Ÿæœ€åŸºæœ¬çš„å®‰å…¨åŠŸèƒ½ï¼Œç°åœ¨æ‰€æœ‰æ”¯æŒ JavaScript çš„æµè§ˆå™¨éƒ½ä¼šä½¿ç”¨è¿™ä¸ªç­–ç•¥ã€‚æ‰€è°“åŒæºæ˜¯æŒ‡åè®®ã€åŸŸåä»¥åŠç«¯å£è¦ç›¸åŒã€‚åŒæºç­–ç•¥æ˜¯åŸºäºå®‰å…¨æ–¹é¢çš„è€ƒè™‘æå‡ºæ¥çš„ï¼Œè¿™ä¸ªç­–ç•¥æœ¬èº«æ²¡é—®é¢˜ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨å®é™…å¼€å‘ä¸­ï¼Œç”±äºå„ç§åŸå› åˆç»å¸¸æœ‰è·¨åŸŸçš„éœ€æ±‚ï¼Œä¼ ç»Ÿçš„è·¨åŸŸæ–¹æ¡ˆæ˜¯ JSONPï¼ŒJSONP è™½ç„¶èƒ½è§£å†³è·¨åŸŸä½†æ˜¯æœ‰ä¸€ä¸ªå¾ˆå¤§çš„å±€é™æ€§ï¼Œé‚£å°±æ˜¯åªæ”¯æŒ GET è¯·æ±‚ï¼Œä¸æ”¯æŒå…¶ä»–ç±»å‹çš„è¯·æ±‚ï¼Œè€Œ CORSï¼ˆè·¨åŸŸæºèµ„æºå…±äº«ï¼‰ï¼ˆCORSï¼ŒCross-origin resource sharingï¼‰æ˜¯ä¸€ä¸ª W3C æ ‡å‡†ï¼Œå®ƒæ˜¯ä¸€ä»½æµè§ˆå™¨æŠ€æœ¯çš„è§„èŒƒï¼Œæä¾›äº† Web æœåŠ¡ä»ä¸åŒç½‘åŸŸä¼ æ¥æ²™ç›’è„šæœ¬çš„æ–¹æ³•ï¼Œä»¥é¿å¼€æµè§ˆå™¨çš„åŒæºç­–ç•¥ï¼Œè¿™æ˜¯ JSONP æ¨¡å¼çš„ç°ä»£ç‰ˆã€‚åœ¨ Spring æ¡†æ¶ä¸­ï¼Œå¯¹äº CORS ä¹Ÿæä¾›äº†ç›¸åº”çš„è§£å†³æ–¹æ¡ˆï¼Œ SpringBoot ä¸­å¦‚ä½•å®ç° CORSã€‚</p><h2 id="äºŒã€å¦‚ä½•å‡ºç°"><a href="#äºŒã€å¦‚ä½•å‡ºç°" class="headerlink" title="äºŒã€å¦‚ä½•å‡ºç°"></a>äºŒã€å¦‚ä½•å‡ºç°</h2><p>å¯åŠ¨ä¸¤ä¸ª SpringBoot é¡¹ç›®ï¼Œåˆ†åˆ«ä»¥ 8080 å’Œ 8081 ç«¯å£å¯åŠ¨ï¼Œåœ¨å…¶ä¸­ä¸€ä¸ªå†™ä¸Šå¦‚ä¸‹çš„ Controllerï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;get hello&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;post hello&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨å¦ä¸€ä¸ªä¸­å†™å…¥ä¸€ä¸ªé™æ€é¡µé¢ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.w3.org/1999/xhtml&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;jquery-3.5.1.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;btnClick()&quot;</span> <span class="attr">value</span>=<span class="string">&quot;get_button&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;btnClick2()&quot;</span> <span class="attr">value</span>=<span class="string">&quot;post_button&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">btnClick</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        $.get(<span class="string">&#x27;http://localhost:8080/hello&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">msg</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            $(<span class="string">&quot;#app&quot;</span>).html(msg);</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">btnClick2</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        $.post(<span class="string">&#x27;http://localhost:8080/hello&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">msg</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            $(<span class="string">&quot;#app&quot;</span>).html(msg);</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>æ³¨ï¼šè®°å¾—å¼•å…¥ Jquery</p></blockquote><p>åœ¨ <a href="http://localhost:8081/hello.html">http://localhost:8081/hello.html</a> ç‚¹å‡»ä»»ä½•è¯·æ±‚ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200820133233.png" alt="image-20200820133227549"></p><p>å¯ä»¥çœ‹åˆ°æ­¤æ—¶å·²ç»å‘ç”Ÿè·¨åŸŸé—®é¢˜</p><h2 id="ä¸‰ã€è§£å†³æ–¹æ¡ˆ"><a href="#ä¸‰ã€è§£å†³æ–¹æ¡ˆ" class="headerlink" title="ä¸‰ã€è§£å†³æ–¹æ¡ˆ"></a>ä¸‰ã€è§£å†³æ–¹æ¡ˆ</h2><p>ä»åç«¯è§£å†³ï¼Œä¿®æ”¹ Controller ä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@CrossOrigin(origins = &quot;http://localhost:8081&quot;)</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;post hello&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@CrossOrigin(value = &quot;http://localhost:8081&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;get hello&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å…¶ä¸­ origins ä¸ value æ•ˆæœä¸€æ ·ï¼Œçœ‹æºç å¯ä»¥çŸ¥é“å®ƒä»¬äº’ç›¸æˆä¸ºå¯¹æ–¹çš„åˆ«å</p></blockquote><p>æ­¤æ—¶å·²ç»ä¸ä¼šå‡ºç°è·¨åŸŸé—®é¢˜</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200820134429.png" alt="image-20200820134429094"></p><h2 id="å››ã€åŠ å¼ºç‰ˆè§£å†³"><a href="#å››ã€åŠ å¼ºç‰ˆè§£å†³" class="headerlink" title="å››ã€åŠ å¼ºç‰ˆè§£å†³"></a>å››ã€åŠ å¼ºç‰ˆè§£å†³</h2><p>æ­¤æ—¶ï¼Œåœ¨æ¯ä¸€ä¸ªç±»æˆ–è€…æ–¹æ³•ä¸Šéƒ½ä½¿ç”¨è¿™ä¸ªæ³¨è§£ï¼Œæ³•å¤–ç‹‚å¾’å¼ ä¸‰éƒ½è§‰å¾—è¿™ä¸ªå¤ªéº»çƒ¦äº†</p><p>åªéœ€è¦é…ç½®ä¸€ä¸ªå®ç° <code>WebMvcConfigurer</code> é…ç½®ç±»ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CORSConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> </span>&#123;</span><br><span class="line">        registry.addMapping(<span class="string">&quot;/**&quot;</span>).allowedOrigins(<span class="string">&quot;http://localhost:8081&quot;</span>)</span><br><span class="line">                .allowedMethods(<span class="string">&quot;*&quot;</span>)</span><br><span class="line">                .allowedHeaders(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨ï¼š<code>/**</code> è¡¨ç¤ºæœ¬åº”ç”¨çš„æ‰€æœ‰æ–¹æ³•éƒ½ä¼šå»å¤„ç†è·¨åŸŸè¯·æ±‚ï¼›allowedMethods è¡¨ç¤ºå…è®¸é€šè¿‡çš„è¯·æ±‚æ•°ï¼›allowedHeaders åˆ™è¡¨ç¤ºå…è®¸çš„è¯·æ±‚å¤´ã€‚</p></blockquote><h2 id="äº”ã€å®‰å…¨é—®é¢˜"><a href="#äº”ã€å®‰å…¨é—®é¢˜" class="headerlink" title="äº”ã€å®‰å…¨é—®é¢˜"></a>äº”ã€å®‰å…¨é—®é¢˜</h2><p>å‡ºç°äº†ä¸€ä¸ªç‹å…«è€æœ¬è¡Œçš„é—®é¢˜ï¼šé€šè¿‡ Ajax å‘é€è·¨åŸŸè¯·æ±‚ï¼Œè™½ç„¶ç”¨æˆ·ä½“éªŒæé«˜äº†ï¼Œä½†æ˜¯ä¹Ÿæœ‰æ½œåœ¨çš„å¨èƒå­˜åœ¨ï¼Œå¸¸è§çš„å°±æ˜¯ CSRFï¼ˆCross-site request forgeryï¼‰è·¨ç«™è¯·æ±‚ä¼ªé€ ã€‚</p><blockquote><p>ä¸€å¥è¯ï¼šåˆ©ç”¨æˆ‘ä»¬è¿˜åœ¨ç™»å½•çš„çŠ¶æ€ï¼Œå³ Cookie æœ‰æ•ˆï¼Œæ‰“å¼€ä¸€ä¸ªæ­£å¸¸ç½‘ç«™ï¼Œè€Œè¿™ä¸ªç½‘ç«™ä¸Šå¯èƒ½æœ‰ä¸€ä¸ªéæ­£å¸¸æ“ä½œ ( å›¾ç‰‡ï¼Œé“¾æ¥ç­‰) ï¼Œé‚£ä½ å°±å¯èƒ½å·²ç»è¢«æ”»å‡»ã€‚</p></blockquote><p>åœ¨ä¿¡æ¯å®‰å…¨ä¸­ï¼Œæˆ‘ä»¬é˜²å¾¡ CSRF çš„æ–¹æ³•ä¸»è¦æ˜¯å¢åŠ  Tokenï¼Œè¿™ä¹Ÿæ˜¯ç°åœ¨å¤§å¤šæ•°é˜²å¾¡ CSRF çš„æ–¹å¼ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> SpringBoot </tag>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBootä¸­è‡ªå®šä¹‰å¼‚å¸¸</title>
      <link href="/2020/08/19/SpringBoot%E4%B8%AD%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8/"/>
      <url>/2020/08/19/SpringBoot%E4%B8%AD%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä¸€ã€æ­£å¸¸å‡ºç°å¼‚å¸¸"><a href="#ä¸€ã€æ­£å¸¸å‡ºç°å¼‚å¸¸" class="headerlink" title="ä¸€ã€æ­£å¸¸å‡ºç°å¼‚å¸¸"></a>ä¸€ã€æ­£å¸¸å‡ºç°å¼‚å¸¸</h2><p>Controllerï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ErrorController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/diyError&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">error</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">2</span> / <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;diyError&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200819140914.png" alt="image-20200819140914040"></p><blockquote><p>å¯ä»¥çœ‹è§æ­¤é”™è¯¯é¡µæ˜¯ SpringBoot æä¾›çš„ï¼Œç”±äºæˆ‘ä»¬æ²¡æœ‰æä¾› /error é¡µé¢ï¼Œé¡ºä¾¿å±•ç¤ºæˆ‘ä»¬å‡ºç°çš„é”™è¯¯</p></blockquote><h2 id="äºŒã€é™æ€é¡µé¢å¼‚å¸¸"><a href="#äºŒã€é™æ€é¡µé¢å¼‚å¸¸" class="headerlink" title="äºŒã€é™æ€é¡µé¢å¼‚å¸¸"></a>äºŒã€é™æ€é¡µé¢å¼‚å¸¸</h2><p>åœ¨ <code>static</code> ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª <code>error</code> ç›®å½•ï¼Œå¹¶åœ¨å…¶ä¸­æ–°å»º 404.html å’Œ 500.htmlï¼š</p><p><code>404.html:</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>404<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code> 500.htmlï¼š</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>500<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å†æ¬¡è®¿é—® <a href="http://localhost:8080/diyError">http://localhost:8080/diyError</a></p><p>å¯ä»¥çœ‹è§å·²ç»è¿›å…¥è‡ªå®šä¹‰çš„é™æ€é¡µé¢äº†ï¼š<br><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200819142425.png" alt="image-20200819142425408"></p><p>å†è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„é¡µé¢ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200819142448.png" alt="image-20200819142448711"></p><blockquote><p>æ³¨ï¼šä¹Ÿå¯ä»¥åªå®šä¹‰  4xx.html ä¸ 5xx.html çš„é™æ€é¡µé¢ï¼Œåªè¦å‘ç”Ÿ 400-499 çš„çŠ¶æ€ç æˆ–è€… 500-599 çš„çŠ¶æ€ç å°±å¯¹åº” 4xx.html ä¸ 5xx.html çš„ç»“æœ</p></blockquote><h2 id="ä¸‰ã€åŠ¨æ€é¡µé¢å¼‚å¸¸"><a href="#ä¸‰ã€åŠ¨æ€é¡µé¢å¼‚å¸¸" class="headerlink" title="ä¸‰ã€åŠ¨æ€é¡µé¢å¼‚å¸¸"></a>ä¸‰ã€åŠ¨æ€é¡µé¢å¼‚å¸¸</h2><p>å¼•å…¥ thymeleaf çš„ä¾èµ–ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨ <code>templates</code> ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª <code>error</code> ç›®å½•ï¼Œå¹¶åœ¨å…¶ä¸­æ–°å»º 404.htmlã€ 500.htmlã€ 4xx.htmlã€5xx.html ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200819144108.png" alt="image-20200819144108160"></p><p>å†æ¬¡è®¿é—® <a href="http://localhost:8080/diyError">http://localhost:8080/diyError</a></p><p>å¯ä»¥çœ‹è§å·²ç»è¿›å…¥è‡ªå®šä¹‰çš„åŠ¨æ€é¡µé¢äº†ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200819144234.png" alt="image-20200819144234652"></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200819144308.png" alt="image-20200819144308646"></p><blockquote><p>ä¼˜å…ˆçº§ï¼š</p><ul><li>å¦‚æœæœ‰ 404 çš„é¡µé¢ï¼Œä¼šå…ˆæ‰¾ 404.htmlï¼›å¦‚æœæ²¡æœ‰å°±ä¼šæ‰¾ 4xx.html</li><li>å¦‚æœåŠ¨æ€é¡µé¢å’Œé™æ€é¡µé¢åŒæ—¶å­˜åœ¨ï¼Œä¼šä¼˜å…ˆä½¿ç”¨åŠ¨æ€é¡µé¢</li></ul><p>å®Œæ•´é¡ºåºå¤§æ¦‚å¦‚ä¸‹ï¼š</p><p>å‘ç”Ÿäº†500é”™è¯¯ â€“&gt; æŸ¥æ‰¾åŠ¨æ€ 500.html é¡µé¢ â€“&gt; æŸ¥æ‰¾é™æ€ 500.html  â€“&gt; æŸ¥æ‰¾åŠ¨æ€ 5xx.html â€“&gt; æŸ¥æ‰¾é™æ€ 5xx.html</p></blockquote><h2 id="å››ã€SpringBoot-æ€ä¹ˆè‡ªåŠ¨é…ç½®"><a href="#å››ã€SpringBoot-æ€ä¹ˆè‡ªåŠ¨é…ç½®" class="headerlink" title="å››ã€SpringBoot æ€ä¹ˆè‡ªåŠ¨é…ç½®"></a>å››ã€SpringBoot æ€ä¹ˆè‡ªåŠ¨é…ç½®</h2><p>å…³é”®ç±»ï¼š<code>ErrorMvcAutoConfiguration</code> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration(proxyBeanMethods = false)</span></span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">DefaultErrorViewResolverConfiguration</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">final</span> ApplicationContext applicationContext;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">final</span> ResourceProperties resourceProperties;</span><br><span class="line"></span><br><span class="line">   DefaultErrorViewResolverConfiguration(ApplicationContext applicationContext,</span><br><span class="line">         ResourceProperties resourceProperties) &#123;</span><br><span class="line">      <span class="keyword">this</span>.applicationContext = applicationContext;</span><br><span class="line">      <span class="keyword">this</span>.resourceProperties = resourceProperties;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Bean</span></span><br><span class="line">   <span class="meta">@ConditionalOnBean(DispatcherServlet.class)</span></span><br><span class="line">   <span class="meta">@ConditionalOnMissingBean(ErrorViewResolver.class)</span></span><br><span class="line">  <span class="comment">// é»˜è®¤çš„é”™è¯¯è§†å›¾è§£æå™¨ DefaultErrorViewResolver</span></span><br><span class="line">   <span class="function">DefaultErrorViewResolver <span class="title">conventionErrorViewResolver</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> DefaultErrorViewResolver(<span class="keyword">this</span>.applicationContext, <span class="keyword">this</span>.resourceProperties);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨é»˜è®¤çš„é”™è¯¯è§†å›¾è§£æå™¨ <code>DefaultErrorViewResolver</code> ä¸­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">resolveErrorView</span><span class="params">(HttpServletRequest request, HttpStatus status, Map&lt;String, Object&gt; model)</span> </span>&#123;</span><br><span class="line">   ModelAndView modelAndView = resolve(String.valueOf(status.value()), model);</span><br><span class="line">   <span class="keyword">if</span> (modelAndView == <span class="keyword">null</span> &amp;&amp; SERIES_VIEWS.containsKey(status.series())) &#123;</span><br><span class="line">      modelAndView = resolve(SERIES_VIEWS.get(status.series()), model);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> modelAndView;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœ modelAndView ä¸ºç©ºï¼Œå³æ²¡æ‰¾åˆ°å¯¹åº”çš„å…·ä½“ 404.htmlï¼Œå°±ä¼šç”¨ SERIES_VIEWS.containsKey(status.series())      æ‰¾ 4xx.html </p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> ModelAndView <span class="title">resolve</span><span class="params">(String viewName, Map&lt;String, Object&gt; model)</span> </span>&#123;</span><br><span class="line">   String errorViewName = <span class="string">&quot;error/&quot;</span> + viewName;</span><br><span class="line">   TemplateAvailabilityProvider provider = <span class="keyword">this</span>.templateAvailabilityProviders.getProvider(errorViewName,</span><br><span class="line">         <span class="keyword">this</span>.applicationContext);</span><br><span class="line">   <span class="keyword">if</span> (provider != <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(errorViewName, model);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> resolveResource(errorViewName, model);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><ul><li>åˆ¤æ–­ error æ–‡ä»¶å¤¹ä¸‹é¢æ˜¯å¦æœ‰å¯¹åº”çš„çŠ¶æ€ç çš„æ–‡æ¡£</li><li>å†åˆ¤æ–­æ˜¯å¦æœ‰åŠ¨æ€é¡µé¢ï¼Œå³ TemplateAvailabilityProvider</li><li>å¦‚æœæ˜¯åŠ¨æ€é¡µé¢ï¼Œå°±è¿”å›åŠ¨æ€é¡µé¢ï¼›å¦åˆ™è¿”å›é™æ€é¡µé¢</li></ul></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> ModelAndView <span class="title">resolveResource</span><span class="params">(String viewName, Map&lt;String, Object&gt; model)</span> </span>&#123;</span><br><span class="line">   <span class="keyword">for</span> (String location : <span class="keyword">this</span>.resourceProperties.getStaticLocations()) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">         Resource resource = <span class="keyword">this</span>.applicationContext.getResource(location);</span><br><span class="line">         resource = resource.createRelative(viewName + <span class="string">&quot;.html&quot;</span>);</span><br><span class="line">         <span class="keyword">if</span> (resource.exists()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="keyword">new</span> HtmlResourceView(resource), model);</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="äº”ã€è‡ªå®šä¹‰å¼‚å¸¸æ•°æ®"><a href="#äº”ã€è‡ªå®šä¹‰å¼‚å¸¸æ•°æ®" class="headerlink" title="äº”ã€è‡ªå®šä¹‰å¼‚å¸¸æ•°æ®"></a>äº”ã€è‡ªå®šä¹‰å¼‚å¸¸æ•°æ®</h2><p>åœ¨ <code>ErrorMvcAutoConfiguration</code> ä¸­ï¼Œå¤„ç†å¼‚å¸¸æ•°æ®çš„æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean(value = ErrorAttributes.class, search = SearchStrategy.CURRENT)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> DefaultErrorAttributes <span class="title">errorAttributes</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">new</span> DefaultErrorAttributes();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ <code>DefaultErrorAttributes()</code> ä¸­é€šè¿‡è®¾ç½®å‚æ•°å¾—åˆ°ç›¸åº”çš„ç»“æœ</p><p>ä¾‹å¦‚ï¼šå°† error ä¸­çš„ 5xx.html æ”¹ä¸ºï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>5xx<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>path<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;path&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>error<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;error&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>message<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;message&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>timestamp<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;timestamp&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>status<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;status&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>trace<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;trace&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ä»”è¿è¡Œç»“æœï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200819162419.png" alt="image-20200819162419826"></p><p>å†çœ‹ä¸€ä¸‹ä½¿ <code>DefaultErrorAttributes</code> ç”Ÿæ•ˆçš„æ¡ä»¶ï¼š</p><blockquote><p>@ConditionalOnMissingBean(value = ErrorAttributes.class, search = SearchStrategy.CURRENT)</p></blockquote><p>æ‰€ä»¥åªè¦æˆ‘ä»¬è‡ªå®šä¹‰ <code>ErrorAttributes.class</code> å°±å¯ä»¥å®ç°è‡ªå·±å®šä¹‰çš„å¼‚å¸¸æ•°æ®å¤„ç†</p><p>è‡ªå®šä¹‰ ErrorAttributes æœ‰ä¸¤ç§æ–¹å¼ ï¼š</p><ol><li>ç›´æ¥å®ç° ErrorAttributes æ¥å£</li><li>ç»§æ‰¿ DefaultErrorAttributesï¼ˆæ¨èï¼‰ï¼Œå› ä¸º DefaultErrorAttributes ä¸­å¯¹å¼‚å¸¸æ•°æ®çš„å¤„ç†å·²ç»å®Œæˆï¼Œå¼€å‘è€…å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</li></ol><p>æ–°å»ºä¸€ä¸ªé…ç½®ç±»ç»§æ‰¿ <code>DefaultErrorAttributes</code> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyErrorConfig</span> <span class="keyword">extends</span> <span class="title">DefaultErrorAttributes</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title">getErrorAttributes</span><span class="params">(WebRequest webRequest, ErrorAttributeOptions options)</span> </span>&#123;</span><br><span class="line">        Map&lt;String, Object&gt; errorAttributes = <span class="keyword">super</span>.getErrorAttributes(webRequest, options);</span><br><span class="line">        errorAttributes.put(<span class="string">&quot;myerror&quot;</span>, <span class="string">&quot;è‡ªå®šä¹‰å¼‚å¸¸&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> errorAttributes;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ 5xx.html ä¸­åŠ å…¥ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>myerror<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;myerror&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼šå¯ä»¥çœ‹åˆ°æ­¤æ—¶çš„è‡ªå®šä¹‰çš„ error å·²ç»åŠ å…¥</p>]]></content>
      
      
      
        <tags>
            
            <tag> SpringBoot </tag>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBootæ•´åˆJSON</title>
      <link href="/2020/08/18/SpringBoot%E6%95%B4%E5%90%88JSON/"/>
      <url>/2020/08/18/SpringBoot%E6%95%B4%E5%90%88JSON/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä¸€ã€Jackson"><a href="#ä¸€ã€Jackson" class="headerlink" title="ä¸€ã€Jackson"></a>ä¸€ã€Jackson</h2><h3 id="1-ç¯å¢ƒæ­å»º"><a href="#1-ç¯å¢ƒæ­å»º" class="headerlink" title="1. ç¯å¢ƒæ­å»º"></a>1. ç¯å¢ƒæ­å»º</h3><p>åªè¦åŠ å…¥æ™®é€šçš„ Web ä¾èµ–å°±è¡Œï¼Œä¸ºäº†æ–¹ä¾¿ä¾ç„¶å¼•å…¥ Lombok å’Œ çƒ­éƒ¨ç½²</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200817142417.png" alt="image-20200817142417630"></p><p>æ‰“å¼€ Maven ä¾èµ–å¯ä»¥çœ‹è§</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200817142731.png" alt="image-20200817142731779"></p><blockquote><p>SpringBoot è‡ªå¸¦çš„å°±æ˜¯ jackson</p></blockquote><h3 id="2-SpringBootä¸­ä½¿ç”¨"><a href="#2-SpringBootä¸­ä½¿ç”¨" class="headerlink" title="2. SpringBootä¸­ä½¿ç”¨"></a>2. SpringBootä¸­ä½¿ç”¨</h3><p>2.1 å»ºç«‹å®ä½“ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line">    <span class="keyword">private</span> Date date;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2.2  Controllerå±‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/user&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">getUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;User&gt; users = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++) &#123;</span><br><span class="line">            User user = <span class="keyword">new</span> User();</span><br><span class="line">            user.setId(i);</span><br><span class="line">            user.setName(<span class="string">&quot;wang&quot;</span> + i);</span><br><span class="line">            user.setAddress(<span class="string">&quot;shanghai&quot;</span> + i);</span><br><span class="line">            user.setDate(<span class="keyword">new</span> Date());</span><br><span class="line">            users.add(user);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> users;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2.3 ç»“æœï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200817144557.png" alt="image-20200817144557760"></p><h3 id="3-æ·±å…¥äº†è§£-Springboot-ä¸­çš„-JSON-è½¬æ¢"><a href="#3-æ·±å…¥äº†è§£-Springboot-ä¸­çš„-JSON-è½¬æ¢" class="headerlink" title="3. æ·±å…¥äº†è§£ Springboot ä¸­çš„ JSON è½¬æ¢"></a>3. æ·±å…¥äº†è§£ Springboot ä¸­çš„ JSON è½¬æ¢</h3><p>æ€è€ƒï¼š</p><ol><li><p>å‰ç«¯ä¼ å…¥çš„ json æ•°æ®å¦‚ä½•è¢«è§£ææˆ Java å¯¹è±¡ä½œä¸º APIå…¥å‚</p></li><li><p>API è¿”å›ç»“æœåˆå¦‚ä½•å°† Java å¯¹è±¡è§£ææˆ json æ ¼å¼æ•°æ®è¿”å›ç»™å‰ç«¯</p></li></ol><p>å…³é”®ç±»ï¼š<code>HttpMessageConverter</code></p><blockquote><p>å®˜æ–¹åŸè¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Strategy interface that specifies a converter that can convert from and to HTTP requests and responses.</span><br></pre></td></tr></table></figure></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200817150036.png" alt="image-20200817150036913"></p><p>ä» Structure ä¸­å¯ä»¥çœ‹è§ä¸€å…±æœ‰äº”ä¸ªæ–¹æ³•ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200817150448.png" alt="image-20200817150448857"></p><p>canReadï¼šæ¥æ”¶åˆ°è¯·æ±‚æ—¶åˆ¤æ–­æ˜¯å¦èƒ½è¯»</p><p>canWriteï¼šè¿”å›ç»“æœæ—¶åˆ¤æ–­æ˜¯å¦èƒ½å†™</p><p>getSupportedMediaTypesï¼šè·å–æ”¯æŒçš„ MediaType</p><p>readï¼šèƒ½è¯»åˆ™è¯»</p><p>writeï¼šèƒ½å†™åˆ™å†™</p><blockquote><p>æ³¨ï¼šåœ¨å‰é¢æˆ‘ä»¬æ²¡æœ‰å†™ä»»ä½•é…ç½®ä¹Ÿèƒ½å®ç°è½¬æ¢ï¼Œæ˜¯ç”±äºå…¶ä¸­æœ‰ç¼ºçœé…ç½®</p><p>å¯ä»¥åœ¨ <code>WebMvcConfigurationSupport </code> ä¸­æŸ¥çœ‹</p></blockquote><h3 id="4-è‡ªå®šä¹‰-JSON-é…ç½®"><a href="#4-è‡ªå®šä¹‰-JSON-é…ç½®" class="headerlink" title="4.è‡ªå®šä¹‰ JSON é…ç½®"></a>4.è‡ªå®šä¹‰ JSON é…ç½®</h3><p>æ–¹å¼ä¸€ï¼šåœ¨éœ€è¦è½¬æ¢çš„å±æ€§ä¸ŠåŠ ä¸Šæ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Date date;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200817152735.png" alt="image-20200817152735887"></p><p>æ–¹å¼äºŒï¼š</p><p>é…ç½®ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JsonConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function">MappingJackson2HttpMessageConverter <span class="title">mappingJackson2HttpMessageConverter</span> <span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        MappingJackson2HttpMessageConverter converter = <span class="keyword">new</span> MappingJackson2HttpMessageConverter();</span><br><span class="line">        ObjectMapper objectMapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">        objectMapper.setDateFormat(<span class="keyword">new</span> SimpleDateFormat(<span class="string">&quot;yyyy-MM-dd-HH:mm:ss&quot;</span>));</span><br><span class="line">        converter.setObjectMapper(objectMapper);</span><br><span class="line">        <span class="keyword">return</span> converter;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200817154209.png" alt="image-20200817154209854"></p><p>ä½¿ç”¨ä¸‹é¢çš„é…ç½®ç±»ä¹Ÿå¯ä»¥ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JsonConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    @Bean</span></span><br><span class="line"><span class="comment">//    MappingJackson2HttpMessageConverter mappingJackson2HttpMessageConverter () &#123;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        MappingJackson2HttpMessageConverter converter = new MappingJackson2HttpMessageConverter();</span></span><br><span class="line"><span class="comment">//        ObjectMapper objectMapper = new ObjectMapper();</span></span><br><span class="line"><span class="comment">//        objectMapper.setDateFormat(new SimpleDateFormat(&quot;yyyy-MM-dd-HH:mm:ss&quot;));</span></span><br><span class="line"><span class="comment">//        converter.setObjectMapper(objectMapper);</span></span><br><span class="line"><span class="comment">//        return converter;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function">ObjectMapper <span class="title">objectMapper</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ObjectMapper objectMapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">        objectMapper.setDateFormat(<span class="keyword">new</span> SimpleDateFormat(<span class="string">&quot;yyyy-MM-dd&quot;</span>));</span><br><span class="line">        <span class="keyword">return</span> objectMapper;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200817154533.png" alt="image-20200817154533630"></p><h3 id="5-Gson-å’Œ-Fastjson"><a href="#5-Gson-å’Œ-Fastjson" class="headerlink" title="5.Gson å’Œ Fastjson"></a>5.Gson å’Œ Fastjson</h3><p>å¦‚æœæƒ³è¦å’Œ Jackson ä¸€æ ·è‡ªå®šä¹‰é…ç½®ï¼š</p><p>åªéœ€è¦é…ç½®ï¼š<code>GsonHttpMessageConverter</code> å’Œ <code>FastJsonHttpMessageConverter</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> SpringBoot </tag>
            
            <tag> JSON </tag>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ControllerAdviceæ³¨è§£çš„ä½¿ç”¨</title>
      <link href="/2020/08/18/ControllerAdvice%E6%B3%A8%E8%A7%A3%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
      <url>/2020/08/18/ControllerAdvice%E6%B3%A8%E8%A7%A3%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä¸€ã€ç”¨æ³•"><a href="#ä¸€ã€ç”¨æ³•" class="headerlink" title="ä¸€ã€ç”¨æ³•"></a>ä¸€ã€ç”¨æ³•</h2><ol><li>å¤„ç†å…¨å±€å¼‚å¸¸</li><li>é¢„è®¾å…¨å±€æ•°æ®</li><li>è¯·æ±‚å‚æ•°é¢„å¤„ç†</li></ol><h2 id="äºŒã€å¤„ç†å…¨å±€å¼‚å¸¸"><a href="#äºŒã€å¤„ç†å…¨å±€å¼‚å¸¸" class="headerlink" title="äºŒã€å¤„ç†å…¨å±€å¼‚å¸¸"></a>äºŒã€å¤„ç†å…¨å±€å¼‚å¸¸</h2><p>æˆ‘ä»¬åªéœ€è¦åœ¨ <strong>application.properties</strong>ä¸­é…ç½®ï¼šspring.servlet.multipart.max-file-size=1KB</p><p>å°±å¯ä»¥çœ‹è§åœ¨ä¸Šä¼ å›¾ç‰‡æ—¶å°±ä¼šæŠ¥ 500 å¼‚å¸¸ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200818200228.png" alt="image-20200818200222467"></p><p>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥è‡ªå·±è‡ªå®šä¹‰å¤„ç† è¿™ç§å¼‚å¸¸ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyException</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler(MaxUploadSizeExceededException.class)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myException</span><span class="params">(MaxUploadSizeExceededException e, HttpServletResponse response)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        response.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">        PrintWriter writer = response.getWriter();</span><br><span class="line">        writer.write(<span class="string">&quot;ä¸Šä¼ å¤§å°é™åˆ¶ä¸º1KB&quot;</span>);</span><br><span class="line">        writer.flush();</span><br><span class="line">        writer.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¸‰ã€é¢„è®¾å…¨å±€æ•°æ®"><a href="#ä¸‰ã€é¢„è®¾å…¨å±€æ•°æ®" class="headerlink" title="ä¸‰ã€é¢„è®¾å…¨å±€æ•°æ®"></a>ä¸‰ã€é¢„è®¾å…¨å±€æ•°æ®</h2><p>è®¾ç½®å…¨å±€å˜é‡ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GlobalData</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ModelAttribute(value = &quot;data&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title">map</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">&quot;wangyi&quot;</span>, <span class="string">&quot;ç‹ä¸€&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;wangba&quot;</span>, <span class="string">&quot;ç‹å…«&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> map;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å–å‡ºè®¾ç½®çš„å€¼ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;hello&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(Model model)</span> </span>&#123;</span><br><span class="line">        Map&lt;String, Object&gt; map = model.asMap();</span><br><span class="line">        Set&lt;String&gt; set = map.keySet();</span><br><span class="line">        <span class="keyword">for</span> (String s : set) &#123;</span><br><span class="line">            System.out.println(s + <span class="string">&quot;:&quot;</span> + map.get(s));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200818203200.png" alt="image-20200818203200239"></p><h2 id="å››ã€è¯·æ±‚å‚æ•°é¢„å¤„ç†"><a href="#å››ã€è¯·æ±‚å‚æ•°é¢„å¤„ç†" class="headerlink" title="å››ã€è¯·æ±‚å‚æ•°é¢„å¤„ç†"></a>å››ã€è¯·æ±‚å‚æ•°é¢„å¤„ç†</h2><p>å®ä½“ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> price;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Author</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Controller:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/book&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">book</span><span class="params">(Book book, Author author)</span> </span>&#123;</span><br><span class="line">        System.out.println(book);</span><br><span class="line">        System.out.println(author);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ Postman è¿›è¡Œæµ‹è¯•ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200818204743.png" alt="image-20200818204743394"></p><p>å¾—åˆ°æœ€ç»ˆç»“æœä¸ºï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200818204824.png" alt="image-20200818204824095"></p><p>å½“å‡ºç°ç›¸åŒå‚æ•°æ—¶ï¼Œå¹¶ä¸èƒ½åˆ†æ¸…æ¥šå‚æ•°å±äºå“ªä¸ªå¯¹è±¡ï¼Œåªèƒ½å°†å‚æ•°èµ‹å€¼ç»™æ¯ä¸€ä¸ªæ‹¥æœ‰ç›¸åŒå‚æ•°çš„å¯¹è±¡</p><p>å¤„ç†ï¼š</p><p>Controllerï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/book&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">book</span><span class="params">(<span class="meta">@ModelAttribute(&quot;b&quot;)</span> Book book,</span></span></span><br><span class="line"><span class="function"><span class="params">                     <span class="meta">@ModelAttribute(&quot;a&quot;)</span> Author author)</span> </span>&#123;</span><br><span class="line">        System.out.println(book);</span><br><span class="line">        System.out.println(author);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‚æ•°é…ç½®ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GlobalData</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@InitBinder(&quot;a&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initA</span><span class="params">(WebDataBinder binder)</span> </span>&#123;</span><br><span class="line">        binder.setFieldDefaultPrefix(<span class="string">&quot;a.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@InitBinder(&quot;b&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initB</span><span class="params">(WebDataBinder binder)</span> </span>&#123;</span><br><span class="line">        binder.setFieldDefaultPrefix(<span class="string">&quot;b.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ Postman è¿›è¡Œæµ‹è¯•ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200818205810.png" alt="image-20200818205810853"></p><p>ç»“æœï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200818205832.png" alt="image-20200818205832096"></p>]]></content>
      
      
      
        <tags>
            
            <tag> æ³¨è§£ </tag>
            
            <tag> SpringBoot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ElasticSearchå…¥é—¨</title>
      <link href="/2020/08/12/ElasticSearch%E5%85%A5%E9%97%A8/"/>
      <url>/2020/08/12/ElasticSearch%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä¸€ã€å‚è€ƒé“¾æ¥"><a href="#ä¸€ã€å‚è€ƒé“¾æ¥" class="headerlink" title="ä¸€ã€å‚è€ƒé“¾æ¥"></a>ä¸€ã€å‚è€ƒé“¾æ¥</h2><p><a href="https://www.elastic.co/cn/">01.ESå®˜ç½‘</a></p><p><a href="http://www.iocoder.cn/Spring-Boot/Elasticsearch/">02.Spring Boot Elasticsearch å…¥é—¨</a></p><p><a href="http://www.iocoder.cn/Fight/Schematic-Elasticsearch-principle/">03.å›¾è§£ Elasticsearch åŸç†</a></p><h2 id="äºŒã€ElasticSearchæ¦‚è¿°"><a href="#äºŒã€ElasticSearchæ¦‚è¿°" class="headerlink" title="äºŒã€ElasticSearchæ¦‚è¿°"></a>äºŒã€ElasticSearchæ¦‚è¿°</h2><h2 id="ä¸‰ã€Solrå’ŒElasticSearchçš„å¯¹æ¯”"><a href="#ä¸‰ã€Solrå’ŒElasticSearchçš„å¯¹æ¯”" class="headerlink" title="ä¸‰ã€Solrå’ŒElasticSearchçš„å¯¹æ¯”"></a>ä¸‰ã€Solrå’ŒElasticSearchçš„å¯¹æ¯”</h2><h2 id="å››ã€ElasticSearchå®‰è£…"><a href="#å››ã€ElasticSearchå®‰è£…" class="headerlink" title="å››ã€ElasticSearchå®‰è£…"></a>å››ã€ElasticSearchå®‰è£…</h2><h2 id="äº”ã€Kibanaå®‰è£…"><a href="#äº”ã€Kibanaå®‰è£…" class="headerlink" title="äº”ã€Kibanaå®‰è£…"></a>äº”ã€Kibanaå®‰è£…</h2><h3 id="5-1-ä¸‹è½½"><a href="#5-1-ä¸‹è½½" class="headerlink" title="5.1 ä¸‹è½½"></a>5.1 ä¸‹è½½</h3><blockquote><p><a href="https://www.elastic.co/cn/downloads/kibana">Kibanaå®˜æ–¹ä¸‹è½½åœ°å€</a></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812151628.png" alt="image-20200728094906706"></p><p>æ³¨ï¼šå¯ä»¥åœ¨<a href="https://www.elastic.co/downloads/past-releases#kibana">past releases</a>ä¸‹è½½è€ç‰ˆæœ¬</p></blockquote><h3 id="5-2-è¿è¡Œ"><a href="#5-2-è¿è¡Œ" class="headerlink" title="5.2 è¿è¡Œ"></a>5.2 è¿è¡Œ</h3><p>è§£å‹åè¿›å…¥binç›®å½•è¿è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./kibana</span><br></pre></td></tr></table></figure><p>åœ¨æµè§ˆå™¨æ‰“å¼€ï¼š</p><p><a href="http://localhost:5601/">http://localhost:5601/</a></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812151656.png" alt="image-20200728095343130"></p><h3 id="5-3-æ±‰åŒ–"><a href="#5-3-æ±‰åŒ–" class="headerlink" title="5.3 æ±‰åŒ–"></a>5.3 æ±‰åŒ–</h3><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812151708.png" alt="image-20200728095941769"></p><p>zh-CN.jsonæ˜¯Kibanaçš„æ±‰åŒ–åŒ…</p><p>å†åˆ° kibana.yml ä¸­åŠ å…¥ï¼š<img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812151717.png" alt="image-20200728100108546"></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812151725.png" alt="image-20200728100208569"></p><h2 id="å…­ã€ElasticSearchæ ¸å¿ƒæ¦‚å¿µ"><a href="#å…­ã€ElasticSearchæ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="å…­ã€ElasticSearchæ ¸å¿ƒæ¦‚å¿µ"></a>å…­ã€ElasticSearchæ ¸å¿ƒæ¦‚å¿µ</h2><h3 id="6-1-ä¸å…³ç³»å‹æ•°æ®åº“å¯¹æ¯”"><a href="#6-1-ä¸å…³ç³»å‹æ•°æ®åº“å¯¹æ¯”" class="headerlink" title="6.1 ä¸å…³ç³»å‹æ•°æ®åº“å¯¹æ¯”"></a>6.1 ä¸å…³ç³»å‹æ•°æ®åº“å¯¹æ¯”</h3><blockquote><p><strong>elasticsearchæ˜¯é¢å‘æ–‡æ¡£ï¼Œå…³ç³»å‹æ•°æ®åº“å’Œ elasticsearch å®¢è§‚çš„å¯¹æ¯”ï¼ä¸€åˆ‡éƒ½æ˜¯JSON</strong></p></blockquote><table><thead><tr><th align="center">MySQL</th><th align="center">ElasticSearch</th></tr></thead><tbody><tr><td align="center">æ•°æ®åº“ï¼ˆdatabaseï¼‰</td><td align="center">ç´¢å¼•ï¼ˆindexï¼‰</td></tr><tr><td align="center">è¡¨ï¼ˆtablesï¼‰</td><td align="center">ç±»å‹ï¼ˆtypesï¼‰</td></tr><tr><td align="center">ES</td><td align="center">æ–‡æ¡£ï¼ˆdocumentsï¼‰</td></tr><tr><td align="center">åˆ—ï¼ˆcolumnsï¼‰</td><td align="center">å­—æ®µï¼ˆfieldsï¼‰</td></tr></tbody></table><p><code>æ³¨ï¼š</code>å…¶ä¸­ types é€æ¸è¢«å¼ƒç”¨äº†ï¼Œ8.Xå°†è¢«åˆ é™¤</p><h3 id="6-2-ä¸€ä¸ªğŸŒ°ï¼š"><a href="#6-2-ä¸€ä¸ªğŸŒ°ï¼š" class="headerlink" title="6.2 ä¸€ä¸ªğŸŒ°ï¼š"></a>6.2 ä¸€ä¸ªğŸŒ°ï¼š</h3><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812151826.png" alt="image-20200728102741475"></p><p>å¯¹åº”ä¸Šé¢æ•°æ®åº“ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812152319.png" alt="image-20200728110933851"></p><h3 id="6-3-è®¾è®¡"><a href="#6-3-è®¾è®¡" class="headerlink" title="6.3 è®¾è®¡"></a>6.3 è®¾è®¡</h3><p>elasticsearch(é›†ç¾¤)ä¸­å¯ä»¥åŒ…å«å¤šä¸ªç´¢å¼•(æ•°æ®åº“)ï¼Œæ¯ä¸ªç´¢å¼•ä¸­å¯ä»¥åŒ…å«å¤šä¸ªç±»å‹(è¡¨)ï¼Œæ¯ä¸ªç±»å‹ä¸‹åˆåŒ…å«å¤šä¸ªæ–‡æ¡£(è¡Œ)ï¼Œæ¯ä¸ªæ–‡æ¡£ä¸­åˆåŒ…å«å¤šä¸ªå­—æ®µ(åˆ—)ã€‚</p><p><strong>ç‰©ç†è®¾è®¡ï¼š</strong></p><p>elasticsearch åœ¨åå°æŠŠæ¯ä¸ªç´¢å¼•åˆ’åˆ†æˆå¤šä¸ªåˆ†ç‰‡ï¼Œæ¯åˆ†åˆ†ç‰‡å¯ä»¥åœ¨é›†ç¾¤ä¸­çš„ä¸åŒæœåŠ¡å™¨é—´è¿ç§» </p><p>ä¸€ä¸ªäººå°±æ˜¯ä¸€ä¸ªé›†ç¾¤ï¼é»˜è®¤çš„é›†ç¾¤åç§°å°±æ˜¯ elaticsearh</p><p>å‚è€ƒä»¥ä¸‹ï¼š</p><ol><li>äº‘ä¸Šçš„é›†ç¾¤<img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812152124.png" alt="image-20200728104645355"></li><li>é›†ç¾¤é‡Œçš„ç›’å­<img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812152218.png" alt="image-20200728104717763"></li><li>èŠ‚ç‚¹ä¹‹é—´<img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812152227.png" alt="image-20200728104728531"></li><li>ç´¢å¼•é‡Œçš„å°æ–¹å—<img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812152234.png" alt="image-20200728104741324"></li></ol><p>åœ¨ ElasticSearch head ä¸­å¯ä»¥çœ‹è§é»˜è®¤é›†ç¾¤çš„åå­—ä¸ºï¼š<code>elasticsearch</code></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812152244.png" alt="image-20200728105040312"></p><p><strong>é€»è¾‘è®¾è®¡ï¼š</strong></p><p>ä¸€ä¸ªç´¢å¼•ç±»å‹ä¸­ï¼ŒåŒ…å«å¤šä¸ªæ–‡æ¡£ï¼Œæ¯”å¦‚è¯´æ–‡æ¡£1ï¼Œæ–‡æ¡£2ã€‚ å½“æˆ‘ä»¬ç´¢å¼•ä¸€ç¯‡æ–‡æ¡£æ—¶ï¼Œå¯ä»¥é€šè¿‡è¿™æ ·çš„é¡ºåºæ‰¾åˆ°å®ƒ: </p><blockquote><p><code>ç´¢å¼• ----&gt; ç±»å‹ ----&gt; æ–‡æ¡£ID </code></p></blockquote><p>é€šè¿‡è¿™ä¸ªç»„åˆæˆ‘ä»¬å°±èƒ½ç´¢å¼•åˆ°æŸä¸ªå…·ä½“çš„æ–‡æ¡£ã€‚ æ³¨æ„ï¼šIDä¸å¿…æ˜¯æ•´æ•°ï¼Œå®é™…ä¸Šå®ƒæ˜¯ä¸ªå­—ç¬¦ä¸²ã€‚</p><h3 id="6-4-æ–‡æ¡£"><a href="#6-4-æ–‡æ¡£" class="headerlink" title="6.4 æ–‡æ¡£"></a>6.4 æ–‡æ¡£</h3><p>å°±æ˜¯æˆ‘ä»¬çš„<code>ä¸€æ¡æ•°æ®</code></p><p>ä¹‹å‰è¯´elasticsearchæ˜¯é¢å‘æ–‡æ¡£çš„ï¼Œé‚£ä¹ˆå°±æ„å‘³ç€ç´¢å¼•å’Œæœç´¢æ•°æ®çš„æœ€å°å•ä½æ˜¯æ–‡æ¡£ï¼Œelasticsearch ä¸­ï¼Œæ–‡æ¡£æœ‰å‡ ä¸ªé‡è¦å±æ€§ :</p><ul><li>è‡ªæˆ‘åŒ…å«ï¼Œä¸€ç¯‡æ–‡æ¡£åŒæ—¶åŒ…å«å­—æ®µå’Œå¯¹åº”çš„å€¼ï¼Œä¹Ÿå°±æ˜¯åŒæ—¶åŒ…å« keyï¼švalueï¼</li><li>å¯ä»¥æ˜¯å±‚æ¬¡å‹çš„ï¼Œä¸€ä¸ªæ–‡æ¡£ä¸­åŒ…å«è‡ªæ–‡æ¡£ï¼Œå¤æ‚çš„é€»è¾‘å®ä½“å°±æ˜¯è¿™ä¹ˆæ¥çš„ï¼å°±æ˜¯ä¸€ä¸ªjsonå¯¹è±¡ï¼</li></ul><p>çµæ´»çš„ç»“æ„ï¼Œæ–‡æ¡£ä¸ä¾èµ–é¢„å…ˆå®šä¹‰çš„æ¨¡å¼ï¼Œæˆ‘ä»¬çŸ¥é“å…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œè¦æå‰å®šä¹‰å­—æ®µæ‰èƒ½ä½¿ç”¨ï¼Œ åœ¨elasticsearchä¸­ï¼Œå¯¹äºå­—æ®µæ˜¯éå¸¸çµæ´»çš„ï¼Œæœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å¿½ç•¥è¯¥å­—æ®µï¼Œæˆ–è€…åŠ¨æ€çš„æ·»åŠ ä¸€ä¸ªæ–°çš„å­—æ®µã€‚</p><p>å°½ç®¡æˆ‘ä»¬å¯ä»¥éšæ„çš„æ–°å¢æˆ–è€…å¿½ç•¥æŸä¸ªå­—æ®µï¼Œä½†æ˜¯ï¼Œæ¯ä¸ªå­—æ®µçš„ç±»å‹éå¸¸é‡è¦ï¼Œæ¯”å¦‚ä¸€ä¸ªå¹´é¾„å­—æ®µç±»å‹ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥æ˜¯æ•´å‹ã€‚å› ä¸ºelasticsearchä¼šä¿å­˜å­—æ®µå’Œç±»å‹ä¹‹é—´çš„æ˜ å°„åŠå…¶ä»–çš„è®¾ç½®ã€‚è¿™ç§æ˜ å°„å…·ä½“åˆ°æ¯ä¸ªæ˜ å°„çš„æ¯ç§ç±»å‹ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨elasticsearchä¸­ï¼Œç±»å‹æœ‰æ—¶å€™ä¹Ÿç§°ä¸ºæ˜ å°„ç±»å‹ ã€‚</p><h3 id="6-5-ç±»å‹"><a href="#6-5-ç±»å‹" class="headerlink" title="6.5 ç±»å‹"></a>6.5 ç±»å‹</h3><p>â€‹        ç±»å‹æ˜¯æ–‡æ¡£çš„é€»è¾‘å®¹å™¨ï¼Œå°±åƒå…³ç³»å‹æ•°æ®åº“ä¸€æ ·ï¼Œè¡¨æ ¼æ˜¯è¡Œçš„å®¹å™¨ã€‚ ç±»å‹ä¸­å¯¹äºå­—æ®µçš„å®šä¹‰ç§°ä¸ºæ˜ å°„ï¼Œ æ¯”å¦‚ name æ˜ å°„ä¸ºå­—ç¬¦ä¸²ç±»å‹ã€‚ æˆ‘ä»¬è¯´æ–‡æ¡£æ˜¯æ— æ¨¡å¼çš„ï¼Œå®ƒä»¬ä¸éœ€è¦æ‹¥æœ‰æ˜ å°„ä¸­æ‰€å®šä¹‰çš„æ‰€æœ‰å­—æ®µï¼Œ æ¯”å¦‚æ–°å¢ä¸€ä¸ªå­—æ®µï¼Œé‚£ä¹ˆelasticsearchæ˜¯æ€ä¹ˆåšçš„å‘¢ï¼Ÿelasticsearchä¼šè‡ªåŠ¨çš„å°†æ–°å­—æ®µåŠ å…¥æ˜ å°„ï¼Œä½†æ˜¯è¿™ä¸ªå­—æ®µçš„ä¸ç¡®å®šå®ƒæ˜¯ä»€ä¹ˆç±»å‹ï¼Œelasticsearchå°±å¼€å§‹çŒœï¼Œå¦‚æœè¿™ä¸ªå€¼æ˜¯18ï¼Œé‚£ä¹ˆelasticsearchä¼šè®¤ä¸ºå®ƒæ˜¯æ•´å‹ã€‚ ä½†æ˜¯elasticsearchä¹Ÿå¯èƒ½çŒœä¸å¯¹ï¼Œ æ‰€ä»¥æœ€å®‰å…¨çš„æ–¹å¼å°±æ˜¯æå‰å®šä¹‰å¥½æ‰€éœ€è¦çš„æ˜ å°„ï¼Œè¿™ç‚¹è·Ÿå…³ç³»å‹æ•°æ®åº“æ®Šé€”åŒå½’äº†ï¼Œå…ˆå®šä¹‰å¥½å­—æ®µï¼Œç„¶åå†ä½¿ç”¨ã€‚</p><h3 id="6-6-ç´¢å¼•"><a href="#6-6-ç´¢å¼•" class="headerlink" title="6.6 ç´¢å¼•"></a>6.6 ç´¢å¼•</h3><p>å°±æ˜¯<code>æ•°æ®åº“</code></p><p>ç´¢å¼•æ˜¯æ˜ å°„ç±»å‹çš„å®¹å™¨ï¼Œelasticsearchä¸­çš„ç´¢å¼•æ˜¯ä¸€ä¸ªéå¸¸å¤§çš„æ–‡æ¡£é›†åˆã€‚ç´¢å¼•å­˜å‚¨äº†æ˜ å°„ç±»å‹çš„å­—æ®µå’Œå…¶ä»–è®¾ç½®ã€‚ ç„¶åå®ƒä»¬è¢«å­˜å‚¨åˆ°äº†å„ä¸ªåˆ†ç‰‡ä¸Šäº†ã€‚ æˆ‘ä»¬æ¥ç ”ç©¶ä¸‹åˆ†ç‰‡æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><p>ä¸€ä¸ªé›†ç¾¤è‡³å°‘æœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè€Œä¸€ä¸ªèŠ‚ç‚¹å°±æ˜¯ä¸€ä¸ªelasricsearchè¿›ç¨‹ï¼ŒèŠ‚ç‚¹å¯ä»¥æœ‰å¤šä¸ªç´¢å¼•é»˜è®¤çš„ï¼Œå¦‚æœä½ åˆ›å»ºç´¢å¼•ï¼Œé‚£ä¹ˆç´¢å¼•å°†ä¼šæœ‰ä¸ª5ä¸ªåˆ†ç‰‡ ( primary shard ,åˆç§°ä¸»åˆ†ç‰‡ ) æ„æˆçš„ï¼Œæ¯ä¸€ä¸ªä¸»åˆ†ç‰‡ä¼šæœ‰ä¸€ä¸ªå‰¯æœ¬ ( replica shard ,åˆç§°å¤åˆ¶åˆ†ç‰‡ )</p><p>åœ¨ ElasticSearch head ä¸­å¯ä»¥çœ‹è§åˆšå»ºç«‹çš„ç´¢å¼•æ˜¯5ä¸ªåˆ†ç‰‡ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812152341.png" alt="image-20200728111430420"></p><h3 id="6-7-å€’æ’"><a href="#6-7-å€’æ’" class="headerlink" title="6.7 å€’æ’"></a>6.7 å€’æ’</h3><p>elasticsearchä½¿ç”¨çš„æ˜¯ä¸€ç§ç§°ä¸ºå€’æ’ç´¢å¼•çš„ç»“æ„ï¼Œé‡‡ç”¨Luceneå€’æ’ç´¢ä½œä¸ºåº•å±‚ã€‚è¿™ç§ç»“æ„é€‚ç”¨äºå¿«é€Ÿçš„å…¨æ–‡æœç´¢ï¼Œ ä¸€ä¸ªç´¢å¼•ç”±æ–‡æ¡£ä¸­æ‰€æœ‰ä¸é‡å¤çš„åˆ—è¡¨æ„æˆï¼Œå¯¹äºæ¯ä¸€ä¸ªè¯ï¼Œéƒ½æœ‰ä¸€ä¸ªåŒ…å«å®ƒçš„æ–‡æ¡£åˆ—è¡¨ã€‚ ä¾‹ å¦‚ï¼Œç°åœ¨æœ‰ä¸¤ä¸ªæ–‡æ¡£ï¼Œ æ¯ä¸ªæ–‡æ¡£åŒ…å«å¦‚ä¸‹å†…å®¹ï¼š</p><blockquote><p>Study every day, good good up to forever           # æ–‡æ¡£1åŒ…å«çš„å†…å®¹<br>To forever, study every day, good good up          # æ–‡æ¡£2åŒ…å«çš„å†…å®¹</p></blockquote><p>ä¸ºäº†åˆ›å»ºå€’æ’ç´¢å¼•ï¼Œæˆ‘ä»¬é¦–å…ˆè¦å°†æ¯ä¸ªæ–‡æ¡£æ‹†åˆ†æˆç‹¬ç«‹çš„è¯(æˆ–ç§°ä¸ºè¯æ¡æˆ–è€…tokens)ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªåŒ…å«æ‰€æœ‰ä¸é‡ å¤çš„è¯æ¡çš„æ’åºåˆ—è¡¨ï¼Œç„¶ååˆ—å‡ºæ¯ä¸ªè¯æ¡å‡ºç°åœ¨å“ªä¸ªæ–‡æ¡£</p><table><thead><tr><th align="center">term</th><th align="center">doc_1</th><th align="center">doc_2</th></tr></thead><tbody><tr><td align="center">Study</td><td align="center">âˆš</td><td align="center">X</td></tr><tr><td align="center">To</td><td align="center">X</td><td align="center">âˆš</td></tr><tr><td align="center">every</td><td align="center">âˆš</td><td align="center">âˆš</td></tr><tr><td align="center">forever</td><td align="center">âˆš</td><td align="center">âˆš</td></tr><tr><td align="center">day</td><td align="center">âˆš</td><td align="center">âˆš</td></tr><tr><td align="center">study</td><td align="center">X</td><td align="center">âˆš</td></tr><tr><td align="center">good</td><td align="center">âˆš</td><td align="center">âˆš</td></tr><tr><td align="center">every</td><td align="center">âˆš</td><td align="center">âˆš</td></tr><tr><td align="center">to</td><td align="center">âˆš</td><td align="center">X</td></tr><tr><td align="center">up</td><td align="center">âˆš</td><td align="center">âˆš</td></tr></tbody></table><p>ç°åœ¨ï¼Œæˆ‘ä»¬è¯•å›¾æœç´¢ to foreverï¼Œåªéœ€è¦æŸ¥çœ‹åŒ…å«æ¯ä¸ªè¯æ¡çš„æ–‡æ¡£ <code>score</code></p><table><thead><tr><th align="center">term</th><th align="center">doc_1</th><th align="center">doc_2</th></tr></thead><tbody><tr><td align="center">to</td><td align="center">âˆš</td><td align="center">X</td></tr><tr><td align="center">forever</td><td align="center">âˆš</td><td align="center">âˆš</td></tr><tr><td align="center">total</td><td align="center">2</td><td align="center">1</td></tr></tbody></table><p>å¦‚æœæ²¡æœ‰åˆ«çš„æ¡ä»¶ï¼Œç°åœ¨ï¼Œè¿™ä¸¤ä¸ªåŒ…å«å…³é”®å­—çš„æ–‡æ¡£éƒ½å°†è¿”å›ã€‚</p><p>åœ¨elasticsearchä¸­ï¼Œ ç´¢å¼• ï¼ˆåº“ï¼‰è¿™ä¸ªè¯è¢«é¢‘ç¹ä½¿ç”¨ï¼Œè¿™å°±æ˜¯æœ¯è¯­çš„ä½¿ç”¨ã€‚ åœ¨elasticsearchä¸­ï¼Œç´¢å¼•è¢«åˆ†ä¸ºå¤šä¸ªåˆ†ç‰‡ï¼Œæ¯ä»½åˆ†ç‰‡æ˜¯ä¸€ä¸ªLuceneçš„ç´¢å¼•ã€‚æ‰€ä»¥ä¸€ä¸ªelasticsearchç´¢å¼•æ˜¯ç”±å¤šä¸ªLuceneç´¢å¼•ç»„æˆçš„ã€‚åˆ«é—®ä¸ºä»€ä¹ˆï¼Œè°è®©elasticsearchä½¿ç”¨Luceneä½œä¸ºåº•å±‚å‘¢! å¦‚æ— ç‰¹æŒ‡ï¼Œè¯´èµ·ç´¢å¼•éƒ½æ˜¯æŒ‡elasticsearch çš„ç´¢å¼•ã€‚</p><p>å…³ç³»å›¾ï¼š</p><blockquote><p>ä¸€ä¸ª ES ç´¢å¼• â€”â€“&gt; å¤šä¸ªåˆ†ç‰‡(shard)</p><p>â€‹                                       ä¸€ä¸ªåˆ†ç‰‡(shard) â€”â€“&gt; ä¸€ä¸ª Lucene ç´¢å¼•</p><p>ä¸€ä¸ª ES ç´¢å¼• â€”â€“&gt; â€”â€“&gt; å¤šä¸ª Lucene ç´¢å¼•</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812152359.png" alt="image-20200728131631335"></p><h2 id="ä¸ƒã€IKåˆ†è¯å™¨"><a href="#ä¸ƒã€IKåˆ†è¯å™¨" class="headerlink" title="ä¸ƒã€IKåˆ†è¯å™¨"></a>ä¸ƒã€IKåˆ†è¯å™¨</h2><h3 id="7-1-åˆ†è¯"><a href="#7-1-åˆ†è¯" class="headerlink" title="7.1 åˆ†è¯"></a>7.1 åˆ†è¯</h3><p>åˆ†è¯ï¼šå³æŠŠä¸€æ®µä¸­æ–‡æˆ–è€…åˆ«çš„åˆ’åˆ†æˆä¸€ä¸ªä¸ªçš„å…³é”®å­—ï¼Œæˆ‘ä»¬åœ¨æœç´¢æ—¶å€™ä¼šæŠŠè‡ªå·±çš„ä¿¡æ¯è¿›è¡Œåˆ†è¯ï¼Œä¼šæŠŠæ•°æ®åº“ä¸­æˆ–è€…ç´¢å¼•åº“ä¸­çš„æ•°æ®è¿›è¡Œåˆ†è¯ï¼Œç„¶åè¿›è¡Œä¸€ä¸ªåŒ¹é…æ“ä½œï¼Œé»˜è®¤çš„ä¸­æ–‡åˆ†è¯æ˜¯å°†æ¯ä¸ªå­—çœ‹æˆä¸€ä¸ª è¯ï¼Œæ¯”å¦‚ â€œæˆ‘æ˜¯ç‹å…«â€ ä¼šè¢«åˆ†ä¸ºâ€æˆ‘â€ã€â€œæ˜¯â€ã€â€œç‹â€ã€â€œå…«â€ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸ç¬¦åˆè¦æ±‚çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å®‰è£…ä¸­æ–‡åˆ†è¯å™¨ IK æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>IK æä¾›äº†ä¸¤ä¸ªåˆ†è¯ç®—æ³•ï¼šik_smart å’Œ ik_max_wordï¼Œå…¶ä¸­ ik_smart ä¸ºæœ€å°‘åˆ‡åˆ†ï¼Œik_max_wordä¸ºæœ€ç»†ç²’åº¦åˆ’åˆ†ï¼</p><h3 id="7-2-ä¸‹è½½å®‰è£…"><a href="#7-2-ä¸‹è½½å®‰è£…" class="headerlink" title="7.2 ä¸‹è½½å®‰è£…"></a>7.2 ä¸‹è½½å®‰è£…</h3><p>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/medcl/elasticsearch-analysis-ik">IK åˆ†è¯å™¨ä¸‹è½½</a></p><p>å®‰è£…ï¼šè§£å‹åæ”¾å…¥ plugins æ–‡ä»¶å¤¹ä¸‹</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812152413.png" alt="image-20200728133942367"></p><p>é‡å¯ ElasticSearch ï¼šçœ‹åˆ° IK åˆ†è¯å™¨å·²ç»åŠ è½½åˆ° ES é‡Œé¢äº†</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812152418.png" alt="image-20200728134131159"></p><h3 id="7-3-IK-åˆ†è¯å™¨çš„å°ğŸŒ°ï¼š"><a href="#7-3-IK-åˆ†è¯å™¨çš„å°ğŸŒ°ï¼š" class="headerlink" title="7.3 IK åˆ†è¯å™¨çš„å°ğŸŒ°ï¼š"></a>7.3 IK åˆ†è¯å™¨çš„å°ğŸŒ°ï¼š</h3><p>ä½¿ç”¨ ik_smart ç®—æ³•ï¼š  <code>æœ€å°‘åˆ‡åˆ†</code></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812152424.png" alt="image-20200728135216813"></p><p>ä½¿ç”¨ ik_max_word ç®—æ³•ï¼š    <code>æœ€ç»†ç²’åº¦åˆ’åˆ†</code>ï¼šé€šè¿‡å­—å…¸ï¼Œæ‰¾å¯»æ‰€æœ‰ç¬¦åˆçš„æƒ…å†µ</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812152432.png" alt="image-20200728135308880"></p><h3 id="7-4-è‡ªè¡Œ-DIY-å­—å…¸"><a href="#7-4-è‡ªè¡Œ-DIY-å­—å…¸" class="headerlink" title="7.4 è‡ªè¡Œ DIY å­—å…¸"></a>7.4 è‡ªè¡Œ DIY å­—å…¸</h3><p>åœ¨å‡ºç°ä»¥ä¸‹æƒ…å†µæ—¶ï¼šæˆ‘ä»¬éœ€è¦çš„æ˜¯ <code>ç¥é­”æ‹</code> åº”è¯¥æ˜¯ä¸€ä¸ªè¯è¯­ï¼Œè€Œä¸åº”è¯¥è¢«åˆ†è¯ä¸º <code>ç¥é­”</code> ä¸ <code>æ‹</code></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812152455.png" alt="image-20200728140135869"></p><p>åœ¨ IK çš„ config ç›®å½•ä¸‹ï¼Œé…ç½® wangba.dic å’Œ IKAnalyzer.cfg.xml å¦‚ä¸‹ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812152536.png" alt="image-20200728144840034"></p><p><code>IKAnalyzer.cfg.xmlï¼š</code></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812152547.png" alt="image-20200728145037806"></p><p><code>wangba.dic:</code></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812152556.png" alt="image-20200728145105415"></p><p>é‡å¯ ES å’Œ Kibanaï¼šå·²ç»å¯ä»¥çœ‹è§ wangba.dic å·²ç»åŠ è½½è¿›å»äº†</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812152607.png" alt="image-20200728144452860"></p><p>æ­¤æ—¶åœ¨Kibanaä¸­å¯ä»¥çœ‹è§ï¼šæ­¤æ—¶ <code>ç¥é­”æ‹</code> å·²ç»æ˜¯ä¸€ä¸ªè¯äº†</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812152614.png" alt="image-20200728145311150"></p><h2 id="å…«ã€Resté£æ ¼"><a href="#å…«ã€Resté£æ ¼" class="headerlink" title="å…«ã€Resté£æ ¼"></a>å…«ã€Resté£æ ¼</h2><h3 id="8-1-Restå‘½ä»¤è¯´æ˜è¯´æ˜"><a href="#8-1-Restå‘½ä»¤è¯´æ˜è¯´æ˜" class="headerlink" title="8.1 Restå‘½ä»¤è¯´æ˜è¯´æ˜"></a>8.1 Restå‘½ä»¤è¯´æ˜è¯´æ˜</h3><p>ä¸€ç§è½¯ä»¶æ¶æ„é£æ ¼ï¼Œè€Œä¸æ˜¯æ ‡å‡†ï¼Œåªæ˜¯æä¾›äº†ä¸€ç»„è®¾è®¡åŸåˆ™å’Œçº¦æŸæ¡ä»¶ã€‚å®ƒä¸»è¦ç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨äº¤ äº’ç±»çš„è½¯ä»¶ã€‚åŸºäºè¿™ä¸ªé£æ ¼è®¾è®¡çš„è½¯ä»¶å¯ä»¥æ›´ç®€æ´ï¼Œæ›´æœ‰å±‚æ¬¡ï¼Œæ›´æ˜“äºå®ç°ç¼“å­˜ç­‰æœºåˆ¶ã€‚</p><p>åŸºæœ¬Restå‘½ä»¤è¯´æ˜ï¼š</p><table><thead><tr><th align="center"><strong>method</strong></th><th align="center">urlåœ°å€</th><th align="center">æè¿°</th></tr></thead><tbody><tr><td align="center">PUT</td><td align="center">localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id</td><td align="center">åˆ›å»ºæ–‡æ¡£ï¼ˆæŒ‡å®šæ–‡æ¡£idï¼‰</td></tr><tr><td align="center">POST</td><td align="center">localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°</td><td align="center">åˆ›å»ºæ–‡æ¡£ï¼ˆéšæœºæ–‡æ¡£idï¼‰</td></tr><tr><td align="center">_update</td><td align="center">localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id/_update</td><td align="center">ä¿®æ”¹æ–‡æ¡£</td></tr><tr><td align="center">DELETE</td><td align="center">localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id</td><td align="center">åˆ é™¤æ–‡æ¡£</td></tr><tr><td align="center">GET</td><td align="center">localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id</td><td align="center">æŸ¥è¯¢æ–‡æ¡£é€šè¿‡æ–‡æ¡£id</td></tr><tr><td align="center">POST</td><td align="center">localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/_search</td><td align="center">æŸ¥è¯¢æ‰€æœ‰æ•°æ®</td></tr></tbody></table><h3 id="8-2-åŸºæœ¬æµ‹è¯•"><a href="#8-2-åŸºæœ¬æµ‹è¯•" class="headerlink" title="8.2 åŸºæœ¬æµ‹è¯•"></a>8.2 åŸºæœ¬æµ‹è¯•</h3><p>åˆ›å»ºç´¢å¼•ï¼š</p><blockquote><p>PUT /ç´¢å¼•åç§°/<del><code>ç±»å‹åç§°</code></del>/æ–‡æ¡£id</p><p>{</p><p>â€‹            è¯·æ±‚ä½“</p><p>}</p><p>æ³¨ï¼šç±»å‹å³å°†è¢«å¼ƒç”¨</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812152625.png" alt="image-20200728151356309"></p><p>åœ¨ ES head ä¸­å¯ä»¥çœ‹è§æ•°æ®å·²ç»æ’å…¥æˆåŠŸï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812152637.png" alt="image-20200728151727329"></p><h3 id="8-3-ç±»å‹"><a href="#8-3-ç±»å‹" class="headerlink" title="8.3 ç±»å‹"></a>8.3 ç±»å‹</h3><table><thead><tr><th align="center"><strong>å­—ç¬¦ä¸²ç±»å‹</strong></th><th align="center"><strong>text ã€ keyword</strong></th></tr></thead><tbody><tr><td align="center"><strong>æ•°å€¼ç±»å‹</strong></td><td align="center">longã€integerã€ shortã€byteã€doubleã€floatã€half_floatã€ scaled_float</td></tr><tr><td align="center"><strong>æ—¥æœŸç±»å‹</strong></td><td align="center">date</td></tr><tr><td align="center"><strong>å¸ƒå°”å€¼ç±»å‹</strong></td><td align="center">boolean</td></tr><tr><td align="center"><strong>äºŒè¿›åˆ¶ç±»å‹</strong></td><td align="center">binary</td></tr></tbody></table><p>è‡ªå®šä¹‰ç±»å‹ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812152919.png" alt="image-20200728153315700"></p><p>é€šè¿‡ GET è¯·æ±‚å¯ä»¥çœ‹è§ test2 ç´¢å¼•çš„ä¿¡æ¯ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812152926.png" alt="image-20200728153419852"></p><p>è‡ªåŠ¨åŒ¹é…ç±»å‹ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153010.png" alt="image-20200728154312363"></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153017.png" alt="image-20200728154429831"></p><h3 id="8-4-å…³äºç´¢å¼•çš„åŸºæœ¬æ“ä½œ"><a href="#8-4-å…³äºç´¢å¼•çš„åŸºæœ¬æ“ä½œ" class="headerlink" title="8.4 å…³äºç´¢å¼•çš„åŸºæœ¬æ“ä½œ"></a>8.4 å…³äºç´¢å¼•çš„åŸºæœ¬æ“ä½œ</h3><blockquote><p>å¢åŠ ï¼šå¦‚ä¸Š</p><p>æŸ¥è¯¢ï¼šå¦‚ä¸Š</p></blockquote><blockquote><p>ä¿®æ”¹ï¼šå¦‚ä¸‹</p></blockquote><p>æ–¹æ³•ä¸€ï¼šç›´æ¥è¦†ç›–</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153031.png" alt="image-20200728155827534"></p><p>å¯ä»¥çœ‹è§ version å‘ç”Ÿäº†æ”¹å˜</p><p>æ–¹æ³•äºŒï¼š</p><blockquote><p>POST /ç´¢å¼•åç§°/_doc/æ–‡æ¡£id/__update</p><p>{</p><p>â€‹            è¯·æ±‚ä½“</p><p>}</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153102.png" alt="image-20200728160513999"></p><p>å¯ä»¥çœ‹è§ version å†æ¬¡å‘ç”Ÿäº†æ”¹å˜</p><blockquote><p>åˆ é™¤</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153148.png" alt="image-20200728161148536"></p><h3 id="8-5-å…³äºæ–‡æ¡£çš„åŸºæœ¬æ“ä½œ"><a href="#8-5-å…³äºæ–‡æ¡£çš„åŸºæœ¬æ“ä½œ" class="headerlink" title="8.5 å…³äºæ–‡æ¡£çš„åŸºæœ¬æ“ä½œ"></a>8.5 å…³äºæ–‡æ¡£çš„åŸºæœ¬æ“ä½œ</h3><p><code>åŸºæœ¬æ“ä½œï¼š</code></p><blockquote><p>å¢åŠ æ•°æ®    PUT</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153158.png" alt="image-20200729085012520"></p><blockquote><p>æŸ¥è¯¢æ•°æ®    GET</p></blockquote><p>æ–¹å¼ä¸€ï¼šç®€å•çš„ ID æŸ¥è¯¢</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153226.png" alt="image-20200729085341564"></p><p>å¯ä»¥çœ‹è§ï¼Œæ¨èä½¿ç”¨ <code>GET /ç´¢å¼•/_doc/æ–‡æ¡£ID</code> æ¥è¿›è¡Œæ“ä½œ</p><p>æ–¹å¼äºŒï¼šç®€å•çš„æ¡ä»¶æŸ¥è¯¢</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153621.png" alt="image-20200729091400956"></p><p>å¯ä»¥çœ‹è§ <code>type</code> å·²ç»è¢«ä¸¢å¼ƒäº†</p><blockquote><p>æ›´æ–°æ•°æ®    POST</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153609.png" alt="image-20200729090204208"></p><p>å¯ä»¥çœ‹è§ï¼Œæ¨èä½¿ç”¨ <code>POST /ç´¢å¼•/_update/æ–‡æ¡£ID</code> æ¥è¿›è¡Œæ“ä½œ</p><blockquote><p><code>å¤æ‚æ“ä½œï¼š</code>select (æ’åºã€åˆ†é¡µã€é«˜äº®ã€æ¨¡ç³ŠæŸ¥è¯¢ã€ç²¾å‡†æŸ¥è¯¢ )</p></blockquote><blockquote><p>æŸ¥è¯¢</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153640.png" alt="image-20200729092702190"></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153648.png" alt="image-20200729093150116"></p><p>ES ä¸­æœ‰ <code>zhangsan</code> å’Œ <code>zhangshan 008</code> ï¼Œé€šè¿‡å…³é”®å­—<code>zhangsan</code> æŸ¥è¯¢ï¼Œä¼šå°†åˆ†è¯åçš„ç»“æœå…¨éƒ¨æŸ¥è¯¢å‡ºæ¥ï¼Œä¸”æ¯ä¸€ä¸ªéƒ½æ˜¯æœ‰ <code>_score</code> çš„ã€‚</p><blockquote><p>hitsï¼šåœ¨Javaå¯ä»¥å¾—åˆ°ç´¢å¼•å’Œæ–‡æ¡£çš„ä¿¡æ¯ã€æŸ¥è¯¢çš„ç»“æœæ€»æ•°ã€å…·ä½“æ–‡æ¡£æ•°æ®ä¿¡æ¯ï¼ˆå¯ä»¥é€šè¿‡éå†å¾—åˆ°å…·ä½“çš„å„ç§ä¿¡æ¯ï¼‰</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153700.png" alt="image-20200729094426031"></p><blockquote><p>é€šè¿‡ <code>_source</code> æ¥æŒ‡å®šæœ€åçš„è¾“å‡ºç»“æœ</p></blockquote><blockquote><p>æ’åº</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153709.png" alt="image-20200729095730668"></p><blockquote><p>é€šè¿‡ <code>sort</code> è¿›è¡Œæ’åºï¼Œç”¨ <code>desc</code> å’Œ <code>asc</code> æ¥è¿›è¡Œé™åºå’Œå‡åº</p></blockquote><blockquote><p>åˆ†é¡µ    /search/{current}/{pagesize}</p></blockquote><p>ç¬¬ä¸€é¡µä¸€ä¸ªæ•°æ®</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153722.png" alt="image-20200729100357807"></p><p>ç¬¬äºŒé¡µçš„ä¸€ä¸ªæ•°æ®</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153731.png" alt="image-20200729100512315"></p><p>ç¬¬ä¸€é¡µçš„ä¸¤ä¸ªæ•°æ®</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153738.png" alt="image-20200729100615639"></p><blockquote><p>bool å€¼æŸ¥è¯¢</p></blockquote><p><code>must å‘½ä»¤</code> ==  and</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153749.png" alt="image-20200729101211913"></p><p><code>should å‘½ä»¤</code> == or</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153757.png" alt="image-20200729102255051"></p><p>ä¸¤ä¸ªéƒ½æŸ¥è¯¢åˆ°äº†</p><p><code>must_not å‘½ä»¤</code> ==  not</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153807.png" alt="image-20200729102630406"></p><p><code>filter å‘½ä»¤</code></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153820.png" alt="image-20200729103629498"></p><blockquote><p>gtï¼šå¤§äº  / gteï¼šå¤§äºç­‰äº / ltï¼šå°äº / lteï¼šå°äºç­‰äº</p></blockquote><p><code>åŒ¹é…å¤šä¸ªæ¡ä»¶</code></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153836.png" alt="image-20200729104255294"></p><p>ç›´æ¥åœ¨ <code>tags</code> ä¸­åŠ ç©ºæ ¼</p><p><code>ç²¾ç¡®æŸ¥è¯¢</code></p><p>term æŸ¥è¯¢æ˜¯ç›´æ¥é€šè¿‡å€’æ’ç´¢å¼•æŒ‡å®šçš„è¯æ¡è¿›è¡Œç²¾ç¡®çš„æŸ¥è¯¢</p><ul><li><p>termï¼šç›´æ¥æŸ¥è¯¢ç²¾ç¡®çš„</p></li><li><p>matchï¼šä½¿ç”¨åˆ†è¯å™¨è§£æï¼ˆå…ˆåˆ†ææ–‡æ¡£ï¼Œåœ¨é€šè¿‡åˆ†æçš„æ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢ï¼‰</p></li></ul><p>ä¸¤ä¸ªç±»å‹ï¼š</p><p><code>textï¼š</code> ä¼šè¢«åˆ†è¯è§£æå™¨è§£æ</p><p><code>keywordï¼š </code> ä¸ä¼šè¢«åˆ†è¯è§£æå™¨è§£æ</p><p>ä½¿ç”¨ keywod åˆ†è¯å™¨ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153858.png" alt="image-20200729112314281"></p><p>ä½¿ç”¨ standard åˆ†è¯å™¨ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153906.png" alt="image-20200729112353845"></p><p><code>textï¼š</code> å¯ä»¥çœ‹è§ä¸‹é¢è¢«åˆ†è¯äº†ï¼Œæ‰€ä»¥å‡ºç°äº†ä¸¤ä¸ªç»“æœ</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153915.png" alt="image-20200729112831873"></p><p><code>keywordï¼š </code> å¯ä»¥çœ‹è§ä¸‹é¢æ²¡æœ‰è¢«åˆ†è¯</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153925.png" alt="image-20200729113003169"></p><blockquote><p>é«˜äº®æŸ¥è¯¢</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153934.png" alt="image-20200729122744294"></p><h2 id="ä¹ã€SpringBooté›†æˆElasticSearch"><a href="#ä¹ã€SpringBooté›†æˆElasticSearch" class="headerlink" title="ä¹ã€SpringBooté›†æˆElasticSearch"></a>ä¹ã€SpringBooté›†æˆElasticSearch</h2><p><a href="https://www.elastic.co/guide/en/elasticsearch/client/java-rest/7.6/java-rest-high.html">å®˜æ–¹ ES Client æ–‡æ¡£</a></p><p>1.ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.elasticsearch.client<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>elasticsearch-rest-high-level-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>7.6.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2.æ‰¾å¯¹è±¡</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812153948.png" alt="image-20200729134909854"></p><p>3.åˆ†æç±»ä¸­æ–¹æ³•</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812154043.png" alt="image-20200729140717144"></p><p>ES çš„ç‰ˆæœ¬ä¸æœ¬æœºä¸­çš„ç‰ˆæœ¬ä¸ä¸€è‡´ </p><p>è‡ªè¡Œé…ç½® SpringBoot ä¸­çš„ ES ç‰ˆæœ¬</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812154036.png" alt="image-20200729141538339"></p><p><code>RestClientAutoConfiguration</code> å’Œ <code>RestClientProperties</code></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/wonderfuleight/blogImg/raw/master//20200812154019.png" alt="image-20200729143842388"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Source code recreated from a .class file by IntelliJ IDEA</span></span><br><span class="line"><span class="comment">// (powered by Fernflower decompiler)</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> org.springframework.boot.autoconfigure.elasticsearch.rest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.Duration;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.HttpHost;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.auth.AuthScope;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.auth.Credentials;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.auth.UsernamePasswordCredentials;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.client.CredentialsProvider;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.impl.client.BasicCredentialsProvider;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.client.RestClient;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.client.RestClientBuilder;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.client.RestHighLevelClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.ObjectProvider;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.condition.ConditionalOnClass;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.PropertyMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RestClientConfigurations</span> </span>&#123;</span><br><span class="line">    RestClientConfigurations() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Configuration(</span></span><br><span class="line"><span class="meta">        proxyBeanMethods = false</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">  <span class="comment">// RestClient  æ™®é€šå®¢æˆ·ç«¯</span></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">RestClientFallbackConfiguration</span> </span>&#123;</span><br><span class="line">        RestClientFallbackConfiguration() &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Bean</span></span><br><span class="line">        <span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line">        <span class="function">RestClient <span class="title">elasticsearchRestClient</span><span class="params">(RestClientBuilder builder)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> builder.build();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Configuration(</span></span><br><span class="line"><span class="meta">        proxyBeanMethods = false</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="meta">@ConditionalOnClass(&#123;RestHighLevelClient.class&#125;)</span></span><br><span class="line">  <span class="comment">// RestHighLevelClient  é«˜çº§å®¢æˆ·ç«¯</span></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">RestHighLevelClientConfiguration</span> </span>&#123;</span><br><span class="line">        RestHighLevelClientConfiguration() &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Bean</span></span><br><span class="line">        <span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line">        <span class="function">RestHighLevelClient <span class="title">elasticsearchRestHighLevelClient</span><span class="params">(RestClientBuilder restClientBuilder)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> RestHighLevelClient(restClientBuilder);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Bean</span></span><br><span class="line">        <span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line">        <span class="function">RestClient <span class="title">elasticsearchRestClient</span><span class="params">(RestClientBuilder builder, ObjectProvider&lt;RestHighLevelClient&gt; restHighLevelClient)</span> </span>&#123;</span><br><span class="line">            RestHighLevelClient client = (RestHighLevelClient)restHighLevelClient.getIfUnique();</span><br><span class="line">            <span class="keyword">return</span> client != <span class="keyword">null</span> ? client.getLowLevelClient() : builder.build();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Configuration(</span></span><br><span class="line"><span class="meta">        proxyBeanMethods = false</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">  <span class="comment">// RestClientBuilder</span></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">RestClientBuilderConfiguration</span> </span>&#123;</span><br><span class="line">        RestClientBuilderConfiguration() &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Bean</span></span><br><span class="line">        <span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line">        <span class="function">RestClientBuilder <span class="title">elasticsearchRestClientBuilder</span><span class="params">(RestClientProperties properties, ObjectProvider&lt;RestClientBuilderCustomizer&gt; builderCustomizers)</span> </span>&#123;</span><br><span class="line">            HttpHost[] hosts = (HttpHost[])properties.getUris().stream().map(HttpHost::create).toArray((x$<span class="number">0</span>) -&gt; &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> HttpHost[x$<span class="number">0</span>];</span><br><span class="line">            &#125;);</span><br><span class="line">            RestClientBuilder builder = RestClient.builder(hosts);</span><br><span class="line">            PropertyMapper map = PropertyMapper.get();</span><br><span class="line">            map.from(properties::getUsername).whenHasText().to((username) -&gt; &#123;</span><br><span class="line">                CredentialsProvider credentialsProvider = <span class="keyword">new</span> BasicCredentialsProvider();</span><br><span class="line">                Credentials credentials = <span class="keyword">new</span> UsernamePasswordCredentials(properties.getUsername(), properties.getPassword());</span><br><span class="line">                credentialsProvider.setCredentials(AuthScope.ANY, credentials);</span><br><span class="line">                builder.setHttpClientConfigCallback((httpClientBuilder) -&gt; &#123;</span><br><span class="line">                    <span class="keyword">return</span> httpClientBuilder.setDefaultCredentialsProvider(credentialsProvider);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;);</span><br><span class="line">            builder.setRequestConfigCallback((requestConfigBuilder) -&gt; &#123;</span><br><span class="line">                properties.getClass();</span><br><span class="line">                map.from(properties::getConnectionTimeout).whenNonNull().asInt(Duration::toMillis).to(requestConfigBuilder::setConnectTimeout);</span><br><span class="line">                properties.getClass();</span><br><span class="line">                map.from(properties::getReadTimeout).whenNonNull().asInt(Duration::toMillis).to(requestConfigBuilder::setSocketTimeout);</span><br><span class="line">                <span class="keyword">return</span> requestConfigBuilder;</span><br><span class="line">            &#125;);</span><br><span class="line">            builderCustomizers.orderedStream().forEach((customizer) -&gt; &#123;</span><br><span class="line">                customizer.customize(builder);</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="keyword">return</span> builder;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åã€ç´¢å¼•ã€æ–‡æ¡£-API-æ“ä½œ"><a href="#åã€ç´¢å¼•ã€æ–‡æ¡£-API-æ“ä½œ" class="headerlink" title="åã€ç´¢å¼•ã€æ–‡æ¡£ API æ“ä½œ"></a>åã€ç´¢å¼•ã€æ–‡æ¡£ API æ“ä½œ</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wangba;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.wangba.enity.User;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.search.TermQuery;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.util.QueryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.action.admin.indices.delete.DeleteIndexRequest;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.action.bulk.BulkRequest;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.action.bulk.BulkResponse;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.action.delete.DeleteRequest;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.action.delete.DeleteResponse;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.action.get.GetRequest;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.action.get.GetResponse;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.action.index.IndexRequest;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.action.index.IndexResponse;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.action.search.SearchRequest;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.action.search.SearchRequestBuilder;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.action.search.SearchResponse;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.action.support.master.AcknowledgedResponse;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.action.update.UpdateRequest;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.action.update.UpdateResponse;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.client.RequestOptions;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.client.RestHighLevelClient;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.client.indices.CreateIndexRequest;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.client.indices.CreateIndexResponse;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.client.indices.GetIndexRequest;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.common.unit.TimeValue;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.common.xcontent.XContentType;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.index.query.MatchAllQueryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.index.query.QueryBuilders;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.index.query.TermQueryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.search.SearchHit;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.search.builder.SearchSourceBuilder;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.search.fetch.subphase.FetchSourceContext;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.repository.query.Param;</span><br><span class="line"><span class="keyword">import</span> org.w3c.dom.ls.LSOutput;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpringbootEsApiApplicationTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(&quot;restHighLevelClient&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> RestHighLevelClient client;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Description</span>: åˆ›å»ºç´¢å¼•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Param</span>: []</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>: void</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span>: wang ba</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Date</span>: 2020/7/29</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">createIndex</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">// 1. åˆ›å»ºç´¢å¼•è¯·æ±‚</span></span><br><span class="line">        CreateIndexRequest request = <span class="keyword">new</span> CreateIndexRequest(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">        <span class="comment">// 2. è®©å®¢æˆ·ç«¯æ‰§è¡Œè¯·æ±‚ indicesClient</span></span><br><span class="line">        CreateIndexResponse createIndexResponse = client.indices().create(request, RequestOptions.DEFAULT);</span><br><span class="line"></span><br><span class="line">        System.out.println(createIndexResponse);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Description</span>: æŸ¥è¯¢ç´¢å¼•</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Param</span>: []</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span>: void</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Author</span>: wang ba</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Date</span>: 2020/7/29</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">existIndex</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        GetIndexRequest request = <span class="keyword">new</span> GetIndexRequest(<span class="string">&quot;test&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">boolean</span> exists = client.indices().exists(request, RequestOptions.DEFAULT);</span><br><span class="line"></span><br><span class="line">      System.out.println(exists);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Description</span>: åˆ é™¤ç´¢å¼•</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Param</span>: []</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span>: void</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Author</span>: wang ba</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Date</span>: 2020/7/29</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deleteIndex</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">      DeleteIndexRequest request = <span class="keyword">new</span> DeleteIndexRequest(<span class="string">&quot;test&quot;</span>);</span><br><span class="line"></span><br><span class="line">      AcknowledgedResponse delete = client.indices().delete(request, RequestOptions.DEFAULT);</span><br><span class="line"></span><br><span class="line">      System.out.println(delete);</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@Description</span>: æ·»åŠ æ–‡æ¡£ PUT test/_doc/1</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@Param</span>: []</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span>: void</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@Author</span>: wang ba</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@Date</span>: 2020/7/29</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">void</span> <span class="title">addDocument</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">      <span class="comment">// åˆ›å»ºå¯¹è±¡</span></span><br><span class="line">      User user = <span class="keyword">new</span> User(<span class="string">&quot;wangba&quot;</span>, <span class="number">25</span>);</span><br><span class="line">      <span class="comment">// åˆ›å»ºè¯·æ±‚</span></span><br><span class="line">      IndexRequest request = <span class="keyword">new</span> IndexRequest(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">      <span class="comment">// è§„åˆ™ï¼š  ==&gt;   PUT test/_doc/1</span></span><br><span class="line">      request.id(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">      request.timeout(<span class="string">&quot;1s&quot;</span>);</span><br><span class="line">      <span class="comment">// å°†æˆ‘ä»¬çš„æ•°æ®æ”¾å…¥è¯·æ±‚ä¸­   JSONæ ¼å¼</span></span><br><span class="line">      request.source(JSON.toJSONString(user), XContentType.JSON);</span><br><span class="line">      <span class="comment">// å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œè¿”å›ç»“æœ</span></span><br><span class="line">        IndexResponse indexResponse = client.index(request, RequestOptions.DEFAULT);</span><br><span class="line"></span><br><span class="line">        System.out.println(indexResponse);</span><br><span class="line">        System.out.println(indexResponse.toString());</span><br><span class="line">        System.out.println(indexResponse.status());   <span class="comment">// å¯¹åº”çš„çŠ¶æ€å°±æ˜¯ CREATED ç­‰</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Description</span>: æ–‡æ¡£æ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Param</span>: []</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span>: void</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Author</span>: wang ba</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Date</span>: 2020/7/29</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">existDocument</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">// GET test/_doc/1</span></span><br><span class="line">        GetRequest request = <span class="keyword">new</span> GetRequest(<span class="string">&quot;test&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">        <span class="comment">// _source ä¸æ˜¾ç¤ºä¸Šä¸‹æ–‡</span></span><br><span class="line">        request.fetchSourceContext(<span class="keyword">new</span> FetchSourceContext(<span class="keyword">false</span>));</span><br><span class="line">        request.storedFields(<span class="string">&quot;_none_&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">boolean</span> exists = client.exists(request, RequestOptions.DEFAULT);</span><br><span class="line">        System.out.println(exists);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Description</span>: æŸ¥è¯¢æ–‡æ¡£æ•°æ®  GET test/_doc/1</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Param</span>: []</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span>: void</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Author</span>: wang ba</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Date</span>: 2020/7/29</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getDocument</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        GetRequest request = <span class="keyword">new</span> GetRequest(<span class="string">&quot;test&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line"></span><br><span class="line">        GetResponse documentFields = client.get(request, RequestOptions.DEFAULT);</span><br><span class="line"></span><br><span class="line">        System.out.println(documentFields.getSourceAsString());</span><br><span class="line">        System.out.println(documentFields);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Description</span>: æ›´æ–°æ–‡æ¡£</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Param</span>: []</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span>: void</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Author</span>: wang ba</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Date</span>: 2020/7/29</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updateDocument</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        UpdateRequest request = <span class="keyword">new</span> UpdateRequest(<span class="string">&quot;test&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">        User user = <span class="keyword">new</span> User(<span class="string">&quot;zhansan&quot;</span>, <span class="number">22</span>);</span><br><span class="line">        request.doc(JSON.toJSONString(user), XContentType.JSON);</span><br><span class="line">        UpdateResponse update = client.update(request, RequestOptions.DEFAULT);</span><br><span class="line"></span><br><span class="line">        System.out.println(update);</span><br><span class="line">        System.out.println(update.status());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Description</span>: åˆ é™¤æ–‡æ¡£  DELETE test/_doc/1</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Param</span>: []</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span>: void</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Author</span>: wang ba</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Date</span>: 2020/7/29</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deleteDocument</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        DeleteRequest request = <span class="keyword">new</span> DeleteRequest(<span class="string">&quot;test&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line"></span><br><span class="line">        DeleteResponse delete = client.delete(request, RequestOptions.DEFAULT);</span><br><span class="line">        System.out.println(delete);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Description</span>: æ‰¹å¤„ç†è¯·æ±‚</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Param</span>: []</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span>: void</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Author</span>: wang ba</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Date</span>: 2020/7/29</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addBulkDocument</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        BulkRequest bulkRequest = <span class="keyword">new</span> BulkRequest();</span><br><span class="line">        bulkRequest.timeout(<span class="string">&quot;10s&quot;</span>);</span><br><span class="line"></span><br><span class="line">        ArrayList&lt;User&gt; userArrayList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        userArrayList.add(<span class="keyword">new</span> User(<span class="string">&quot;zhangsan&quot;</span>, <span class="number">5</span>));</span><br><span class="line">        userArrayList.add(<span class="keyword">new</span> User(<span class="string">&quot;lisi&quot;</span>, <span class="number">10</span>));</span><br><span class="line">        userArrayList.add(<span class="keyword">new</span> User(<span class="string">&quot;xiaoxin&quot;</span>, <span class="number">25</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; userArrayList.size(); i++) &#123;</span><br><span class="line">            bulkRequest.add(</span><br><span class="line">                    <span class="keyword">new</span> IndexRequest(<span class="string">&quot;test&quot;</span>)</span><br><span class="line">                    .id(<span class="string">&quot;&quot;</span>+(i+<span class="number">1</span>))</span><br><span class="line">                    .source(JSON.toJSONString(userArrayList.get(i)), XContentType.JSON)</span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        BulkResponse bulk = client.bulk(bulkRequest, RequestOptions.DEFAULT);</span><br><span class="line"></span><br><span class="line">        System.out.println(bulk);</span><br><span class="line">        System.out.println(bulk.status());</span><br><span class="line">        System.out.println(bulk.hasFailures());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Description</span>: æŒ‰æ¡ä»¶æœç´¢</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Param</span>: []</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span>: void</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Author</span>: wang ba</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@Date</span>: 2020/7/29</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        æŸ¥è¯¢ï¼š</span></span><br><span class="line"><span class="comment">        SearchRequest          æœç´¢è¯·æ±‚</span></span><br><span class="line"><span class="comment">        SearchSourceBuilder    æ¡ä»¶æ„é€ </span></span><br><span class="line"><span class="comment">        HighlightBuilder       é«˜äº®æ„é€ </span></span><br><span class="line"><span class="comment">        TermQueryBuilder       ç²¾ç¡®æŸ¥è¯¢</span></span><br><span class="line"><span class="comment">        MatchAllQueryBuilder   æ‰€æœ‰æŸ¥è¯¢</span></span><br><span class="line"><span class="comment">        // xxxBuilder</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">searchDocument</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºæœç´¢è¯·æ±‚</span></span><br><span class="line">        SearchRequest searchRequest = <span class="keyword">new</span> SearchRequest(<span class="string">&quot;test&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ„é€ æœç´¢æ¡ä»¶</span></span><br><span class="line">        SearchSourceBuilder searchSourceBuilder = <span class="keyword">new</span> SearchSourceBuilder();</span><br><span class="line">        <span class="comment">// QueryBuilders.termQuery ç²¾ç¡®æŸ¥è¯¢</span></span><br><span class="line">        <span class="comment">// QueryBuilders.matchAllQuery æŸ¥è¯¢æ‰€æœ‰</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//TermQueryBuilder termQueryBuilder = QueryBuilders.termQuery(&quot;age&quot;, &quot;25&quot;);</span></span><br><span class="line">        <span class="comment">//searchSourceBuilder.query(termQueryBuilder);</span></span><br><span class="line"></span><br><span class="line">        MatchAllQueryBuilder matchAllQueryBuilder = QueryBuilders.matchAllQuery();</span><br><span class="line">        searchSourceBuilder.query(matchAllQueryBuilder);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ†é¡µ</span></span><br><span class="line">        <span class="comment">// searchSourceBuilder.from();</span></span><br><span class="line">        <span class="comment">// searchSourceBuilder.size();</span></span><br><span class="line"></span><br><span class="line">        searchSourceBuilder.timeout(<span class="keyword">new</span> TimeValue(<span class="number">60</span>, TimeUnit.SECONDS));</span><br><span class="line"></span><br><span class="line">        searchRequest.source(searchSourceBuilder);</span><br><span class="line"></span><br><span class="line">        SearchResponse search = client.search(searchRequest, RequestOptions.DEFAULT);</span><br><span class="line">        System.out.println(JSON.toJSONString(search.getHits()));</span><br><span class="line">        System.out.println(<span class="string">&quot;+++++++++++++æˆ‘æ˜¯åˆ†å‰²çº¿++++++++++++++&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (SearchHit documentFields : search.getHits().getHits()) &#123;</span><br><span class="line">            System.out.println(documentFields.getSourceAsMap());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åä¸€ã€å®æˆ˜"><a href="#åä¸€ã€å®æˆ˜" class="headerlink" title="åä¸€ã€å®æˆ˜"></a>åä¸€ã€å®æˆ˜</h2>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> ES </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
